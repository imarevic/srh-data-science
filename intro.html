
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Modul Statistik und Machine Learning Modelle</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/myfile.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint single-page" id="site-navigation">
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/ixianslab/srh-data-science"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/ixianslab/srh-data-science/issues/new?title=Issue%20on%20page%20%2Fintro.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Modul Statistik und Machine Learning Modelle</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="modul-statistik-und-machine-learning-modelle">
<h1>Modul Statistik und Machine Learning Modelle<a class="headerlink" href="#modul-statistik-und-machine-learning-modelle" title="Permalink to this headline">#</a></h1>
<p><img alt="" src="_images/SRH-master.jpg" /></p>
<section id="autoren">
<h2>Autoren<a class="headerlink" href="#autoren" title="Permalink to this headline">#</a></h2>
<p><strong>Dr. rer. nat. Joachim Krois</strong></p>
<p>Leitender Datenwissenschaftler in der Abteilung ODDH2, Charité - Universitätsmedizin Berlin. Er arbeitet vorwiegend in den Bereichen Statistik, prädiktive Modellierung, maschinelles Lernen, Computer Vision, Epidemiologie und Versorgungsforschung. Ein Arbeitsschwerpunkten ist die Entwicklung konkreter Lösungen zur Verbesserung der zahnmedizinischen Diagnostik durch die Anwendung von Techniken des maschinellen Lernens. Joachim Krois ist ein Advokat des Paradigmas der Datenzahnmedizin. Hierbei wird der Komplexität der Entscheidungsfindung im medizinischen Bereich Rechnung getragen indem Kosten, Nutzen und Vertrauenswürdigkeit von Prognosesystemen kritisch evaluiert werden. Er ist Teil der ITU/WHO Focus Group Artificial Intelligence for Health (AI4H) und verantwortet dort in der Themengruppe “Dental diagnostics and digital dentistry” kollaborativ und interdisziplinär am Benchmarking für KI-Algorithmen. Dadurch sollen die Generalisierbarkeit und Vertrauenswürdigkeit von KI-Systemen verbessert werden.</p>
<p><strong>Mag. rer. nat. Jan Senekowitsch</strong></p>
<p>Studium der theoretischen Physik an der Karl-Franzens Universität Graz und wissenschaftlicher Mitarbeiter an der Technischen Universität Graz im Arbeitsbereich Quantenchemie. Derzeit arbeitet er als Consultant und Freelancer.</p>
</section>
<div class="toctree-wrapper compound">
<span id="document-Vorwort"></span><section class="tex2jax_ignore mathjax_ignore" id="vorwort">
<h2>Vorwort<a class="headerlink" href="#vorwort" title="Permalink to this headline">#</a></h2>
<p>Im Jahr 2000 wurde der Datenwissenschaftler als der ” Sexiest Job of the 21st Century” bezeichnet (<a class="reference external" href="https://hbr.org/2012/10/data-scientist-the-sexiest-job-of-the-21st-century">Harvard Business Review, 2012</a>). Diese mutige Prognose beruht auf der Vorahnung eines Paradigmenwechsels in Wissenschaft und Forschung, der mehr und mehr auch zu sozio-ökonomischen Veränderungen führen würde.</p>
<p>Bereits im 17. Jahrhundert sind die experimentellen und theoretischen Wissenschaften entstanden, die heute als die beiden grundlegenden Forschungsparadigmen für das Verständnis der Natur gelten. In den letzten Jahrzehnten sind Computersimulationen zu einem dritten Paradigma geworden. Heute, an der Schwelle zur Big-Data-Ära hat sich ein viertes Paradigma herausgebildet, welches auf datenintensiven Methoden beruht. Viele Branchen machen sich das datengetrieben Paradigma bereits zu eigen und nutzen Daten, um Wert zu erschaffen. Daten gelten als eine Schlüsselressource für moderne Gesellschaften und erfüllen eine Reihe von Merkmalen, um eine technologische Revolution auszulösen. Dazu gehören unter anderem, dass die Kosten für die Nutzung von Daten niedrig sind, Daten eine unerschöpfliche Ressource darstellen, da sie beliebig oft und von beliebig vielen Akteuren genutzt werden können, und eine intelligente Nutzung von Daten die Effizienz von Prozessen und Verfahren erhöht. Viele große Technologieunternehmen haben den Wert von Daten bereits in den 1990er und 2000er Jahren erkannt, in denen auch der Begriff “Data ist the new oil ” geprägt wurde (<a class="reference external" href="https://www.economist.com/leaders/2017/05/06/the-worlds-most-valuable-resource-is-no-longer-oil-but-data">Economist 2017</a>).</p>
<p>Dabei sind statistische Methoden und der Einsatz von computer-gestützten Methoden essentiell für die Auswertung und Interpretation von Daten. Ziel dieses Moduls ist es die Grundlagen der deskriptiven und der schliessenden Statistik aber auch Programmierkenntnisse zu vermitteln, um diese zur Datenauswertung und Problemlösung einsetzen zu können. Die Verbindung eines mathematischen Fachwissens mit Programmierkenntnissen sowie eine problembezogene und lösungsorientierte Anwendung derselben wird oft als “Data Science” beschrieben.</p>
<p>In den letzten Jahrzehnten erfreute sich die Programmiersprache Python wachsender Beliebtheit. Python hat sich zunehmend als Standardsprache in der Data Science etabliert da sie einer einfachen gut leserlichen Syntax folgt aber auch strukturierte, objektorientierte, aspektorientierte und funktionale Programmierstile ermöglicht. Ein weitere Vorzug von Python ist der einfache Umgang mit umfangreichen Bibliotheken wie <a class="reference external" href="https://numpy.org/">NumPy</a>, <a class="reference external" href="https://pandas.pydata.org/">pandas</a> und <a class="reference external" href="https://matplotlib.org/">matplotlib</a>.</p>
<p>In diesem Sinne wünschen Ihnen die Autoren viel Erfolg uns Spaß mit dem Erlernen von statistischen Methoden und deren Anwendung mithilfe der Programmiersprache Python.</p>
<p>Berlin, August 2022<br />
Dr. rer. nat. Joachim Krois</p>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-Lernziele/Kapitel1_Lernziele"></span><section class="tex2jax_ignore mathjax_ignore" id="lernziele">
<h2>Lernziele<a class="headerlink" href="#lernziele" title="Permalink to this headline">#</a></h2>
<section id="strukturierte-datensatze-und-deskriptive-statistik">
<h3>Strukturierte Datensätze und deskriptive Statistik<a class="headerlink" href="#strukturierte-datensatze-und-deskriptive-statistik" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Der Umgang mit strukturierten Datensätzen wird anhand Panda Dataframes vorgestellt. Das Erstellen, Modifizieren und Selektieren von Daten wird demonstriert.</p></li>
<li><p>Die Grundlagen der deskriptiven Statistik wie unterschiedliche Möglichkeiten die zentralen Tendenz von Daten zu bestimmen werden am Beispiel von Mittelwert, Modalwert, Median besprochen. Es werden anhand des <code class="docutils literal notranslate"><span class="pre">students</span></code> Beispielsdatensatzes deren Vor- und Nachteile veranschaulicht.</p></li>
<li><p>Weiters werden Streuungsmaße und deren Bedeutung in der deskriptiven Statistik diskutiert. Begriffe wie Varianz, Standardabweichung werden erklärt. Es wird durch numerische Simulation das Tschebyscheff-Theorem vorgestellt.</p></li>
<li><p>Letztlich werden Maße für die Korrelation zwischen Variablen und deren Bedeutung in der deskriptiven Statistik besprochen. Die Studierenden lernen Kovarianz, Pearson- und Spearman Korrelation und Kontingenzkoeffizient kennen.</p></li>
<li><p>Zusammengefasst werden folgende Begriffe und Methoden besprochen: Maße der zentralen Tendenz, Streuungsmaße, Positionsmaß, 5-Punkte-Zusammenfassung, Ausreißer und Boxplots, Maße für die Relation zwischen Variablen</p></li>
</ul>
</section>
</section>
<span id="document-Kapitel01/01_Deskriptive_Statistik"></span><section class="tex2jax_ignore mathjax_ignore" id="deskriptive-statistik">
<h2>Deskriptive Statistik<a class="headerlink" href="#deskriptive-statistik" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<p>Angewandte Statistik lässt sich in zwei Bereiche unterteilen: <a href="https://de.wikipedia.org/wiki/Deskriptive_Statistik">deskriptive Statistik</a> und <a href="https://de.wikipedia.org/wiki/Statistische_Inferenz">Inferenzstatistik</a>. Die deskriptive Statistik umfasst Methoden zur Organisation, Darstellung und Beschreibung von Daten mit Hilfe von Tabellen, Diagrammen und Streuungsmaßen. Im Gegensatz dazu besteht die Inferenzstatistik aus Methoden, die Stichprobenergebnisse verwenden, um Entscheidungen oder Vorhersagen über eine Grundgesamtheit zu treffen (<span id="id1">Cramer [<a class="reference internal" href="intro.html#id6" title="Udo Cramer, Erhard und Kamps. Grundlagen der Wahrscheinlichkeitsrechnung und Statistik: Eine Einführung für Studierende der Informatik, der Ingenieur-und Wirtschaftswissenschaften. Springer-Verlag, 2017.">2017</a>]</span> s.1–151, 231–312, <span id="id2">Fahrmeir <em>et al.</em> [<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">2016</a>]</span> s.10, 12 ).</p>
<p>Das Wort <a class="reference external" href="https://de.wikipedia.org/wiki/Univariat">univariat</a> bezieht sich auf die Tatsache, dass nur eine Variable betrachtet wird. Der Hauptzweck der univariaten Statistik besteht darin, die Daten zu beschreiben und zusammenzufassen. Wenn zwei oder mehr Variablen analysiert werden, spricht man von <a class="reference external" href="https://de.wikipedia.org/wiki/Univariat#Verwendung_in_der_Mathematik">bivariater</a> oder <a class="reference external" href="https://de.wikipedia.org/wiki/Multivariate_Verfahren">multivariater Analyse</a> bzw. Statistik. In diesem Fall sind wir in erster Linie an den Beziehungen zwischen und unter einer Reihe von Variablen interessiert.</p>
<section id="strukturierte-datensatze">
<h3>Strukturierte Datensätze<a class="headerlink" href="#strukturierte-datensatze" title="Permalink to this headline">#</a></h3>
<section id="strukturierte-daten">
<h4>Strukturierte Daten<a class="headerlink" href="#strukturierte-daten" title="Permalink to this headline">#</a></h4>
<p>Bei <a href="https://de.wikipedia.org/wiki/Data_Science">Data Science</a> geht es um die Gewinnung von Wissen aus
<a href="https://de.wikipedia.org/wiki/Daten">Daten</a>. Daten sind eine spezifische Form von <a href="https://de.wikipedia.org/wiki/Information">Informationen</a> und weisen verschiedene Abstraktions- und Strukturniveaus auf (<a href="https://de.wikipedia.org/wiki/Datenmodell">strukturiert</a>, <a href="https://de.wikipedia.org/wiki/Semistrukturierte_Daten">halbstrukturiert</a> oder <a href="https://de.wikipedia.org/wiki/Unstrukturierte_Daten">unstrukturiert</a>). <br> Eine sehr verbreitete <a href="https://de.wikipedia.org/wiki/Datenstruktur">Datenstruktur</a> ist ein Array. In verschiedenen Bereichen gibt es andere Bezeichnungen für einen solchen Datentyp, die synonym verwendet werden, z. B. Matrix (<span id="id3">Lang [<a class="reference internal" href="intro.html#id5" title="Norbert Lang, Christian B und Pucker. Mathematische Methoden in der Physik. Volume 2. Springer, 2005.">2005</a>]</span>) in der Mathematik, <a href="https://de.wikipedia.org/wiki/Datenbanktabelle">Tabelle</a> in Datenbanken, <a href="https://de.wikipedia.org/wiki/Tabellenkalkulation">Tabellenkalkulation</a> und <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html">Dataframe</a> , der eine grundlegende Python-Objektklasse ist z. B. : (Pandas <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>). <br> Daten eines solchen Typs bestehen aus Beobachtungen und entsprechenden Variablen, die oft als Merkmale bezeichnet werden.</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>id</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>Age</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>John</p></td>
<td><p>26</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>Alice</p></td>
<td><p>20</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>Mike</p></td>
<td><p>21</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>Anne</p></td>
<td><p>25</p></td>
</tr>
</tbody>
</table>
<p>In diesem Beispiel entsprechen die <strong>Beobachtungen</strong> (<em>Stichprobe</em> genannt) einer Anzahl von Personen. Jede beobachtete Person wird durch eine Reihe von <strong>Variablen</strong> (so genannte <em>Merkmale</em>) charakterisiert: Durch eine Identifikationsnummer (id), durch einen Namen und durch ein Alter. In unserem Beispiel ist es sehr einfach, sich durch einen Blick auf die Tabelle einen Gesamteindruck von den Daten selbst zu verschaffen. Wir erkennen sofort, dass es in unserer Stichprobe <span class="math notranslate nohighlight">\(4\)</span> Personen gibt, zwei Frauen und zwei Männer. Außerdem sehen wir sofort, dass die jüngste Person <span class="math notranslate nohighlight">\(20\)</span> Jahre alt ist und Alice heißt und die älteste Person <span class="math notranslate nohighlight">\(26\)</span> Jahre alt ist und John heißt.</p>
<p>Anwendungen in der realen Welt enthalten jedoch oft eine große Menge an Daten. Hunderte, Tausende, Millionen oder sogar Milliarden von Beobachtungen, kombiniert mit Tausenden von Variablen, können einen Datensatz bilden. Für den Menschen ist es unmöglich, allein durch die Betrachtung solcher Datensätze irgendwelche Schlussfolgerungen über die Daten zu ziehen. Daher reduzieren wir die Daten auf eine überschaubare Größe, indem wir Tabellen erstellen, Diagramme zeichnen oder zusammenfassende Maße wie Durchschnittswerte berechnen. Diese Art von statistischen Methoden wird als <strong>deskriptive Statistik</strong> bezeichnet (<span id="id4">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.10).</p>
</section>
<section id="der-students-datensatz">
<h4>Der <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz<a class="headerlink" href="#der-students-datensatz" title="Permalink to this headline">#</a></h4>
<p>In diesem Abschnitt werden wir einen Datensatz namens <code class="docutils literal notranslate"><span class="pre">students</span></code> untersuchen. Zunächst laden wir den Datensatz, geben ihm einen geeigneten Namen und verschaffen uns einen Eindruck von seiner Struktur und Größe, indem wir die Methode <code class="docutils literal notranslate"><span class="pre">info()</span></code> auf den Datensatz anwenden.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lese Datei students.csv als Dataframe ein</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../data/students.csv&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 8239 entries, 0 to 8238
Data columns (total 16 columns):
 #   Column           Non-Null Count  Dtype  
---  ------           --------------  -----  
 0   stud_id          8239 non-null   int64  
 1   name             8239 non-null   object 
 2   gender           8239 non-null   object 
 3   age              8239 non-null   int64  
 4   height           8239 non-null   int64  
 5   weight           8239 non-null   float64
 6   religion         8239 non-null   object 
 7   nc_score         8239 non-null   float64
 8   semester         8239 non-null   object 
 9   major            8239 non-null   object 
 10  minor            8239 non-null   object 
 11  score1           4892 non-null   float64
 12  score2           4892 non-null   float64
 13  online_tutorial  8239 non-null   int64  
 14  graduated        8239 non-null   int64  
 15  salary           1753 non-null   float64
dtypes: float64(5), int64(5), object(6)
memory usage: 1.0+ MB
</pre></div>
</div>
</div>
</div>
<p>Der Studentendatensatz besteht aus <span class="math notranslate nohighlight">\(8239\)</span> Zeilen, von denen jede einen bestimmten Studenten repräsentiert, und <span class="math notranslate nohighlight">\(16\)</span> Spalten, von denen jede einer Variable/einem Merkmal entspricht, das sich auf diesen bestimmten Studenten bezieht. Diese selbsterklärenden Variablen sind: <em>stud_id, name, gender, age, height, weight, religion, nc_score, semester, major, minor, score1, score2, online_tutorial, graduated, salary</em>. Neben dem jeweiligen Variablennamen listet die Methode <code class="docutils literal notranslate"><span class="pre">info()</span></code> die <code class="docutils literal notranslate"><span class="pre">Klasse</span></code> jeder einzelnen Variablen auf. Alle Objekte in Python haben eine Klasse, z. B. <code class="docutils literal notranslate"><span class="pre">numerische</span></code> Datentypen , die in die Unterklassen <code class="docutils literal notranslate"><span class="pre">(int)</span></code> Ganzzahlen , <code class="docutils literal notranslate"><span class="pre">(float)</span></code> Gleitkommazahlen und <code class="docutils literal notranslate"><span class="pre">(imag)</span></code> komplexe Zahlen, eingeteilt werden.</p>
<p>In den nächsten Abschnitten werden wir die deskriptiven Statistiken des <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatzes genauer untersuchen.</p>
</section>
</section>
</section>
<span id="document-Kapitel01/02_Maße_der_zentralen_Tendenz"></span><section class="tex2jax_ignore mathjax_ignore" id="masze-der-zentralen-tendenz">
<h2>Maße der zentralen Tendenz<a class="headerlink" href="#masze-der-zentralen-tendenz" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statistics</span> <span class="k">as</span> <span class="nn">st</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<p>Um ein Gefühl für einen Datensatz zu bekommen, kann er durch numerische Streuungsmaße beschrieben werden. Es gibt drei Hauptmaße für die <strong>zentrale Tendenz</strong>: den <strong>Mittelwert</strong>, den <strong>Median</strong> und den <strong>Modalwert</strong>; es gibt jedoch auch andere Maße für die zentrale Tendenz, wie z. B. das <strong>harmonische Mittel</strong>, das <strong>gewichtete Mittel</strong> und das <strong>geometrische Mittel</strong>, um nur einige zu nennen.</p>
<section id="der-mittelwert">
<h3>Der Mittelwert<a class="headerlink" href="#der-mittelwert" title="Permalink to this headline">#</a></h3>
<section id="der-arithmethische-mittelwert">
<h4>Der arithmethische Mittelwert<a class="headerlink" href="#der-arithmethische-mittelwert" title="Permalink to this headline">#</a></h4>
<div class="math notranslate nohighlight">
\[\text{Mittelwert} = \frac{\text{Summe aller Werte}}{\text{Anzahl aller Werte}}\]</div>
<p>Das für Stichprobendaten berechnete arithmetische Mittel wird mit <span class="math notranslate nohighlight">\(\bar{x}\)</span> (gelesen als “x strich”) bezeichnet, und das Mittel für Grundgesamtheitsdaten wird mit <span class="math notranslate nohighlight">\(\mu\)</span> (griechischer Buchstabe mu) bezeichnet. Der Mittelwert kann also durch die folgenden Gleichungen ausgedrückt werden:</p>
<div class="math notranslate nohighlight">
\[\bar{x}=\frac{1}{n} \cdot \sum_{i=1}^n x_i\]</div>
<p>oder</p>
<div class="math notranslate nohighlight">
\[\mu=\frac{1}{N} \cdot \sum_{i=1}^N x_i\]</div>
<p>wobei <span class="math notranslate nohighlight">\(\sum_{i=1}^n x_i\)</span> die Summe aller Werte <span class="math notranslate nohighlight">\((x_1,x_2,...,x_n)\)</span>, <span class="math notranslate nohighlight">\(N\)</span> der Umfang der Grundgesamtheit und <span class="math notranslate nohighlight">\(n\)</span> der Stichprobenumfang ist.
Betrachten wir die Variable <code class="docutils literal notranslate"><span class="pre">height</span></code> im Datensatz <code class="docutils literal notranslate"><span class="pre">students</span></code> und berechnen wir ihr arithmetisches Mittel. Beachten Sie, dass es sich bei dem <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz um eine <em>Stichprobe</em> und <strong>nicht</strong> um die Grundgesamtheit aller Studenten handelt. Daher berechnen wir <span class="math notranslate nohighlight">\(\bar{x}\)</span>, den Stichprobenmittelwert.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../data/students.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># Wende Funktion mean() auf Spalte &#39;height&#39; an und speicher Ergebnis in height_mean</span>
<span class="n">height_mean</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mittelwert der Körpergöße der Studenten: </span><span class="si">{</span><span class="n">height_mean</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mittelwert der Körpergöße der Studenten: 171.38075009103048
</pre></div>
</div>
</div>
</div>
</section>
<section id="das-geometrische-mittel">
<h4>Das geometrische Mittel<a class="headerlink" href="#das-geometrische-mittel" title="Permalink to this headline">#</a></h4>
<p>Bei der Untersuchung von Phänomenen wie der Inflation oder der Bevölkerungsentwicklung, die mit periodischen Zu- oder Abnahmen einhergehen (so genannte Veränderungsraten), ist das <strong>geometrische Mittel</strong> besser geeignet, um die durchschnittliche Veränderung über den gesamten Untersuchungszeitraum zu ermitteln. Um das geometrische Mittel einer Folge von <span class="math notranslate nohighlight">\(n\)</span> Werten <span class="math notranslate nohighlight">\(x_1,x_2,\dots,x_n \)</span> zu berechnen, werden diese miteinander multipliziert und dann die <span class="math notranslate nohighlight">\(n\)</span>-te Wurzel aus diesem Produkt ermittelt.</p>
<div class="math notranslate nohighlight">
\[ \bar{x}_{geo}=\sqrt{x_1\cdot x_2 \cdots  x_n}\]</div>
<p>was umgeschrieben werden kann als</p>
<div class="math notranslate nohighlight">
\[ \bar{x}_{geo} = \sqrt{x_1\cdot x_2 \cdots  x_n} = (\prod_{i=1}^n x_i)^{\frac{1}{n}} = \sqrt[n]{\prod_{i=1}^n x_i}\]</div>
<p>Lassen Sie uns das an einem Beispiel verdeutlichen: <br>
Wir betrachten die jährlichen Wachstumsraten eines Schwarmes von Honigbienen über einen Zeitraum von <span class="math notranslate nohighlight">\(5\)</span> Jahren. Diese Veränderungsraten sind: <span class="math notranslate nohighlight">\(14 \%\)</span>, <span class="math notranslate nohighlight">\(26 \%\)</span>, <span class="math notranslate nohighlight">\(16 \%\)</span>, <span class="math notranslate nohighlight">\(-38 \%\)</span>, <span class="math notranslate nohighlight">\(-6 \%\)</span>. Außerdem wissen wir, dass sich zu Beginn des Beobachtungszeitraums <span class="math notranslate nohighlight">\(5.000\)</span> Bienen im Schwarm befunden haben. Wir suchen nach der mittleren Rate der Populationsveränderung. <br>
Zunächst schreiben wir unsere Wachstumsraten in eine Liste.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bees</span> <span class="o">=</span> <span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="o">-</span><span class="mi">38</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Nun wenden wir wider besseres Wissens das arithmetische Mittel an: <br></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Wir verwenden die Funktion `mean()` im Paket `numpy`.</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Die mittlere Änderungsrate der Bienenpopulation ist </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bees</span><span class="p">)</span><span class="si">}</span><span class="s2"> Prozent&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Die mittlere Änderungsrate der Bienenpopulation ist 2.4 Prozent
</pre></div>
</div>
</div>
</div>
<p>Das arithmetische Mittel zeigt, dass der Schwarm über den Zeitraum von fünf Jahren wächst! Wir sind skeptisch und berechnen das jährliche Wachstum des Bienenschwarms explizit. Zunächst wandeln wir die angegebenen Prozentsätze in relative Wachstumsraten um (<code class="docutils literal notranslate"><span class="pre">bees_growth_rel</span></code>), und dann berechnen wir einfach den Stand der Bienenpopulation, indem wir die Veränderungsraten nacheinander mit der Anzahl der Bienen multiplizieren, von der wir wissen, dass sie zu Beginn der Erhebung <span class="math notranslate nohighlight">\(5.000\)</span> betrug.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;bees:       &quot;</span><span class="p">,</span> <span class="n">bees</span><span class="p">)</span>
<span class="c1"># Initialisiere leere Liste bees_growth_rel und Indexvariable i</span>
<span class="n">bees_growth_rel</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="mi">100</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bees</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;bees rates: &quot;</span><span class="p">,</span> <span class="n">bees_growth_rel</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>bees:        [14, 26, 16, -38, -6]
bees rates:  [1.14, 1.26, 1.16, 0.62, 0.94]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="k">for</span> <span class="n">rate</span> <span class="ow">in</span> <span class="n">bees_growth_rel</span><span class="p">:</span>
    <span class="n">pop</span> <span class="o">=</span> <span class="n">pop</span> <span class="o">*</span> <span class="n">rate</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Nach einem relativen Wachstum von </span><span class="si">{</span><span class="n">rate</span><span class="si">}</span><span class="s2"> erreicht die Population einen Wert von </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Nach einem relativen Wachstum von 1.14 erreicht die Population einen Wert von 5700.0
Nach einem relativen Wachstum von 1.26 erreicht die Population einen Wert von 7182.0
Nach einem relativen Wachstum von 1.16 erreicht die Population einen Wert von 8331.0
Nach einem relativen Wachstum von 0.62 erreicht die Population einen Wert von 5165.0
Nach einem relativen Wachstum von 0.94 erreicht die Population einen Wert von 4855.0
</pre></div>
</div>
</div>
</div>
<p>Wow, was für eine Überraschung! Offensichtlich stimmt da etwas nicht! Wir hatten erwartet, dass der Schwarm im Laufe der Zeit im Durchschnitt zunehmen würde. Wir haben jedoch einen Rückgang der absoluten Zahl der Bienen berechnet!</p>
<p>Versuchen wir es mit dem geometrischen Mittel. Zum Glück gibt es in Python vordefinierte Funktionspakete für Berechnung von Streuungsmaßen. Diese können durch <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">statistics</span></code> verwendet werden. Die Funktion für das geometrische Mittel heisst <code class="docutils literal notranslate"><span class="pre">geometric_mean()</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">st</span><span class="o">.</span><span class="n">geometric_mean</span><span class="p">(</span><span class="n">bees_growth_rel</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9941469529781075
</pre></div>
</div>
</div>
</div>
<p>Großartig! Das geometrische Mittel zeigt, dass die Zahl der Arten im Laufe der Zeit mit einer durchschnittlichen Rate von <span class="math notranslate nohighlight">\(0,994\)</span> abnimmt, was <span class="math notranslate nohighlight">\(-0,006 \% \)</span> entspricht. Wir überprüfen dies, indem wir <span class="math notranslate nohighlight">\(5.000\)</span> Bienen (die anfängliche Anzahl der Bienen im Schwarm) mal <span class="math notranslate nohighlight">\(0,994\)</span> für jedes Jahr nehmen; dies ergibt <span class="math notranslate nohighlight">\(4.971\)</span> Bienen nach dem ersten Jahr, <span class="math notranslate nohighlight">\(4.942\)</span> nach dem zweiten Jahr, <span class="math notranslate nohighlight">\(4.913\)</span> nach dem dritten Jahr, <span class="math notranslate nohighlight">\(4.884\)</span> nach dem vierten Jahr und <span class="math notranslate nohighlight">\(4.855\)</span> nach dem fünften Jahr der Beobachtung. Eine perfekte Übereinstimmung! Im Gegensatz zum arithmetischen Mittel gibt das geometrische Mittel die Entwicklung im Vergleich zum Vorjahr nicht zu hoch an! <br> <br></p>
</section>
<section id="der-harmonische-mittelwert">
<h4>Der harmonische Mittelwert<a class="headerlink" href="#der-harmonische-mittelwert" title="Permalink to this headline">#</a></h4>
<p>Der <strong>harmonische Mittelwert</strong> eignet sich am besten für die Ermittlung des Durchschnitts von inversen Größen wie Geschwindigkeit (km/h) oder Bevölkerungsdichte (pop/km2).</p>
<p>Betrachten Sie das folgende Beispiel:
Die Entfernung zwischen Ihrem Haus und dem nächsten See beträgt <span class="math notranslate nohighlight">\(40\)</span> km. Sie sind mit einer Geschwindigkeit von <span class="math notranslate nohighlight">\(20\)</span> km pro Stunde zum See gefahren und mit einer Geschwindigkeit von <span class="math notranslate nohighlight">\(80\)</span> km pro Stunde nach Hause zurückgekehrt. Wie hoch war die Durchschnittsgeschwindigkeit während der gesamten Fahrt?
Berechnen wir zunächst das arithmetische Mittel.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialisiere Liste speed_arithmetic</span>
<span class="n">speed_arithmetic</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">80</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">speed_arithmetic</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>50.0
</pre></div>
</div>
</div>
</div>
<p>Das arithmetische Mittel der beiden Geschwindigkeiten, mit denen Sie gefahren sind, beträgt <span class="math notranslate nohighlight">\(50\)</span> km pro Stunde. Dies ist jedoch nicht die richtige Durchschnittsgeschwindigkeit. Es lässt die Tatsache außer Acht, dass Sie mit <span class="math notranslate nohighlight">\(20\)</span> km/h viel länger gefahren sind als mit <span class="math notranslate nohighlight">\(80\)</span> km/h. Um die richtige Durchschnittsgeschwindigkeit zu ermitteln, müssen wir stattdessen das harmonische Mittel berechnen.</p>
<p>Das harmonische Mittel <span class="math notranslate nohighlight">\(\bar{x}_h\)</span>für die positiven reellen Zahlen <span class="math notranslate nohighlight">\(x_1,x_2,...,x_n\)</span> ist definiert durch</p>
<div class="math notranslate nohighlight">
\[\bar{x}_h = \frac{n}{\frac{1}{x_1} + \frac{1}{x_2} + \cdots + \frac{1}{x_n}} = \frac{n}{\sum_{i=1}^{n}\frac{1}{x_i}} \ \  x_i \gt 0, \ \  \forall \ \ i \ \ \]</div>
<p>Wir können die vordefinierte Funktion <code class="docutils literal notranslate"><span class="pre">harmonic_mean</span></code> aus dem Packet <code class="docutils literal notranslate"><span class="pre">statistics</span></code> verwenden:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">speed</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">80</span><span class="p">]</span>
<span class="n">st</span><span class="o">.</span><span class="n">harmonic_mean</span><span class="p">(</span><span class="n">speed</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>32.0
</pre></div>
</div>
</div>
</div>
<p>Aber ist dieses Ergebnis korrekt? Wir versuchen das Ergebnis nachzuvollziehen. Im obigen Beispiel beträgt die Entfernung zwischen dem See und Ihrem Haus <span class="math notranslate nohighlight">\(40\)</span> km. Die Fahrt von A nach B mit einer Geschwindigkeit von <span class="math notranslate nohighlight">\(20\)</span> km/h dauert also <span class="math notranslate nohighlight">\(2\)</span> Stunden. Die Fahrt von B nach A mit einer Geschwindigkeit von <span class="math notranslate nohighlight">\(80\)</span> km/h dauert <span class="math notranslate nohighlight">\(0,5\)</span> Stunden. Die Gesamtzeit für die Rundstrecke von <span class="math notranslate nohighlight">\(2 \times 40\)</span> km beträgt <span class="math notranslate nohighlight">\(2,5\)</span> Stunden. Die Durchschnittsgeschwindigkeit beträgt dann <span class="math notranslate nohighlight">\(\frac{80}{2,5}=32\)</span>.</p>
</section>
<section id="der-gewichtete-mittelwert">
<h4>Der gewichtete Mittelwert<a class="headerlink" href="#der-gewichtete-mittelwert" title="Permalink to this headline">#</a></h4>
<p>Es gibt Anwendungen, bei denen bestimmte Werte in einem Datensatz als wichtiger angesehen werden können als andere. Im Allgemeinen gilt für eine Folge von <span class="math notranslate nohighlight">\(n\)</span> Datenwerten <span class="math notranslate nohighlight">\(x_1,x_2,...,x_n\)</span> und ihren entsprechenden Gewichten <span class="math notranslate nohighlight">\(w_1,w_2,...,w_n\)</span>, ist das gewichtete (arithmetische) Mittel <span class="math notranslate nohighlight">\(\bar{x}_w\)</span> gegeben durch</p>
<div class="math notranslate nohighlight">
\[ \bar{x}_w = \frac{\sum_{i=1}^n w_i x_i}{\sum_{i=1}^n w_i} \]</div>
<p>wobei <span class="math notranslate nohighlight">\(\sum_{i=1}^n w_i x_i\)</span> durch Multiplikation jedes Datenwertes mit seinem Gewicht und anschließender Addition der Produkte ermittelt wird. <br> <br> Um die Noten der Studenten in einem Kurs zu ermitteln, kann ein Dozent beispielsweise der Abschlussprüfung eine dreimal so hohe Gewichtung zuweisen wie den anderen Prüfungen. Ermitteln wir den gewichteten Mittelwert für einen Studenten, der in den ersten beiden Prüfungen <span class="math notranslate nohighlight">\(45\)</span> und <span class="math notranslate nohighlight">\(68\)</span> Punkte und in der Abschlussprüfung <span class="math notranslate nohighlight">\(74\)</span> Punkte erzielt hat.</p>
<p>Wir berechnen as gewichtete Mittel indem wir die Funktion <code class="docutils literal notranslate"><span class="pre">np.average()</span></code> anwenden.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialisiere Liste scores, weights_scores und leere Liste weighted</span>
<span class="n">scores</span> <span class="o">=</span> <span class="p">[</span><span class="mi">45</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">74</span><span class="p">]</span>
<span class="n">weights_scores</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights_scores</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>67.0
</pre></div>
</div>
</div>
</div>
<p>Verglichen mit dem nicht gewichteten Mittelwert ergibt sich ein anderes Ergebnis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>62.333333333333336
</pre></div>
</div>
</div>
</div>
<p>Bitte beachten Sie, dass die Gewichtung der Eingabewerte ein Prinzip ist, das auch auf andere Mittelwertmaße anwendbar ist. Zum Beispiel können wir die Eingangsvariable für die Berechnung des geometrischen Mittels gewichten.</p>
</section>
<section id="der-gewichtete-geometrische-mittelwert">
<h4>Der gewichtete geometrische Mittelwert<a class="headerlink" href="#der-gewichtete-geometrische-mittelwert" title="Permalink to this headline">#</a></h4>
<div class="math notranslate nohighlight">
\[\bar{x}_{geo_w}= (\prod_{i=1}^n {x_i}^{w_i})^{1/\sum_{i=1}^n w_i}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(x_1,x_2,\dots x_n\)</span> den Datenwerten und <span class="math notranslate nohighlight">\(w_1,w_2,\dots w_n\)</span> den Gewichten entsprechen.</p>
<p>Wir greifen auf die Implementierung des gewichteten geometrischen Mittelwerts im <a class="reference external" href="https://scipy.org/">Scipy</a> Modul zurück.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">gmean</span>
</pre></div>
</div>
</div>
</div>
<p>Wir berechnen das Beispiel des Bienenschwarms aus dem obigen Abschnitt erneut. Wir erinnern uns, dass wir im obigen Beispiel einen Bienenschwarm über <span class="math notranslate nohighlight">\(5\)</span> Jahre beobachtet und die Veränderungsraten der Bienenpopulation notiert haben. Die jährlichen Veränderungsraten waren <span class="math notranslate nohighlight">\(1,14 \ \)</span>,<span class="math notranslate nohighlight">\( \  1,26 \ \)</span>,<span class="math notranslate nohighlight">\( \  1,16 \ \)</span>,<span class="math notranslate nohighlight">\( \  0,62 \ \)</span>,<span class="math notranslate nohighlight">\( \  0,94\)</span>, was <span class="math notranslate nohighlight">\(x_1, x_2,...x_n\)</span> entspricht. Um das Ergebnis von oben zu reproduzieren, setzen wir alle Gewichte <span class="math notranslate nohighlight">\(w_1,w_2,\dots w_n\)</span> auf <span class="math notranslate nohighlight">\(1\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weights_bees</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">gmean</span><span class="p">(</span><span class="n">bees_growth_rel</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights_bees</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9941469529781075
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gmean</span><span class="p">(</span><span class="n">bees_growth_rel</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights_bees</span><span class="p">)</span> <span class="o">==</span> <span class="n">gmean</span><span class="p">(</span><span class="n">bees_growth_rel</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>Korrekt, wir erhalten das gleiche Ergebnis!
Falls wir nun jedes konsekutive Element mehr gewichten wollen, können wir die Gewichte auf z.B. <span class="math notranslate nohighlight">\([1, 2, 3, 4]\)</span> setzen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weights_bees</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">gmean</span><span class="p">(</span><span class="n">bees_growth_rel</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights_bees</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9241626141253284
</pre></div>
</div>
</div>
</div>
</section>
<section id="der-gewichtete-harmonische-mittelwert">
<h4>Der gewichtete harmonische Mittelwert<a class="headerlink" href="#der-gewichtete-harmonische-mittelwert" title="Permalink to this headline">#</a></h4>
<p>Schließlich werden wir eine eigene gewichtete harmonische Mittelwertfunktion implementieren. <br> <br> Das gewichtete harmonische Mittel <span class="math notranslate nohighlight">\(\bar{x}\)</span> für die positiven reellen Zahlen <span class="math notranslate nohighlight">\(x_1,x_2,\dots,x_n\)</span> ist durch die folgende Gleichung definiert:</p>
<div class="math notranslate nohighlight">
\[ \bar{x}_{hw} = \frac{w_1+w_2 + \cdots + w_n}{\frac{w_1}{x_1} + \frac{w_2}{x_2} + \cdots  + \frac{w_n}{x_n}} = \frac{\sum_{i=1}^n w_i}{\sum_{i=1}^n\frac{w_i}{x_i}} ,\  x_i \gt 0, \ \forall \ \ i \ \ \]</div>
<p>Implementieren wir die Funktion des gewichteten harmonischen Mittels in Python. Die Kodierung ist einfach, aber um die Funktionalität unserer Funktion des gewichteten harmonischen Mittels zu erweitern, fügen wir eine <code class="docutils literal notranslate"><span class="pre">if</span></code>-Anweisung ein. Diese <code class="docutils literal notranslate"><span class="pre">if</span></code>-Anweisung im Code normalisiert die Gewichte, wenn die Gewichte nicht in Proportionen angegeben sind. Wenn die <code class="docutils literal notranslate"><span class="pre">if</span></code>-Anweisung ausgeführt wird, geben wir ein Benutzer-Feedback aus, andernfalls erfolgt keine Rückmeldung.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Definiere Funktion my_weighted_harmonic_mean</span>
<span class="k">def</span> <span class="nf">my_weighted_harmonic_mean1</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">weights</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Die Gewichte werden normalisiert&quot;</span><span class="p">)</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="n">weights</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">weights</span> <span class="o">/</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Lassen Sie uns unser <code class="docutils literal notranslate"><span class="pre">my_weighted_harmonic_mean</span></code> an einem recht komplexen Datensatz ausprobieren. Der Datensatz <code class="docutils literal notranslate"><span class="pre">cities</span></code> besteht aus allen Landeshauptstädten Deutschlands, ihrer Bevölkerungszahl und ihrer Fläche. Ziel ist es, die mittlere Bevölkerungsdichte für die Landeshauptstädte Deutschlands zu berechnen. Sie können die Datei <code class="docutils literal notranslate"><span class="pre">cities.csv</span></code> <a href="https://userpage.fu-berlin.de/soga/200/2010_data_sets/cities.csv">hier</a> herunterladen. Die Daten werden von dieser <a href="https://www.bundeslaenderdeutschland.de/landeshauptstaedte/">Website</a> abgerufen.</p>
<p>Zunächst laden wir den Datensatz, geben ihm einen passenden Namen und schauen ihn uns an.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../data/cities.csv&quot;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>state</th>
      <th>area_km2</th>
      <th>pop.size</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Berlin</td>
      <td>Land Berlin</td>
      <td>891.85</td>
      <td>3415100</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bremen</td>
      <td>Freie Hansestadt Bremen</td>
      <td>325.42</td>
      <td>546450</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Dresden</td>
      <td>Freistaat Sachsen</td>
      <td>328.31</td>
      <td>525100</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Düsseldorf</td>
      <td>Land Nordrhein-Westfalen</td>
      <td>217.41</td>
      <td>593682</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Erfurt</td>
      <td>Freistaat Thüringen</td>
      <td>269.17</td>
      <td>203480</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Hamburg</td>
      <td>Freie und Hansestadt Hamburg</td>
      <td>755.26</td>
      <td>1751780</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Hannover</td>
      <td>Land Niedersachsen</td>
      <td>204.14</td>
      <td>514130</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Kiel</td>
      <td>Land Schleswig-Holstein</td>
      <td>118.60</td>
      <td>239860</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Magdeburg</td>
      <td>Land Sachsen-Anhalt</td>
      <td>200.97</td>
      <td>229924</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Mainz</td>
      <td>Land Rheinland-Pfalz</td>
      <td>97.76</td>
      <td>202750</td>
    </tr>
    <tr>
      <th>10</th>
      <td>München</td>
      <td>Freistaat Bayern</td>
      <td>310.71</td>
      <td>1388300</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Potsdam</td>
      <td>Land Brandenburg</td>
      <td>187.27</td>
      <td>159450</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Saarbrücken</td>
      <td>Saarland</td>
      <td>167.07</td>
      <td>176990</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Schwerin</td>
      <td>Land Mecklenburg-Vorpommern</td>
      <td>130.46</td>
      <td>91260</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Stuttgart</td>
      <td>Land Baden-Württemberg</td>
      <td>207.36</td>
      <td>597939</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Wiesbaden</td>
      <td>Land Hessen</td>
      <td>203.90</td>
      <td>272630</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Zweitens erstellen wir eine neue Spalte und berechnen die Bevölkerungsdichte (Einwohner pro Quadratkilometer) und speichern das Ergebniss in der Spalte <code class="docutils literal notranslate"><span class="pre">density</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;density&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;pop.size&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;area_km2&quot;</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>state</th>
      <th>area_km2</th>
      <th>pop.size</th>
      <th>density</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Berlin</td>
      <td>Land Berlin</td>
      <td>891.85</td>
      <td>3415100</td>
      <td>3829.231373</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bremen</td>
      <td>Freie Hansestadt Bremen</td>
      <td>325.42</td>
      <td>546450</td>
      <td>1679.214554</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Dresden</td>
      <td>Freistaat Sachsen</td>
      <td>328.31</td>
      <td>525100</td>
      <td>1599.403003</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Düsseldorf</td>
      <td>Land Nordrhein-Westfalen</td>
      <td>217.41</td>
      <td>593682</td>
      <td>2730.702360</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Erfurt</td>
      <td>Freistaat Thüringen</td>
      <td>269.17</td>
      <td>203480</td>
      <td>755.953487</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Hamburg</td>
      <td>Freie und Hansestadt Hamburg</td>
      <td>755.26</td>
      <td>1751780</td>
      <td>2319.439663</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Hannover</td>
      <td>Land Niedersachsen</td>
      <td>204.14</td>
      <td>514130</td>
      <td>2518.516704</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Kiel</td>
      <td>Land Schleswig-Holstein</td>
      <td>118.60</td>
      <td>239860</td>
      <td>2022.428331</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Magdeburg</td>
      <td>Land Sachsen-Anhalt</td>
      <td>200.97</td>
      <td>229924</td>
      <td>1144.071254</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Mainz</td>
      <td>Land Rheinland-Pfalz</td>
      <td>97.76</td>
      <td>202750</td>
      <td>2073.956628</td>
    </tr>
    <tr>
      <th>10</th>
      <td>München</td>
      <td>Freistaat Bayern</td>
      <td>310.71</td>
      <td>1388300</td>
      <td>4468.153584</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Potsdam</td>
      <td>Land Brandenburg</td>
      <td>187.27</td>
      <td>159450</td>
      <td>851.444439</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Saarbrücken</td>
      <td>Saarland</td>
      <td>167.07</td>
      <td>176990</td>
      <td>1059.376309</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Schwerin</td>
      <td>Land Mecklenburg-Vorpommern</td>
      <td>130.46</td>
      <td>91260</td>
      <td>699.524759</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Stuttgart</td>
      <td>Land Baden-Württemberg</td>
      <td>207.36</td>
      <td>597939</td>
      <td>2883.579282</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Wiesbaden</td>
      <td>Land Hessen</td>
      <td>203.90</td>
      <td>272630</td>
      <td>1337.076999</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Drittens berechnen wir das Gewicht für jede Stadt entsprechend der Bevölkerungszahl und speichern das Ergebniss in der Spalte <code class="docutils literal notranslate"><span class="pre">cities_pop_weight</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;cities_pop_weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;pop.size&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;pop.size&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>state</th>
      <th>area_km2</th>
      <th>pop.size</th>
      <th>density</th>
      <th>cities_pop_weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Berlin</td>
      <td>Land Berlin</td>
      <td>891.85</td>
      <td>3415100</td>
      <td>3829.231373</td>
      <td>0.313058</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bremen</td>
      <td>Freie Hansestadt Bremen</td>
      <td>325.42</td>
      <td>546450</td>
      <td>1679.214554</td>
      <td>0.050092</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Dresden</td>
      <td>Freistaat Sachsen</td>
      <td>328.31</td>
      <td>525100</td>
      <td>1599.403003</td>
      <td>0.048135</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Düsseldorf</td>
      <td>Land Nordrhein-Westfalen</td>
      <td>217.41</td>
      <td>593682</td>
      <td>2730.702360</td>
      <td>0.054422</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Erfurt</td>
      <td>Freistaat Thüringen</td>
      <td>269.17</td>
      <td>203480</td>
      <td>755.953487</td>
      <td>0.018653</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Hamburg</td>
      <td>Freie und Hansestadt Hamburg</td>
      <td>755.26</td>
      <td>1751780</td>
      <td>2319.439663</td>
      <td>0.160584</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Hannover</td>
      <td>Land Niedersachsen</td>
      <td>204.14</td>
      <td>514130</td>
      <td>2518.516704</td>
      <td>0.047130</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Kiel</td>
      <td>Land Schleswig-Holstein</td>
      <td>118.60</td>
      <td>239860</td>
      <td>2022.428331</td>
      <td>0.021988</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Magdeburg</td>
      <td>Land Sachsen-Anhalt</td>
      <td>200.97</td>
      <td>229924</td>
      <td>1144.071254</td>
      <td>0.021077</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Mainz</td>
      <td>Land Rheinland-Pfalz</td>
      <td>97.76</td>
      <td>202750</td>
      <td>2073.956628</td>
      <td>0.018586</td>
    </tr>
    <tr>
      <th>10</th>
      <td>München</td>
      <td>Freistaat Bayern</td>
      <td>310.71</td>
      <td>1388300</td>
      <td>4468.153584</td>
      <td>0.127264</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Potsdam</td>
      <td>Land Brandenburg</td>
      <td>187.27</td>
      <td>159450</td>
      <td>851.444439</td>
      <td>0.014617</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Saarbrücken</td>
      <td>Saarland</td>
      <td>167.07</td>
      <td>176990</td>
      <td>1059.376309</td>
      <td>0.016224</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Schwerin</td>
      <td>Land Mecklenburg-Vorpommern</td>
      <td>130.46</td>
      <td>91260</td>
      <td>699.524759</td>
      <td>0.008366</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Stuttgart</td>
      <td>Land Baden-Württemberg</td>
      <td>207.36</td>
      <td>597939</td>
      <td>2883.579282</td>
      <td>0.054812</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Wiesbaden</td>
      <td>Land Hessen</td>
      <td>203.90</td>
      <td>272630</td>
      <td>1337.076999</td>
      <td>0.024992</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Nun wenden wir unsere Implementierung des gewichteten harmonischen Mittels <code class="docutils literal notranslate"><span class="pre">my_weighted_harmonic_mean</span></code> an und vergleichen es mit dem arithmetischen Mittel.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Wir verwenden die Spalte &quot;cities_pop_weight&quot; als Gewichte. Hier ist keine Normalisierung notwending.</span>
<span class="n">my_weighted_harmonic_mean1</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;density&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;cities_pop_weight&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2363.437731548685
</pre></div>
</div>
</div>
</div>
<p>Jetzt testen wir die Funktionalität unserer Funktion, indem wir <code class="docutils literal notranslate"><span class="pre">pop.size</span></code> als Eingabeparameter angeben.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Wir verwenden die Spalte &quot;pop.size&quot; als Gewichte. Ein Normalisierung ist notwending.</span>
<span class="n">my_weighted_harmonic_mean1</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;density&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;pop.size&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Die Gewichte werden normalisiert
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2363.437731548685
</pre></div>
</div>
</div>
</div>
<p>Wunderbar, die Funktion funktioniert wie erwartet. Die Ergebnisse sind identisch. Wir können daraus schließen, dass die durchschnittliche Bevölkerungsdichte in den Landeshauptstädten Deutschlands etwa <span class="math notranslate nohighlight">\(2.363\)</span> Einwohner/km<span class="math notranslate nohighlight">\(^2\)</span> beträgt.</p>
<p>Zum Vergleich können wir das arithmetische Mittel der Bevölkerungsdichte berechnen. Dieses würde uns hier ein weniger exaktes Ergebnis liefern.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;density&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1998.2545454902418
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="der-median">
<h3>Der Median<a class="headerlink" href="#der-median" title="Permalink to this headline">#</a></h3>
<p>Ein weiteres sehr wichtiges Maß für die zentrale Tendenz ist der <strong>Median</strong>. Der Median von Messwerten ist der Wert des mittleren Terms in einem Datensatz, der in aufsteigender Reihenfolge geordnet wurde. Der Median unterteilt also einen geordneten Datensatz <strong>in zwei gleiche Teile</strong>.
Die Berechnung des Medians besteht aus den folgenden zwei Schritten:</p>
<ol class="simple">
<li><p>Ordnen Sie den Datensatz in aufsteigender Reihenfolge.</p></li>
<li><p>Finden Sie den mittleren Term. Der Wert dieses Terms ist der Median.</p></li>
</ol>
<p>Wenn die Anzahl der Beobachtungen in einem Datensatz ungerade ist, wird der Median durch den Wert des mittleren Terms in den geordneten Daten bestimmt. Ist die Anzahl der Beobachtungen jedoch gerade, so wird der Median durch den Durchschnitt der Werte der beiden mittleren Terme bestimmt (<span id="id1">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.52). <br> <br> Lassen Sie uns den Median für die Variable <code class="docutils literal notranslate"><span class="pre">age</span></code> des <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatzes auswerten.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../data/students.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">age</span><span class="p">,</span> <span class="s2">&quot;bo&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fe02ac11ff0&gt;]
</pre></div>
</div>
<img alt="_images/02_Maße_der_zentralen_Tendenz_69_1.png" src="_images/02_Maße_der_zentralen_Tendenz_69_1.png" />
</div>
</div>
<p>Wenn wir die Variable <code class="docutils literal notranslate"><span class="pre">age</span></code> plotten, erkennen wir sofort, dass es einige Studenten gibt, die viel älter sind als der Rest der Studenten. Lassen Sie uns den Median berechnen…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Median des Alters der Studenten:     </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">age</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mittelwert des Alters der Studenten: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">age</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Median des Alters der Studenten:     21.0
Mittelwert des Alters der Studenten: 22.541570578953756
</pre></div>
</div>
</div>
</div>
<p>Zur Veranschaulichung fügen wir nun den Median und das arithmetische Mittel in das Streudiagramm ein.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">age</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">age</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Median&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">age</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;arithmetisches Mittel&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C2&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fe0289b6470&gt;
</pre></div>
</div>
<img alt="_images/02_Maße_der_zentralen_Tendenz_73_1.png" src="_images/02_Maße_der_zentralen_Tendenz_73_1.png" />
</div>
</div>
<p>Noch deutlicher veranschaulicht ein Histogram den Sachverhalt, dass das arithmetische Mittel stark durch Extremwerte und Ausreisser beeinflusst wird, der Median hingegen nicht. Daher wird der Median als Maß für die zentrale Tendenz bei Datensätzen, die Ausreißer enthalten, dem Mittelwert vorgezogen (<span id="id2">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.54).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">age</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">nunique</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">age</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Median&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">age</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;arithmetisches Mittel&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C2&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fe028a0bbe0&gt;
</pre></div>
</div>
<img alt="_images/02_Maße_der_zentralen_Tendenz_75_1.png" src="_images/02_Maße_der_zentralen_Tendenz_75_1.png" />
</div>
</div>
</section>
<section id="der-modalwert">
<h3>Der Modalwert<a class="headerlink" href="#der-modalwert" title="Permalink to this headline">#</a></h3>
<p>In der Statistik stellt der <strong>Modus</strong> den häufigsten Wert in einem Datensatz dar. Der Modalwert ist also der Wert, der in einem Datensatz mit der größten Häufigkeit auftritt <em>(<span id="id3">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s. 53)</em>. In Bezug auf die graphische Häufigkeitsverteilung entspricht der Modus dem Scheitelpunkt bzw. den Scheitelpunkten des Diagramms. Ein großes Manko des Modus ist, dass ein Datensatz keinen oder mehr als einen Modalwert haben kann, während er nur einen Mittelwert und nur einen Median hat. Ein Datensatz, bei dem jeder Wert nur einmal vorkommt, hat zum Beispiel keinen Modus. Ein Datensatz, bei dem nur ein Wert mit der größten Häufigkeit vorkommt, hat nur einen Modus. Der Datensatz wird in diesem Fall als <strong>unimodal</strong> bezeichnet. Ein Datensatz mit zwei Werten, die am häufigsten vorkommen, hat zwei Modi. Die Verteilung wird in diesem Fall als <strong>bimodal</strong> bezeichnet. Wenn mehr als zwei Werte in einem Datensatz am häufigsten vorkommen, dann enthält der Datensatz mehr als zwei Modi und wird als <strong>multimodal</strong> bezeichnet (<span id="id4">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s. 81,83).</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>

<span class="n">x_axis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">TITELSIZE</span> <span class="o">=</span> <span class="mi">18</span>
<span class="n">COLOR</span> <span class="o">=</span> <span class="s2">&quot;k&quot;</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)]:</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sd</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">y_axis</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sd</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">y_axis</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">COLOR</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">y_axis</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">COLOR</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;unimodal&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">TITELSIZE</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">16</span><span class="p">)]:</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sd</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">y_axis</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sd</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">y_axis</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">COLOR</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">y_axis</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">COLOR</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;bimodal&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">TITELSIZE</span><span class="p">)</span>


<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="mi">22</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">45</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">10</span><span class="p">)]:</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sd</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">y_axis</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sd</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">y_axis</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">COLOR</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">y_axis</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">COLOR</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;multimodal&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">TITELSIZE</span><span class="p">)</span>


<span class="k">for</span> <span class="n">_ax</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">:</span>
    <span class="n">_ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/02_Maße_der_zentralen_Tendenz_78_0.png" src="_images/02_Maße_der_zentralen_Tendenz_78_0.png" />
</div>
</div>
<p>Anders als der Mittelwert und der Median kann der Modus für quantitative (numerische) und qualitative (kategoriale) Daten verwendet werden. Python verfügt über eine vordefinierte Funktion <code class="docutils literal notranslate"><span class="pre">mode()</span></code> zur Berechnung des Modus im Paket <code class="docutils literal notranslate"><span class="pre">statistics</span></code>. Wir verwenden diese um den Modalwert aller Spaltenwerte des <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatzes zu berechnen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../data/students.csv&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;gender&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="s2">&quot;religion&quot;</span><span class="p">,</span> <span class="s2">&quot;nc_score&quot;</span><span class="p">,</span> <span class="s2">&quot;semester&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Der Modalwert der Spalte &#39;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">&#39; ist &#39;</span><span class="si">{</span><span class="n">st</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">])</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Der Modalwert der Spalte &#39;gender&#39; ist &#39;Male&#39;.
Der Modalwert der Spalte &#39;age&#39; ist &#39;21&#39;.
Der Modalwert der Spalte &#39;religion&#39; ist &#39;Catholic&#39;.
Der Modalwert der Spalte &#39;nc_score&#39; ist &#39;1.18&#39;.
Der Modalwert der Spalte &#39;semester&#39; ist &#39;1st&#39;.
Der Modalwert der Spalte &#39;height&#39; ist &#39;174&#39;.
Der Modalwert der Spalte &#39;weight&#39; ist &#39;67.1&#39;.
</pre></div>
</div>
</div>
</div>
</section>
</section>
<span id="document-Kapitel01/03_Streuungsmaße"></span><section class="tex2jax_ignore mathjax_ignore" id="streuungsmasze">
<h2>Streuungsmaße<a class="headerlink" href="#streuungsmasze" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span><span class="p">,</span> <span class="n">gaussian_kde</span>
</pre></div>
</div>
</div>
</div>
<p>Die Maße der zentralen Tendenz, wie Mittelwert, Median und Modus, geben nicht das ganze Bild der Verteilung eines Datensatzes wieder. Zwei Datensätze mit identischem Mittelwert können völlig unterschiedliche Streuungen aufweisen. Die Streuung der Beobachtungswerte des einen Datensatzes kann viel größer oder kleiner sein als die des anderen Datensatzes. Daher ist der Mittelwert, Median oder Modus allein in der Regel kein ausreichendes Maß, um die Form der Verteilung eines Datensatzes aufzuzeigen. Wir benötigen auch ein Maß, das Informationen über die Variation zwischen den Datenwerten liefert. Diese Maße werden als <strong>Streuungsmaße</strong> bezeichnet. Die Maße der zentralen Tendenz und der Streuung ergeben zusammengenommen ein besseres Bild eines Datensatzes als die Maße der zentralen Tendenz allein (<span id="id1">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.65).</p>
<section id="varianz-und-standardabweichung">
<h3>Varianz und Standardabweichung<a class="headerlink" href="#varianz-und-standardabweichung" title="Permalink to this headline">#</a></h3>
<p>Die <strong>Varianz</strong> ist die Summe der quadrierten Abweichungen vom Mittelwert. Die Varianz für Populationsdaten wird mit <span class="math notranslate nohighlight">\(\sigma^2\)</span> bezeichnet (gelesen als Sigma-Quadrat), und die für Stichprobendaten berechnete Varianz wird mit <span class="math notranslate nohighlight">\(s^2\)</span> bezeichnet.</p>
<div class="math notranslate nohighlight">
\[ \sigma^2 = \frac{\sum_{i=1}^n (x_i - \mu)^2}{N} \]</div>
<p>und
$<span class="math notranslate nohighlight">\( s^2 = \frac{\sum_{i=1}^n (x_i - \bar{x})^2}{n-1} \)</span>$</p>
<p>wobei <span class="math notranslate nohighlight">\(\sigma^2\)</span> die Varianz der Grundgesamtheit und <span class="math notranslate nohighlight">\(s^2\)</span> die Stichprobenvarianz ist. Die Größe <span class="math notranslate nohighlight">\(x_i-\mu\)</span> oder <span class="math notranslate nohighlight">\(x_i-\bar{x}\)</span> in den obigen Formeln wird als die Abweichung des <span class="math notranslate nohighlight">\(x_i\)</span>-Wertes <span class="math notranslate nohighlight">\((x_1,x_2, \dots ,x_n)\)</span> vom Mittelwert bezeichnet (<span id="id2">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.64).</p>
<p>Die <a href="https://de.wikipedia.org/wiki/Varianz_(Stochastik)">Standardabweichung</a> ist das gebräuchlichste Maß für die Streuung. Der Wert der Standardabweichung gibt an, wie eng die Werte eines Datensatzes um den Mittelwert herum gestreut sind. Im Allgemeinen zeigt ein niedriger Wert der Standardabweichung für einen Datensatz an, dass die Werte dieses Datensatzes über einen relativ kleineren Bereich um den Mittelwert herum verteilt sind. Im Gegensatz dazu zeigt ein größerer Wert der Standardabweichung für einen Datensatz an, dass die Werte dieses Datensatzes über einen relativ größeren Bereich um den Mittelwert herum gestreut sind (<span id="id3">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.65).</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">TITLESIZE</span> <span class="o">=</span> <span class="mi">17</span>
<span class="n">SEED</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">SIZE</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">SIZE</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">SIZE</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Geringe Abweichungen um den Mittelwert&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">TITLESIZE</span><span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">SIZE</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Grosse Abweichungen um den Mittelwert&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">TITLESIZE</span><span class="p">)</span>

<span class="k">for</span> <span class="n">_ax</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">:</span>
    <span class="n">_ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="n">_ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
    <span class="n">_ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
    <span class="n">_ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
    <span class="n">_ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;Daten&quot;</span><span class="p">,</span> <span class="s2">&quot;Mittelwert&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/03_Streuungsmaße_6_0.png" src="_images/03_Streuungsmaße_6_0.png" />
</div>
</div>
<p>Die Standardabweichung erhält man durch Ziehen der Quadratwurzel aus der <strong>Varianz</strong>. Folglich wird die für Grundgesamtheitsdaten berechnete Standardabweichung mit <span class="math notranslate nohighlight">\(\sigma\)</span> und die für Stichprobendaten berechnete Standardabweichung mit <span class="math notranslate nohighlight">\(s\)</span> bezeichnet.</p>
<div class="math notranslate nohighlight">
\[ \sigma = \sqrt{\frac{\sum_{i=1}^n (x_i - \mu)^2}{N}} \]</div>
<p>und</p>
<div class="math notranslate nohighlight">
\[ s = \sqrt{\frac{\sum_{i=1}^n (x_i - \bar{x})^2}{n-1}} \]</div>
<p>wobei <span class="math notranslate nohighlight">\(\sigma\)</span> die Standardabweichung der Grundgesamtheit und <span class="math notranslate nohighlight">\(s\)</span> die Standardabweichung der Stichprobe ist.</p>
<p>Als Übung berechnen wir für einige numerische Variablen, die im <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz von Interesse sind, den Mittelwert, den Median, die Varianz und die Standardabweichung und stellen sie in einem Dataframe dar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lesen der Datei students.csv als Dataframe; nur die Spalten &quot;age&quot;, &quot;weight&quot;, &quot;height&quot; und &quot;nc_score&quot; Spalten werden eingelesen</span>
<span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;../../data/students.csv&quot;</span><span class="p">,</span>
    <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">,</span> <span class="s2">&quot;nc_score&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="c1"># Zeige die ersten 10 Werte</span>
<span class="n">students</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>height</th>
      <th>weight</th>
      <th>nc_score</th>
    </tr>
    <tr>
      <th>age</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>19</th>
      <td>160</td>
      <td>64.8</td>
      <td>1.91</td>
    </tr>
    <tr>
      <th>19</th>
      <td>172</td>
      <td>73.0</td>
      <td>1.56</td>
    </tr>
    <tr>
      <th>22</th>
      <td>168</td>
      <td>70.6</td>
      <td>1.24</td>
    </tr>
    <tr>
      <th>19</th>
      <td>183</td>
      <td>79.7</td>
      <td>1.37</td>
    </tr>
    <tr>
      <th>21</th>
      <td>175</td>
      <td>71.4</td>
      <td>1.46</td>
    </tr>
    <tr>
      <th>19</th>
      <td>189</td>
      <td>85.8</td>
      <td>1.34</td>
    </tr>
    <tr>
      <th>21</th>
      <td>156</td>
      <td>65.9</td>
      <td>1.11</td>
    </tr>
    <tr>
      <th>21</th>
      <td>167</td>
      <td>65.7</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>18</th>
      <td>195</td>
      <td>94.4</td>
      <td>1.29</td>
    </tr>
    <tr>
      <th>18</th>
      <td>165</td>
      <td>66.0</td>
      <td>1.19</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Pandas verfügt über die Methode <code class="docutils literal notranslate"><span class="pre">agg</span></code>. Diese lässt uns sehr einfach verschiedene deskritptive Statisitken berechnen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">students</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;median&quot;</span><span class="p">,</span> <span class="s2">&quot;var&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>height</th>
      <th>weight</th>
      <th>nc_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>mean</th>
      <td>171.380750</td>
      <td>72.998131</td>
      <td>2.166481</td>
    </tr>
    <tr>
      <th>median</th>
      <td>171.000000</td>
      <td>71.800000</td>
      <td>2.040000</td>
    </tr>
    <tr>
      <th>var</th>
      <td>122.711652</td>
      <td>74.566017</td>
      <td>0.658610</td>
    </tr>
    <tr>
      <th>std</th>
      <td>11.077529</td>
      <td>8.635162</td>
      <td>0.811548</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="verwendung-der-standardabweichung">
<h4>Verwendung der Standardabweichung<a class="headerlink" href="#verwendung-der-standardabweichung" title="Permalink to this headline">#</a></h4>
<p>Mit Hilfe des <strong>Mittelwerts</strong> und der <strong>Standardabweichung</strong> lässt sich der Anteil oder Prozentsatz der Gesamtbeobachtungen ermitteln, die in ein bestimmtes Intervall um den Mittelwert fallen.</p>
<section id="tschebyscheff-theorem">
<h5>Tschebyscheff-Theorem<a class="headerlink" href="#tschebyscheff-theorem" title="Permalink to this headline">#</a></h5>
<p>Die <a href="https://de.wikipedia.org/wiki/Tschebyscheffsche_Ungleichung">Tschebyscheff Ungleichung</a> gibt eine untere Schranke für die Fläche unter einer Kurve zwischen zwei Punkten, die auf gegenüberliegenden Seiten des Mittelwerts und im gleichen Abstand vom Mittelwert liegen.</p>
<blockquote>
<div><p><strong>Für jede Zahl <span class="math notranslate nohighlight">\(k\)</span>, die größer als <span class="math notranslate nohighlight">\(1\)</span> ist, liegen mindestens <span class="math notranslate nohighlight">\(1-\frac{1}{k^2}\)</span> der Datenwerte innerhalb von <span class="math notranslate nohighlight">\(k\)</span> Standardabweichungen vom Mittelwert.</strong></p>
</div></blockquote>
<p>Lassen Sie uns Python verwenden, um ein Gefühl für den Tschebyscheff-Theorem zu bekommen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">4.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">k</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">chebyshev</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;k&quot;</span><span class="p">:</span> <span class="n">k</span><span class="p">,</span> <span class="s2">&quot;Prozent&quot;</span><span class="p">:</span> <span class="n">value</span><span class="p">})</span>
<span class="n">chebyshev</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>k</th>
      <th>Prozent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.1</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.2</td>
      <td>31.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.3</td>
      <td>41.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.4</td>
      <td>49.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.5</td>
      <td>56.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1.6</td>
      <td>61.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1.7</td>
      <td>65.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1.8</td>
      <td>69.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1.9</td>
      <td>72.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2.0</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2.1</td>
      <td>77.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2.2</td>
      <td>79.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2.3</td>
      <td>81.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2.4</td>
      <td>83.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2.5</td>
      <td>84.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2.6</td>
      <td>85.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2.7</td>
      <td>86.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2.8</td>
      <td>87.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2.9</td>
      <td>88.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>3.0</td>
      <td>89.0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>3.1</td>
      <td>90.0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>3.2</td>
      <td>90.0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>3.3</td>
      <td>91.0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>3.4</td>
      <td>91.0</td>
    </tr>
    <tr>
      <th>25</th>
      <td>3.5</td>
      <td>92.0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>3.6</td>
      <td>92.0</td>
    </tr>
    <tr>
      <th>27</th>
      <td>3.7</td>
      <td>93.0</td>
    </tr>
    <tr>
      <th>28</th>
      <td>3.8</td>
      <td>93.0</td>
    </tr>
    <tr>
      <th>29</th>
      <td>3.9</td>
      <td>93.0</td>
    </tr>
    <tr>
      <th>30</th>
      <td>4.0</td>
      <td>94.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Um es in Worte zu fassen: Für <span class="math notranslate nohighlight">\(k=2\)</span> bedeutet das, dass mindestens <strong><span class="math notranslate nohighlight">\(75 \% \)</span></strong> der Datenwerte innerhalb von <strong>2 Standardabweichungen</strong> vom Mittelwert liegen.</p>
<p>Stellen wir das Tschebyscheff-Theorem mit Python dar:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">chebyshev</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Prozent&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Tschebyscheff-Theorem&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/imarevic/.local/lib/python3.10/site-packages/pandas/plotting/_matplotlib/core.py:1114: UserWarning: No data for colormapping provided via &#39;c&#39;. Parameters &#39;cmap&#39; will be ignored
  scatter = ax.scatter(
</pre></div>
</div>
<img alt="_images/03_Streuungsmaße_17_1.png" src="_images/03_Streuungsmaße_17_1.png" />
</div>
</div>
<p>Das Theorem gilt sowohl für Stichproben- als auch für Grundgesamtheitsdaten. Die Tschebyscheffsche Ungleichung gilt für Verteilungen beliebiger Form. Sie kann jedoch nur für <span class="math notranslate nohighlight">\(k &gt; 1\)</span> verwendet werden. Denn wenn <span class="math notranslate nohighlight">\(k=1\)</span> ist, ist der Wert von <span class="math notranslate nohighlight">\(1-\frac{1}{k^2}\)</span> Null, und wenn <span class="math notranslate nohighlight">\(k &lt; 1\)</span> ist, ist der Wert von <span class="math notranslate nohighlight">\(1-\frac{1}{k^2}\)</span> negativ (<span id="id4">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.304).</p>
</section>
<section id="empirische-regel">
<h5>Empirische Regel<a class="headerlink" href="#empirische-regel" title="Permalink to this headline">#</a></h5>
<p>Während die Tschebyscheffsche Ungleichung auf jede Art von Verteilung anwendbar ist, gilt die <strong>empirische Regel</strong> nur für eine bestimmte Art von Verteilung, die so genannte <strong>Gaußverteilung</strong> oder <strong>Normalverteilung</strong>. Es gibt 3 Regeln: <br> <br> Bei einer Normalverteilung sind</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(68 \%\)</span> der Beobachtungen innerhalb einer Standardabweichung des Mittelwerts.</p></li>
<li><p><span class="math notranslate nohighlight">\(95 \%\)</span> der Beobachtungen innerhalb von zwei Standardabweichungen des Mittelwerts.</p></li>
<li><p><span class="math notranslate nohighlight">\(99,7 \%\)</span> der Beobachtungen innerhalb von drei Standardabweichungen des Mittelwerts.</p></li>
</ol>
<p>Da wir inzwischen über genügend Hacking-Power verfügen, werden wir versuchen zu testen, ob die drei Regeln gültig sind.</p>
<p><strong>(1) Erstens</strong> werden wir die Funktion <code class="docutils literal notranslate"><span class="pre">random.normal()</span></code> in Python erforschen, um normalverteilte Daten zu erzeugen, und</p>
<p><strong>(2) Zweitens</strong> werden wir zu unserem <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz zurückkehren um diese Regeln an diesem Datensatz zu validieren.
<br> <br> Die Normalverteilung gehört zur Familie der <a href="https://de.wikipedia.org/wiki/Wahrscheinlichkeitsma%C3%9F">stetigen Verteilungen</a>. In Python gibt es eine Vielzahl von Wahrscheinlichkeitsverteilungen <a href="https://docs.scipy.org/doc/scipy/reference/stats.html">(hier)</a>. Um Daten aus einer Normalverteilung zu erzeugen, kann man die Funktion <code class="docutils literal notranslate"><span class="pre">random.normal()</span></code> verwenden, die ein Zufallsvariablengenerator für die Normalverteilung ist.</p>
<p>Mit der Funktion <code class="docutils literal notranslate"><span class="pre">np.random.normal(loc=0.0,</span> <span class="pre">scale=1.0)</span></code> können wir Zufallsvariablen aus einer Normalverteilung mit einem gegebenen Mittelwert (Standard ist <span class="math notranslate nohighlight">\(0\)</span>) und einer Standardabweichung (Standard ist <span class="math notranslate nohighlight">\(1\)</span>) entnehmen. Mit dem Argument <code class="docutils literal notranslate"><span class="pre">size</span></code> können wir die Anzahl der erzeugten Zufallsvariablen bestimmen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.35778736])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.56078453])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1.08305124])
</pre></div>
</div>
</div>
</div>
<p>Wir können die Funktion ziemlich einfach bitten, hunderte oder tausende oder noch mehr (Pseudo-)Zufallszahlen zu ziehen:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 1.05380205, -1.37766937, -0.93782504,  0.51503527,  0.51378595,
        0.51504769,  3.85273149,  0.57089051,  1.13556564,  0.95400176])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0.65139125, -0.31526924,  0.75896922, -0.77282521, -0.23681861,
       -0.48536355,  0.08187414,  2.31465857, -1.86726519,  0.68626019,
       -1.61271587, -0.47193187,  1.0889506 ,  0.06428002, -1.07774478,
       -0.71530371,  0.67959775, -0.73036663,  0.21645859,  0.04557184,
       -0.65160035,  2.14394409,  0.63391902, -2.02514259,  0.18645431,
       -0.66178646,  0.85243333, -0.79252074, -0.11473644,  0.50498728,
        0.86575519, -1.20029641, -0.33450124, -0.47494531, -0.65332923,
        1.76545424,  0.40498171, -1.26088395,  0.91786195,  2.1221562 ,
        1.03246526, -1.51936997, -0.48423407,  1.26691115, -0.70766947,
        0.44381943,  0.77463405, -0.92693047, -0.05952536, -3.24126734,
       -1.02438764, -0.25256815, -1.24778318,  1.6324113 , -1.43014138,
       -0.44004449,  0.13074058,  1.44127329, -1.43586215,  1.16316375,
        0.01023306, -0.98150865,  0.46210347,  0.1990597 , -0.60021688,
        0.06980208, -0.3853136 ,  0.11351735,  0.66213067,  1.58601682,
       -1.2378155 ,  2.13303337, -1.9520878 , -0.1517851 ,  0.58831721,
        0.28099187, -0.62269952, -0.20812225, -0.49300093, -0.58936476,
        0.8496021 ,  0.35701549, -0.6929096 ,  0.89959988,  0.30729952,
        0.81286212,  0.62962884, -0.82899501, -0.56018104,  0.74729361,
        0.61037027, -0.02090159,  0.11732738,  1.2776649 , -0.59157139,
        0.54709738, -0.20219265, -0.2176812 ,  1.09877685,  0.82541635])
</pre></div>
</div>
</div>
</div>
<p>Wenn wir ein Histogramm dieser Zahlen erstellen, sehen wir die namensgebende glockenförmige Verteilung.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>
<span class="n">bins</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_norm</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span>  <span class="c1"># bestimmt die Anzahl der Bins</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">y_norm</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Absolute Häufigkeit&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/03_Streuungsmaße_28_0.png" src="_images/03_Streuungsmaße_28_0.png" />
</div>
</div>
<p>Wir kennen bereits den Mittelwert und die Standardabweichung der Werte in <code class="docutils literal notranslate"><span class="pre">y_norm</span></code>, da wir die Funktion <code class="docutils literal notranslate"><span class="pre">np.random.normal()</span></code> explizit mit <code class="docutils literal notranslate"><span class="pre">mean=0</span></code> und <code class="docutils literal notranslate"><span class="pre">sd=1</span></code> aufgerufen haben. Wir müssen also nur die Zahlen in <code class="docutils literal notranslate"><span class="pre">y_norm</span></code> zählen, die größer als <span class="math notranslate nohighlight">\(-1\)</span> bzw. kleiner als <span class="math notranslate nohighlight">\(1\)</span> und <span class="math notranslate nohighlight">\(2\)</span> bzw. <span class="math notranslate nohighlight">\(-2\)</span> und <span class="math notranslate nohighlight">\(3\)</span> bzw. <span class="math notranslate nohighlight">\(-3\)</span> sind, und sie zur Länge von <code class="docutils literal notranslate"><span class="pre">y_norm</span></code>, in unserem Fall <span class="math notranslate nohighlight">\(100.000\)</span>, in Beziehung setzen, um die drei oben genannten Regeln zu bestätigen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne Anzahl der Werte &lt; 1 - Anzahl der Werte &gt; -1 durch Gesamtanzahl</span>
<span class="n">sd1</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">y_norm</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">y_norm</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_norm</span><span class="p">)</span>

<span class="c1"># Berechne Anzahl der Werte &lt; 2 - Anzahl der Werte  &gt; -2 durch Gesamtanzahl</span>
<span class="n">sd2</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">y_norm</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">y_norm</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_norm</span><span class="p">)</span>

<span class="c1"># Berechne Anzahl der Werte &lt; 3 - Anzahl der Werte &gt; -3 durch Gesamtanzahl</span>
<span class="n">sd3</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">y_norm</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">y_norm</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">))</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_norm</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sd1 :&quot;</span><span class="p">,</span> <span class="n">sd1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sd2 :&quot;</span><span class="p">,</span> <span class="n">sd2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sd3 :&quot;</span><span class="p">,</span> <span class="n">sd3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sd1 : 0.68143
sd2 : 0.95444
sd3 : 0.99737
</pre></div>
</div>
</div>
</div>
<p>Perfekte Übereinstimmung! Die drei empirischen Regeln sind offensichtlich gültig. Um unsere Ergebnisse zu veranschaulichen, stellen wir das Histogramm erneut dar und fügen einige Anmerkungen hinzu. Bitte beachten Sie, dass wir in der <code class="docutils literal notranslate"><span class="pre">hist()</span></code>-Funktion das Argument <code class="docutils literal notranslate"><span class="pre">density=True</span></code> setzen. Dies hat zur Folge, dass das resultierende Histogramm nicht mehr die Zählungen auf der y-Achse anzeigt, sondern die <strong>Dichtewerte</strong> (normalisierte Zählung geteilt durch Bin-Breite), was bedeutet, dass sich die Balkenbereiche zu <span class="math notranslate nohighlight">\(1\)</span> summieren.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">y_norm</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Absolute Häufigkeit&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">std</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">std</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;C</span><span class="si">{</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">std</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;C</span><span class="si">{</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/03_Streuungsmaße_32_0.png" src="_images/03_Streuungsmaße_32_0.png" />
</div>
</div>
<p>Nun, lassen Sie uns an der <strong>zweiten</strong> Aufgabe arbeiten: Überprüfen Sie die drei empirischen Regeln anhand des <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatzes. Dazu müssen wir überprüfen, ob eine der numerischen Variablen im Studentendatensatz  normalverteilt ist. Wir beginnen mit der Extraktion numerischer Variablen von Interesse aus dem <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz. Dann zeichnen wir Histogramme und beurteilen, ob die Variable normalverteilt ist oder nicht. Zunächst überprüfen wir jedoch den Datensatz, indem wir die Funktion <code class="docutils literal notranslate"><span class="pre">head()</span></code> aufrufen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lesen der Datei students.csv als Dataframe;</span>
<span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;../../data/students.csv&quot;</span><span class="p">,</span>
    <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">,</span> <span class="s2">&quot;score1&quot;</span><span class="p">,</span> <span class="s2">&quot;score2&quot;</span><span class="p">,</span> <span class="s2">&quot;salary&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">students</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>height</th>
      <th>weight</th>
      <th>score1</th>
      <th>score2</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>19</td>
      <td>160</td>
      <td>64.8</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>19</td>
      <td>172</td>
      <td>73.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>22</td>
      <td>168</td>
      <td>70.6</td>
      <td>45.0</td>
      <td>46.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>19</td>
      <td>183</td>
      <td>79.7</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>21</td>
      <td>175</td>
      <td>71.4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>19</td>
      <td>189</td>
      <td>85.8</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>21</td>
      <td>156</td>
      <td>65.9</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>21</td>
      <td>167</td>
      <td>65.7</td>
      <td>58.0</td>
      <td>62.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>18</td>
      <td>195</td>
      <td>94.4</td>
      <td>57.0</td>
      <td>67.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9</th>
      <td>18</td>
      <td>165</td>
      <td>66.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Um einen Überblick über die Form der Verteilung der einzelnen Variablen zu erhalten, verwenden wir die Methode <code class="docutils literal notranslate"><span class="pre">hist()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cols</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">columns</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>  <span class="c1"># vereinfacht das iterieren durch die axes Objekte</span>
<span class="n">titles</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="s2">&quot;Alter&quot;</span><span class="p">,</span>
    <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="s2">&quot;Grösse&quot;</span><span class="p">,</span>
    <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="s2">&quot;Gewicht&quot;</span><span class="p">,</span>
    <span class="s2">&quot;score1&quot;</span><span class="p">:</span> <span class="s2">&quot;Punkte1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;score2&quot;</span><span class="p">:</span> <span class="s2">&quot;Punkte2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;salary&quot;</span><span class="p">:</span> <span class="s2">&quot;Gehalt&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cols</span><span class="p">):</span>
    <span class="n">bins</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">students</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">students</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">titles</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/03_Streuungsmaße_36_0.png" src="_images/03_Streuungsmaße_36_0.png" />
</div>
</div>
<p>Wir stellen sofort fest, dass einige Variablen positiv verzerrt sind, also schließen wir sie aus und behalten diejenigen, die normal verteilt zu sein scheinen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="s2">&quot;salary&quot;</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>  <span class="c1"># vereinfacht das iterieren durch die axes Objekte</span>
<span class="n">bins_fact</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;salary&quot;</span><span class="p">:</span> <span class="mi">40</span><span class="p">}</span>

<span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cols</span><span class="p">):</span>
    <span class="n">bins</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">students</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span> <span class="o">/</span> <span class="n">bins_fact</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">students</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">titles</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/03_Streuungsmaße_38_0.png" src="_images/03_Streuungsmaße_38_0.png" />
</div>
</div>
<p>Nun, sowohl die Variable <code class="docutils literal notranslate"><span class="pre">height</span></code> als auch die Variable <code class="docutils literal notranslate"><span class="pre">salary</span></code> scheinen mehr oder weniger normalverteilt zu sein. Es ist also eine Frage des Geschmacks, welche Variable man für die weitere Analyse auswählt. Für den Moment bleiben wir bei der Gehaltsvariable und überprüfen, ob die drei oben genannten empirischen Regeln gültig sind. Wir wechseln zu Python und validieren diese Regeln, indem wir zunächst den Mittelwert und die Standardabweichungen berechnen. Bitte beachten Sie, dass die Gehaltsvariable Fehlwerte enthält, die mit <code class="docutils literal notranslate"><span class="pre">NA</span></code> gekennzeichnet sind. Daher schließen wir zunächst alle <code class="docutils literal notranslate"><span class="pre">NA</span></code>-Werte aus, indem wir die Funktion <code class="docutils literal notranslate"><span class="pre">dropna()</span></code> anwenden.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">salary</span> <span class="o">=</span> <span class="n">students</span><span class="p">[</span><span class="s2">&quot;salary&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">salary</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10      45254.11
12      40552.79
13      27007.03
16      33969.16
27      50617.64
          ...   
8228    33259.70
8233    41028.24
8234    36750.09
8237    40112.04
8238    45900.13
Name: salary, Length: 1753, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mittelwert des Gehalts:             </span><span class="si">{</span><span class="n">salary</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;1 Standardabweichung des Gehalts:   </span><span class="si">{</span><span class="n">salary</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;2 Standardabweichungen des Gehalts: </span><span class="si">{</span><span class="mi">2</span> <span class="o">*</span> <span class="n">salary</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;3 Standardabweichungen des Gehalts: </span><span class="si">{</span><span class="mi">3</span> <span class="o">*</span> <span class="n">salary</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mittelwert des Gehalts:             42522.112253280095
1 Standardabweichung des Gehalts:   10333.139991647347
2 Standardabweichungen des Gehalts: 20666.279983294695
3 Standardabweichungen des Gehalts: 30999.419974942044
</pre></div>
</div>
</div>
</div>
<p>Wie in der obigen allgemeinen Beispielform zählen wir die Anzahl der Werte, die größer als <span class="math notranslate nohighlight">\(+1\)</span> s.d. bzw. kleiner als <span class="math notranslate nohighlight">\(-1\)</span> s.d. und <span class="math notranslate nohighlight">\(+2\)</span> s.d. bzw. <span class="math notranslate nohighlight">\(-2\)</span> s.d. und <span class="math notranslate nohighlight">\(+3\)</span> s.d. bzw. <span class="math notranslate nohighlight">\(-3\)</span> s.d. sind, und setzen sie in Beziehung zur Länge des Vektors, in unserem Fall <span class="math notranslate nohighlight">\(1753\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">salary_mean</span> <span class="o">=</span> <span class="n">salary</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">salary_std</span> <span class="o">=</span> <span class="n">salary</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="n">sd1</span> <span class="o">=</span> <span class="p">(</span>
    <span class="nb">sum</span><span class="p">((</span><span class="n">salary</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">salary_mean</span> <span class="o">-</span> <span class="n">salary_std</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">salary</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">salary_mean</span> <span class="o">+</span> <span class="n">salary_std</span><span class="p">)))</span>
    <span class="o">/</span> <span class="n">salary</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">sd2</span> <span class="o">=</span> <span class="p">(</span>
    <span class="nb">sum</span><span class="p">(</span>
        <span class="p">(</span><span class="n">salary</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">salary_mean</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">salary_std</span><span class="p">))</span>
        <span class="o">&amp;</span> <span class="p">(</span><span class="n">salary</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">salary_mean</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">salary_std</span><span class="p">))</span>
    <span class="p">)</span>
    <span class="o">/</span> <span class="n">salary</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">)</span>


<span class="n">sd3</span> <span class="o">=</span> <span class="p">(</span>
    <span class="nb">sum</span><span class="p">(</span>
        <span class="p">(</span><span class="n">salary</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">salary_mean</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">salary_std</span><span class="p">))</span>
        <span class="o">&amp;</span> <span class="p">(</span><span class="n">salary</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">salary_mean</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">salary_std</span><span class="p">))</span>
    <span class="p">)</span>
    <span class="o">/</span> <span class="n">salary</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sd1 :&quot;</span><span class="p">,</span> <span class="n">sd1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sd2 :&quot;</span><span class="p">,</span> <span class="n">sd2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sd3 :&quot;</span><span class="p">,</span> <span class="n">sd3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sd1 : 0.6708499714774672
sd2 : 0.9560752994865944
sd3 : 0.9977181973759269
</pre></div>
</div>
</div>
</div>
<p>Wow, ziemlich nah dran! Offensichtlich zeigt die Gehaltsvariable eine starke Tendenz zur Unterstützung der so genannten empirischen Regel. Wir stellen das Histogramm für die Variable <code class="docutils literal notranslate"><span class="pre">salary</span></code> dar, um unseren Eindruck zu bestätigen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">bins</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">salary</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span> <span class="o">/</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">salary</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Absolute Häufigkeit&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Gehalt&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">salary_mean</span> <span class="o">+</span> <span class="p">(</span><span class="n">e</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">salary_std</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;C</span><span class="si">{</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">salary_mean</span> <span class="o">-</span> <span class="p">(</span><span class="n">e</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">salary_std</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;C</span><span class="si">{</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/03_Streuungsmaße_45_0.png" src="_images/03_Streuungsmaße_45_0.png" />
</div>
</div>
<p>Wir können nun unseren Visualisierungsansatz erweitern, indem wir die <strong>empirische Dichteschätzung</strong> mit der Funktion <code class="docutils literal notranslate"><span class="pre">scipy_kernel.evaluate()</span></code> grafisch darstellen und ihre Form überprüfen. Wir stellen die empirische Dichteschätzung als gestrichelte Linie dar, indem wir das <a href="https://matplotlib.org/stable/gallery/lines_bars_and_markers/linestyles.html">(Linientyp-Argument)</a> <code class="docutils literal notranslate"><span class="pre">'-.'</span></code> und eine Linienbreite von <span class="math notranslate nohighlight">\(3\)</span> (Argument <code class="docutils literal notranslate"><span class="pre">linewidth=3.0</span></code>) setzen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">bins</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">salary</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span> <span class="o">/</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">salary</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Dichte&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Gehalt&quot;</span><span class="p">)</span>

<span class="c1"># empirische Dichteschätzung</span>
<span class="n">x_salary</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">salary</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">salary</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">scipy_kernel</span> <span class="o">=</span> <span class="n">gaussian_kde</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span>
<span class="n">dens_emp</span> <span class="o">=</span> <span class="n">scipy_kernel</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">x_salary</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_salary</span><span class="p">,</span> <span class="n">dens_emp</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c1"># Standardabweichungen</span>
<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">salary_mean</span> <span class="o">+</span> <span class="p">(</span><span class="n">e</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">salary_std</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;C</span><span class="si">{</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">salary_mean</span> <span class="o">-</span> <span class="p">(</span><span class="n">e</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">salary_std</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;C</span><span class="si">{</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/03_Streuungsmaße_47_0.png" src="_images/03_Streuungsmaße_47_0.png" />
</div>
</div>
<p>Schließlich vergleichen wir unsere <strong>empirische Dichteschätzung</strong> mit der theoretischen <strong>Wahrscheinlichkeitsdichtefunktion</strong>, die auf dem tatsächlichen Mittelwert und der Standardabweichung der Daten <code class="docutils literal notranslate"><span class="pre">salary</span></code> basiert. Für einen besseren visuellen Vergleich wechseln wir zurück zu einer nicht eingefärbten Histogramm-Darstellung.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">bins</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">salary</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span> <span class="o">/</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">salary</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Dichte&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Gehalt&quot;</span><span class="p">)</span>

<span class="c1"># empirische Dichteschätzung</span>
<span class="n">x_salary</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">salary</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">salary</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">scipy_kernel</span> <span class="o">=</span> <span class="n">gaussian_kde</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span>
<span class="n">dens_emp</span> <span class="o">=</span> <span class="n">scipy_kernel</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">x_salary</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">x_salary</span><span class="p">,</span>
    <span class="n">dens_emp</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Empirische Dichteschätzung&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Wahrscheinlichkeitsdichtefunktion</span>
<span class="n">pdf</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x_salary</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">salary</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">scale</span><span class="o">=</span><span class="n">salary</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">x_salary</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Wahrscheinlichkeitsdichtefunktion&quot;</span>
<span class="p">)</span>

<span class="c1"># Standardabweichungen</span>
<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">salary_mean</span> <span class="o">+</span> <span class="p">(</span><span class="n">e</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">salary_std</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;C</span><span class="si">{</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">salary_mean</span> <span class="o">-</span> <span class="p">(</span><span class="n">e</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">salary_std</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;C</span><span class="si">{</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f9a1f29bfd0&gt;
</pre></div>
</div>
<img alt="_images/03_Streuungsmaße_49_1.png" src="_images/03_Streuungsmaße_49_1.png" />
</div>
</div>
<p>Wir können daraus schließen, dass <code class="docutils literal notranslate"><span class="pre">salary</span></code> im Datensatz der <code class="docutils literal notranslate"><span class="pre">students</span></code> ungefähr normalverteilt ist. Die Grafik zeigt jedoch, dass die Verteilung der Gehaltsvariablen leicht linksschief ist. Dies ist an der Abweichung zwischen der <strong>empirischen Dichteschätzung</strong> und der <strong>Wahrscheinlichkeitsdichtefunktion</strong> zu erkennen.</p>
</section>
</section>
</section>
<section id="die-spannweite">
<h3>Die Spannweite<a class="headerlink" href="#die-spannweite" title="Permalink to this headline">#</a></h3>
<p>Die <strong>Spannweite</strong> als Maß für die Streuung ist einfach zu berechnen. Sie ergibt sich aus der Differenz zwischen dem größten und dem kleinsten Wert in einem Datensatz.</p>
<div class="math notranslate nohighlight">
\[\text{Range} = \text{größter Wert} - \text{kleinster Wert}\]</div>
<p>Betrachten wir unseren <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz. Wir unterteilen den Datensatz so, dass er nur numerische Daten enthält.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../data/students.csv&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>stud_id</th>
      <th>name</th>
      <th>gender</th>
      <th>age</th>
      <th>height</th>
      <th>weight</th>
      <th>religion</th>
      <th>nc_score</th>
      <th>semester</th>
      <th>major</th>
      <th>minor</th>
      <th>score1</th>
      <th>score2</th>
      <th>online_tutorial</th>
      <th>graduated</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3599</th>
      <td>255883</td>
      <td>Morrison-Cook, Austin</td>
      <td>Male</td>
      <td>20</td>
      <td>172</td>
      <td>72.6</td>
      <td>Other</td>
      <td>1.67</td>
      <td>4th</td>
      <td>Mathematics and Statistics</td>
      <td>Economics and Finance</td>
      <td>91.0</td>
      <td>87.0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2081</th>
      <td>686345</td>
      <td>Lenahan, Kyle</td>
      <td>Male</td>
      <td>21</td>
      <td>181</td>
      <td>78.0</td>
      <td>Other</td>
      <td>1.38</td>
      <td>2nd</td>
      <td>Social Sciences</td>
      <td>Economics and Finance</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>521</th>
      <td>346731</td>
      <td>Lee, Nicholas</td>
      <td>Male</td>
      <td>22</td>
      <td>192</td>
      <td>93.1</td>
      <td>Catholic</td>
      <td>1.27</td>
      <td>5th</td>
      <td>Environmental Sciences</td>
      <td>Social Sciences</td>
      <td>78.0</td>
      <td>65.0</td>
      <td>1</td>
      <td>1</td>
      <td>49068.50</td>
    </tr>
    <tr>
      <th>5603</th>
      <td>963305</td>
      <td>Kramer, David</td>
      <td>Male</td>
      <td>56</td>
      <td>170</td>
      <td>72.6</td>
      <td>Orthodox</td>
      <td>2.14</td>
      <td>5th</td>
      <td>Environmental Sciences</td>
      <td>Mathematics and Statistics</td>
      <td>72.0</td>
      <td>71.0</td>
      <td>1</td>
      <td>1</td>
      <td>42606.35</td>
    </tr>
    <tr>
      <th>3670</th>
      <td>124687</td>
      <td>Than, Jonathan</td>
      <td>Male</td>
      <td>22</td>
      <td>172</td>
      <td>72.4</td>
      <td>Protestant</td>
      <td>1.79</td>
      <td>4th</td>
      <td>Environmental Sciences</td>
      <td>Mathematics and Statistics</td>
      <td>62.0</td>
      <td>69.0</td>
      <td>0</td>
      <td>1</td>
      <td>49004.73</td>
    </tr>
    <tr>
      <th>5375</th>
      <td>696262</td>
      <td>Macasinag, Paulo</td>
      <td>Male</td>
      <td>20</td>
      <td>197</td>
      <td>94.3</td>
      <td>Catholic</td>
      <td>3.41</td>
      <td>6th</td>
      <td>Political Science</td>
      <td>Environmental Sciences</td>
      <td>51.0</td>
      <td>47.0</td>
      <td>1</td>
      <td>1</td>
      <td>39442.80</td>
    </tr>
    <tr>
      <th>2317</th>
      <td>452190</td>
      <td>Briseno, Alisha</td>
      <td>Female</td>
      <td>63</td>
      <td>162</td>
      <td>68.0</td>
      <td>Catholic</td>
      <td>2.19</td>
      <td>2nd</td>
      <td>Mathematics and Statistics</td>
      <td>Environmental Sciences</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4839</th>
      <td>955228</td>
      <td>Thapa, Richard</td>
      <td>Male</td>
      <td>23</td>
      <td>175</td>
      <td>76.0</td>
      <td>Other</td>
      <td>2.48</td>
      <td>1st</td>
      <td>Mathematics and Statistics</td>
      <td>Environmental Sciences</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1285</th>
      <td>854649</td>
      <td>Duling, Joshua Ian</td>
      <td>Male</td>
      <td>61</td>
      <td>170</td>
      <td>70.3</td>
      <td>Protestant</td>
      <td>1.54</td>
      <td>&gt;6th</td>
      <td>Economics and Finance</td>
      <td>Mathematics and Statistics</td>
      <td>64.0</td>
      <td>69.0</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>117</th>
      <td>582922</td>
      <td>Valenciano-Poffenbarger, Quincie</td>
      <td>Female</td>
      <td>19</td>
      <td>175</td>
      <td>76.8</td>
      <td>Catholic</td>
      <td>2.19</td>
      <td>1st</td>
      <td>Social Sciences</td>
      <td>Mathematics and Statistics</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Wir sind also an den Kategorien <code class="docutils literal notranslate"><span class="pre">age</span></code>, <code class="docutils literal notranslate"><span class="pre">height</span></code>, <code class="docutils literal notranslate"><span class="pre">weight</span></code> und <code class="docutils literal notranslate"><span class="pre">nc_score</span></code> interessiert. Wir verwenden die Methoden <code class="docutils literal notranslate"><span class="pre">min()</span></code> und <code class="docutils literal notranslate"><span class="pre">max()</span></code>, um das Minimum und Maximum der ausgewählten Variablen zu berechnen. Erneut greifen wir auf die <code class="docutils literal notranslate"><span class="pre">agg</span></code>-Methode zurück.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">summary</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">,</span> <span class="s2">&quot;nc_score&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">])</span>
<span class="n">summary</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>height</th>
      <th>weight</th>
      <th>nc_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>min</th>
      <td>18</td>
      <td>135</td>
      <td>51.4</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>max</th>
      <td>64</td>
      <td>206</td>
      <td>116.0</td>
      <td>4.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Um nun die Spannweite für jede Variable zu berechnen, müssen wir nur eine Zeile von der anderen abziehen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">summary</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;Spannweite&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">summary</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">summary</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">]</span>
<span class="n">summary</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>height</th>
      <th>weight</th>
      <th>nc_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>min</th>
      <td>18.0</td>
      <td>135.0</td>
      <td>51.4</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>max</th>
      <td>64.0</td>
      <td>206.0</td>
      <td>116.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>Spannweite</th>
      <td>46.0</td>
      <td>71.0</td>
      <td>64.6</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Die Spannweite hat, wie der Mittelwert, den Nachteil, dass sie durch Ausreißer beeinflusst wird. Daher ist die Spannweite kein gutes Streuungsmaß für einen Datensatz, der Ausreißer enthält. Ein weiterer Nachteil der Verwendung der Spannweite als Streuungsmaß ist, dass ihre Berechnung nur auf zwei Werten basiert: Dem größten und dem kleinsten. Alle anderen Werte in einem Datensatz werden bei der Berechnung der Spanne ignoriert. Daher ist die Spannweite oftmals kein sehr zufriedenstellendes Maß für die Streuung (<span id="id5">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.62).</p>
</section>
</section>
<span id="document-Kapitel01/04_Maße_der_Position"></span><section class="tex2jax_ignore mathjax_ignore" id="das-positionsmasz">
<h2>Das Positionsmaß<a class="headerlink" href="#das-positionsmasz" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stats</span>
</pre></div>
</div>
</div>
</div>
<p>Ein Positionsmaß bestimmt die Position eines einzelnen Wertes im Verhältnis zu anderen Werten in einer Stichprobe oder einem Populationsdatensatz. Anders als der Mittelwert und die Standardabweichung sind auf <strong>Quantilen</strong> basierende deskriptive Maße nicht empfindlich gegenüber dem Einfluss einiger weniger extremer Beobachtungen. Aus diesem Grund werden deskriptive Maße, die auf Quantilen basieren, häufig denjenigen vorgezogen, die auf dem Mittelwert und der Standardabweichung basieren (<span id="id1">Fahrmeir <em>et al.</em> [<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">2016</a>]</span> s.60).</p>
<p>Quantile sind Punkte, die den Bereich der Daten in zusammenhängende Intervalle mit gleichen Wahrscheinlichkeiten unterteilen. Bestimmte <a href="https://de.wikipedia.org/wiki/Quantil_(Wahrscheinlichkeitstheorie)">Quantile</a> sind besonders wichtig: Der <strong>Median</strong> eines Datensatzes unterteilt die Daten in zwei gleiche Teile: die unteren <span class="math notranslate nohighlight">\(50 \%\)</span> und die oberen <span class="math notranslate nohighlight">\(50 \%\)</span>. <strong>Quartile</strong> unterteilen die Daten in vier gleiche Teile und <strong>Perzentile</strong> unterteilen sie in Hundertstel oder <span class="math notranslate nohighlight">\(100\)</span> gleiche Teile. Beachten Sie, dass der Median auch das <span class="math notranslate nohighlight">\(50\)</span>-te Perzentil ist. <strong>Dezile</strong> unterteilen einen Datensatz in Zehntel (<span class="math notranslate nohighlight">\(10\)</span> gleiche Teile), und die <strong>Quintile</strong> unterteilen einen Datensatz in Fünftel (<span class="math notranslate nohighlight">\(5\)</span> gleiche Teile). Es gibt immer ein Quantil weniger als die Anzahl der gebildeten Gruppen (z. B. gibt es <strong>3</strong> Quartile, die die Daten in <strong>4</strong> gleiche Teile unterteilen!).</p>
<section id="quartile-und-interquartilsbereich">
<h3>Quartile und Interquartilsbereich<a class="headerlink" href="#quartile-und-interquartilsbereich" title="Permalink to this headline">#</a></h3>
<p><strong>Quartile</strong> unterteilen einen geordneten Datensatz in <strong>vier gleiche Teile</strong>. Diese drei Maße werden als <strong>erstes Quartil</strong> <span class="math notranslate nohighlight">\((Q1)\)</span>, <strong>zweites Quartil</strong> <span class="math notranslate nohighlight">\((Q2)\)</span> und <strong>drittes Quartil</strong> <span class="math notranslate nohighlight">\((Q3)\)</span> bezeichnet. Das zweite Quartil ist dasselbe wie der Median eines Datensatzes. Das erste Quartil ist der Wert des mittleren Terms unter den Beobachtungen, die kleiner als der Median sind, und das dritte Quartil ist der Wert des mittleren Terms unter den Beobachtungen, die größer als der Median sind (<span id="id2">Fahrmeir <em>et al.</em> [<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">2016</a>]</span> s.59).</p>
<p><img alt="Alt-Text" src="_images/median.png" /></p>
<p>Ungefähr <span class="math notranslate nohighlight">\(25 \%\)</span> der Werte in einem geordneten Datensatz sind kleiner als <span class="math notranslate nohighlight">\(Q1\)</span> und etwa <span class="math notranslate nohighlight">\(75 \%\)</span> sind größer als <span class="math notranslate nohighlight">\(Q1\)</span>. Das zweite Quartil, <span class="math notranslate nohighlight">\(Q2\)</span>, unterteilt einen geordneten Datensatz in zwei gleiche Teile; daher sind das zweite Quartil und der Median identisch. Etwa <span class="math notranslate nohighlight">\(75 \%\)</span> der Datenwerte sind kleiner als <span class="math notranslate nohighlight">\(Q3\)</span> und etwa <span class="math notranslate nohighlight">\(25 \%\)</span> sind größer als <span class="math notranslate nohighlight">\(Q3\)</span>. Die Differenz zwischen dem dritten Quartil und dem ersten Quartil eines Datensatzes wird als <strong>Interquartilsbereich</strong> (<span class="math notranslate nohighlight">\(IQR\)</span>) bezeichnet (<span id="id3">Fahrmeir <em>et al.</em> [<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">2016</a>]</span> s.61).</p>
<div class="math notranslate nohighlight">
\[ IQR=Q3−Q1 \]</div>
<p>Wechseln wir zu Python und testen wir seine Funktionalität zur Berechnung von Quantilen/Quartilen. Wir werden die <code class="docutils literal notranslate"><span class="pre">nc_score</span></code>-Variable des <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatzes verwenden, um Quartile und den <span class="math notranslate nohighlight">\(IQR\)</span> zu berechnen. Die <code class="docutils literal notranslate"><span class="pre">nc_score</span></code>-Variable entspricht der <a href="https://de.wikipedia.org/wiki/Numerus_clausus">Numerus-Clausus</a>-Punktzahl jedes Studenten.</p>
<p>Zunächst werden die Daten unterteilt und ein Histogramm erstellt, um die Verteilung der Variablen genauer zu untersuchen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lese Daten ein</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../data/students.csv&quot;</span><span class="p">)</span>

<span class="c1"># Histogramm</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;nc_score&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Numerus Clausus&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Häufigkeit&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Histogramm von &#39;nc_score&#39;&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/04_Maße_der_Position_11_0.png" src="_images/04_Maße_der_Position_11_0.png" />
</div>
</div>
<p>Um die Quartile für die Variable nc_score zu berechnen, wenden wir die Funktion <code class="docutils literal notranslate"><span class="pre">np.quantile</span></code> an. Um die Quartile für die Variable <code class="docutils literal notranslate"><span class="pre">nc_score</span></code> zu berechnen, schreiben wir also einfach:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mi">1</span><span class="p">]):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">. Quantil des nc_score: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;nc_score&#39;</span><span class="p">],</span> <span class="n">q</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1. Quantil des nc_score: 1.46
2. Quantil des nc_score: 2.04
3. Quantil des nc_score: 2.78
4. Quantil des nc_score: 4.0
</pre></div>
</div>
</div>
</div>
<p><strong>Hinweis:</strong> Nicht alle Statistiker definieren Quartile auf genau dieselbe Weise. Eine ausführliche Diskussion der verschiedenen Methoden zur Berechnung von Quantilen finden Sie in dem Online-Artikel <a href="http://jse.amstat.org/v14n3/langford.html">”Quartiles in Elementary Statistics” von E. Langford (2006)</a>.</p>
<p>Um den <span class="math notranslate nohighlight">\(IQR\)</span> für die Variable <code class="docutils literal notranslate"><span class="pre">nc_score</span></code> zu berechnen, schreiben wir entweder…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne Interquartil Abstand mit Funktion np.percentile()</span>
<span class="n">q1</span><span class="p">,</span> <span class="n">q3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;nc_score&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">75</span><span class="p">])</span>
<span class="n">iqr</span> <span class="o">=</span> <span class="n">q3</span> <span class="o">-</span> <span class="n">q1</span>
<span class="n">iqr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.3199999999999998
</pre></div>
</div>
</div>
</div>
<p>…oder wir wenden die eingebaute Funktion <code class="docutils literal notranslate"><span class="pre">iqr</span></code> aus dem Modul <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> an:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">iqr</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;nc_score&quot;</span><span class="p">],</span> <span class="n">rng</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">75</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.3199999999999998
</pre></div>
</div>
</div>
</div>
<p>Wir können die Aufteilung der Variablen <code class="docutils literal notranslate"><span class="pre">nc_score</span></code> in Quartile visualisieren, indem wir ein Histogramm erstellen und ein paar zusätzliche Codezeilen hinzufügen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plotte die Liste als Histogramm mit Quartilen</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;nc_score&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;nc_score&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Häufigkeit&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Histogramm der Variable Numerus Clausus&quot;</span><span class="p">)</span>

<span class="c1"># Zeichne vertikale Linien bei Q1, Q2, Q3, Q4</span>
<span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mi">1</span><span class="p">]):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;nc_score&quot;</span><span class="p">],</span> <span class="n">q</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;C</span><span class="si">{</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Q</span><span class="si">{</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fa419339840&gt;
</pre></div>
</div>
<img alt="_images/04_Maße_der_Position_20_1.png" src="_images/04_Maße_der_Position_20_1.png" />
</div>
</div>
</section>
<section id="die-5-punkte-zusammenfassung">
<h3>Die 5-Punkte-Zusammenfassung<a class="headerlink" href="#die-5-punkte-zusammenfassung" title="Permalink to this headline">#</a></h3>
<p>Aus den drei Quartilen <span class="math notranslate nohighlight">\((Q1, Q2, Q3)\)</span>können wir ein Maß für die Lage der Mitte (den Median, <span class="math notranslate nohighlight">\(Q2\)</span>) und ein Maß für die Variation der beiden mittleren Quartale der Daten, <span class="math notranslate nohighlight">\(Q2-Q1\)</span> für die zweiten Quartile und <span class="math notranslate nohighlight">\(Q3-Q2\)</span> für die dritten Quartile ableiten. Die drei Quartile sagen jedoch nichts über die Variation der ersten und vierten Quartile aus.</p>
<p>Um diese Informationen zu erhalten, beziehen wir auch die Beobachtungen des Minimums und des Maximums mit ein. Die Variation der ersten Quartile kann als Differenz zwischen dem Minimum und der ersten Quartile, <span class="math notranslate nohighlight">\(Q1-Min\)</span>, gemessen werden, und die Variation der vierten Quartile kann als Differenz zwischen der dritten Quartile und dem Maximum, <span class="math notranslate nohighlight">\(Max-Q3\)</span>, gemessen werden. Somit liefern das Minimum, das Maximum und die Quartile zusammen unter anderem Informationen über Zentrum und Variation (<span id="id4">Fahrmeir <em>et al.</em> [<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">2016</a>]</span> s.62).</p>
<p>Die so genannte <strong>Tukey-Fünf-Punkte-Zusammenfassung</strong> (nach dem Mathematiker <a href="https://de.wikipedia.org/wiki/John_W._Tukey">John Wilder Tukey</a>) eines Datensatzes besteht aus den Werten <span class="math notranslate nohighlight">\(Min, Q1, Q2, Q3\)</span> und <span class="math notranslate nohighlight">\(Max\)</span> des Datensatzes.</p>
<p>Die Fünf-Punkte-Zusammenfassung lässt sich in Python durch <code class="docutils literal notranslate"><span class="pre">np.percentile</span></code> und die <code class="docutils literal notranslate"><span class="pre">min()</span></code>, <code class="docutils literal notranslate"><span class="pre">max()</span></code> Funktionen berechnen. Zu Demonstrationszwecken berechnen wir die Fünf-Punkte-Zusammenfassung für die Variable <code class="docutils literal notranslate"><span class="pre">nc_score</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lese Datei students.csv als Dataframe ein; Indexspalte wird übersprungen</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../data/students.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Berechne Fünf-Zahlen-Zusammenfassung</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;nc_score&quot;</span><span class="p">]</span>

<span class="c1"># Berechne die Quartilen</span>
<span class="n">q1</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="n">q3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">])</span>

<span class="c1"># Berechne minimal/maximal Datenpunkte</span>
<span class="n">data_min</span><span class="p">,</span> <span class="n">data_max</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">scores</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>

<span class="c1"># Ausgabe der Daten</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Min:    </span><span class="si">{</span><span class="n">data_min</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Q1:     </span><span class="si">{</span><span class="n">q1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Median: </span><span class="si">{</span><span class="n">median</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Q3:     </span><span class="si">{</span><span class="n">q3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Max:    </span><span class="si">{</span><span class="n">data_max</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Min:    1.0
Q1:     1.46
Median: 2.04
Q3:     2.78
Max:    4.0
</pre></div>
</div>
</div>
</div>
<p>Diese Funktion liefert Minimum, untere Quartile, Median, obere Quartile und Maximum für die Eingabedaten.</p>
<p>In Python gibt es eine ähnliche Methode namens <code class="docutils literal notranslate"><span class="pre">describe()</span></code>, die ähnliche Statistiken liefert.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>height</th>
      <th>weight</th>
      <th>nc_score</th>
      <th>score1</th>
      <th>score2</th>
      <th>online_tutorial</th>
      <th>graduated</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>8239.000000</td>
      <td>8239.000000</td>
      <td>8239.000000</td>
      <td>8239.000000</td>
      <td>4892.000000</td>
      <td>4892.000000</td>
      <td>8239.000000</td>
      <td>8239.000000</td>
      <td>1753.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>22.541571</td>
      <td>171.380750</td>
      <td>72.998131</td>
      <td>2.166481</td>
      <td>68.164963</td>
      <td>69.494685</td>
      <td>0.386212</td>
      <td>0.212769</td>
      <td>42522.112253</td>
    </tr>
    <tr>
      <th>std</th>
      <td>6.065111</td>
      <td>11.077529</td>
      <td>8.635162</td>
      <td>0.811548</td>
      <td>14.051762</td>
      <td>14.395251</td>
      <td>0.486910</td>
      <td>0.409290</td>
      <td>10333.139992</td>
    </tr>
    <tr>
      <th>min</th>
      <td>18.000000</td>
      <td>135.000000</td>
      <td>51.400000</td>
      <td>1.000000</td>
      <td>30.000000</td>
      <td>31.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>11444.140000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>20.000000</td>
      <td>163.000000</td>
      <td>66.500000</td>
      <td>1.460000</td>
      <td>58.000000</td>
      <td>59.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>35206.540000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>21.000000</td>
      <td>171.000000</td>
      <td>71.800000</td>
      <td>2.040000</td>
      <td>70.000000</td>
      <td>71.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>41672.010000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>23.000000</td>
      <td>180.000000</td>
      <td>78.500000</td>
      <td>2.780000</td>
      <td>78.000000</td>
      <td>80.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>49372.540000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>64.000000</td>
      <td>206.000000</td>
      <td>116.000000</td>
      <td>4.000000</td>
      <td>97.000000</td>
      <td>98.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>75596.790000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="perzentile-und-perzentilrang">
<h3>Perzentile und Perzentilrang<a class="headerlink" href="#perzentile-und-perzentilrang" title="Permalink to this headline">#</a></h3>
<p><strong>Perzentile</strong> unterteilen einen geordneten Datensatz in <span class="math notranslate nohighlight">\(100\)</span> gleiche Teile. Jeder (geordnete) Datensatz hat <span class="math notranslate nohighlight">\(99\)</span> Perzentile, die ihn in <span class="math notranslate nohighlight">\(100\)</span> gleiche Teile unterteilen. Das <strong>k-te</strong> Perzentil wird mit <span class="math notranslate nohighlight">\(P_k\)</span> bezeichnet, wobei <span class="math notranslate nohighlight">\(k\)</span> eine ganze Zahl im Bereich von <span class="math notranslate nohighlight">\(1\)</span> bis <span class="math notranslate nohighlight">\(99\)</span> ist. Das <span class="math notranslate nohighlight">\(25\)</span>-te Perzentil wird zum Beispiel mit <span class="math notranslate nohighlight">\(P_{25}\)</span> bezeichnet.</p>
<p>So kann das <strong>k-te</strong> Perzentil, <span class="math notranslate nohighlight">\(P_k\)</span>, als ein Wert in einem Datensatz definiert werden, bei dem etwa <span class="math notranslate nohighlight">\(k\%\)</span> der Messungen kleiner als der Wert von <span class="math notranslate nohighlight">\(P_k\)</span> und etwa <span class="math notranslate nohighlight">\((100-k)\)</span> der Messungen größer als der Wert von <span class="math notranslate nohighlight">\(P_k\)</span> sind</p>
<p>.</p>
<p>Der ungefähre Wert des <strong>k-ten</strong>.
Perzentils, bezeichnet mit <span class="math notranslate nohighlight">\(P_k\)</span>, ist</p>
<div class="math notranslate nohighlight">
\[ P_k = \frac{kn}{100} \]</div>
<p>wobei <strong>k</strong> die Nummer des Perzentils bezeichnet und <strong>n</strong> den Stichprobenumfang darstellt.</p>
<p>Als Übung berechnen wir das <span class="math notranslate nohighlight">\(38\)</span>-te, das <span class="math notranslate nohighlight">\(50\)</span>-te und das <span class="math notranslate nohighlight">\(73\)</span>-te Perzentil der Variablen <code class="docutils literal notranslate"><span class="pre">nc_score</span></code> in Python. Zunächst berechnen wir das 38. Perzentil gemäß der oben angegebenen Gleichung. Dann wenden wir die <code class="docutils literal notranslate"><span class="pre">np.percentile()</span></code>-Funktion von Python an, um das <span class="math notranslate nohighlight">\(38\)</span>-te, <span class="math notranslate nohighlight">\(50\)</span>-te und <span class="math notranslate nohighlight">\(73\)</span>-te Perzentil der Variablen <code class="docutils literal notranslate"><span class="pre">nc_score</span></code> zu ermitteln.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lese Datei students.csv als Dataframe ein; Indexspalte wird übersprungen</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../data/students.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">scores</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;nc_score&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>

<span class="c1"># Berechne 38-te Perzentile</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">38</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Die </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">-te Perzentile ist </span><span class="si">{</span><span class="nb">round</span><span class="p">((</span><span class="n">k</span><span class="o">*</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Die 38-te Perzentile ist 3131.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scores</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>stud_id
403145    1.0
884117    1.0
832302    1.0
499028    1.0
924359    1.0
         ... 
676841    4.0
679521    4.0
706167    4.0
941727    4.0
806767    4.0
Name: nc_score, Length: 8239, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Wir wählen den Wert anhand dieser Zahl in der geordneten Liste <code class="docutils literal notranslate"><span class="pre">nc_score</span></code> aus und vergleichen ihn mit den Perzentilwerten.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scores</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3131</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.74
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">quartiles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="p">[</span><span class="mi">38</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">73</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">quartiles</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.74 2.04 2.71]
</pre></div>
</div>
</div>
</div>
<p>Das hat gut funktioniert! Sie können prüfen, ob der Median der Variablen <code class="docutils literal notranslate"><span class="pre">nc_score</span></code> dem <span class="math notranslate nohighlight">\(50\)</span>-te Perzentil <span class="math notranslate nohighlight">\((2,04)\)</span> entspricht, wie oben berechnet.</p>
<p>Wir können auch den <strong>Perzentilrang</strong> für einen bestimmten Wert <span class="math notranslate nohighlight">\(x_i\)</span>
eines Datensatzes mit der folgenden Gleichung berechnen:</p>
<div class="math notranslate nohighlight">
\[ \text{Perzentil Rang für} \   x_i = \frac{ \text{Werte kleiner als} \ x_i}{ \text{Gesamtanzahl der Werte im Datensatz}} \]</div>
<p>Der Perzentilrang von <span class="math notranslate nohighlight">\(x_i\)</span> gibt den Prozentsatz der Werte im Datensatz an, die kleiner als <span class="math notranslate nohighlight">\(x_i\)</span> sind.</p>
<p>In Python gibt es keine eingebaute Funktion zur Berechnung des Perzentilrangs. Es ist jedoch relativ einfach, eine solche Funktion selbst zu schreiben.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Definiere Funktion my_percentile_rank</span>
<span class="k">def</span> <span class="nf">my_percentile_rank</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Computes the percentile rank</span>
<span class="sd">    Args:</span>
<span class="sd">       x: int or float number</span>
<span class="sd">       data: Pandas Series</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">data</span> <span class="o">&lt;</span> <span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Jetzt berechnen wir zum Beispiel den Perzentilrang für einen Numerus clausus von <span class="math notranslate nohighlight">\(2,5\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_percentile_rank</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">scores</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6627017841971113
</pre></div>
</div>
</div>
</div>
<p>Wenn wir das Ergebnis auf den nächsten ganzzahligen Wert runden, können wir feststellen, dass etwa <span class="math notranslate nohighlight">\(66 \%\)</span> der Studenten in unserem Datensatz einen Numerus clausus von mehr als <span class="math notranslate nohighlight">\(2,5\)</span> hatten.</p>
</section>
<section id="ausreiszer-und-boxplots">
<h3>Ausreißer und Boxplots<a class="headerlink" href="#ausreiszer-und-boxplots" title="Permalink to this headline">#</a></h3>
<section id="ausreiszer">
<h4>Ausreißer<a class="headerlink" href="#ausreiszer" title="Permalink to this headline">#</a></h4>
<p>Bei der Datenanalyse ist die Identifizierung von Ausreißern und damit von Beobachtungen, die deutlich aus dem Gesamtmuster der Daten herausfallen, sehr wichtig. Ein Ausreißer erfordert besondere Aufmerksamkeit. Er kann das Ergebnis eines Mess- oder Aufzeichnungsfehlers, einer Beobachtung aus einer anderen Population oder einer ungewöhnlich extremen Beobachtung sein. Beachten Sie, dass eine extreme Beobachtung nicht zwangsläufig ein Ausreißer sein muss, sondern auch ein Hinweis auf eine Schieflage sein kann (<span id="id5">Fahrmeir <em>et al.</em> [<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">2016</a>]</span> s.62).</p>
<p>Wenn wir einen Ausreißer beobachten, sollten wir versuchen, seine Ursache zu ermitteln. Ist ein Ausreißer auf einen Mess- oder Aufzeichnungsfehler zurückzuführen oder gehört er aus einem anderen Grund eindeutig nicht zum Datensatz, kann er einfach entfernt werden. Wenn jedoch keine Erklärung für einen Ausreißer ersichtlich ist, ist die Entscheidung, ob er im Datensatz verbleiben soll, eine schwierige Ermessensentscheidung.</p>
<p>Als Diagnoseinstrument zum Aufspüren von Beobachtungen, die Ausreißer sein könnten, können wir Quartile und den <strong>IQR</strong> verwenden. Daher definieren wir die <strong>Untergrenze</strong> und die <strong>Obergrenze</strong> eines Datensatzes. Die untere Grenze ist die Zahl, die <span class="math notranslate nohighlight">\(1,5×IQRs\)</span> unter dem ersten Quartil liegt; die obere Grenze ist die Zahl, die <span class="math notranslate nohighlight">\(1,5×IQRs\)</span> über dem dritten Quartil liegt. Beobachtungen, die unterhalb der Untergrenze oder oberhalb der Obergrenze liegen, sind potenzielle Ausreißer (<span id="id6">Fahrmeir <em>et al.</em> [<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">2016</a>]</span> s.61).</p>
<div class="math notranslate nohighlight">
\[\text{Untere Grenze}=Q1-1,5×IQR\]</div>
<div class="math notranslate nohighlight">
\[\text{Obere Grenze}=Q3+1,5×IQR\]</div>
</section>
<section id="boxplots">
<h4>Boxplots<a class="headerlink" href="#boxplots" title="Permalink to this headline">#</a></h4>
<p>Das Boxplot-Diagramm, auch <strong>Box-and-Whisker-Diagramm</strong> genannt, basiert auf der Fünf-Punkte-Zusammenfassung (<span id="id7">Fahrmeir <em>et al.</em> [<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">2016</a>]</span> s.62) und kann zur grafischen Darstellung von Zentrum und Variation eines Datensatzes verwendet werden. Diese Diagramme wurden von dem Mathematiker <a href="https://de.wikipedia.org/wiki/John_W._Tukey">John Wilder Tukey</a> erfunden. Es sind mehrere <a href="https://de.wikipedia.org/wiki/Box-Plot">Arten von Boxplots</a> gebräuchlich.</p>
<p>Box-and-Whisker-Diagramm bieten eine grafische Darstellung der Daten anhand von fünf Maßzahlen: dem Median, dem ersten Quartil, dem dritten Quartil sowie dem kleinsten und dem größten Wert des Datensatzes zwischen der unteren und der oberen Grenze. Der Abstand zwischen den verschiedenen Teilen des Kastens zeigt den Grad der Streuung und Schiefe der Daten an. Durch die Erstellung von Box-and-Whisker-Diagrammen können verschiedene Verteilungen miteinander verglichen werden. Es hilft auch, Ausreißer zu erkennen (<span id="id8">Fahrmeir <em>et al.</em> [<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">2016</a>]</span> s.62). Box-Plots können entweder horizontal oder vertikal gezeichnet werden.</p>
<p><img alt="Alt-Text" src="_images/boxplot.png" />
Die Ränder der Box sind immer das erste und dritte Quartil, und der Bereich innerhalb der Box ist immer das zweite Quartil (der Median). Die von den Boxen ausgehenden Linien (Whisker) zeigen die Variabilität außerhalb des oberen und unteren Quartils an. Um einen Boxplot zu erstellen, benötigen wir auch das Konzept der benachbarten Werte. Die <strong>angrenzenden Werte</strong> eines Datensatzes sind die extremsten Beobachtungen, die noch innerhalb der unteren und oberen Grenzen liegen; sie sind die extremsten Beobachtungen, die keine potenziellen Ausreißer sind. Ausreißer können als einzelne Punkte aufgetragen werden. Wenn es in einem Datensatz keine potenziellen Ausreißer gibt, sind die angrenzenden Werte lediglich das Minimum und das Maximum der Beobachtungen (<span id="id9">Fahrmeir <em>et al.</em> [<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">2016</a>]</span>).</p>
<p>Lassen Sie uns nun eine Reihe von Boxplots erstellen, um den Datensatz <code class="docutils literal notranslate"><span class="pre">students</span></code> eingehender zu analysieren. Wir beginnen mit der Erstellung eines Boxplots für die Variable <code class="docutils literal notranslate"><span class="pre">nc_score</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lese der Datei students.csv; nur Spalten &#39;nc_score&#39;,&#39;semester&#39;,&#39;gender&#39;,&#39;height&#39; werden verwendet</span>
<span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;../../data/students.csv&quot;</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;nc_score&quot;</span><span class="p">,</span> <span class="s2">&quot;semester&quot;</span><span class="p">,</span> <span class="s2">&quot;gender&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">students</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gender</th>
      <th>height</th>
      <th>nc_score</th>
      <th>semester</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Female</td>
      <td>160</td>
      <td>1.91</td>
      <td>1st</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Female</td>
      <td>172</td>
      <td>1.56</td>
      <td>2nd</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Female</td>
      <td>168</td>
      <td>1.24</td>
      <td>3rd</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Male</td>
      <td>183</td>
      <td>1.37</td>
      <td>2nd</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Female</td>
      <td>175</td>
      <td>1.46</td>
      <td>1st</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>8234</th>
      <td>Male</td>
      <td>181</td>
      <td>2.91</td>
      <td>6th</td>
    </tr>
    <tr>
      <th>8235</th>
      <td>Male</td>
      <td>178</td>
      <td>2.03</td>
      <td>2nd</td>
    </tr>
    <tr>
      <th>8236</th>
      <td>Female</td>
      <td>169</td>
      <td>3.72</td>
      <td>3rd</td>
    </tr>
    <tr>
      <th>8237</th>
      <td>Male</td>
      <td>195</td>
      <td>2.74</td>
      <td>4th</td>
    </tr>
    <tr>
      <th>8238</th>
      <td>Female</td>
      <td>170</td>
      <td>3.29</td>
      <td>&gt;6th</td>
    </tr>
  </tbody>
</table>
<p>8239 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">students</span><span class="p">[</span><span class="s2">&quot;nc_score&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/04_Maße_der_Position_57_0.png" src="_images/04_Maße_der_Position_57_0.png" />
</div>
</div>
<p>Wir erhalten sofort einen Eindruck von der Streuung und Schiefe der Daten. Durch Hinzufügen des Arguments <code class="docutils literal notranslate"><span class="pre">vert</span> <span class="pre">=</span> <span class="pre">False</span></code> zum Boxplot drehen wir den Boxplot um <span class="math notranslate nohighlight">\(90^∘\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">students</span><span class="p">[</span><span class="s2">&quot;nc_score&quot;</span><span class="p">],</span> <span class="n">vert</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Scores&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Numerus Clausus&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Numerus Clausus&#39;)
</pre></div>
</div>
<img alt="_images/04_Maße_der_Position_59_1.png" src="_images/04_Maße_der_Position_59_1.png" />
</div>
</div>
<p>Boxplots sind eine sehr leistungsfähige Technik für die explorative Datenanalyse, da es sehr einfach ist, die Variable von Interesse, in unserem Fall die <code class="docutils literal notranslate"><span class="pre">nc_score</span></code>-Variable, auf andere Variablen zu beziehen und in ihrer Relation darstellen. In Python können wir das erreichen indem wir das Argument <code class="docutils literal notranslate"><span class="pre">by</span></code> in der <code class="docutils literal notranslate"><span class="pre">boxplot</span></code> Methode anwenden.</p>
<p>Zeichnen wir einen Boxplot der Variable <code class="docutils literal notranslate"><span class="pre">nc_score</span></code> in Abhängigkeit von der Variable <code class="docutils literal notranslate"><span class="pre">semester</span></code>. Die <code class="docutils literal notranslate"><span class="pre">semester</span></code>-Variable entspricht dem Semester, in dem der jeweilige Student studiert. Zu Ihrer Information: Die Mindeststudienzeit für die untersuchten Studiengänge ist auf <span class="math notranslate nohighlight">\(4\)</span> Semester festgelegt.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;nc_score&quot;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s2">&quot;semester&quot;</span><span class="p">,</span> <span class="n">vert</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">notch</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/04_Maße_der_Position_61_0.png" src="_images/04_Maße_der_Position_61_0.png" />
</div>
</div>
<p>Interessant, nicht wahr? Die Grafik zeigt, dass Studierende höherer Semester (<span class="math notranslate nohighlight">\(&gt;5\)</span>-tes Semester) beim <em>Numerus clausus</em> tendenziell schlechter abschneiden. Mit anderen Worten: Studierende, die ihr Studium innerhalb der Mindeststudienzeit abschließen, haben tendenziell eine höhere <em>Numerus-clausus</em>-Punktzahl.</p>
<p>Doch damit sind wir noch nicht fertig. Wir wollen wissen, ob das Geschlecht einen Einfluss auf diese Beobachtung hat. Wir können ganz einfach eine Interaktionsvariable einfügen, indem wir die Variable nach den gruppiert werden soll in eckige Klammern setzen : <code class="docutils literal notranslate"><span class="pre">[var1,</span> <span class="pre">var2]</span></code>. Außerdem verwenden wir das Argument <code class="docutils literal notranslate"><span class="pre">notch</span></code> in der <code class="docutils literal notranslate"><span class="pre">boxplot</span></code> Methode. Wenn sich die notches zweier Diagramme nicht überschneiden, ist dies ein “starker Hinweis” dafür, dass sich die beiden Mediane unterscheiden <a class="reference external" href="https://www.worldcat.org/title/graphical-methods-for-data-analysis/oclc/1035370684">Chambers, et al. (1983): Graphical Methods for Data Analysis. Wadsworth &amp; Brooks/Cole, S. 62)</a>.</p>
<p>Bitte beachten Sie, dass wir eine zusätzliche Zeile Code schreiben müssen, um ein schöneres <span class="math notranslate nohighlight">\(y\)</span>-Label zu erhalten.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
    <span class="n">column</span><span class="o">=</span><span class="s2">&quot;nc_score&quot;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;semester&quot;</span><span class="p">,</span> <span class="s2">&quot;gender&quot;</span><span class="p">],</span> <span class="n">vert</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">notch</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/04_Maße_der_Position_63_0.png" src="_images/04_Maße_der_Position_63_0.png" />
</div>
</div>
<p>Dieses Diagramm ist nicht so einfach zu interpretieren. Es scheint jedoch, dass die oben gemachte Beobachtung bestätigt wird: Studierende aus höheren Semestern (<span class="math notranslate nohighlight">\(&gt;5\)</span>-tes) schneiden beim <em>Numerus clausus</em> tendenziell schlechter ab. Der Einfluss des Geschlechts auf die <em>Numerus-Clausus</em>-Werte ist jedoch nicht so eindeutig. Wir werden Methoden der <strong>Inferenzstatistik</strong> anwenden müssen, um zu beurteilen, ob diese Unterschiede <em>statistisch signifikant</em> sind oder ob diese Schwankungen um den Median auch rein zufällig sein könnten.</p>
<p>Zum Abschluss dieses Abschnitts und um auch einen Boxplot mit Ausreißern zu sehen, stellen wir die Variable <code class="docutils literal notranslate"><span class="pre">height</span></code> gegen die Variable <code class="docutils literal notranslate"><span class="pre">gender</span></code> dar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s2">&quot;gender&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/04_Maße_der_Position_65_0.png" src="_images/04_Maße_der_Position_65_0.png" />
</div>
</div>
<p>Offensichtlich, und sicherlich nicht unerwartet, gibt es einen Unterschied in der Größe der Studenten zwischen den verschiedenen Gruppen (männlich oder weiblich). Weibliche Studenten sind tendenziell kleiner als männliche, aber wenn wir uns die Extreme ansehen, gibt es in beiden Gruppen große und kleine Personen. Wie bereits erwähnt, müssen wir jedoch zunächst die Daten auf <em>statistische Signifikanz</em> prüfen, um sicher zu sein, dass der beobachtete Größenunterschied nicht nur zufällig ist.</p>
</section>
</section>
</section>
<span id="document-Kapitel01/05_Maße_der_Relation_zwischen_Variablen"></span><section class="tex2jax_ignore mathjax_ignore" id="masze-fur-die-relation-zwischen-variablen">
<h2>Maße für die Relation zwischen Variablen<a class="headerlink" href="#masze-fur-die-relation-zwischen-variablen" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
<p>In den vorangegangenen Abschnitten haben wir uns hauptsächlich auf eine einzelne Variable, die Beschreibung einer Verteilung und die Berechnung von zusammenfassenden Statistiken konzentriert. Statistiken, die eine einzelne Variable beschreiben, werden als <a href="https://de.wikipedia.org/wiki/Univariat">univariate Statistiken</a> bezeichnet. Untersucht man die Beziehung zwischen zwei Variablen, spricht man von <a href="https://de.wikipedia.org/wiki/Univariat#Verwendung_in_der_Mathematik">bivariater Statistik</a>. Wenn die Beziehungen zwischen mehreren Variablen gleichzeitig untersucht werden, spricht man von <a href="https://de.wikipedia.org/wiki/Multivariate_Verfahren">multivariaten Statistiken</a>. <strong>Maße für die Relation</strong> zwischen Variablen bieten die Möglichkeit, die Größe der Verknüpfung zwischen zwei Variablen zusammenzufassen.</p>
<section id="kovarianz">
<h3>Kovarianz<a class="headerlink" href="#kovarianz" title="Permalink to this headline">#</a></h3>
<p>Die <a href="https://de.wikipedia.org/wiki/Kovarianz_(Stochastik)">Kovarianz</a> ist ein Maß für die gemeinsame Variabilität von zwei Variablen. Die Kovarianz kann jeden Wert im Intervall <span class="math notranslate nohighlight">\(]-\infty \ \)</span>,<span class="math notranslate nohighlight">\( \ +\infty[\)</span> annehmen.</p>
<p>Die Kovarianz ist positiv, wenn die größeren/kleineren Werte der einen Variablen hauptsächlich mit den größeren/kleineren Werten der anderen Variablen übereinstimmen. Die Kovarianz ist negativ, wenn die Variablen tendenziell ein entgegengesetztes Verhalten zeigen. Die Kovarianz ist negativ, wenn die größeren Werte der einen Variablen hauptsächlich mit den kleineren Werten der anderen Variablen übereinstimmen.</p>
<p>Die Kovarianz, <span class="math notranslate nohighlight">\(s_{xy}\)</span>
wird durch die folgende Gleichung berechnet</p>
<div class="math notranslate nohighlight">
\[s_{xy} = \frac{\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})}{n-1}\]</div>
<p>Die <strong>normalisierte Version der Kovarianz</strong> wird <strong>Korrelationskoeffizient</strong> genannt, dessen Größe die Stärke einer linearen Beziehung zwischen zwei Variablen angibt.</p>
</section>
<section id="korrelation">
<h3>Korrelation<a class="headerlink" href="#korrelation" title="Permalink to this headline">#</a></h3>
<section id="pearson-produkt-moment-korrelationskoeffizient">
<h4>Pearson-Produkt-Moment-Korrelationskoeffizient<a class="headerlink" href="#pearson-produkt-moment-korrelationskoeffizient" title="Permalink to this headline">#</a></h4>
<p>Die Korrelation ist eine weit verbreitete Methode zur Untersuchung der Beziehung zwischen <strong>quantitativen Variablen</strong>. Die am häufigsten verwendete Statistik ist der <strong>lineare Korrelationskoeffizient</strong> <span class="math notranslate nohighlight">\(r\)</span>, der zu Ehren seines Entwicklers, <a href="https://de.wikipedia.org/wiki/Karl_Pearson">Karl Pearson</a>, auch als <a href="https://de.wikipedia.org/wiki/Korrelationskoeffizient">Pearson-Produkt-Moment-Korrelationskoeffizient</a> bekannt ist. Er ist gegeben durch</p>
<div class="math notranslate nohighlight">
\[ r = \frac{\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum_{i=1}^n (x_i - \bar{x})^2} \sqrt{ \sum_{i=1}^n (y_i - \bar{y})^2}} = \frac{s_{xy}}{s_x s_y}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(s_{xy}\)</span> die Kovarianz von <span class="math notranslate nohighlight">\(x\)</span> und <span class="math notranslate nohighlight">\(y\)</span> und <span class="math notranslate nohighlight">\(s_x\)</span> und <span class="math notranslate nohighlight">\(s_y\)</span> die Standardabweichung von <span class="math notranslate nohighlight">\(x\)</span> bzw. <span class="math notranslate nohighlight">\(y\)</span> sind. Durch Division durch die Standardabweichungen der Stichprobe, <span class="math notranslate nohighlight">\(s_x\)</span> und <span class="math notranslate nohighlight">\(s_y\)</span>, wird der lineare Korrelationskoeffizient, <span class="math notranslate nohighlight">\(r\)</span>, skalenunabhängig und nimmt Werte zwischen <span class="math notranslate nohighlight">\(-1\)</span> und <span class="math notranslate nohighlight">\(1\)</span> an.</p>
<p>Der lineare Korrelationskoeffizient misst die Stärke der linearen Beziehung zwischen zwei Variablen. Liegt <span class="math notranslate nohighlight">\(r\)</span> nahe bei <span class="math notranslate nohighlight">\(\pm 1\)</span>, sind die beiden Variablen stark korreliert, und in einem Streudiagramm liegen die Datenpunkte um eine Linie herum. Liegt <span class="math notranslate nohighlight">\(r\)</span> weit von <span class="math notranslate nohighlight">\(\pm 1\)</span> entfernt, sind die Datenpunkte weiter gestreut. Liegt <span class="math notranslate nohighlight">\(r\)</span> nahe bei <span class="math notranslate nohighlight">\(0\)</span>, sind die Datenpunkte im Wesentlichen um eine horizontale Linie gestreut, was darauf hindeutet, dass es fast keine lineare Beziehung zwischen den Variablen gibt.</p>
<p><img alt="Alt-Text" src="_images/pearson.png" /></p>
<p>Eine interessante Eigenschaft von <span class="math notranslate nohighlight">\(r\)</span> ist, dass sein Vorzeichen die Steigung der linearen Beziehung zwischen zwei Variablen widerspiegelt. Ein positiver Wert von <span class="math notranslate nohighlight">\(r\)</span> deutet darauf hin, dass die Variablen <strong>positiv linear korreliert</strong> sind, was bedeutet, dass <span class="math notranslate nohighlight">\(y\)</span> tendenziell linear zunimmt, wenn <span class="math notranslate nohighlight">\(x\)</span> zunimmt. Ein negativer Wert von <span class="math notranslate nohighlight">\(r\)</span> deutet darauf hin, dass die Variablen <strong>negativ linear korreliert</strong> sind, was bedeutet, dass <span class="math notranslate nohighlight">\(y\)</span> tendenziell linear abnimmt, wenn <span class="math notranslate nohighlight">\(x\)</span> zunimmt.</p>
<p>Es gibt keine eindeutige Klassifizierungsregel für die Größe einer linearen Beziehung zwischen zwei Variablen. Die folgende Tabelle kann jedoch als Faustregel für den Umgang mit den numerischen Werten des Pearson-Produkt-Moment-Korrelationskoeffizienten dienen.</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>starke lineare Korrelation</p></td>
<td><p><span class="math notranslate nohighlight">\(r &gt; 0,9\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>mittlere lineare Korrelation</p></td>
<td><p><span class="math notranslate nohighlight">\(0,7 &lt; r \le 0,9\)</span></p></td>
</tr>
<tr class="row-even"><td><p>schwache lineare Korrelation</p></td>
<td><p><span class="math notranslate nohighlight">\(0,5 &lt; r \le 0,7\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>keine oder zweifelhafte lineare Korrelation</p></td>
<td><p><span class="math notranslate nohighlight">\(0 &lt; r \le 0,5\)</span></p></td>
</tr>
</tbody>
</table>
<p>Die Pearson-Korrelation setzt voraus, dass die Variablen annähernd normalverteilt sind, und sie ist bei Vorhandensein von Ausreißern nicht robust.</p>
<p>In einem späteren Abschnitt über lineare Regression wird das Bestimmtheitsmaß, <span class="math notranslate nohighlight">\(R^2\)</span>
ein anschauliches Maß für die Qualität von linearen Modellen. Es besteht eine enge Beziehung zwischen <span class="math notranslate nohighlight">\(R^2\)</span> und dem linearen Korrelationskoeffizienten <span class="math notranslate nohighlight">\(r\)</span>. Das Bestimmtheitsmaß <span class="math notranslate nohighlight">\(R^2\)</span> ist gleich dem Quadrat des linearen Korrelationskoeffizienten <span class="math notranslate nohighlight">\(r\)</span>.</p>
<div class="math notranslate nohighlight">
\[\text{Determinationskoeffizient} (R^2) = r^2\]</div>
</section>
<section id="korrelationskoeffizient-nach-pearson-ein-beispiel">
<h4>Korrelationskoeffizient nach Pearson: Ein Beispiel<a class="headerlink" href="#korrelationskoeffizient-nach-pearson-ein-beispiel" title="Permalink to this headline">#</a></h4>
<p>Um ein Gefühl dafür zu bekommen, berechnen wir den Pearson-Produkt-Moment-Korrelationskoeffizienten in einem Beispiel. Dazu laden wir den <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz in unseren Arbeitsbereich (Sie können die Datei <code class="docutils literal notranslate"><span class="pre">students.csv</span></code> <a href="https://userpage.fu-berlin.de/soga/200/2010_data_sets/students.csv">hier</a> herunterladen).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Einlesen der Daten als Dataframe</span>
<span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../data/students.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Der <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz besteht aus <span class="math notranslate nohighlight">\(8239\)</span> Zeilen, von denen jede einen bestimmten Studenten repräsentiert, und <span class="math notranslate nohighlight">\(16\)</span> Spalten, von denen jede einer Variable/einem Merkmal entspricht, das sich auf diesen bestimmten Studenten bezieht. Diese selbsterklärenden Variablen sind: <em>stud_id, name, gender, age, height, weight, religion, nc_score, semester, major, minor, score1, score2, online_tutorial, graduated, salary</em>.</p>
<p>In diesem Beispiel wird <strong>die lineare Beziehung zwischen dem Gewicht und der Größe der Studenten</strong> untersucht. Dazu wählen wir zufällig <span class="math notranslate nohighlight">\(37\)</span> Studenten aus und extrahieren die Variablen <code class="docutils literal notranslate"><span class="pre">height</span></code> und <code class="docutils literal notranslate"><span class="pre">weight</span></code> aus dem Datensatz.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Wähle zufällige Stichprobe n=37 aus ohne doppelt auszuwählen</span>
<span class="n">students_sample</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Lese height und weight der Probe aus dem dataframe in Listen ein</span>
<span class="n">height_sample</span> <span class="o">=</span> <span class="n">students_sample</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span>
<span class="n">weight_sample</span> <span class="o">=</span> <span class="n">students_sample</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">height_sample</span><span class="p">,</span> <span class="n">weight_sample</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Körpergrösse&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Gewicht&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/05_Maße_der_Relation_zwischen_Variablen_23_0.png" src="_images/05_Maße_der_Relation_zwischen_Variablen_23_0.png" />
</div>
</div>
<p>Das Streudiagramm zeigt, dass eine lineare Beziehung zwischen den beiden betrachteten Variablen besteht. Für diese Übung berechnen wir den linearen Korrelationskoeffizienten zunächst von Hand und wenden dann die <code class="docutils literal notranslate"><span class="pre">np.corrcoef()</span></code>-Funktion in Python an. Wir erinnern uns an die Gleichung von oben</p>
<div class="math notranslate nohighlight">
\[ r = \frac{\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum_{i=1}^n (x_i - \bar{x})^2} \sqrt{ \sum_{i=1}^n (y_i - \bar{y})^2}} = \frac{s_{xy}}{s_x s_y}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s_xy</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
    <span class="p">(</span><span class="n">height_sample</span> <span class="o">-</span> <span class="n">height_sample</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">*</span> <span class="p">(</span><span class="n">weight_sample</span> <span class="o">-</span> <span class="n">weight_sample</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="p">)</span>
<span class="n">sx_sy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">((</span><span class="n">height_sample</span> <span class="o">-</span> <span class="n">height_sample</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
    <span class="nb">sum</span><span class="p">((</span><span class="n">weight_sample</span> <span class="o">-</span> <span class="n">weight_sample</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">s_xy</span> <span class="o">/</span> <span class="n">sx_sy</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9295600715108283
</pre></div>
</div>
</div>
</div>
<p>Zur Überprüfung des Ergebnisses berechnen wir das Verhältnis der Kovarianz von <span class="math notranslate nohighlight">\(x\)</span> und <span class="math notranslate nohighlight">\(y\)</span> und die Standardabweichung von <span class="math notranslate nohighlight">\(x\)</span> und <span class="math notranslate nohighlight">\(y\)</span>.</p>
<div class="math notranslate nohighlight">
\[ r = \frac{s_{xy}}{s_x s_y} \]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne Kovarianz zwischen height_sample und weight_sample</span>
<span class="n">s_xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">height_sample</span><span class="p">,</span> <span class="n">weight_sample</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="c1"># Berechne Standardabweichung für height_sample und weight_sample</span>
<span class="n">std_height_sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">height_sample</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">std_weight_sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">weight_sample</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Berechne Pearsonkorrelationskoeffizienten</span>
<span class="n">s_xy</span> <span class="o">/</span> <span class="p">(</span><span class="n">std_height_sample</span> <span class="o">*</span> <span class="n">std_weight_sample</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.929560071510828
</pre></div>
</div>
</div>
</div>
<p>Zum Schluss wenden wir die Funktion <code class="docutils literal notranslate"><span class="pre">np.corrcoef</span></code> an, die im <code class="docutils literal notranslate"><span class="pre">numpy</span></code> Modul enthalten ist.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">weight_sample</span><span class="p">,</span> <span class="n">height_sample</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9295600715108281
</pre></div>
</div>
</div>
</div>
<p>Perfekt! Die vier Berechnungen ergeben genau das gleiche Ergebnis! Der lineare Korrelationskoeffizient beträgt <span class="math notranslate nohighlight">\(r=0,9296\)</span>. Daraus können wir schließen, dass es einen starken linearen Zusammenhang zwischen der Größe und dem Gewicht eines Studenten gibt.</p>
<p>Natürlich ist eine Korrelationsanalyse nicht auf zwei Variablen beschränkt. Dank statistischer Softwarepakete, wie Python, können wir eine paarweise Korrelationsanalyse für mehr als zwei Variablen durchführen. Lassen Sie uns zunächst den Datensatz vorbereiten. Für eine bessere Visualisierung ziehen wir <span class="math notranslate nohighlight">\(100\)</span> zufällig ausgewählte Studenten aus dem <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz. Dann wählen wir eine numerische Variablen aus, um eine Korrelationsanalyse durchzuführen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Wähle zufällige Stichprobe n=100 aus ohne Zurücklegen auszuwählen</span>
<span class="n">students_sample</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="c1"># Wähle nur numerische Variablen aus</span>
<span class="n">students_sample</span> <span class="o">=</span> <span class="n">students_sample</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="s2">&quot;number&quot;</span><span class="p">)</span>

<span class="n">students_sample</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>height</th>
      <th>weight</th>
      <th>nc_score</th>
      <th>score1</th>
      <th>score2</th>
      <th>online_tutorial</th>
      <th>graduated</th>
      <th>salary</th>
    </tr>
    <tr>
      <th>stud_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>966453</th>
      <td>22</td>
      <td>180</td>
      <td>75.9</td>
      <td>2.70</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>462072</th>
      <td>23</td>
      <td>172</td>
      <td>76.5</td>
      <td>1.25</td>
      <td>64.0</td>
      <td>68.0</td>
      <td>0</td>
      <td>1</td>
      <td>47556.44</td>
    </tr>
    <tr>
      <th>222219</th>
      <td>20</td>
      <td>168</td>
      <td>69.9</td>
      <td>1.18</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>191101</th>
      <td>20</td>
      <td>168</td>
      <td>63.0</td>
      <td>2.41</td>
      <td>72.0</td>
      <td>80.0</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>188703</th>
      <td>18</td>
      <td>173</td>
      <td>75.7</td>
      <td>1.19</td>
      <td>74.0</td>
      <td>74.0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>225865</th>
      <td>20</td>
      <td>177</td>
      <td>75.4</td>
      <td>2.11</td>
      <td>72.0</td>
      <td>70.0</td>
      <td>1</td>
      <td>1</td>
      <td>50078.33</td>
    </tr>
    <tr>
      <th>112287</th>
      <td>19</td>
      <td>176</td>
      <td>76.1</td>
      <td>2.68</td>
      <td>52.0</td>
      <td>55.0</td>
      <td>0</td>
      <td>1</td>
      <td>46075.27</td>
    </tr>
    <tr>
      <th>358839</th>
      <td>21</td>
      <td>175</td>
      <td>78.8</td>
      <td>1.93</td>
      <td>71.0</td>
      <td>77.0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>963828</th>
      <td>21</td>
      <td>173</td>
      <td>78.3</td>
      <td>3.04</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>159750</th>
      <td>23</td>
      <td>164</td>
      <td>65.9</td>
      <td>3.03</td>
      <td>46.0</td>
      <td>44.0</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Offensichtlich enthalten einige Variablen fehlende Werte, die als <span class="math notranslate nohighlight">\(NaN\)</span> bezeichnet werden. Wir können diese Werte aus der Analyse ausschließen, indem wir die Methode <code class="docutils literal notranslate"><span class="pre">dropna()</span></code> hinzufügen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Entferne Spalten die NaN enthalten</span>
<span class="n">students_sample_clean</span> <span class="o">=</span> <span class="n">students_sample</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;any&quot;</span><span class="p">)</span>
<span class="n">students_sample_clean</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>height</th>
      <th>weight</th>
      <th>nc_score</th>
      <th>score1</th>
      <th>score2</th>
      <th>online_tutorial</th>
      <th>graduated</th>
      <th>salary</th>
    </tr>
    <tr>
      <th>stud_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>729441</th>
      <td>34</td>
      <td>167</td>
      <td>70.4</td>
      <td>1.13</td>
      <td>60.0</td>
      <td>57.0</td>
      <td>1</td>
      <td>1</td>
      <td>33208.01</td>
    </tr>
    <tr>
      <th>567950</th>
      <td>20</td>
      <td>182</td>
      <td>79.7</td>
      <td>1.37</td>
      <td>59.0</td>
      <td>58.0</td>
      <td>1</td>
      <td>1</td>
      <td>42604.55</td>
    </tr>
    <tr>
      <th>163772</th>
      <td>23</td>
      <td>163</td>
      <td>65.4</td>
      <td>1.90</td>
      <td>76.0</td>
      <td>67.0</td>
      <td>0</td>
      <td>1</td>
      <td>28235.06</td>
    </tr>
    <tr>
      <th>111998</th>
      <td>20</td>
      <td>174</td>
      <td>75.8</td>
      <td>2.15</td>
      <td>64.0</td>
      <td>72.0</td>
      <td>1</td>
      <td>1</td>
      <td>37364.35</td>
    </tr>
    <tr>
      <th>648227</th>
      <td>24</td>
      <td>187</td>
      <td>91.0</td>
      <td>1.94</td>
      <td>51.0</td>
      <td>50.0</td>
      <td>0</td>
      <td>1</td>
      <td>41601.20</td>
    </tr>
    <tr>
      <th>601421</th>
      <td>24</td>
      <td>197</td>
      <td>99.9</td>
      <td>2.72</td>
      <td>64.0</td>
      <td>70.0</td>
      <td>1</td>
      <td>1</td>
      <td>40460.52</td>
    </tr>
    <tr>
      <th>635788</th>
      <td>22</td>
      <td>167</td>
      <td>69.6</td>
      <td>1.22</td>
      <td>47.0</td>
      <td>47.0</td>
      <td>1</td>
      <td>1</td>
      <td>33318.30</td>
    </tr>
    <tr>
      <th>112287</th>
      <td>19</td>
      <td>176</td>
      <td>76.1</td>
      <td>2.68</td>
      <td>52.0</td>
      <td>55.0</td>
      <td>0</td>
      <td>1</td>
      <td>46075.27</td>
    </tr>
    <tr>
      <th>570121</th>
      <td>23</td>
      <td>148</td>
      <td>61.1</td>
      <td>2.45</td>
      <td>66.0</td>
      <td>77.0</td>
      <td>1</td>
      <td>1</td>
      <td>31764.44</td>
    </tr>
    <tr>
      <th>397699</th>
      <td>23</td>
      <td>172</td>
      <td>69.4</td>
      <td>1.83</td>
      <td>69.0</td>
      <td>67.0</td>
      <td>0</td>
      <td>1</td>
      <td>37854.66</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Die Methode <code class="docutils literal notranslate"><span class="pre">corr()</span></code> liefert eine schöne Tabelle, auch <strong>Korrelationsmatrix</strong> genannt, mit den paarweisen Pearsonschen Korrelationskoeffizienten.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">students_sample_clean</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>height</th>
      <th>weight</th>
      <th>nc_score</th>
      <th>score1</th>
      <th>score2</th>
      <th>online_tutorial</th>
      <th>graduated</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>age</th>
      <td>1.000000</td>
      <td>-0.021219</td>
      <td>0.046222</td>
      <td>-0.277334</td>
      <td>0.132991</td>
      <td>0.073143</td>
      <td>0.037136</td>
      <td>NaN</td>
      <td>-0.146958</td>
    </tr>
    <tr>
      <th>height</th>
      <td>-0.021219</td>
      <td>1.000000</td>
      <td>0.955495</td>
      <td>-0.031163</td>
      <td>-0.041360</td>
      <td>-0.181769</td>
      <td>-0.155009</td>
      <td>NaN</td>
      <td>0.467934</td>
    </tr>
    <tr>
      <th>weight</th>
      <td>0.046222</td>
      <td>0.955495</td>
      <td>1.000000</td>
      <td>0.073386</td>
      <td>-0.078268</td>
      <td>-0.176928</td>
      <td>-0.165820</td>
      <td>NaN</td>
      <td>0.473708</td>
    </tr>
    <tr>
      <th>nc_score</th>
      <td>-0.277334</td>
      <td>-0.031163</td>
      <td>0.073386</td>
      <td>1.000000</td>
      <td>-0.185161</td>
      <td>-0.037330</td>
      <td>-0.048404</td>
      <td>NaN</td>
      <td>0.037957</td>
    </tr>
    <tr>
      <th>score1</th>
      <td>0.132991</td>
      <td>-0.041360</td>
      <td>-0.078268</td>
      <td>-0.185161</td>
      <td>1.000000</td>
      <td>0.860207</td>
      <td>0.131912</td>
      <td>NaN</td>
      <td>0.165573</td>
    </tr>
    <tr>
      <th>score2</th>
      <td>0.073143</td>
      <td>-0.181769</td>
      <td>-0.176928</td>
      <td>-0.037330</td>
      <td>0.860207</td>
      <td>1.000000</td>
      <td>0.381767</td>
      <td>NaN</td>
      <td>-0.038099</td>
    </tr>
    <tr>
      <th>online_tutorial</th>
      <td>0.037136</td>
      <td>-0.155009</td>
      <td>-0.165820</td>
      <td>-0.048404</td>
      <td>0.131912</td>
      <td>0.381767</td>
      <td>1.000000</td>
      <td>NaN</td>
      <td>-0.325214</td>
    </tr>
    <tr>
      <th>graduated</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>salary</th>
      <td>-0.146958</td>
      <td>0.467934</td>
      <td>0.473708</td>
      <td>0.037957</td>
      <td>0.165573</td>
      <td>-0.038099</td>
      <td>-0.325214</td>
      <td>NaN</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Eine Tabelle ist eine schöne Darstellung für eine Korrelationsanalyse, aber eine Abbildung würde natürlich die Interpretierbarkeit verbessern. Das Modul <a class="reference external" href="https://seaborn.pydata.org/">seaborn</a> bietet die Funktion <code class="docutils literal notranslate"><span class="pre">pairplot</span></code> zur Darstellung von Korrelationsmatrizen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Erzeuge Pair Plot</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">students_sample_clean</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.PairGrid at 0x7fd78a8cc700&gt;
</pre></div>
</div>
<img alt="_images/05_Maße_der_Relation_zwischen_Variablen_40_1.png" src="_images/05_Maße_der_Relation_zwischen_Variablen_40_1.png" />
</div>
</div>
<p>Es fällt sofort auf, dass die Mehrzahl der Variablen nicht linear korreliert zu sein scheint. Im Gegensatz dazu scheinen die Variablenpaare <code class="docutils literal notranslate"><span class="pre">height</span></code> und <code class="docutils literal notranslate"><span class="pre">weight</span></code> sowie <code class="docutils literal notranslate"><span class="pre">score1</span></code> und <code class="docutils literal notranslate"><span class="pre">score2</span></code> positiv korreliert zu sein.</p>
</section>
<section id="rangkorrelationskoeffizient-nach-spearman">
<h4>Rangkorrelationskoeffizient nach Spearman<a class="headerlink" href="#rangkorrelationskoeffizient-nach-spearman" title="Permalink to this headline">#</a></h4>
<p>Der Rangkorrelationskoeffizient nach Spearman (<span id="id1">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.133), auch bekannt als Spearmans <span class="math notranslate nohighlight">\(\rho\)</span>, ist ein nichtparametrischer Rangkorrelationskoeffizient. Er wurde von <a href="https://de.wikipedia.org/wiki/Charles_Spearman">Charles Spearman</a> entwickelt und ist eine Alternative zum Produkt-Moment-Korrelationskoeffizienten von Pearson. Der Spearman <span class="math notranslate nohighlight">\(\rho\)</span> Rangkorrelationskoeffizient wird für Stichprobendaten mit <span class="math notranslate nohighlight">\(r_s\)</span> und für Grundgesamtheitsdaten mit <span class="math notranslate nohighlight">\(\rho_s\)</span> bezeichnet (Mann 2012). Der Korrelationskoeffizient bewertet die monotone Beziehung zwischen zwei Variablen und liegt zwischen <span class="math notranslate nohighlight">\(-1\)</span> und <span class="math notranslate nohighlight">\(1\)</span>. Er beschreibt die lineare Korrelation zwischen den Rängen der Daten zu den Variablen <span class="math notranslate nohighlight">\(x\)</span> und <span class="math notranslate nohighlight">\(y\)</span>. Die Spearman-Korrelation ist hoch, wenn die Variablen einen ähnlichen Rang haben, und niedrig, wenn die Variablen einen ungleichen Rang haben.</p>
<p>Um <span class="math notranslate nohighlight">\(r_s\)</span> zu berechnen, werden die Daten für jede Variable, <span class="math notranslate nohighlight">\(x\)</span> und <span class="math notranslate nohighlight">\(y\)</span>, getrennt eingestuft. Die Differenz zwischen jedem Paar von Rängen bezeichnen wir mit <span class="math notranslate nohighlight">\(d\)</span>. Für eine gegebene bivariate Sequenz <span class="math notranslate nohighlight">\((x_1,y_1),(x_2,y_2), \dots,(x_n,y_n)\)</span> ist Spearmans <span class="math notranslate nohighlight">\(r_s\)</span> gegeben durch</p>
<div class="math notranslate nohighlight">
\[ r_s = 1 - \frac{6 \sum_{i=1}^n (r_{xi} - r_{yi})^2}{n(n^2 -1)} \]</div>
<p>wobei <span class="math notranslate nohighlight">\(r_{xi}=Rank(x_i)\)</span> , <span class="math notranslate nohighlight">\(r_{yi}=Rank(y_i)\)</span> , und <span class="math notranslate nohighlight">\(n\)</span>
die Stichprobengröße ist.</p>
<p>Im Gegensatz zum linearen Korrelationskoeffizienten von Pearson ist der lineare Koeffizient von Spearman sowohl für quantitative als auch für ordinale Variablen geeignet. Außerdem sind rangbasierte Korrelationen nicht von der Normalverteilungsannahme abhängig und resistenter gegenüber Ausreißern (<span id="id2">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.135).</p>
</section>
<section id="spearman-s-rangkorrelationskoeffizient-ein-beispiel">
<h4>Spearman’s Rangkorrelationskoeffizient: Ein Beispiel<a class="headerlink" href="#spearman-s-rangkorrelationskoeffizient-ein-beispiel" title="Permalink to this headline">#</a></h4>
<p>Betrachten wir ein Beispiel. Die Bevölkerung einer Gemeinde an einem Fluss ist der Meinung, dass der jüngste Anstieg der Abflussspitzen auf die Abholzung durch ein Holzunternehmen in den letzten Jahren zurückzuführen ist. Wir berechnen den Spearman’schen Rangkorrelationskoeffizienten, um festzustellen, ob es eine Korrelation zwischen dem Spitzenabfluss und dem Anteil der abgeholzten Fläche im Wassereinzugsgebiet gibt (Daten geändert nach <a href=https://www.routledge.com/Modeling-Hydrologic-Change-Statistical-Methods/McCuen/p/book/9781566706001>McCuen 2003, S. 112</a>).</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Jahr</p></th>
<th class="text-align:center head"><p>Abflussspitzen <span class="math notranslate nohighlight">\((m^3s^{-1})\)</span></p></th>
<th class="text-align:center head"><p>abgeholzten Fläche (%)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1982</p></td>
<td class="text-align:center"><p>227</p></td>
<td class="text-align:center"><p>53</p></td>
</tr>
<tr class="row-odd"><td><p>1983</p></td>
<td class="text-align:center"><p>249</p></td>
<td class="text-align:center"><p>56</p></td>
</tr>
<tr class="row-even"><td><p>1984</p></td>
<td class="text-align:center"><p>210</p></td>
<td class="text-align:center"><p>57</p></td>
</tr>
<tr class="row-odd"><td><p>1985</p></td>
<td class="text-align:center"><p>190</p></td>
<td class="text-align:center"><p>58</p></td>
</tr>
<tr class="row-even"><td><p>1986</p></td>
<td class="text-align:center"><p>314</p></td>
<td class="text-align:center"><p>55</p></td>
</tr>
<tr class="row-odd"><td><p>1987</p></td>
<td class="text-align:center"><p>345</p></td>
<td class="text-align:center"><p>54</p></td>
</tr>
<tr class="row-even"><td><p>1988</p></td>
<td class="text-align:center"><p>161</p></td>
<td class="text-align:center"><p>51</p></td>
</tr>
<tr class="row-odd"><td><p>1989</p></td>
<td class="text-align:center"><p>266</p></td>
<td class="text-align:center"><p>50</p></td>
</tr>
<tr class="row-even"><td><p>1990</p></td>
<td class="text-align:center"><p>402</p></td>
<td class="text-align:center"><p>49</p></td>
</tr>
<tr class="row-odd"><td><p>1991</p></td>
<td class="text-align:center"><p>215</p></td>
<td class="text-align:center"><p>47</p></td>
</tr>
<tr class="row-even"><td><p>1992</p></td>
<td class="text-align:center"><p>164</p></td>
<td class="text-align:center"><p>46</p></td>
</tr>
<tr class="row-odd"><td><p>1993</p></td>
<td class="text-align:center"><p>405</p></td>
<td class="text-align:center"><p>44</p></td>
</tr>
<tr class="row-even"><td><p>1994</p></td>
<td class="text-align:center"><p>328</p></td>
<td class="text-align:center"><p>43</p></td>
</tr>
<tr class="row-odd"><td><p>1995</p></td>
<td class="text-align:center"><p>294</p></td>
<td class="text-align:center"><p>42</p></td>
</tr>
</tbody>
</table>
<p>Lassen Sie uns unsere Datenvektoren konstruieren. Wir ordnen die Abflusswerte der Variablen <code class="docutils literal notranslate"><span class="pre">Q</span></code> und die abgeholzte Fläche der Variablen <code class="docutils literal notranslate"><span class="pre">logged</span></code> zu.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Erzeuge Listen Q, logged</span>
<span class="n">q</span> <span class="o">=</span> <span class="p">[</span><span class="mi">227</span><span class="p">,</span> <span class="mi">249</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">190</span><span class="p">,</span> <span class="mi">314</span><span class="p">,</span> <span class="mi">345</span><span class="p">,</span> <span class="mi">161</span><span class="p">,</span> <span class="mi">266</span><span class="p">,</span> <span class="mi">402</span><span class="p">,</span> <span class="mi">215</span><span class="p">,</span> <span class="mi">164</span><span class="p">,</span> <span class="mi">405</span><span class="p">,</span> <span class="mi">328</span><span class="p">,</span> <span class="mi">294</span><span class="p">]</span>
<span class="n">logged</span> <span class="o">=</span> <span class="p">[</span><span class="mi">53</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">42</span><span class="p">]</span>

<span class="c1"># Erzeuge Dataframe aus Q und logged</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Q&quot;</span><span class="p">:</span> <span class="n">q</span><span class="p">,</span> <span class="s2">&quot;Logged&quot;</span><span class="p">:</span> <span class="n">logged</span><span class="p">})</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Q</th>
      <th>Logged</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>227</td>
      <td>53</td>
    </tr>
    <tr>
      <th>1</th>
      <td>249</td>
      <td>56</td>
    </tr>
    <tr>
      <th>2</th>
      <td>210</td>
      <td>57</td>
    </tr>
    <tr>
      <th>3</th>
      <td>190</td>
      <td>58</td>
    </tr>
    <tr>
      <th>4</th>
      <td>314</td>
      <td>55</td>
    </tr>
    <tr>
      <th>5</th>
      <td>345</td>
      <td>54</td>
    </tr>
    <tr>
      <th>6</th>
      <td>161</td>
      <td>51</td>
    </tr>
    <tr>
      <th>7</th>
      <td>266</td>
      <td>50</td>
    </tr>
    <tr>
      <th>8</th>
      <td>402</td>
      <td>49</td>
    </tr>
    <tr>
      <th>9</th>
      <td>215</td>
      <td>47</td>
    </tr>
    <tr>
      <th>10</th>
      <td>164</td>
      <td>46</td>
    </tr>
    <tr>
      <th>11</th>
      <td>405</td>
      <td>44</td>
    </tr>
    <tr>
      <th>12</th>
      <td>328</td>
      <td>43</td>
    </tr>
    <tr>
      <th>13</th>
      <td>294</td>
      <td>42</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Zunächst berechnen wir den Spearman’schen Rangkorrelationskoeffizienten per Hand. Erinnern Sie sich an die Gleichung</p>
<div class="math notranslate nohighlight">
\[ r_s = 1 - \frac{6 \sum_{i=1}^n (r_{xi} - r_{yi})^2}{n(n^2 -1)} \]</div>
<p>wobei <span class="math notranslate nohighlight">\(r_{xi}=Rang(x_i)\)</span> , <span class="math notranslate nohighlight">\(r_{yi}=Rang(y_i)\)</span> , und <span class="math notranslate nohighlight">\(n\)</span> der Stichprobenumfang ist. Wir verwenden die Methode <code class="docutils literal notranslate"><span class="pre">rank()</span></code>, um den Rang für die Werte jeder Variablen zu berechnen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rs</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span>
    <span class="mi">6</span>
    <span class="o">*</span> <span class="nb">sum</span><span class="p">((</span><span class="n">df</span><span class="o">.</span><span class="n">rank</span><span class="p">()[</span><span class="s2">&quot;Q&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">rank</span><span class="p">()[</span><span class="s2">&quot;Logged&quot;</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<span class="p">)</span>
<span class="n">rs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.34065934065934056
</pre></div>
</div>
</div>
</div>
<p>Alternativ können wir auch die Funktion <code class="docutils literal notranslate"><span class="pre">corr()</span></code> in Python verwenden und das Argument <code class="docutils literal notranslate"><span class="pre">method</span> <span class="pre">=</span> <span class="pre">'spearman'</span></code> hinzufügen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;spearman&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Q</th>
      <th>Logged</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Q</th>
      <td>1.000000</td>
      <td>-0.340659</td>
    </tr>
    <tr>
      <th>Logged</th>
      <td>-0.340659</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Der Rangkorrelationskoeffizient von Spearman ist nichts anderes als der lineare Korrelationskoeffizient von Pearson für die gerankten Daten. Das Ergebnis der folgenden Codezelle sollte mit den vorherigen Ergebnissen übereinstimmen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Q</th>
      <th>Logged</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Q</th>
      <td>1.000000</td>
      <td>-0.340659</td>
    </tr>
    <tr>
      <th>Logged</th>
      <td>-0.340659</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Perfekt, wir erhielten das gleiche Ergebnis durch alle drei Berechnungen, die einen Spearman’s Rangkorrelationskoeffizienten von <span class="math notranslate nohighlight">\(r_s = -0,34\)</span> ergeben. Die Ergebnisse deuten darauf hin, dass es keine bis eine schwache negative Korrelation zwischen dem Spitzenabfluss und der Einschlagsfläche gibt. Mit anderen Worten, der Abfluss nimmt tendenziell ab, wenn die Abholzungsfläche zunimmt. Die Wahrnehmung der Bevölkerung kann also durch unsere statistische Analyse nicht bestätigt werden. Es wird empfohlen, einen statistischen Test durchzuführen, um festzustellen, ob das Ergebnis statistisch signifikant ist oder ob die Abweichung nur zufällig ist. Weitere Informationen finden Sie in den Abschnitten über <em>Hypothesentests</em>.</p>
</section>
</section>
<section id="kontingenzkoeffizient">
<h3>Kontingenzkoeffizient<a class="headerlink" href="#kontingenzkoeffizient" title="Permalink to this headline">#</a></h3>
<p>Der <strong>Kontingenzkoeffizient</strong> <span class="math notranslate nohighlight">\(C\)</span> ist ein <span class="math notranslate nohighlight">\(\chi ^2\)</span>-basiertes Maß für die Assoziation von kategorialen Daten. Er stützt sich auf den <a href="https://de.wikipedia.org/wiki/Chi-Quadrat-Test"><span class="math notranslate nohighlight">\(\chi ^2\)</span>-Test auf Unabhängigkeit</a>. Die <span class="math notranslate nohighlight">\(\chi ^2\)</span> Statistik ermöglicht es zu beurteilen, ob eine statistische Beziehung zwischen den Variablen in den <a href="https://de.wikipedia.org/wiki/Kontingenztafel">Kontingenztabellen</a> (auch bekannt als Kontingenztafeln oder Kreuztabellen) besteht oder nicht. In dieser Art von Tabellen wird die Verteilung der Variablen in einem Matrixformat dargestellt.</p>
<p>Für die Berechnung des <strong>Kontingenzkoeffizienten</strong> <span class="math notranslate nohighlight">\(C\)</span>
zu berechnen, müssen wir die <span class="math notranslate nohighlight">\(\chi ^2\)</span>-Statistik im Voraus bestimmen.</p>
<section id="berechnung-der-chi-2-statistik">
<h4>Berechnung der <span class="math notranslate nohighlight">\(\chi ^2\)</span>-Statistik<a class="headerlink" href="#berechnung-der-chi-2-statistik" title="Permalink to this headline">#</a></h4>
<p>Die <span class="math notranslate nohighlight">\(\chi ^2\)</span>-Statistik ist gegeben durch
$<span class="math notranslate nohighlight">\(\chi^2= \sum{\frac{(O-E)^2}{E}}\text{,}\)</span>$</p>
<p>wobei <span class="math notranslate nohighlight">\(O\)</span> für die beobachtete Häufigkeit und <span class="math notranslate nohighlight">\(E\)</span> für die erwartete Häufigkeit steht. Bitte beachten Sie, dass <span class="math notranslate nohighlight">\(\frac{(O-E)^2}{E}\)</span> für jede Zelle ausgewertet und dann aufsummiert wird.</p>
<p>Anhand eines Beispiels soll die Berechnung der <span class="math notranslate nohighlight">\(\chi ^2\)</span>-Statistik auf der Grundlage kategorialer Beobachtungsdaten näher erläutert werden. Nehmen wir eine Prüfung am Ende des Semesters. Es gibt drei Gruppen von Studierenden: Die Studierenden haben entweder bestanden, nicht bestanden oder nicht an der Prüfung teilgenommen. Außerdem wird die Anzahl der Übungen, die jeder einzelne Studierende während des Semesters absolviert hat, in vier Gruppen eingeteilt: Keine, weniger als die Hälfte <span class="math notranslate nohighlight">\((\lt 0,5)\)</span>, mehr als die Hälfte <span class="math notranslate nohighlight">\((\ge 0,5)\)</span>, alle.</p>
<p>Die resultierende Kontingenztabelle sieht wie folgt aus:</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="text-align:center head"><p>Keine</p></th>
<th class="text-align:center head"><p><span class="math notranslate nohighlight">\(&lt;0,5\)</span></p></th>
<th class="text-align:center head"><p><span class="math notranslate nohighlight">\(\geq 0,5\)</span></p></th>
<th class="text-align:center head"><p>Alle</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>erfolgreich</p></td>
<td class="text-align:center"><p>12</p></td>
<td class="text-align:center"><p>13</p></td>
<td class="text-align:center"><p>24</p></td>
<td class="text-align:center"><p>14</p></td>
</tr>
<tr class="row-odd"><td><p>nicht erfolgreich</p></td>
<td class="text-align:center"><p>22</p></td>
<td class="text-align:center"><p>11</p></td>
<td class="text-align:center"><p>8</p></td>
<td class="text-align:center"><p>6</p></td>
</tr>
<tr class="row-even"><td><p>nicht teilgenommen</p></td>
<td class="text-align:center"><p>11</p></td>
<td class="text-align:center"><p>14</p></td>
<td class="text-align:center"><p>6</p></td>
<td class="text-align:center"><p>7</p></td>
</tr>
</tbody>
</table>
<p>Zunächst konstruieren wir ein <code class="docutils literal notranslate"><span class="pre">dataframe</span></code> Objekt und geben ihm den Namen <code class="docutils literal notranslate"><span class="pre">obs</span></code>, um uns daran zu erinnern, dass diese Daten der beobachteten Häufigkeit entsprechen:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Erzeuge neues Dataframe obs</span>
<span class="n">col1</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;erfolgreich&quot;</span><span class="p">,</span> <span class="s2">&quot;nicht erfolgreich&quot;</span><span class="p">,</span> <span class="s2">&quot;nicht teilgenommen&quot;</span><span class="p">]</span>
<span class="n">col2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span>
<span class="n">col3</span> <span class="o">=</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">14</span><span class="p">]</span>
<span class="n">col4</span> <span class="o">=</span> <span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">col5</span> <span class="o">=</span> <span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>

<span class="n">obs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;Keine&quot;</span><span class="p">:</span> <span class="n">col2</span><span class="p">,</span> <span class="s2">&quot;&lt;0.5&quot;</span><span class="p">:</span> <span class="n">col3</span><span class="p">,</span> <span class="s2">&quot;&gt;0.5&quot;</span><span class="p">:</span> <span class="n">col4</span><span class="p">,</span> <span class="s2">&quot;Alle&quot;</span><span class="p">:</span> <span class="n">col5</span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">col1</span>
<span class="p">)</span>
<span class="n">obs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Keine</th>
      <th>&lt;0.5</th>
      <th>&gt;0.5</th>
      <th>Alle</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>erfolgreich</th>
      <td>12</td>
      <td>13</td>
      <td>24</td>
      <td>14</td>
    </tr>
    <tr>
      <th>nicht erfolgreich</th>
      <td>22</td>
      <td>11</td>
      <td>8</td>
      <td>6</td>
    </tr>
    <tr>
      <th>nicht teilgenommen</th>
      <td>11</td>
      <td>14</td>
      <td>6</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Perfekt, jetzt haben wir eine ordentliche Darstellung unserer Daten in Python. Allerdings fehlt noch ein Teil, um eine Kontingenztabelle zu vervollständigen. Die Zeilensummen und Spaltensummen.</p>
<p>Es gibt mehrere Möglichkeiten, die Zeilen- und Spaltensummen in Python zu berechnen. Unter anderem kann man die Funktion <code class="docutils literal notranslate"><span class="pre">sum(df,</span> <span class="pre">axis=0,1)</span></code> verwenden. Die Funktion benötigt zwei Argumente, die Daten und eine Zahl, die angibt, ob die Daten zeilen- oder spaltenweise vorliegen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne Zeilen/Spaltensumme</span>
<span class="n">columnsum</span> <span class="o">=</span> <span class="n">obs</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="n">rowsum</span> <span class="o">=</span> <span class="n">obs</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Spaltensummen: </span><span class="si">{</span><span class="n">columnsum</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Zeilensummen:  </span><span class="si">{</span><span class="n">rowsum</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Spaltensummen: [45 38 38 27]
Zeilensummen:  [63 47 38]
</pre></div>
</div>
</div>
</div>
<p>Setzt man alle Teile zusammen, sieht die Kontingenztabelle wie folgt aus:</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="text-align:center head"><p>Keine</p></th>
<th class="text-align:center head"><p><span class="math notranslate nohighlight">\(&lt;0,5\)</span></p></th>
<th class="text-align:center head"><p><span class="math notranslate nohighlight">\(\geq 0,5\)</span></p></th>
<th class="text-align:center head"><p>Alle</p></th>
<th class="text-align:center head"><p>Zeilensumme</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>erfolgreich</p></td>
<td class="text-align:center"><p>12</p></td>
<td class="text-align:center"><p>13</p></td>
<td class="text-align:center"><p>24</p></td>
<td class="text-align:center"><p>14</p></td>
<td class="text-align:center"><p>63</p></td>
</tr>
<tr class="row-odd"><td><p>nicht erfolgreich</p></td>
<td class="text-align:center"><p>22</p></td>
<td class="text-align:center"><p>11</p></td>
<td class="text-align:center"><p>8</p></td>
<td class="text-align:center"><p>6</p></td>
<td class="text-align:center"><p>47</p></td>
</tr>
<tr class="row-even"><td><p>nicht teilgenommen</p></td>
<td class="text-align:center"><p>11</p></td>
<td class="text-align:center"><p>14</p></td>
<td class="text-align:center"><p>6</p></td>
<td class="text-align:center"><p>7</p></td>
<td class="text-align:center"><p>38</p></td>
</tr>
<tr class="row-odd"><td><p>Spaltensumme</p></td>
<td class="text-align:center"><p>45</p></td>
<td class="text-align:center"><p>38</p></td>
<td class="text-align:center"><p>38</p></td>
<td class="text-align:center"><p>27</p></td>
<td class="text-align:center"><p></p></td>
</tr>
</tbody>
</table>
<p>Toll, jetzt haben wir eine Tabelle mit den beobachteten Häufigkeiten. Im nächsten Schritt berechnen wir die erwarteten Häufigkeiten. Um die erwarteten Häufigkeiten <span class="math notranslate nohighlight">\((E)\)</span> zu berechnen, wenden wir diese Gleichung an:</p>
<div class="math notranslate nohighlight">
\[E = \frac{R\times C}{n} \text{,}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(R\)</span> die Zeilensumme, <span class="math notranslate nohighlight">\(C\)</span> die Spaltensumme und <span class="math notranslate nohighlight">\(n\)</span> der Stichprobenumfang ist. Bitte beachten Sie, dass wir die erwartete Häufigkeit für jeden einzelnen Tabelleneintrag berechnen müssen, d. h. wir müssen <span class="math notranslate nohighlight">\(3 \times 4=12\)</span> Berechnungen durchführen. Auch hier bietet Python mehrere Möglichkeiten, diese Aufgabe zu lösen. Man kann eine verschachtelte for-Schleife bauen, um jede Zelle zu durchlaufen und die Berechnungen schrittweise durchzuführen, das ist definitiv in Ordnung! Wir können aber auch die vektorisierte und damit viel schnellere Funktion <code class="docutils literal notranslate"><span class="pre">outer()</span></code> in Kombination mit der Funktion <code class="docutils literal notranslate"><span class="pre">sum()</span></code> verwenden. Wir weisen das Ergebnis einer Variablen mit der Bezeichnung <code class="docutils literal notranslate"><span class="pre">exp</span></code> zu, um uns daran zu erinnern, dass diese Tabelle den erwarteten Häufigkeiten entspricht.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">columnsum</span><span class="p">,</span> <span class="n">rowsum</span><span class="p">)</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">columnsum</span><span class="p">)</span>
<span class="n">exp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[19.15540541, 14.29054054, 11.55405405],
       [16.17567568, 12.06756757,  9.75675676],
       [16.17567568, 12.06756757,  9.75675676],
       [11.49324324,  8.57432432,  6.93243243]])
</pre></div>
</div>
</div>
</div>
<p>Im nächsten Schritt erstellen wir aus den Ergebnissen einen Dataframe der dieselbe Spalten- und Zeilenanzahl, denseben Index und dieslelben Spaltennamen hat wie der <code class="docutils literal notranslate"><span class="pre">obs</span></code> Dataframe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">exp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">exp</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">obs</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">obs</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">exp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Keine</th>
      <th>&lt;0.5</th>
      <th>&gt;0.5</th>
      <th>Alle</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>erfolgreich</th>
      <td>19.155405</td>
      <td>16.175676</td>
      <td>16.175676</td>
      <td>11.493243</td>
    </tr>
    <tr>
      <th>nicht erfolgreich</th>
      <td>14.290541</td>
      <td>12.067568</td>
      <td>12.067568</td>
      <td>8.574324</td>
    </tr>
    <tr>
      <th>nicht teilgenommen</th>
      <td>11.554054</td>
      <td>9.756757</td>
      <td>9.756757</td>
      <td>6.932432</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Im nächsten Schritt berechnen wir schließlich die <span class="math notranslate nohighlight">\(\chi ^2\)</span>-Statistik. Erinnern Sie sich an die Gleichung:</p>
<div class="math notranslate nohighlight">
\[\chi^2= \sum{\frac{(O-E)^2}{E}}\text{,}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(O\)</span> für die beobachtete Häufigkeit und <span class="math notranslate nohighlight">\(E\)</span> für die erwartete Häufigkeit steht.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne chisqVal</span>
<span class="n">chisqVal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(((</span><span class="n">obs</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">exp</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">exp</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">chisqVal</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>17.344387665138406
</pre></div>
</div>
</div>
</div>
</section>
<section id="berechnung-des-kontingenzkoeffizienten-c">
<h4>Berechnung des Kontingenzkoeffizienten <span class="math notranslate nohighlight">\(C\)</span><a class="headerlink" href="#berechnung-des-kontingenzkoeffizienten-c" title="Permalink to this headline">#</a></h4>
<p>Der Kontingenzkoeffizient, bezeichnet als <span class="math notranslate nohighlight">\(C^∗\)</span>, passt die <span class="math notranslate nohighlight">\(\chi ^2\)</span>-Statistik um den Stichprobenumfang <span class="math notranslate nohighlight">\((n)\)</span> an. Er kann wie folgt geschrieben werden</p>
<div class="math notranslate nohighlight">
\[ C^*=\sqrt{\frac{\chi^2}{n+\chi^2}}\text{,} \]</div>
<p>wobei <span class="math notranslate nohighlight">\(\chi ^2\)</span> der <span class="math notranslate nohighlight">\(\chi ^2\)</span>-Statistik entspricht und <span class="math notranslate nohighlight">\(n\)</span> die Anzahl der Beobachtungen bezeichnet. Wenn keine Beziehung zwischen zwei Variablen besteht, ist <span class="math notranslate nohighlight">\(C^∗=0\)</span>. Der Kontingenzkoeffizient <span class="math notranslate nohighlight">\(C^∗\)</span> kann Werte <span class="math notranslate nohighlight">\(\gt 1\)</span> nicht überschreiten, aber der Kontingenzkoeffizient kann kleiner als <span class="math notranslate nohighlight">\(1\)</span> sein, selbst wenn zwei Variablen perfekt miteinander verbunden sind. Dies ist nicht so wünschenswert, daher wird <span class="math notranslate nohighlight">\(C^∗\)</span> so angepasst, dass er maximal <span class="math notranslate nohighlight">\(1\)</span> erreicht, wenn in einer Tabelle mit einer beliebigen Anzahl von Zeilen und Spalten ein vollständiger Zusammenhang besteht. Daher berechnen wir <span class="math notranslate nohighlight">\(C^{∗}_{max}\)</span>, das ist</p>
<div class="math notranslate nohighlight">
\[ C^*_{max}=\sqrt{\frac{k-1}{k}}\text{,} \]</div>
<p>wobei <span class="math notranslate nohighlight">\(k\)</span> die Anzahl der Zeilen oder die Anzahl der Spalten ist, je nachdem, welcher Wert kleiner ist, <span class="math notranslate nohighlight">\(k=min(\text{Zeilen,Spalten})\)</span>. Dann wird der bereinigte Kontingenzkoeffizient wie folgt berechnet</p>
<div class="math notranslate nohighlight">
\[ C=\frac{C^*}{C^*_{max}}=\sqrt\frac{k \cdot \chi^2}{(k-1)(n+\chi^2)} \]</div>
<p>Im obigen Abschnitt wurde die <span class="math notranslate nohighlight">\(\chi ^2\)</span>-Statistik der Variablen <code class="docutils literal notranslate"><span class="pre">chisqVal</span></code> zugeordnet und als <span class="math notranslate nohighlight">\(17,3443877\)</span> berechnet. Nun setzen wir diesen Wert in die Gleichung für den Kontingenzkoeffizienten <span class="math notranslate nohighlight">\(C^∗\)</span> ein.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">C_star</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">chisqVal</span> <span class="o">/</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">columnsum</span><span class="p">)</span> <span class="o">+</span> <span class="n">chisqVal</span><span class="p">))</span>
<span class="n">C_star</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3238804670641156
</pre></div>
</div>
</div>
</div>
<p>Der Kontingenzkoeffizient <span class="math notranslate nohighlight">\(C^∗\)</span> beläuft sich auf <span class="math notranslate nohighlight">\(0,3238805\)</span>.</p>
<p>Nun wenden wir die Gleichung für den bereinigten Kontingenzkoeffizienten, <span class="math notranslate nohighlight">\(C\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="p">[</span><span class="n">obs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">obs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">k</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="n">k</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">C_star_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">k</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">C_star</span> <span class="o">/</span> <span class="n">C_star_max</span>
<span class="n">C</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.39667094098068806
</pre></div>
</div>
</div>
</div>
<p>Der bereinigte Kontingenzkoeffizient <span class="math notranslate nohighlight">\(C\)</span> wird mit <span class="math notranslate nohighlight">\(0,3966709\)</span> bewertet. Zur Erinnerung: Der Kontingenzkoeffizient reicht von <span class="math notranslate nohighlight">\(0\)</span> bis <span class="math notranslate nohighlight">\(1\)</span>. Ein Kontingenzkoeffizient von <span class="math notranslate nohighlight">\(0,4\)</span> deutet nicht auf einen starken Zusammenhang zwischen den Prüfungsergebnissen und der Bereitschaft der Studierenden hin, die Übungen während des Semesters zu bearbeiten.</p>
</section>
</section>
</section>
<span id="document-Aufgaben/Kapitel01/Aufgaben"></span><section class="tex2jax_ignore mathjax_ignore" id="ubungsaufgaben">
<h2>Übungsaufgaben<a class="headerlink" href="#ubungsaufgaben" title="Permalink to this headline">#</a></h2>
<div class="toctree-wrapper compound">
<span id="document-Aufgaben/Kapitel01/pandas"></span><section class="tex2jax_ignore mathjax_ignore" id="die-pandas-bibliothek">
<h3>Die Pandas Bibliothek<a class="headerlink" href="#die-pandas-bibliothek" title="Permalink to this headline">#</a></h3>
<p>Die <a href="https://pandas.pydata.org//">Pandas-Bibliothek</a> wurde 2010 von <a href="https://wesmckinney.com/">Wes McKinney</a> entwickelt. pandas bietet <strong>Datenstrukturen</strong> und <strong>Funktionen</strong> für die Manipulation, Verarbeitung, Bereinigung und Verwertung von Daten. Im Python-Ökosystem ist pandas das modernste Werkzeug für die Arbeit mit tabellarischen oder tabellenähnlichen Daten, bei denen jede Spalte von einem anderen Typ sein kann (<code class="docutils literal notranslate"><span class="pre">String</span></code>, <code class="docutils literal notranslate"><span class="pre">numerisch</span></code>, <code class="docutils literal notranslate"><span class="pre">Datum</span></code> oder andere). pandas bietet ausgefeilte Indizierungsfunktionen, die das Umformen, Zerlegen, Aggregieren und Auswählen von Teilmengen von Daten erleichtern. pandas stützt sich auf andere Pakete, wie <a href="https://numpy.org/">NumPy</a> und <a href="https://scipy.org/">SciPy</a>. Außerdem integriert pandas <a href="https://matplotlib.org/">matplotlib</a> zum Plotten.</p>
<p>Wenn Sie neu im Umgang mit pandas sind, empfehlen wir Ihnen dringend, die sehr gut geschriebenen <a href="https://pandas.pydata.org/pandas-docs/stable/getting_started/tutorials.html">pandas-Tutorials</a> zu besuchen, die alle relevanten Abschnitte für neue Benutzer abdecken, um richtig loszulegen.</p>
<p>Nach der Installation (Details finden Sie in der <a href="https://pandas.pydata.org/pandas-docs/stable/getting_started/install.html">Dokumentation</a>) wird pandas mit dem kanonischen Alias <code class="docutils literal notranslate"><span class="pre">pd</span></code> importiert.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<p>Die Pandas-Bibliothek verfügt über zwei bewährte Datenstrukturen: <strong>Series</strong> und <strong>DataFrame</strong>.</p>
<ul class="simple">
<li><p>eindimensionales pd.Series-Objekt</p></li>
<li><p>zweidimensionales pd.DataFrame-Objekt</p></li>
</ul>
<section id="das-pd-series-objekt">
<h4>Das <code class="docutils literal notranslate"><span class="pre">pd.Series</span></code> Objekt<a class="headerlink" href="#das-pd-series-objekt" title="Permalink to this headline">#</a></h4>
<p>Erzeugung von Daten</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># importiere das random module von numpy</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">random</span>

<span class="c1"># setze seed</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="c1"># Erzeuge 26 Zufallszahlen zwischen -10 and 10</span>
<span class="n">my_data</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>
<span class="c1"># Ausgabe</span>
<span class="n">my_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([  3,  -8,  -8,  -4,   7,   9,   0,  -9, -10,   7,   5,  -1, -10,
         4, -10,   5,   9,   4,  -6, -10,   6,  -6,   7,  -7,  -8,  -3])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">my_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>numpy.ndarray
</pre></div>
</div>
</div>
</div>
<p>Eine Series ist ein eindimensionales Array-ähnliches Objekt, das ein Array mit Daten und ein zugehöriges Array mit Datenbeschriftungen, genannt Index, enthält. Wir erstellen ein <code class="docutils literal notranslate"><span class="pre">pd.Series-Objekt</span></code>, indem wir die Funktion <code class="docutils literal notranslate"><span class="pre">pd.Series()</span></code> aufrufen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Entkommentieren für Dokumentation</span>

<span class="c1"># docstring</span>
<span class="c1"># ?pd.Series</span>

<span class="c1"># source</span>
<span class="c1"># ??pd.Series</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Erzeuge pd.Series Objekt</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">my_data</span><span class="p">)</span>
<span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0      3
1     -8
2     -8
3     -4
4      7
5      9
6      0
7     -9
8    -10
9      7
10     5
11    -1
12   -10
13     4
14   -10
15     5
16     9
17     4
18    -6
19   -10
20     6
21    -6
22     7
23    -7
24    -8
25    -3
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pandas.core.series.Series
</pre></div>
</div>
</div>
</div>
<section id="pd-series-attribute">
<h5><code class="docutils literal notranslate"><span class="pre">pd.Series</span></code>-Attribute<a class="headerlink" href="#pd-series-attribute" title="Permalink to this headline">#</a></h5>
<p>Python-Objekte im Allgemeinen und die <code class="docutils literal notranslate"><span class="pre">pd.Series</span></code> im Besonderen bieten nützliche objektspezifische Attribute.</p>
<p><em>Attribut</em> -&gt;<code class="docutils literal notranslate"><span class="pre">OBJECT.attribute</span></code></p>
<p><em>Beachten Sie, dass das Attribut ohne Klammern aufgerufen wird</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dtype(&#39;int64&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RangeIndex(start=0, stop=26, step=1)
</pre></div>
</div>
</div>
</div>
<p>Wir können das Attribut <code class="docutils literal notranslate"><span class="pre">index</span></code> verwenden, um einem <code class="docutils literal notranslate"><span class="pre">pd.Series-Objekt</span></code> einen Index zuzuweisen.</p>
<p>Betrachten wir die Buchstaben des Alphabets….</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">string</span>

<span class="n">letters</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span>
<span class="n">letters</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">letters</span><span class="p">)</span>
<span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A     3
B    -8
C    -8
D    -4
E     7
F     9
G     0
H    -9
I   -10
J     7
K     5
L    -1
M   -10
N     4
O   -10
P     5
Q     9
R     4
S    -6
T   -10
U     6
V    -6
W     7
X    -7
Y    -8
Z    -3
dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="pd-series-methoden">
<h5><code class="docutils literal notranslate"><span class="pre">pd.Series</span></code>-Methoden<a class="headerlink" href="#pd-series-methoden" title="Permalink to this headline">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-34
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.3076923076923077
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-10
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-2.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-2.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.25   -8.0
0.50   -2.0
0.75    5.0
dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="elementweise-arithmetik">
<h5>Elementweise Arithmetik<a class="headerlink" href="#elementweise-arithmetik" title="Permalink to this headline">#</a></h5>
<p>Eine sehr nützliche Eigenschaft von <code class="docutils literal notranslate"><span class="pre">pd.Series</span></code>-Objekten ist, dass wir arithmetische Operationen <em>elementweise</em> anwenden können.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">+</span> <span class="mi">10</span>
<span class="c1"># s*0.1</span>
<span class="c1"># 10/s</span>
<span class="c1"># s**2</span>
<span class="c1"># (2+s)*1**3</span>
<span class="c1"># s+s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A    13
B     2
C     2
D     6
E    17
F    19
G    10
H     1
I     0
J    17
K    15
L     9
M     0
N    14
O     0
P    15
Q    19
R    14
S     4
T     0
U    16
V     4
W    17
X     3
Y     2
Z     7
dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="auswahl-und-indizierung">
<h5>Auswahl und Indizierung<a class="headerlink" href="#auswahl-und-indizierung" title="Permalink to this headline">#</a></h5>
<p>Eine weitere wichtige Datenoperation ist die Indizierung und Auswahl bestimmter Teilmengen des Datenobjekts. pandas verfügt über einen <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html">sehr umfangreichen Satz</a> von Methoden für diese Art von Aufgaben.</p>
<p>In der einfachsten Form indizieren wir eine Reihe numpy-ähnlich, indem wir den <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">]</span></code> Operator verwenden, um einen bestimmten <code class="docutils literal notranslate"><span class="pre">Index</span></code> der Reihe auszuwählen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A     3
B    -8
C    -8
D    -4
E     7
F     9
G     0
H    -9
I   -10
J     7
K     5
L    -1
M   -10
N     4
O   -10
P     5
Q     9
R     4
S    -6
T   -10
U     6
V    -6
W     7
X    -7
Y    -8
Z    -3
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-4
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C   -8
D   -4
E    7
F    9
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-8
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">:</span><span class="s2">&quot;K&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C    -8
D    -4
E     7
F     9
G     0
H    -9
I   -10
J     7
K     5
dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="das-pd-dataframe-objekt">
<h4>Das <code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code>-Objekt<a class="headerlink" href="#das-pd-dataframe-objekt" title="Permalink to this headline">#</a></h4>
<p>Die primäre Datenstruktur von Pandas ist der <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>. Es handelt sich um eine zweidimensionale, größenveränderliche, potenziell heterogene tabellarische Datenstruktur mit Zeilen- und Spaltenbeschriftungen. Arithmetische Operationen richten sich sowohl auf Zeilen- als auch auf Spaltenbeschriftungen aus. Grundsätzlich kann man sich den <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> als einen <code class="docutils literal notranslate"><span class="pre">dictionary</span></code>-artigen Container für Seriesobjekte vorstellen.</p>
<p><strong>Erzeugen eines <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>-Objekts von Grund auf</strong></p>
<p>pandas erleichtert den Import verschiedener Datentypen und -quellen, aber für dieses Tutorial erzeugen wir ein DataFrame-Objekt von Grund auf.</p>
<p>Quelle: <a class="reference external" href="http://duelingdata.blogspot.de/2016/01/the-beatles.html">http://duelingdata.blogspot.de/2016/01/the-beatles.html</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
        <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;John&quot;</span><span class="p">,</span> <span class="s2">&quot;Paul&quot;</span><span class="p">,</span> <span class="s2">&quot;George&quot;</span><span class="p">,</span> <span class="s2">&quot;Ringo&quot;</span><span class="p">],</span>
        <span class="s2">&quot;Last Name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Lennon&quot;</span><span class="p">,</span> <span class="s2">&quot;McCartney&quot;</span><span class="p">,</span> <span class="s2">&quot;Harrison&quot;</span><span class="p">,</span> <span class="s2">&quot;Star&quot;</span><span class="p">],</span>
        <span class="s2">&quot;dead&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
        <span class="s2">&quot;year_born&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1940</span><span class="p">,</span> <span class="mi">1942</span><span class="p">,</span> <span class="mi">1943</span><span class="p">,</span> <span class="mi">1940</span><span class="p">],</span>
        <span class="s2">&quot;no_of_songs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">62</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>Name</th>
      <th>Last Name</th>
      <th>dead</th>
      <th>year_born</th>
      <th>no_of_songs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>John</td>
      <td>Lennon</td>
      <td>True</td>
      <td>1940</td>
      <td>62</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Paul</td>
      <td>McCartney</td>
      <td>False</td>
      <td>1942</td>
      <td>58</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>George</td>
      <td>Harrison</td>
      <td>True</td>
      <td>1943</td>
      <td>24</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Ringo</td>
      <td>Star</td>
      <td>False</td>
      <td>1940</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="pd-dataframe-attribute">
<h5><code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code>-Attribute<a class="headerlink" href="#pd-dataframe-attribute" title="Permalink to this headline">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>id              int64
Name           object
Last Name      object
dead             bool
year_born       int64
no_of_songs     int64
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Achse 0</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;id&#39;, &#39;Name&#39;, &#39;Last Name&#39;, &#39;dead&#39;, &#39;year_born&#39;, &#39;no_of_songs&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Achse 1</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RangeIndex(start=0, stop=4, step=1)
</pre></div>
</div>
</div>
</div>
</section>
<section id="pd-dataframe-methoden">
<h5><code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code>-Methoden<a class="headerlink" href="#pd-dataframe-methoden" title="Permalink to this headline">#</a></h5>
<p><strong>Verschaffen Sie sich einen schnellen Überblick über den Datensatz</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 4 entries, 0 to 3
Data columns (total 6 columns):
 #   Column       Non-Null Count  Dtype 
---  ------       --------------  ----- 
 0   id           4 non-null      int64 
 1   Name         4 non-null      object
 2   Last Name    4 non-null      object
 3   dead         4 non-null      bool  
 4   year_born    4 non-null      int64 
 5   no_of_songs  4 non-null      int64 
dtypes: bool(1), int64(3), object(2)
memory usage: 292.0+ bytes
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>year_born</th>
      <th>no_of_songs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>4.000000</td>
      <td>4.00</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2.500000</td>
      <td>1941.25</td>
      <td>36.750000</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.290994</td>
      <td>1.50</td>
      <td>28.229712</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>1940.00</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.750000</td>
      <td>1940.00</td>
      <td>18.750000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2.500000</td>
      <td>1941.00</td>
      <td>41.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>3.250000</td>
      <td>1942.25</td>
      <td>59.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>4.000000</td>
      <td>1943.00</td>
      <td>62.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>Name</th>
      <th>Last Name</th>
      <th>dead</th>
      <th>year_born</th>
      <th>no_of_songs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>4.000000</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4.00</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>NaN</td>
      <td>4</td>
      <td>4</td>
      <td>2</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>top</th>
      <td>NaN</td>
      <td>John</td>
      <td>Lennon</td>
      <td>True</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>NaN</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2.500000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1941.25</td>
      <td>36.750000</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.290994</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.50</td>
      <td>28.229712</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1940.00</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.750000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1940.00</td>
      <td>18.750000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2.500000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1941.00</td>
      <td>41.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>3.250000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1942.25</td>
      <td>59.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>4.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1943.00</td>
      <td>62.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Index in die Variable <code class="docutils literal notranslate"><span class="pre">id</span></code> ändern</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>Name</th>
      <th>Last Name</th>
      <th>dead</th>
      <th>year_born</th>
      <th>no_of_songs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>John</td>
      <td>Lennon</td>
      <td>True</td>
      <td>1940</td>
      <td>62</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Paul</td>
      <td>McCartney</td>
      <td>False</td>
      <td>1942</td>
      <td>58</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>George</td>
      <td>Harrison</td>
      <td>True</td>
      <td>1943</td>
      <td>24</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Ringo</td>
      <td>Star</td>
      <td>False</td>
      <td>1940</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Last Name</th>
      <th>dead</th>
      <th>year_born</th>
      <th>no_of_songs</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>John</td>
      <td>Lennon</td>
      <td>True</td>
      <td>1940</td>
      <td>62</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Paul</td>
      <td>McCartney</td>
      <td>False</td>
      <td>1942</td>
      <td>58</td>
    </tr>
    <tr>
      <th>3</th>
      <td>George</td>
      <td>Harrison</td>
      <td>True</td>
      <td>1943</td>
      <td>24</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ringo</td>
      <td>Star</td>
      <td>False</td>
      <td>1940</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>Name</th>
      <th>Last Name</th>
      <th>dead</th>
      <th>year_born</th>
      <th>no_of_songs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>John</td>
      <td>Lennon</td>
      <td>True</td>
      <td>1940</td>
      <td>62</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Paul</td>
      <td>McCartney</td>
      <td>False</td>
      <td>1942</td>
      <td>58</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>George</td>
      <td>Harrison</td>
      <td>True</td>
      <td>1943</td>
      <td>24</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Ringo</td>
      <td>Star</td>
      <td>False</td>
      <td>1940</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Beachten Sie, dass sich nichts geändert hat!!</p>
<p>Aus Gründen der Speicher- und Berechnungseffizienz gibt <code class="docutils literal notranslate"><span class="pre">Pandas</span></code> eine Ansicht des Objekts zurück, keine Kopie. Wenn wir also eine dauerhafte Änderung vornehmen wollen, müssen wir das Objekt einer Variablen zuweisen/neu zuordnen:</p>
<p><code class="docutils literal notranslate"><span class="pre">df</span> <span class="pre">=</span> <span class="pre">df.set_index(&quot;id&quot;)</span> </code></p>
<p>oder einige Methoden haben das Argument <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>:</p>
<p><code class="docutils literal notranslate"><span class="pre">df.set_index(&quot;id&quot;,</span> <span class="pre">inplace=True)</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Last Name</th>
      <th>dead</th>
      <th>year_born</th>
      <th>no_of_songs</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>John</td>
      <td>Lennon</td>
      <td>True</td>
      <td>1940</td>
      <td>62</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Paul</td>
      <td>McCartney</td>
      <td>False</td>
      <td>1942</td>
      <td>58</td>
    </tr>
    <tr>
      <th>3</th>
      <td>George</td>
      <td>Harrison</td>
      <td>True</td>
      <td>1943</td>
      <td>24</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ringo</td>
      <td>Star</td>
      <td>False</td>
      <td>1940</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Arithmetische Methoden</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Last Name</th>
      <th>dead</th>
      <th>year_born</th>
      <th>no_of_songs</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>John</td>
      <td>Lennon</td>
      <td>True</td>
      <td>1940</td>
      <td>62</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Paul</td>
      <td>McCartney</td>
      <td>False</td>
      <td>1942</td>
      <td>58</td>
    </tr>
    <tr>
      <th>3</th>
      <td>George</td>
      <td>Harrison</td>
      <td>True</td>
      <td>1943</td>
      <td>24</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ringo</td>
      <td>Star</td>
      <td>False</td>
      <td>1940</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Name                   JohnPaulGeorgeRingo
Last Name      LennonMcCartneyHarrisonStar
dead                                     2
year_born                             7765
no_of_songs                            147
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_37323/1459321664.py:1: FutureWarning: Dropping of nuisance columns in DataFrame reductions (with &#39;numeric_only=None&#39;) is deprecated; in a future version this will raise TypeError.  Select only valid columns before calling the reduction.
  df.sum(axis=1)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>id
1    2003.0
2    2000.0
3    1968.0
4    1943.0
dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="groupby-methode">
<h5><code class="docutils literal notranslate"><span class="pre">Groupby</span></code>-Methode<a class="headerlink" href="#groupby-methode" title="Permalink to this headline">#</a></h5>
<p><a href="https://www.jstatsoft.org/article/view/v040i01">Hadley Wickham 2011: The Split-Apply-Combine Strategy for Data Analysis, Journal of Statistical Software, 40(1)</a></p>
<p><img alt="Alt-Text" src="_images/split-apply-combine.svg" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Last Name</th>
      <th>dead</th>
      <th>year_born</th>
      <th>no_of_songs</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>John</td>
      <td>Lennon</td>
      <td>True</td>
      <td>1940</td>
      <td>62</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Paul</td>
      <td>McCartney</td>
      <td>False</td>
      <td>1942</td>
      <td>58</td>
    </tr>
    <tr>
      <th>3</th>
      <td>George</td>
      <td>Harrison</td>
      <td>True</td>
      <td>1943</td>
      <td>24</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ringo</td>
      <td>Star</td>
      <td>False</td>
      <td>1940</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;dead&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x7fbbfefdb640&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;dead&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year_born</th>
      <th>no_of_songs</th>
    </tr>
    <tr>
      <th>dead</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>False</th>
      <td>3882</td>
      <td>61</td>
    </tr>
    <tr>
      <th>True</th>
      <td>3883</td>
      <td>86</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;dead&quot;</span><span class="p">)[</span><span class="s2">&quot;no_of_songs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dead
False    61
True     86
Name: no_of_songs, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;dead&quot;</span><span class="p">)[</span><span class="s2">&quot;no_of_songs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dead
False    30.5
True     43.0
Name: no_of_songs, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;dead&quot;</span><span class="p">)[</span><span class="s2">&quot;no_of_songs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;sum&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>max</th>
      <th>min</th>
      <th>sum</th>
    </tr>
    <tr>
      <th>dead</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>False</th>
      <td>30.5</td>
      <td>58</td>
      <td>3</td>
      <td>61</td>
    </tr>
    <tr>
      <th>True</th>
      <td>43.0</td>
      <td>62</td>
      <td>24</td>
      <td>86</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="familie-von-apply-map-methoden">
<h5>Familie von <code class="docutils literal notranslate"><span class="pre">apply/map</span></code>-Methoden<a class="headerlink" href="#familie-von-apply-map-methoden" title="Permalink to this headline">#</a></h5>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">apply</span></code> arbeitet zeilenweise (<code class="docutils literal notranslate"><span class="pre">axis=0</span></code>, Standard) / spaltenweise (<code class="docutils literal notranslate"><span class="pre">axis=1</span></code>) auf einem <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">applymap</span></code> arbeitet elementweise auf einem <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">map</span></code> arbeitet elementweise mit einer <code class="docutils literal notranslate"><span class="pre">Series</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Last Name</th>
      <th>dead</th>
      <th>year_born</th>
      <th>no_of_songs</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>John</td>
      <td>Lennon</td>
      <td>True</td>
      <td>1940</td>
      <td>62</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Paul</td>
      <td>McCartney</td>
      <td>False</td>
      <td>1942</td>
      <td>58</td>
    </tr>
    <tr>
      <th>3</th>
      <td>George</td>
      <td>Harrison</td>
      <td>True</td>
      <td>1943</td>
      <td>24</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ringo</td>
      <td>Star</td>
      <td>False</td>
      <td>1940</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># (axis=0, default)</span>
<span class="n">df</span><span class="p">[[</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Last Name&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Name                 JohnPaulGeorgeRingo
Last Name    LennonMcCartneyHarrisonStar
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># (axis=1)</span>
<span class="n">df</span><span class="p">[[</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Last Name&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>id
1        JohnLennon
2     PaulMcCartney
3    GeorgeHarrison
4         RingoStar
dtype: object
</pre></div>
</div>
</div>
</div>
<p><em>… vielleicht ein nützlicherer Fall …</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="p">[[</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Last Name&quot;</span><span class="p">]]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>id
1        John Lennon
2     Paul McCartney
3    George Harrison
4         Ringo Star
dtype: object
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id1">
<h4>Auswahl und Indizierung<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h4>
<p><strong>Spaltenindex</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>id
1      John
2      Paul
3    George
4     Ringo
Name: Name, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Last Name&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Last Name</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>John</td>
      <td>Lennon</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Paul</td>
      <td>McCartney</td>
    </tr>
    <tr>
      <th>3</th>
      <td>George</td>
      <td>Harrison</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ringo</td>
      <td>Star</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dead</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>id
1     True
2    False
3     True
4    False
Name: dead, dtype: bool
</pre></div>
</div>
</div>
</div>
<p><strong>Zeilenindex</strong></p>
<p>Neben dem <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">]</span></code>-Operator verfügt Pandas über weitere Indizierungsoperatoren wie <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code> und <code class="docutils literal notranslate"><span class="pre">.iloc[]</span></code>, um nur einige zu nennen.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.loc[]</span></code> basiert hauptsächlich auf <strong>Bezeichnungen</strong>, kann aber auch mit einem booleschen Array verwendet werden.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.iloc[]</span></code> basiert in erster Linie auf <strong>Ganzzahlpositionen</strong> (von <span class="math notranslate nohighlight">\(0\)</span> bis Länge <span class="math notranslate nohighlight">\(-1\)</span> der Achse), kann aber auch mit einem booleschen Array verwendet werden.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Last Name</th>
      <th>dead</th>
      <th>year_born</th>
      <th>no_of_songs</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>John</td>
      <td>Lennon</td>
      <td>True</td>
      <td>1940</td>
      <td>62</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Paul</td>
      <td>McCartney</td>
      <td>False</td>
      <td>1942</td>
      <td>58</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Name             John
Last Name      Lennon
dead             True
year_born        1940
no_of_songs        62
Name: 1, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Name                Paul
Last Name      McCartney
dead               False
year_born           1942
no_of_songs           58
Name: 2, dtype: object
</pre></div>
</div>
</div>
</div>
<p><strong>Zeilen- und Spaltenindizes</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">df.loc[row,</span> <span class="pre">col]</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Last Name&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Lennon&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;dead&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>dead</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>Paul</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>George</td>
      <td>True</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ringo</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>logisches Indizieren</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Last Name</th>
      <th>dead</th>
      <th>year_born</th>
      <th>no_of_songs</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>John</td>
      <td>Lennon</td>
      <td>True</td>
      <td>1940</td>
      <td>62</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Paul</td>
      <td>McCartney</td>
      <td>False</td>
      <td>1942</td>
      <td>58</td>
    </tr>
    <tr>
      <th>3</th>
      <td>George</td>
      <td>Harrison</td>
      <td>True</td>
      <td>1943</td>
      <td>24</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ringo</td>
      <td>Star</td>
      <td>False</td>
      <td>1940</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;no_of_songs&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">50</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>id
1     True
2     True
3    False
4    False
Name: no_of_songs, dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;no_of_songs&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Last Name</th>
      <th>dead</th>
      <th>year_born</th>
      <th>no_of_songs</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>John</td>
      <td>Lennon</td>
      <td>True</td>
      <td>1940</td>
      <td>62</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Paul</td>
      <td>McCartney</td>
      <td>False</td>
      <td>1942</td>
      <td>58</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;no_of_songs&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;year_born&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">1942</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Last Name</th>
      <th>dead</th>
      <th>year_born</th>
      <th>no_of_songs</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>Paul</td>
      <td>McCartney</td>
      <td>False</td>
      <td>1942</td>
      <td>58</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;no_of_songs&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;year_born&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">1942</span><span class="p">),</span> <span class="p">[</span><span class="s2">&quot;Last Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Name&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Last Name</th>
      <th>Name</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>McCartney</td>
      <td>Paul</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="manipulation-von-spalten-zeilen-und-bestimmten-eintragen">
<h4>Manipulation von Spalten, Zeilen und bestimmten Einträgen<a class="headerlink" href="#manipulation-von-spalten-zeilen-und-bestimmten-eintragen" title="Permalink to this headline">#</a></h4>
<p><strong>Hinzufügen einer Zeile zum Datensatz</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">nan</span>

<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Mickey&quot;</span><span class="p">,</span> <span class="s2">&quot;Mouse&quot;</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="mi">1928</span><span class="p">,</span> <span class="n">nan</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_37323/1527406442.py:3: FutureWarning: Behavior when concatenating bool-dtype and numeric-dtype arrays is deprecated; in a future version these will cast to object dtype (instead of coercing bools to numeric values). To retain the old behavior, explicitly cast bool-dtype arrays to numeric dtype.
  df.loc[5] = [&quot;Mickey&quot;, &quot;Mouse&quot;, nan, 1928, nan]
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Last Name</th>
      <th>dead</th>
      <th>year_born</th>
      <th>no_of_songs</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>John</td>
      <td>Lennon</td>
      <td>1.0</td>
      <td>1940</td>
      <td>62.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Paul</td>
      <td>McCartney</td>
      <td>0.0</td>
      <td>1942</td>
      <td>58.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>George</td>
      <td>Harrison</td>
      <td>1.0</td>
      <td>1943</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ringo</td>
      <td>Star</td>
      <td>0.0</td>
      <td>1940</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Mickey</td>
      <td>Mouse</td>
      <td>NaN</td>
      <td>1928</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Name            object
Last Name       object
dead           float64
year_born        int64
no_of_songs    float64
dtype: object
</pre></div>
</div>
</div>
</div>
<p>Beachten Sie, dass sich die Variable <code class="docutils literal notranslate"><span class="pre">dead</span></code> geändert hat. Ihre Werte änderten sich von <code class="docutils literal notranslate"><span class="pre">True</span></code>/<code class="docutils literal notranslate"><span class="pre">False</span></code> zu <code class="docutils literal notranslate"><span class="pre">1.0</span></code>/<code class="docutils literal notranslate"><span class="pre">0.0</span></code>. Folglich änderte sich ihr <code class="docutils literal notranslate"><span class="pre">dtype</span></code> von <code class="docutils literal notranslate"><span class="pre">bool</span></code> zu <code class="docutils literal notranslate"><span class="pre">float64</span></code>.</p>
<p><strong>Hinzufügen einer Spalte zum Datensatz</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="n">datetime</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>datetime.datetime(2023, 2, 15, 16, 27, 36, 794174)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">year</span>
<span class="n">now</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">year_born</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Last Name</th>
      <th>dead</th>
      <th>year_born</th>
      <th>no_of_songs</th>
      <th>age</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>John</td>
      <td>Lennon</td>
      <td>1.0</td>
      <td>1940</td>
      <td>62.0</td>
      <td>83</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Paul</td>
      <td>McCartney</td>
      <td>0.0</td>
      <td>1942</td>
      <td>58.0</td>
      <td>81</td>
    </tr>
    <tr>
      <th>3</th>
      <td>George</td>
      <td>Harrison</td>
      <td>1.0</td>
      <td>1943</td>
      <td>24.0</td>
      <td>80</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ringo</td>
      <td>Star</td>
      <td>0.0</td>
      <td>1940</td>
      <td>3.0</td>
      <td>83</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Mickey</td>
      <td>Mouse</td>
      <td>NaN</td>
      <td>1928</td>
      <td>NaN</td>
      <td>95</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Einen bestimmten Eintrag ändern</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Minnie&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Last Name</th>
      <th>dead</th>
      <th>year_born</th>
      <th>no_of_songs</th>
      <th>age</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>John</td>
      <td>Lennon</td>
      <td>1.0</td>
      <td>1940</td>
      <td>62.0</td>
      <td>83</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Paul</td>
      <td>McCartney</td>
      <td>0.0</td>
      <td>1942</td>
      <td>58.0</td>
      <td>81</td>
    </tr>
    <tr>
      <th>3</th>
      <td>George</td>
      <td>Harrison</td>
      <td>1.0</td>
      <td>1943</td>
      <td>24.0</td>
      <td>80</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ringo</td>
      <td>Star</td>
      <td>0.0</td>
      <td>1940</td>
      <td>3.0</td>
      <td>83</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Minnie</td>
      <td>Mouse</td>
      <td>NaN</td>
      <td>1928</td>
      <td>NaN</td>
      <td>95</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="plotten">
<h4>Plotten<a class="headerlink" href="#plotten" title="Permalink to this headline">#</a></h4>
<p>Die Plotting-Funktionalität in Pandas basiert auf Matplotlib. Es ist recht praktisch, den Visualisierungsprozess mit der grundlegenden Pandas-Darstellung zu beginnen und zu matplotlib zu wechseln, um die Pandas-Visualisierung anzupassen.</p>
<section id="plot-methoden">
<h5><code class="docutils literal notranslate"><span class="pre">plot</span></code>-Methoden<a class="headerlink" href="#plot-methoden" title="Permalink to this headline">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># dieser Aufruf bewirkt, dass die Zahlen unter den Codezellen eingezeichnet werden</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Last Name</th>
      <th>dead</th>
      <th>year_born</th>
      <th>no_of_songs</th>
      <th>age</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>John</td>
      <td>Lennon</td>
      <td>1.0</td>
      <td>1940</td>
      <td>62.0</td>
      <td>83</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Paul</td>
      <td>McCartney</td>
      <td>0.0</td>
      <td>1942</td>
      <td>58.0</td>
      <td>81</td>
    </tr>
    <tr>
      <th>3</th>
      <td>George</td>
      <td>Harrison</td>
      <td>1.0</td>
      <td>1943</td>
      <td>24.0</td>
      <td>80</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ringo</td>
      <td>Star</td>
      <td>0.0</td>
      <td>1940</td>
      <td>3.0</td>
      <td>83</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Minnie</td>
      <td>Mouse</td>
      <td>NaN</td>
      <td>1928</td>
      <td>NaN</td>
      <td>95</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s2">&quot;no_of_songs&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;id&#39;&gt;
</pre></div>
</div>
<img alt="_images/pandas_112_1.png" src="_images/pandas_112_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;dead&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: ylabel=&#39;Frequency&#39;&gt;
</pre></div>
</div>
<img alt="_images/pandas_113_1.png" src="_images/pandas_113_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;id&#39;&gt;
</pre></div>
</div>
<img alt="_images/pandas_114_1.png" src="_images/pandas_114_1.png" />
</div>
</div>
<blockquote>
<div><p><strong>…einige Anmerkungen zum Plotten mit Python</strong></p>
</div></blockquote>
<p>Das Plotten ist ein wesentlicher Bestandteil der Datenanalyse. Die Welt der Python-Visualisierung kann jedoch ein frustrierender Ort sein. Es gibt viele verschiedene Optionen, und die Auswahl der richtigen ist eine Herausforderung. (Wenn Sie sich trauen, werfen Sie einen Blick auf die <a href="https://github.com/rougier/python-visualization-landscape">Python-Visualisierungslandschaft</a>).</p>
<p><a href="https://matplotlib.org/">matplotlib</a> ist wahrscheinlich die bekannteste Python-Bibliothek für 2D-Diagramme. Mit ihr lassen sich plattformübergreifend Zahlen in Publikationsqualität in einer Vielzahl von Formaten und interaktiven Umgebungen erstellen. Allerdings ist matplotlib aufgrund der komplexen Syntax und der Existenz zweier Schnittstellen, einer <strong>MATLAB-ähnlichen zustandsbasierten Schnittstelle</strong> und einer <strong>objektorientierten Schnittstelle</strong>, schwer zugänglich. Daher gibt <strong>es immer mehr als eine Möglichkeit, eine Visualisierung zu erstellen</strong>. Eine weitere Quelle der Verwirrung ist die Tatsache, dass matplotlib gut in andere Python-Bibliotheken integriert ist, wie z. B. <a href="https://pandas.pydata.org/index.html">pandas</a>, <a href="http://seaborn.pydata.org/index.html">seaborn</a>, <a href="https://xarray.pydata.org/en/stable/">xarray</a> und andere. Daher gibt es Verwirrung darüber, wann man die reine matplotlib oder ein Tool, das auf matplotlib aufbaut, verwenden sollte.</p>
<p>Wir importieren die <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>-Bibliothek und das <code class="docutils literal notranslate"><span class="pre">pyplot</span></code>-Modul von matplotlib mit den folgenden kanonischen Befehlen</p>
<p><code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">matplotlib</span> <span class="pre">as</span> <span class="pre">mpl</span></code>
<code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">matplotlib.pyplot</span> <span class="pre">as</span> <span class="pre">plt</span></code></p>
<p>In Bezug auf die Terminologie von matplotlib ist es wichtig zu verstehen, dass die <code class="docutils literal notranslate"><span class="pre">Figure</span></code> das endgültige Bild ist, das eine oder mehrere <code class="docutils literal notranslate"><span class="pre">Axes</span></code> enthalten kann, und dass die  <code class="docutils literal notranslate"><span class="pre">Axes</span></code> eine individuelle Darstellung repräsentieren.</p>
<p>Um ein <code class="docutils literal notranslate"><span class="pre">Figure</span></code>-Objekt zu erstellen, rufen wir</p>
<p><code class="docutils literal notranslate"><span class="pre">fig</span> <span class="pre">=</span> <span class="pre">plt.figure()</span></code> auf.</p>
<p>Ein bequemerer Weg, ein <code class="docutils literal notranslate"><span class="pre">Figure</span></code>-Objekt und ein <code class="docutils literal notranslate"><span class="pre">Axes</span></code>-Objekt auf einmal zu erstellen, ist jedoch der Aufruf</p>
<p><code class="docutils literal notranslate"><span class="pre">fig,</span> <span class="pre">ax</span> <span class="pre">=</span> <span class="pre">plt.subplots()</span></code></p>
<p>Dann können wir das <code class="docutils literal notranslate"><span class="pre">Axes</span></code>-Objekt verwenden, um Daten für die Darstellung hinzuzufügen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Erzeuge Figure und Axes Objekt</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># plot die Daten und referenzier das Axes Objekt</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="c1"># Passe das Axes Objekt an</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Age&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;The Beatles and ... something else&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;The Beatles and ... something else&#39;)
</pre></div>
</div>
<img alt="_images/pandas_117_1.png" src="_images/pandas_117_1.png" />
</div>
</div>
<p>Beachten Sie, dass wir nur an der Oberfläche der Plot-Möglichkeiten mit Pandas kratzen. In der Online-Dokumentation von Pandas (<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/visualization.html">hier</a>) finden Sie einen umfassenden Überblick.</p>
</section>
</section>
</section>
<span id="document-Aufgaben/Kapitel01/Pandas_Dataframes"></span><section class="tex2jax_ignore mathjax_ignore" id="ubung-zu-pandas-dataframes">
<h3>Übung zu Pandas Dataframes<a class="headerlink" href="#ubung-zu-pandas-dataframes" title="Permalink to this headline">#</a></h3>
<ol class="simple">
<li><p>Erstellen Sie einen Pandas Dataframe (<code class="docutils literal notranslate"><span class="pre">df</span></code>) wie vorgegeben.</p></li>
<li><p>Fügen Sie die Spalte <code class="docutils literal notranslate"><span class="pre">nc_score</span></code> <span class="math notranslate nohighlight">\(= [2.5, 3, 2.2, 1.0] \)</span> zum Dataframe <code class="docutils literal notranslate"><span class="pre">df</span></code> hinzu.</p></li>
<li><p>Wählen Sie alle Daten aus, für die gilt <code class="docutils literal notranslate"><span class="pre">age</span></code> <span class="math notranslate nohighlight">\(\gt 23 \)</span> und speichern Sie die Werte in den neuen Dataframe <code class="docutils literal notranslate"><span class="pre">df2</span></code>.</p></li>
</ol>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>id</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>Age</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>John</p></td>
<td><p>26</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>Alice</p></td>
<td><p>20</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>Mike</p></td>
<td><p>21</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>Anne</p></td>
<td><p>25</p></td>
</tr>
</tbody>
</table>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 1 ...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 2 ...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 3 ...</span>
</pre></div>
</div>
</div>
</div>
<section id="losungen">
<h4>Lösungen<a class="headerlink" href="#losungen" title="Permalink to this headline">#</a></h4>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
        <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;John&quot;</span><span class="p">,</span> <span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="s2">&quot;Mike&quot;</span><span class="p">,</span> <span class="s2">&quot;Anne&quot;</span><span class="p">],</span>
        <span class="s2">&quot;Age&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">26</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>Name</th>
      <th>Age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>John</td>
      <td>26</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Alice</td>
      <td>20</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Mike</td>
      <td>21</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Anne</td>
      <td>25</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;nc_score&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>Name</th>
      <th>Age</th>
      <th>nc_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>John</td>
      <td>26</td>
      <td>2.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Alice</td>
      <td>20</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Mike</td>
      <td>21</td>
      <td>2.2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Anne</td>
      <td>25</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Age&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">23</span><span class="p">]</span>
<span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>Name</th>
      <th>Age</th>
      <th>nc_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Alice</td>
      <td>20</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Mike</td>
      <td>21</td>
      <td>2.2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<span id="document-Aufgaben/Kapitel01/Fuenf_Punkte"></span><section class="tex2jax_ignore mathjax_ignore" id="masze-der-zentralen-tendenz-streumasze-und-funf-punkte-zusammenfassung">
<h3>Maße der zentralen Tendenz, Streumaße und Fünf-Punkte Zusammenfassung<a class="headerlink" href="#masze-der-zentralen-tendenz-streumasze-und-funf-punkte-zusammenfassung" title="Permalink to this headline">#</a></h3>
<ol class="simple">
<li><p>Berechnen Sie Mittelwert, Standardabweichung, Modalwert des Vektors <code class="docutils literal notranslate"><span class="pre">data</span></code>.</p></li>
</ol>
<p><code class="docutils literal notranslate"><span class="pre">data</span> <span class="pre">=</span> <span class="pre">[10,</span> <span class="pre">1,</span> <span class="pre">17,</span> <span class="pre">0,</span> <span class="pre">14,</span> <span class="pre">2,</span> <span class="pre">11,</span> <span class="pre">1,</span> <span class="pre">4,</span> <span class="pre">10,</span> <span class="pre">5,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">99,</span> <span class="pre">47,</span> <span class="pre">16,</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">9,</span> <span class="pre">11]</span></code></p>
<ol class="simple">
<li><p>Berechnen Sie die Fünf-Punkte-Zusammenfassung für <code class="docutils literal notranslate"><span class="pre">data</span></code>.</p></li>
<li><p>Generieren Sie mit der Funktion <code class="docutils literal notranslate"><span class="pre">np.linspace()</span></code> eine <span class="math notranslate nohighlight">\(x\)</span>-Achse mit Werten zwischen <span class="math notranslate nohighlight">\(0\)</span> und <span class="math notranslate nohighlight">\(1\)</span> und stellen Sie <code class="docutils literal notranslate"><span class="pre">data</span></code> als Streudiagramm dar.</p></li>
<li><p>Stellen Sie die Daten als Boxplot dar.</p></li>
<li><p>Bewerten Sie anhand der Ergebnisse mögliche Ausreißer.</p></li>
</ol>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 1 ...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 2 ...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 3 ...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 4 ...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 5 ...</span>
</pre></div>
</div>
</div>
</div>
<section id="losungen">
<h4>Lösungen<a class="headerlink" href="#losungen" title="Permalink to this headline">#</a></h4>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">statistics</span> <span class="k">as</span> <span class="nn">st</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mittelwert: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Standardabweichung: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Modalwert: </span><span class="si">{</span><span class="n">st</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mittelwert: 13.3
Standardabweichung: 22.147460351019934
Modalwert: 1
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne Fünf-Punkte-Zusammenfassung</span>
<span class="c1"># Berechne die Quartilen</span>
<span class="n">q1</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="n">q3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">])</span>

<span class="c1"># Berechne minimal/maximal Datenpunkte</span>
<span class="n">data_min</span><span class="p">,</span> <span class="n">data_max</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># Ausgabe der Daten</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Min:    </span><span class="si">{</span><span class="n">data_min</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Q1:     </span><span class="si">{</span><span class="n">q1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Median: </span><span class="si">{</span><span class="n">median</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Q3:     </span><span class="si">{</span><span class="n">q3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Max:    </span><span class="si">{</span><span class="n">data_max</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Min:    0
Q1:     1.75
Median: 7.0
Q3:     11.75
Max:    99
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Fuenf_Punkte_12_0.png" src="_images/Fuenf_Punkte_12_0.png" />
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Fuenf_Punkte_13_0.png" src="_images/Fuenf_Punkte_13_0.png" />
</div>
</div>
<div class="toggle docutils container">
<p>Anhand der visuellen Auswertung von Boxplot und Streudiagram liegt es nahe, dass die Datenpunkte 99 und 27 Ausreißer sind.</p>
</div>
</section>
</section>
<span id="document-Aufgaben/Kapitel01/Arithmetisches_Mittel"></span><section class="tex2jax_ignore mathjax_ignore" id="arithmetisches-mittel">
<h3>Arithmetisches Mittel<a class="headerlink" href="#arithmetisches-mittel" title="Permalink to this headline">#</a></h3>
<p>diedieSchreiben Sie eine Funktion (<code class="docutils literal notranslate"><span class="pre">arithmic_average</span></code>) die den Mittelwert einer Liste/eines Arrays berechnet. Vergleichen Sie Ihre Implementierung mit einer <em>built-in</em> Funktion von Python.
Verwenden Sie die Funktion auf die folgenden Daten an.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 1 ...</span>
</pre></div>
</div>
</div>
</div>
<section id="losungen">
<h4>Lösungen<a class="headerlink" href="#losungen" title="Permalink to this headline">#</a></h4>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">arithmic_average</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Function to compute the arithmic average&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Self implementation&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">arithmic_average</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">arithmic_average</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">numpy built-in function&quot;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Self implementation
5.5
-5.0

numpy built-in function
5.5
-5.0
</pre></div>
</div>
</div>
</div>
</section>
</section>
</div>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-Lernziele/Kapitel2_Lernziele"></span><section class="tex2jax_ignore mathjax_ignore" id="lernziele">
<h2>Lernziele<a class="headerlink" href="#lernziele" title="Permalink to this headline">#</a></h2>
<section id="diskrete-zufallsvariablen">
<h3>Diskrete Zufallsvariablen<a class="headerlink" href="#diskrete-zufallsvariablen" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Die Studierenden werden mit diskreten Zufallsvariablen und der Berechnung deren Erwartungswerts und Standardabweichung vertraut gemacht</p></li>
<li><p>Verschiedene Verteilungsarten von Zufallsvariablen wie Binomialverteilung, hypergeometrische Verteilung und Poisson-Verteilung werden erklärt</p></li>
<li><p>Den Studierenden wird anhand von Beispielen die Konzepte von Permutationen und Kombinatorik erläutert</p></li>
<li><p>Zusammengefasst werden folgende Begriffe und Methoden besprochen : diskrete Zufallsvariablen, Erwartungswert und Standardabweichung von diskreten Zufallsvariablen, Binomialverteilung, hypergeometrische Verteilung, Poissonverteilung</p></li>
</ul>
</section>
</section>
<span id="document-Kapitel02/01_Diskrete_Zufallsvariablen"></span><section class="tex2jax_ignore mathjax_ignore" id="diskrete-zufallsvariablen-und-ihre-wahrscheinlichkeitsverteilungen">
<h2>Diskrete Zufallsvariablen und ihre Wahrscheinlichkeitsverteilungen<a class="headerlink" href="#diskrete-zufallsvariablen-und-ihre-wahrscheinlichkeitsverteilungen" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<p>Eine <a href="https://de.wikipedia.org/wiki/Zufallsvariable">Zufallsvariable</a> ist eine Variable, deren Wert vom Zufall abhängt; dementsprechend ist ihr Wert mit einer Wahrscheinlichkeit verbunden. Generell sind Zufallsvariablen Zuordnungsvorschriften die möglichen Ergebnissen eines Zufallsexperiments einen Zahlenwert zuordnen. Eine <strong>diskrete Zufallsvariable</strong> weist den möglichen Ergebnissen diskrete, also abzählbare Werte zu. Eine <strong>Wahrscheinlichkeitsverteilung</strong> ist eine Auflistung der möglichen Werte und der entsprechenden Wahrscheinlichkeiten einer diskreten Zufallsvariablen, die häufig durch eine Formel dargestellt wird.</p>
<p>Ein Diagramm der Wahrscheinlichkeitsverteilung, das die Wahrscheinlichkeit jedes Wertes, dargestellt durch einen vertikalen Balken, dessen Höhe der Wahrscheinlichkeit entspricht, und die möglichen Werte einer diskreten Zufallsvariablen auf der horizontalen Achse anzeigt, wird <strong>Wahrscheinlichkeitshistogramm</strong> genannt.</p>
<p>Die <strong>Summe der Wahrscheinlichkeiten einer diskreten Zufallsvariablen</strong> für eine beliebige diskrete Zufallsvariable <span class="math notranslate nohighlight">\(X\)</span> wird geschrieben als</p>
<div class="math notranslate nohighlight">
\[\sum_{i=1}^{N}P(X = x_i) = 1\]</div>
<p>Bei einer großen Anzahl an voneinander unabhängigen Beobachtungen einer Zufallsvariablen <span class="math notranslate nohighlight">\(X\)</span> wird das Wahrscheinlichkeitshistogramm eine Annäherung an die Wahrscheinlichkeitsverteilung für <span class="math notranslate nohighlight">\(X\)</span> darstellen (<span id="id1">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.209-250).</p>
<section id="diskrete-zufallsvariablen-ein-beispiel">
<h3>Diskrete Zufallsvariablen - ein Beispiel<a class="headerlink" href="#diskrete-zufallsvariablen-ein-beispiel" title="Permalink to this headline">#</a></h3>
<p>Lassen Sie uns das Konzept der <strong>diskreten Zufallsvariablen</strong> anhand eines Beispiels erläutern.</p>
<p>Unsere zu untersuchende Population besteht aus allen Studierenden, allen Dozenten und allen Verwaltungsmitarbeitern der <a href="https://www.fu-berlin.de/">FU Berlin</a>. Wir wählen zufällig eine dieser Personen aus und fragen sie nach der Anzahl ihrer Geschwister. Folglich ist die Antwort, die Anzahl der Geschwister einer zufällig ausgewählten Person, eine diskrete Zufallsvariable, bezeichnet als <span class="math notranslate nohighlight">\(X\)</span>. Der tatsächliche Wert (Anzahl der Geschwister) von <span class="math notranslate nohighlight">\(X\)</span> hängt vom Zufall ab, aber wir können trotzdem alle Werte von <span class="math notranslate nohighlight">\(X\)</span> auflisten, z.B. <span class="math notranslate nohighlight">\(0\)</span> Geschwister, <span class="math notranslate nohighlight">\(1\)</span> Geschwister, <span class="math notranslate nohighlight">\(2\)</span> Geschwister, usw. Zur Vereinfachung beschränken wir die Anzahl der Geschwister in dieser Übung auf <span class="math notranslate nohighlight">\(5\)</span>.</p>
<p>Laut der <a href="https://www.fu-berlin.de/universitaet/profil/zahlen/index.html">Website</a> der FU Berlin gibt es im WS 2021/2022 <span class="math notranslate nohighlight">\(33.000\)</span> Studierende, <span class="math notranslate nohighlight">\(4.000\)</span> Doktoranden, <span class="math notranslate nohighlight">\(379\)</span> Professoren und <span class="math notranslate nohighlight">\(4.660\)</span> Mitarbeiter an der FU Berlin (bitte beachten Sie, dass sich die tatsächlichen Zahlen im Laufe der Zeit ändern können).</p>
<p>Da wir keine Vorstellung von der damit verbundenen Wahrscheinlichkeit für eine bestimmte Anzahl von Geschwistern haben, starten wir einige Experimente:</p>
<p>Wir wählen <strong>eine</strong> zufällig ausgewählte Person aus und fragen nach der Anzahl der Geschwister.</p>
<p>Die Antwort lautet: <span class="math notranslate nohighlight">\(0\)</span></p>
<p>Wir wählen <strong>zehn</strong> zufällig ausgewählte Personen aus und befragen sie zu ihren Geschwistern.</p>
<p>Die Antworten lauten: <span class="math notranslate nohighlight">\(4,0,2,0,2,2,1,2,0,3\)</span></p>
<p>Wir wählen <em>hundert</em> Personen aus und fragen nach Geschwistern.</p>
<p>Die Antworten lauten: <span class="math notranslate nohighlight">\(2, 0, 1, 2, 2, 0, 0, 0, 1, 3, 1, 2, 1, 0, 2, 0, 0, 2, 1, 1, 1, 1, 2, 2, 1, 2, 2, 0, 1, 1, 2, 4, 0, 3, 2, 0, 1, 2, 2, 2, 1, 2, 1, 1, 2, 1, 2, 2, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 2, 2, 1, 1, 0, 2, 0, 1, 0, 1, 2, 1, 2, 1, 2, 2, 2, 1, 0, 2, 2, 4, 1, 2, 1, 1, 1, 1, 1, 0, 2, 1, 0, 1, 0, 1, 1, 2, 0, 2, 0, 0\)</span></p>
<p>Sie sehen, die Form der Notation wird ziemlich schnell unübersichtlich, wenn wir die Anzahl der abgefragten Individuen erhöhen. Wir beschließen also, die <strong>Häufigkeit</strong> und die entsprechende <strong>relative Häufigkeit</strong> der Werte für die Klassen <span class="math notranslate nohighlight">\(0\)</span>, <span class="math notranslate nohighlight">\(1\)</span>, <span class="math notranslate nohighlight">\(2\)</span>, <span class="math notranslate nohighlight">\(3\)</span>, <span class="math notranslate nohighlight">\(4\)</span>, <span class="math notranslate nohighlight">\(5\)</span> (um es deutlich zu sagen: die letzte Klasse entspricht <span class="math notranslate nohighlight">\(5\)</span> oder mehr Geschwistern) zu notieren und das Experiment in Form einer schön formatierten Tabelle zu präsentieren.</p>
<p>Wir wählen <span class="math notranslate nohighlight">\(1.000\)</span> Personen aus und befragen sie zu ihren Geschwistern.</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Geschwister (<span class="math notranslate nohighlight">\(x\)</span>)</p></th>
<th class="text-align:center head"><p>Absolute Häufigkeit(<span class="math notranslate nohighlight">\(f\)</span>)</p></th>
<th class="text-align:center head"><p>Relative Häufigkeit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>0</p></td>
<td class="text-align:center"><p>205</p></td>
<td class="text-align:center"><p>0,205</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p>419</p></td>
<td class="text-align:center"><p>0,419</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>2</p></td>
<td class="text-align:center"><p>280</p></td>
<td class="text-align:center"><p>0,28</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>3</p></td>
<td class="text-align:center"><p>65</p></td>
<td class="text-align:center"><p>0,065</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>4</p></td>
<td class="text-align:center"><p>29</p></td>
<td class="text-align:center"><p>0,029</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>5</p></td>
<td class="text-align:center"><p>2</p></td>
<td class="text-align:center"><p>0,002</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p></p></td>
<td class="text-align:center"><p>1000</p></td>
<td class="text-align:center"><p>1</p></td>
</tr>
</tbody>
</table>
<p>Nachdem wir alle möglichen Werte aufgelistet und die entsprechenden relativen Häufigkeiten berechnet haben, kennen wir immer noch nicht genau die Wahrscheinlichkeiten der diskreten Zufallsvariablen <span class="math notranslate nohighlight">\(X\)</span> für die gesamte Population von <span class="math notranslate nohighlight">\(40.961\)</span> Personen, die der FU Berlin zugeordnet sind. Nach Gesprächen mit <span class="math notranslate nohighlight">\(1.000\)</span> zufällig ausgewählten Personen sind wir jedoch recht zuversichtlich, dass eine so große Anzahl von Interviews - verglichen mit der Anzahl der Gesamtpopulation <span class="math notranslate nohighlight">\((40.961)\)</span> - uns eine gute Annäherung an die Wahrscheinlichkeiten der diskreten Zufallsvariablen <span class="math notranslate nohighlight">\(X\)</span> (Anzahl der Geschwister) für die Gesamtpopulation liefern wird.</p>
<p>Im nächsten Schritt zeichnen wir ein <strong>Wahrscheinlichkeitshistogramm</strong> (der Stichprobe), das die möglichen Werte einer diskreten Zufallsvariablen <span class="math notranslate nohighlight">\(X\)</span> auf der horizontalen Achse und die Anteile dieser Werte auf der vertikalen Achse darstellt. Ein Verhältnishistogramm kann auch als Annäherung an die Wahrscheinlichkeitsverteilung dienen. Bitte beachten Sie, dass sowohl die <strong>Summe der Wahrscheinlichkeiten</strong> als auch die <strong>Summe der Anteile</strong> jeder diskreten Zufallsvariablen gleich <span class="math notranslate nohighlight">\(1\)</span> ist.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Erzeuge Dataframe df</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.205</span><span class="p">,</span> <span class="mf">0.419</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.065</span><span class="p">,</span> <span class="mf">0.029</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>

<span class="c1"># Säulendiagramm</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span>
    <span class="n">p</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># annotate</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label_type</span><span class="o">=</span><span class="s2">&quot;edge&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s2">&quot;Wahrscheinlichkeithistogramm der Zufallsvariablen X, die Anzahl der Geschwister zufällig </span><span class="se">\n</span><span class="s2"> ausgewählter Einzelpersonen der FU Berlin&quot;</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Anzahl Geschwister&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Wahrscheinlichkeit&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Wahrscheinlichkeit&#39;)
</pre></div>
</div>
<img alt="_images/01_Diskrete_Zufallsvariablen_24_1.png" src="_images/01_Diskrete_Zufallsvariablen_24_1.png" />
</div>
</div>
<p>Bei vielen Anwendungen im wirklichen Leben kennen wir die Wahrscheinlichkeitsverteilung der Grundgesamtheit nicht - <strong>und werden sie auch nie kennen</strong>. Das liegt vor allem daran, dass in vielen Anwendungen die Grundgesamtheit viel zu groß ist oder es keine Möglichkeit gibt, zuverlässige Daten zu erhalten, oder wir weder das Geld noch die Zeit für eine umfassende Datenerhebung haben. Erhöht man jedoch die Anzahl der unabhängigen Beobachtungen einer Zufallsvariablen <span class="math notranslate nohighlight">\(X\)</span>, so nähert sich das Wahrscheinlichkeitshistogramm der Stichprobe immer mehr dem Wahrscheinlichkeitshistogramm der Grundgesamtheit an. Um diese Behauptung zu beweisen, vergrößern wir unser Experiment:</p>
<p>Wir wählen nacheinander <span class="math notranslate nohighlight">\(10\)</span>, <span class="math notranslate nohighlight">\(100\)</span> und <span class="math notranslate nohighlight">\(1.000\)</span> zufällig Personen aus, die mit der FU Berlin verbunden sind, und befragen sie nach der Anzahl der Geschwister. Wir werden jedes unserer drei Experimente aufzeichnen und schließlich mit der tatsächlichen/realen Wahrscheinlichkeitsverteilung vergleichen (Bitte beachten Sie, dass dieses Beispiel ein Übungsbeispiel ist und nicht die reale Anzahl der Geschwister in der Population der Personen an der FU Berlin darstellt; daher <em>kennen</em> die Dozenten des vorliegenden Skripts die Wahrscheinlichkeitsverteilung der Grundgesamtheit ;-))</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_prob_experiment</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.425</span><span class="p">,</span> <span class="mf">0.275</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">)</span>

<span class="n">trialsize</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>
<span class="n">siblings</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">trialsize</span><span class="p">):</span>
    <span class="n">trial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
        <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">_prob_experiment</span><span class="p">)),</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">_prob_experiment</span>
    <span class="p">)</span>
    <span class="n">unique_elements</span><span class="p">,</span> <span class="n">counts_elements</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">trial</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">unique_elements</span><span class="p">,</span> <span class="n">counts_elements</span> <span class="o">/</span> <span class="n">n</span><span class="p">))</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;frequency&quot;</span><span class="p">])</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">siblings</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
        <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
        <span class="n">df</span><span class="o">.</span><span class="n">frequency</span><span class="p">,</span>
        <span class="n">width</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label_type</span><span class="o">=</span><span class="s2">&quot;edge&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Häufigkeitsverteilung (n=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
    <span class="n">siblings</span><span class="p">,</span>
    <span class="n">_prob_experiment</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label_type</span><span class="o">=</span><span class="s2">&quot;edge&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Die tatsächliche (unbekannte) Häufigkeitsverteilung&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">_ax</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">:</span>
    <span class="n">_ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">)</span>
    <span class="n">_ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Anzahl Geschwister&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/01_Diskrete_Zufallsvariablen_27_0.png" src="_images/01_Diskrete_Zufallsvariablen_27_0.png" />
</div>
</div>
<p>Die Diagramme bestätigen unsere Hypothese, dass sich das Histogramm der Stichprobe mit zunehmender Anzahl der Beobachtungen immer mehr dem Häufigkeitsverteilung der Grundgesamtheit annähert.</p>
</section>
<section id="der-mittelwert-und-die-standardabweichung-einer-diskreten-zufallsvariablen">
<h3>Der Mittelwert und die Standardabweichung einer diskreten Zufallsvariablen<a class="headerlink" href="#der-mittelwert-und-die-standardabweichung-einer-diskreten-zufallsvariablen" title="Permalink to this headline">#</a></h3>
<section id="mittelwert-einer-diskreten-zufallsvariable">
<h4>Mittelwert einer diskreten Zufallsvariable<a class="headerlink" href="#mittelwert-einer-diskreten-zufallsvariable" title="Permalink to this headline">#</a></h4>
<p>Der Mittelwert einer <strong>diskreten Zufallsvariablen</strong> <span class="math notranslate nohighlight">\(X\)</span> wird mit <span class="math notranslate nohighlight">\(\mu_X\)</span> oder, wenn keine Verwechslung auftreten soll, einfach mit <span class="math notranslate nohighlight">\(\mu\)</span> bezeichnet. Die Begriffe <strong>Erwartungswert</strong>, <span class="math notranslate nohighlight">\(E(X)\)</span> und <strong>Erwartung</strong> werden üblicherweise anstelle des Begriffs Mittelwert verwendet.</p>
<div class="math notranslate nohighlight">
\[E(X) = \sum_{i=1}^{N}x_iP(X=x_i)\]</div>
<p>Bei einer großen Anzahl unabhängiger Beobachtungen einer Zufallsvariablen <span class="math notranslate nohighlight">\(X\)</span> nähert sich <span class="math notranslate nohighlight">\(E(X)\)</span> dieser Beobachtungen - der Stichprobe - dem Mittelwert <span class="math notranslate nohighlight">\(\mu\)</span> der Grundgesamtheit an. Je größer die Zahl der Beobachtungen ist, desto näher liegt <span class="math notranslate nohighlight">\(E(X)\)</span> an <span class="math notranslate nohighlight">\(\mu\)</span> (<span id="id2">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.226).</p>
<p>Erinnern wir uns an unser Experiment aus dem vorherigen Abschnitt, als wir <span class="math notranslate nohighlight">\(1.000\)</span> Personen ausgewählt und nach der Anzahl der Geschwister gefragt haben. Werfen wir noch einmal einen Blick auf die Tabelle, die das Experiment zusammenfasst</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Geschwister (<span class="math notranslate nohighlight">\(x\)</span>)</p></th>
<th class="text-align:center head"><p>Absolute Häufigkeit(<span class="math notranslate nohighlight">\(f\)</span>)</p></th>
<th class="text-align:center head"><p>Relative Häufigkeit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>0</p></td>
<td class="text-align:center"><p>205</p></td>
<td class="text-align:center"><p>0,205</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p>419</p></td>
<td class="text-align:center"><p>0,419</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>2</p></td>
<td class="text-align:center"><p>280</p></td>
<td class="text-align:center"><p>0,28</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>3</p></td>
<td class="text-align:center"><p>65</p></td>
<td class="text-align:center"><p>0,065</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>4</p></td>
<td class="text-align:center"><p>29</p></td>
<td class="text-align:center"><p>0,029</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>5</p></td>
<td class="text-align:center"><p>2</p></td>
<td class="text-align:center"><p>0,002</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p></p></td>
<td class="text-align:center"><p>1000</p></td>
<td class="text-align:center"><p>1</p></td>
</tr>
</tbody>
</table>
<p>Berechnen wir den Erwartungswert (Mittelwert) für dieses Experiment.</p>
<p><span class="math notranslate nohighlight">\(E(X) = \sum_{i=1}^{N}x_iP(X=x_i) \)</span></p>
<p><span class="math notranslate nohighlight">\( = 0 \cdot P(X=0) + 1 \cdot P(X=1)+ 2 \cdot P(X=2) + 3 \cdot P(X=3) +4 \cdot P(X=4)+ 5 \cdot P(X \ge 5) \)</span></p>
<p><span class="math notranslate nohighlight">\( = 0 \cdot 0,205 + 1 \cdot 0,419 + 2 \cdot 0,28+ 3 \cdot 0,065  + 4 \cdot 0,029  + 5 \cdot 0,002  \)</span></p>
<p><span class="math notranslate nohighlight">\( = 1,3 \)</span></p>
<p>Der sich daraus ergebende Erwartungswert von <span class="math notranslate nohighlight">\(1,3\)</span> liegt nahe am Mittelwert <span class="math notranslate nohighlight">\(\mu\)</span>, den wir anhand der Wahrscheinlichkeiten der Grundgesamtheit berechnen (die realen Wahrscheinlichkeiten sind der unteren rechten Abbildung im vorherigen Abschnitt entnommen).</p>
<div class="math notranslate nohighlight">
\[\mu = 1 \cdot 0,2 + 2 \cdot 0,425 +  3 \cdot 0,275 + 4 \cdot 0,07 + 5 \cdot 0,025=2,28\]</div>
</section>
<section id="ubung">
<h4>Übung<a class="headerlink" href="#ubung" title="Permalink to this headline">#</a></h4>
<p>Betrachten wir einen fairen sechsseitigen Würfel. Wir können den <strong>Erwartungswert</strong> <span class="math notranslate nohighlight">\(E(X)\)</span> leicht mit Python berechnen. Der Begriff “fair” bedeutet, dass jede Zufallsvariable <span class="math notranslate nohighlight">\(X=x_i,\; x \in 1,2,3,4,5,6\)</span> mit gleicher Wahrscheinlichkeit auftritt. Daher ist <span class="math notranslate nohighlight">\(P(X=x_i)=\frac{1}{6}\)</span>.</p>
<div class="math notranslate nohighlight">
\[E(X) = \sum_{i=1}^{6}x_iP(X=x_i) = 1 \cdot \frac{1}{6} + 2 \cdot \frac{1}{6} +  3 \cdot \frac{1}{6} +  4 \cdot \frac{1}{6} + 5 \cdot \frac{1}{6} + 6 \cdot \frac{1}{6}= 3,5\]</div>
<p>In Python schreiben wir den folgenden Code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_die</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">6</span>
<span class="n">die</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="n">die</span> <span class="o">=</span> <span class="n">die</span> <span class="o">*</span> <span class="n">p_die</span>
<span class="nb">sum</span><span class="p">(</span><span class="n">die</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.5
</pre></div>
</div>
</div>
</div>
<p>Was aber, wenn wir uns nicht sicher sind, ob die Würfel wirklich fair sind? Woher wissen wir, dass wir nicht betrogen werden? Oder anders ausgedrückt: Wie oft müssen wir würfeln, bevor wir mehr Vertrauen haben können?</p>
<p>Führen wir ein Berechnungsexperiment durch: Wir wissen aus den obigen Überlegungen, dass der Erwartungswert eines <span class="math notranslate nohighlight">\(6\)</span>-seitigen fairen Würfels <span class="math notranslate nohighlight">\(3,5\)</span> ist. Wir führen ein Experiment durch, indem wir einen Würfel immer und immer wieder werfen. Wir speichern das Ergebnis und bevor wir erneut würfeln, berechnen wir den Durchschnitt aller bisherigen Würfelwürfe. Um dieses kleine Experiment durchzuführen, schreiben wir eine for-Schleife in Python.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Setze random seed für Reproduzierbarkeit</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">wuerfel</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">e_wert</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1"># Simuliere Würfelwurf</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">500</span><span class="p">):</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
    <span class="n">wuerfel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    <span class="n">e_wert</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">wuerfel</span><span class="p">))</span>
<span class="c1"># Plotten</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">e_wert</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Erwartungswert : 3,5&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Anzahl der Versuche&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Erwartungswert&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f03d7cf3010&gt;
</pre></div>
</div>
<img alt="_images/01_Diskrete_Zufallsvariablen_47_1.png" src="_images/01_Diskrete_Zufallsvariablen_47_1.png" />
</div>
</div>
<p>Das Diagramm zeigt, dass die Kurve nach anfänglichen Schwankungen schließlich abflacht und sich dem <span class="math notranslate nohighlight">\(E(X)\)</span> von <span class="math notranslate nohighlight">\(3,5\)</span> annähert.</p>
</section>
<section id="standardabweichung-einer-diskreten-zufallsvariable">
<h4>Standardabweichung einer diskreten Zufallsvariable<a class="headerlink" href="#standardabweichung-einer-diskreten-zufallsvariable" title="Permalink to this headline">#</a></h4>
<p>Die Standardabweichung einer diskreten Zufallsvariablen <span class="math notranslate nohighlight">\(X\)</span> wird mit <span class="math notranslate nohighlight">\(\sigma_X\)</span> oder, wenn keine Verwechslung auftreten soll, einfach mit <span class="math notranslate nohighlight">\(\sigma\)</span> bezeichnet. Sie ist definiert als</p>
<div class="math notranslate nohighlight">
\[\sigma = \sqrt{\sum_{i=1}^{N}(x_i-\mu)^2P(X=x_i)}\]</div>
</section>
</section>
</section>
<span id="document-Kapitel02/02_Die_Binomialverteilung"></span><section class="tex2jax_ignore mathjax_ignore" id="die-binomialverteilung">
<h2>Die Binomialverteilung<a class="headerlink" href="#die-binomialverteilung" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">binom</span>
</pre></div>
</div>
</div>
</div>
<p>Viele Anwendungen der Wahrscheinlichkeitsrechnung und Statistik betreffen die Wiederholung eines Experiments. Wir nennen jede Wiederholung einen <strong>Versuch</strong>, und wir sind besonders an Fällen interessiert, in denen das Experiment (jeder Versuch) <strong>nur zwei mögliche Ergebnisse</strong> hat: Erfolg oder Misserfolg, wahr oder falsch, <span class="math notranslate nohighlight">\(0\)</span> oder <span class="math notranslate nohighlight">\(1\)</span>.</p>
<p>Um wiederholte Versuche eines Experiments mit zwei möglichen Ergebnissen zu analysieren, benötigen wir Kenntnisse über <strong>Fakultäten</strong>, <strong>Binomialkoeffizienten</strong> und <strong>Bernoulli-Versuche</strong>.</p>
<p>Auf der Grundlage dieser Voraussetzungen lernen wir die <strong>Binomialverteilung</strong> kennen, die eine <strong>Wahrscheinlichkeitsverteilung</strong> für die Anzahl der Erfolge in einer Folge von <strong>Bernoulli-Versuchen</strong> ist (<span id="id1">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.213,s.289).</p>
<section id="voraussetzungen">
<h3>Voraussetzungen<a class="headerlink" href="#voraussetzungen" title="Permalink to this headline">#</a></h3>
<section id="fakultat">
<h4>Fakultät<a class="headerlink" href="#fakultat" title="Permalink to this headline">#</a></h4>
<p>Das Produkt der ersten <span class="math notranslate nohighlight">\(k\)</span> positiven ganzen Zahlen wird als <span class="math notranslate nohighlight">\(k\)</span>-Faktultät bezeichnet und mit <span class="math notranslate nohighlight">\(k!\)</span> abgekürzt (<span id="id2">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.186).</p>
<div class="math notranslate nohighlight">
\[k! = k \times (k - 1) \times ...\times 2 \times  1\]</div>
<p>Wir definieren auch <span class="math notranslate nohighlight">\(0!=1\)</span>.</p>
<p>Betrachten wir ein einfaches Beispiel und berechnen die Fakultät von <span class="math notranslate nohighlight">\(6\)</span>. Wenn wir die obige Gleichung einsetzen, erhalten wir folgendes Ergebnis</p>
<div class="math notranslate nohighlight">
\[6! = 6 \times  5 \times  4 \times  3 \times  2 \times 1\]</div>
<p>In Python können wir das entweder direkt berechnen…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">6</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>720
</pre></div>
</div>
</div>
</div>
<p>…oder wir verwenden die eingebaute Funktion <code class="docutils literal notranslate"><span class="pre">factorial()</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>720
</pre></div>
</div>
</div>
</div>
</section>
<section id="binomialkoeffizienten">
<h4>Binomialkoeffizienten<a class="headerlink" href="#binomialkoeffizienten" title="Permalink to this headline">#</a></h4>
<p>Wenn <span class="math notranslate nohighlight">\(n\)</span> eine positive ganze Zahl und <span class="math notranslate nohighlight">\(k\)</span> eine nicht negative ganze Zahl kleiner oder gleich <span class="math notranslate nohighlight">\(n\)</span> ist, dann ist der <a href="https://de.wikipedia.org/wiki/Binomialkoeffizient">Binomialkoeffizient</a> <span class="math notranslate nohighlight">\({n \choose k}\)</span> definiert als:</p>
<div class="math notranslate nohighlight">
\[{n \choose k}= \frac{n!}{k!(n - k)!}\]</div>
<p>Die Binomialkoeffizienten <span class="math notranslate nohighlight">\({n \choose k}\)</span> werden oft als “<span class="math notranslate nohighlight">\(n\)</span> über <span class="math notranslate nohighlight">\(k\)</span>” gelesen, weil es <span class="math notranslate nohighlight">\({n \choose k}\)</span> Möglichkeiten gibt, <span class="math notranslate nohighlight">\(k\)</span> Elemente ohne Rücksicht auf ihre Reihenfolge aus einer Menge von <span class="math notranslate nohighlight">\(n\)</span> Elementen auszuwählen. Mit anderen Worten: Die Binomialkoeffizienten beziehen sich auf die Anzahl der Kombinationen von <span class="math notranslate nohighlight">\(n\)</span> Dingen, die <span class="math notranslate nohighlight">\(k\)</span>-mal ohne Wiederholung ausgewählt werden. Bitte beachten Sie, dass die Reihenfolge der Auswahl keine Rolle spielt.</p>
<p>Versuchen wir es mit einem Beispiel, um ein Gefühl dafür zu bekommen.</p>
<p>Nehmen wir ein einfaches Wort wie “dog”, das drei verschiedene Buchstaben enthält: d, o, g. Wie viele Möglichkeiten gibt es, genau einen Buchstaben aus diesen <span class="math notranslate nohighlight">\(3\)</span> Buchstaben zu ziehen? Mit Sicherheit gibt es <span class="math notranslate nohighlight">\(3\)</span> Möglichkeiten, genau einen Buchstaben zu zeichnen: “d”, “o”, oder “g”. Wir können also alle Kombinationen als <span class="math notranslate nohighlight">\({3 \choose 1}\)</span> schreiben. Was ist mit zwei Buchstaben? Wie viele Kombinationen gibt es, um genau zwei Buchstaben aus <span class="math notranslate nohighlight">\(3\)</span> Buchstaben zu ziehen? Die Kombinationen sind “do”, “dg” und “og” (Bitte beachten Sie, dass z.B. “og” und “go” nur als eine Kombination gezählt werden, da die Reihenfolge im Moment keine Rolle spielt). Dementsprechend ist die Antwort <span class="math notranslate nohighlight">\(3\)</span>, die als <span class="math notranslate nohighlight">\({3 \choose 2}\)</span> geschrieben werden kann. Eine letzte Frage: Wie viele Kombinationen gibt es, um aus <span class="math notranslate nohighlight">\(3\)</span> Buchstaben genau drei Buchstaben zu ziehen? Fragen wir Python!</p>
<p>Zunächst wenden wir einen naiven Ansatz an, indem wir die obige Formel anwenden.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># n entspricht 3 Buchstaben von dog</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">3</span>
<span class="c1"># k entspricht wir ziehen 3 Buchstaben</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">k</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
<p>Wir können aber auch die eingebaute Funktion <code class="docutils literal notranslate"><span class="pre">math.comb()</span></code> verwenden, um die Anzahl der Kombinationen zu berechnen. Wir machen das für <span class="math notranslate nohighlight">\(k=1,2,3\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 3 über 1</span>
<span class="n">math</span><span class="o">.</span><span class="n">comb</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 3 über 2</span>
<span class="n">math</span><span class="o">.</span><span class="n">comb</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 3 über 3</span>
<span class="n">math</span><span class="o">.</span><span class="n">comb</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<p>Nun, da wir mit dem Konzept vertraut sind, wollen wir ein komplexeres Beispiel betrachten: Die SRH Hochschule bittet alle Absolventen, ihre <span class="math notranslate nohighlight">\(4\)</span> Lieblingskurse aus dem Studienplan zu wählen. Wie viele verschiedene Antworten könnten die Studierenden geben, wenn der Studienplan <span class="math notranslate nohighlight">\(24\)</span> Kurse zur Auswahl anbietet? Irgendwelche Vermutungen? Lassen Sie uns Python fragen!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">math</span><span class="o">.</span><span class="n">comb</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10626
</pre></div>
</div>
</div>
</div>
<p>Die Studenten können <span class="math notranslate nohighlight">\(10.626\)</span> verschiedene Antworten geben.</p>
</section>
<section id="bernoulli-versuche">
<h4>Bernoulli-Versuche<a class="headerlink" href="#bernoulli-versuche" title="Permalink to this headline">#</a></h4>
<p>Wiederholte Versuche eines Experiments werden als <strong>Bernoulli-Versuche</strong> bezeichnet, wenn die folgenden drei Bedingungen erfüllt sind:</p>
<ol class="simple">
<li><p>Das Experiment (jeder Versuch) hat zwei mögliche Ergebnisse, die mit <span class="math notranslate nohighlight">\(s\)</span> für Erfolg und <span class="math notranslate nohighlight">\(f\)</span> für Misserfolg bezeichnet werden.</p></li>
<li><p>Die Versuche sind unabhängig voneinander.</p></li>
<li><p>Die Wahrscheinlichkeit für einen Erfolg, die als Erfolgswahrscheinlichkeit bezeichnet wird und mit <span class="math notranslate nohighlight">\(p\)</span> bezeichnet wird, bleibt von Versuch zu Versuch gleich.</p></li>
</ol>
</section>
</section>
<section id="id3">
<h3>Die Binomialverteilung<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h3>
<p>Die Binomialverteilung ist die <strong>Wahrscheinlichkeitsverteilung</strong> für die Anzahl der Erfolge in einer Folge von <strong>Bernoulli-Versuchen</strong> (<span id="id4">[<a class="reference internal" href="intro.html#id8" title="Lothar Papula. Mathematik für Ingenieure und Naturwissenschaftler Band 3. Springer, 2016.">Papula, 2016</a>]</span> s.350).</p>
<section id="die-binomische-wahrscheinlichkeitsformel">
<h4>Die binomische Wahrscheinlichkeitsformel<a class="headerlink" href="#die-binomische-wahrscheinlichkeitsformel" title="Permalink to this headline">#</a></h4>
<p>Bei <span class="math notranslate nohighlight">\(n\)</span> Bernoulli-Versuchen ist die Anzahl der Ergebnisse, die genau <span class="math notranslate nohighlight">\(x\)</span> Erfolge enthalten, gleich dem Binomialkoeffizienten <span class="math notranslate nohighlight">\({n \choose x}\)</span> (<span id="id5">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.188).</p>
<p><span class="math notranslate nohighlight">\(X\)</span> sei die Gesamtzahl der Erfolge in <span class="math notranslate nohighlight">\(n\)</span> Bernoulli-Versuchen mit der Erfolgswahrscheinlichkeit <span class="math notranslate nohighlight">\(p\)</span>. Dann ist die Wahrscheinlichkeitsverteilung der Zufallsvariablen <span class="math notranslate nohighlight">\(X\)</span> gegeben durch:</p>
<div class="math notranslate nohighlight">
\[P(X = x) = {n \choose x}p^x(1 - p)^{n-x}, \qquad x = 0, 1, 2, \dots , n\]</div>
<p>Die Zufallsvariable <span class="math notranslate nohighlight">\(X\)</span> wird als <strong>Binomialzufallsvariable</strong> bezeichnet und folgt der Binomialverteilung mit den Parametern <span class="math notranslate nohighlight">\(n\)</span> und <span class="math notranslate nohighlight">\(p\)</span> (<span id="id6">[<a class="reference internal" href="intro.html#id8" title="Lothar Papula. Mathematik für Ingenieure und Naturwissenschaftler Band 3. Springer, 2016.">Papula, 2016</a>]</span> s.356).</p>
<p>Betrachten wir ein Beispiel aus der realen Welt.</p>
<p>Langzeitstatistiken besagen, dass die Chance, die Abschlussprüfung in Statistik zu bestehen, bei <span class="math notranslate nohighlight">\(0,3\)</span> liegt. Ja, etwa <span class="math notranslate nohighlight">\(70 \%\)</span> der Studenten fallen in der Statistikprüfung durch! Übrigens, wenn Sie dieses E-Learning-Modul absolvieren, werden Ihre Chancen, die Abschlussprüfung zu bestehen, definitiv steigen :-)</p>
<p>Betrachten wir eine Klasse mit <span class="math notranslate nohighlight">\(25\)</span> Studenten. Wie hoch ist die Wahrscheinlichkeit, dass genau <span class="math notranslate nohighlight">\(3\)</span> der Studenten dieser Klasse die Abschlussprüfung in Statistik bestehen werden? Oder anders ausgedrückt: <span class="math notranslate nohighlight">\(P(X=3)\)</span>. Auch hier beginnen wir mit der Implementierung eines naiven Ansatzes in Python.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Anzahl der Studenten</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">25</span>
<span class="c1"># Erfolgswahrscheinlichkeit</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="c1"># Anzahl der Studenten die die Prüfung bestehen</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">math</span><span class="o">.</span><span class="n">comb</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="n">p</span> <span class="o">**</span> <span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.02427998871170032
</pre></div>
</div>
</div>
</div>
<p>Wow, die Wahrscheinlichkeit, dass genau <span class="math notranslate nohighlight">\(3\)</span> von <span class="math notranslate nohighlight">\(25\)</span> Studierenden <span class="math notranslate nohighlight">\((P(X=3))\)</span> die Abschlussprüfung in Statistik bestehen, ist ziemlich gering. Wie sieht es mit der Wahrscheinlichkeit aus, dass genau <span class="math notranslate nohighlight">\(15\)</span> von <span class="math notranslate nohighlight">\(25\)</span> Studierenden <span class="math notranslate nohighlight">\((P(X=15))\)</span> die Abschlussprüfung in Statistik bestehen werden? Wir wenden uns an Python.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Anzahl der Studenten</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">25</span>
<span class="c1"># Erfolgswahrscheinlichkeit</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="c1"># Anzahl der Studenten die die Prüfung bestehen</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">15</span>

<span class="n">math</span><span class="o">.</span><span class="n">comb</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="n">p</span> <span class="o">**</span> <span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.001324897424235193
</pre></div>
</div>
</div>
</div>
<p>Die Wahrscheinlichkeit von <span class="math notranslate nohighlight">\(P(X=15)\)</span> beträgt etwa <span class="math notranslate nohighlight">\(0,1 \%\)</span>. Wir könnten mit unseren Experimenten fortfahren, um alle Wahrscheinlichkeiten für <strong>genau ein Ergebnis</strong> für <span class="math notranslate nohighlight">\(k=0,1,2, \dots ,n\)</span> herauszufinden. Bitte beachten Sie allerdings, dass es für unser spezielles Beispiel nicht sehr informativ ist, die Wahrscheinlichkeit für das Bestehen der Prüfung für genau eine bestimmte Anzahl <span class="math notranslate nohighlight">\((k)\)</span> von Studenten zu kennen. Für uns ist es von größerem Informationsinteresse, wenn wir die Frage beantworten könnten, wie hoch die Wahrscheinlichkeit ist, dass <span class="math notranslate nohighlight">\(k\)</span> oder weniger Studierende <span class="math notranslate nohighlight">\((P(X \le k))\)</span> die Prüfung bestehen, oder, was ebenso interessant ist, dass <span class="math notranslate nohighlight">\(k\)</span> oder mehr Studierende <span class="math notranslate nohighlight">\((P(X \ge k))\)</span> die Prüfung bestehen.</p>
<p>Als Übung wenden wir uns an Python und bestimmen die Wahrscheinlichkeit, dass <span class="math notranslate nohighlight">\(9\)</span> oder weniger Studierende die Abschlussprüfung in Statistik bestehen <span class="math notranslate nohighlight">\((P(X \le 9))\)</span>. Wir interessieren uns also für die Wahrscheinlichkeit, dass <span class="math notranslate nohighlight">\(0\)</span> von <span class="math notranslate nohighlight">\(25 \ \)</span>,<span class="math notranslate nohighlight">\( \ 1\)</span> von <span class="math notranslate nohighlight">\(25 \ \)</span>,<span class="math notranslate nohighlight">\( \ 2\)</span> von <span class="math notranslate nohighlight">\(25 \ \)</span>,<span class="math notranslate nohighlight">\( \ ...\)</span> oder <span class="math notranslate nohighlight">\(9\)</span> von <span class="math notranslate nohighlight">\(25\)</span> Studierenden die Prüfung bestehen. Um diese Wahrscheinlichkeit zu berechnen, können wir unseren naiven Ansatz erweitern und Folgendes berechnen</p>
<p><span class="math notranslate nohighlight">\(P(X = 0)+P(X = 1)+P(X = 2)+ \dots+P(X = 9)\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Anzahl der Studenten</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">25</span>
<span class="c1"># Erfolgswahrscheinlichkeit</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="c1"># Anzahl der maximalen Erfolge</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">9</span>

<span class="n">prob</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">prob_total</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Erzeuge for-loop</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">prob</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">comb</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="o">*</span> <span class="n">p</span> <span class="o">**</span> <span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">prob_total</span> <span class="o">+=</span> <span class="n">prob</span>
<span class="n">prob_total</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8105639764950532
</pre></div>
</div>
</div>
</div>
<p>Die Wahrscheinlichkeit, dass <span class="math notranslate nohighlight">\(9\)</span> oder weniger Studierende die Statistikprüfung bestehen <span class="math notranslate nohighlight">\((P(X≤9))\)</span>, beträgt <span class="math notranslate nohighlight">\(81,1 \%\)</span>. Das wiederum bedeutet, dass die Wahrscheinlichkeit, dass <span class="math notranslate nohighlight">\(10\)</span> oder mehr Studierende die Prüfung bestehen, <span class="math notranslate nohighlight">\(P(X&gt;9)=1-P(X≤9)\)</span> oder nur <span class="math notranslate nohighlight">\(18,9 \%\)</span> beträgt.</p>
<p>Neben der ehrlich gesagt recht unangenehmen Einsicht in die Statistik des Bestehens der Abschlussprüfung ist es klar, dass die naive Implementierung von oben ziemlich mühsam ist. Deshalb führen wir die eingebauten Funktionen <code class="docutils literal notranslate"><span class="pre">binom.pmf()</span></code> und <code class="docutils literal notranslate"><span class="pre">binom.cdf()</span></code> ein.</p>
<p>Die Verwendung von <code class="docutils literal notranslate"><span class="pre">binom.pmf()</span></code> ist wie folgt: <code class="docutils literal notranslate"><span class="pre">binom.pmf(k,</span> <span class="pre">n,</span> <span class="pre">p,</span> <span class="pre">loc)</span></code>. Wir lassen vorerst das Argument <code class="docutils literal notranslate"><span class="pre">loc</span></code> außer Acht. Somit vereinfacht sich die Funktion <code class="docutils literal notranslate"><span class="pre">binom.pmf()</span></code> zu <code class="docutils literal notranslate"><span class="pre">binom.pmf(k,</span> <span class="pre">n,</span> <span class="pre">p)</span></code>, wobei <span class="math notranslate nohighlight">\(k\)</span> den insgesamten Erfolgen, <span class="math notranslate nohighlight">\(n\)</span> der Gesamtanzahl und <span class="math notranslate nohighlight">\(p\)</span> der Wahrscheinlichkeit für das Bestehen der Prüfung entspricht. Um zu überprüfen, ob die Funktion <code class="docutils literal notranslate"><span class="pre">binom.pmf()</span></code> wie erwartet funktioniert, erinnern wir uns an unsere Testbeispiele von oben, nämlich <span class="math notranslate nohighlight">\(P(X=3)\)</span> und <span class="math notranslate nohighlight">\(P(X=15)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.024279988711700378
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0013248974242351943
</pre></div>
</div>
</div>
</div>
<p>Vergleichen Sie diese Ergebnisse mit den Ergebnissen unserer naiven Implementierung (scrollen Sie nach oben). Die Zahlen sollten übereinstimmen.</p>
<p>Die Funktion <code class="docutils literal notranslate"><span class="pre">binom.pmf()</span></code>  ist sehr praktisch, wenn wir Wahrscheinlichkeiten akkumulieren wollen, wie z. B. <span class="math notranslate nohighlight">\(P(X≤x)\)</span> oder <span class="math notranslate nohighlight">\(P(X&gt;x)\)</span>, denn wir können eine for - Schleife für das Argument <span class="math notranslate nohighlight">\(x\)</span> angeben und anschließend summieren. Betrachten wir das Beispiel von oben <span class="math notranslate nohighlight">\((P(X≤9))\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P_le9</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">P_le9</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">))</span>
<span class="n">P_le</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">P_le9</span><span class="p">)</span>
<span class="n">P_le</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8105639764950541
</pre></div>
</div>
</div>
</div>
<p>Eine weitere eingebaute Funktion, die für die Beantwortung von <span class="math notranslate nohighlight">\(P(X≤9)\)</span> geeignet ist, ist die Funktion <code class="docutils literal notranslate"><span class="pre">binom.pdf()</span></code>, die die Verteilungsfunktion zurückgibt. Die Funktion <code class="docutils literal notranslate"><span class="pre">binom.cdf()</span></code> berechnet die kumulative Wahrscheinlichkeitsverteilung und ist insofern praktisch, da wir auf den Aufruf der Summenfunktion verzichten können. Die Verwendung von <code class="docutils literal notranslate"><span class="pre">binom.cdf()</span></code> ist wie folgt:</p>
<p><code class="docutils literal notranslate"><span class="pre">binom.cdf(k,</span> <span class="pre">n,</span> <span class="pre">p,</span> <span class="pre">loc)</span></code>. Auch hier lassen wir das Argument <code class="docutils literal notranslate"><span class="pre">loc</span></code> außer Acht und belassen es bei <code class="docutils literal notranslate"><span class="pre">binom.cdf(k,</span> <span class="pre">n,</span> <span class="pre">p)</span></code>. Zusätzlich zu den Argumenten der Funktion <code class="docutils literal notranslate"><span class="pre">binom.cdf()</span></code> gilt zu beachten, dass <code class="docutils literal notranslate"><span class="pre">binom.cdf()</span></code>  die Wahrscheinlichkeiten <span class="math notranslate nohighlight">\(P(X≤x)\)</span> wiedergibt und <code class="docutils literal notranslate"><span class="pre">binom.sf(k,</span> <span class="pre">n,</span> <span class="pre">p)</span></code> <span class="math notranslate nohighlight">\(P(X&gt;x)\)</span> die Gegenwahrscheinlichkeit <code class="docutils literal notranslate"><span class="pre">1-binom.cdf()</span></code>.</p>
<p>Um dies zu verdeutlichen, lassen Sie uns <span class="math notranslate nohighlight">\(P(X≤9)\)</span> neu berechnen. Das Ergebnis der obigen Berechnung war <span class="math notranslate nohighlight">\(0,81056\)</span>. Nun wenden wir die Funktion <code class="docutils literal notranslate"><span class="pre">binom.cdf()</span></code> an, um das gleiche Ergebnis zu erhalten.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">binom</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8105639764950546
</pre></div>
</div>
</div>
</div>
<p>Um <span class="math notranslate nohighlight">\(P(X&gt;9)\)</span> zu erhalten, was dasselbe ist wie <span class="math notranslate nohighlight">\(1-P(X≤9)\)</span>, setzen wir das Argument</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">binom</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.18943602350494537
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="o">-</span> <span class="n">binom</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.18943602350494537
</pre></div>
</div>
</div>
</div>
<p>Um die <strong>binomische Wahrscheinlichkeitsverteilung</strong> zu visualisieren, verwenden wir die Funktion <code class="docutils literal notranslate"><span class="pre">binom.rvs()</span></code>, die Zufallsabweichungen für eine Binomialverteilung erzeugt, die durch ihre Größe <span class="math notranslate nohighlight">\(n\)</span> und die Erfolgs-/Misserfolgswahrscheinlichkeit <span class="math notranslate nohighlight">\(p\)</span> definiert ist.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Setze random seed für Reproduzierbarkeit</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Erzeuge y-Werte der Binomialverteilung</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>

<span class="c1"># Erzeuge Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">26</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Binomialverteilung: n=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2"> , p=</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Anzahl der Studenten die Prüfung bestehen&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Wahrscheinlichkeit (P=X)&quot;</span><span class="p">)</span>
<span class="n">bins</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/02_Die_Binomialverteilung_68_0.png" src="_images/02_Die_Binomialverteilung_68_0.png" />
</div>
</div>
<p>Zusätzlich visualisieren wir die oben diskutierten Wahrscheinlichkeiten: <span class="math notranslate nohighlight">\(P(X=3), P(X=15), P(X≤9), P(X&gt;9)\)</span> und die entsprechende <strong>kumulative binomiale Wahrscheinlichkeitsverteilungsfunktion</strong>.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Setze random seed für Reproduzierbarkeit</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Erzeuge y-Werte der Binomialverteilung</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">26</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.22</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Binomialverteilung: n=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2"> , p=</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Anzahl der Studenten die die Prüfung bestehen&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Wahrscheinlichkeit (P=X)&quot;</span><span class="p">)</span>
<span class="n">bins</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">26</span><span class="p">))</span>
<span class="c1"># Annotation</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="s2">&quot;P(X &gt; 9)&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mf">0.18</span><span class="p">),</span>
    <span class="n">xycoords</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">9.3</span><span class="p">,</span> <span class="mf">0.18</span><span class="p">),</span>
    <span class="n">textcoords</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.0005</span><span class="p">),</span>
    <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="s2">&quot;P(X &lt;= 9)&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.18</span><span class="p">),</span>
    <span class="n">xycoords</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">6.5</span><span class="p">,</span> <span class="mf">0.18</span><span class="p">),</span>
    <span class="n">textcoords</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.0005</span><span class="p">),</span>
    <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="s2">&quot;P(X = 15)&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">),</span>
    <span class="n">xycoords</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
    <span class="n">textcoords</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.0005</span><span class="p">),</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="s2">&quot;P(X = 3)&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">0.035</span><span class="p">),</span>
    <span class="n">xycoords</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
    <span class="n">textcoords</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.0005</span><span class="p">),</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/02_Die_Binomialverteilung_70_0.png" src="_images/02_Die_Binomialverteilung_70_0.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Erzeuge x und y Werte für kumulitative Wahrscheinlichkeit</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>
<span class="n">cdf</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">cdf</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">26</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Binomialverteilung: n = </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2"> , p = </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Anzahl der Studenten die die Prüfung bestehen&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Kumulative Wahrscheinlichkeit&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">binom</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.95</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span>
    <span class="n">y</span><span class="o">=</span><span class="n">binom</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">),</span>
    <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">xmax</span><span class="o">=</span><span class="mi">9</span> <span class="o">/</span> <span class="mf">24.5</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Annotations</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="s2">&quot;P(X &lt;= 9)&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">9.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span>
    <span class="n">xycoords</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">9.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span>
    <span class="n">textcoords</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="s2">&quot;P(X &lt;= 9) = 0.81)&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">),</span>
    <span class="n">xycoords</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">),</span>
    <span class="n">textcoords</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(1.5, 0.85, &#39;P(X &lt;= 9) = 0.81)&#39;)
</pre></div>
</div>
<img alt="_images/02_Die_Binomialverteilung_71_1.png" src="_images/02_Die_Binomialverteilung_71_1.png" />
</div>
</div>
<p>Zum Abschluss dieses Abschnitts und um Ihnen ein Gefühl für die Formen der verschiedenen binomischen Wahrscheinlichkeitsverteilungen zu vermitteln, werden im Folgenden drei verschiedene binomische Wahrscheinlichkeitsverteilungen und die entsprechenden kumulativen binomischen Beweisbarkeitsverteilungen für <span class="math notranslate nohighlight">\(p=0,1, p=0,5\)</span> und <span class="math notranslate nohighlight">\(p=0,9\)</span> angegeben.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>
<span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
    <span class="n">bins</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Wahrscheinlichkeit (P=X)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Wahrscheinlichkeit (P=X)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">26</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.30</span><span class="p">)</span>
    <span class="c1"># zweite Y-Achse</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
    <span class="n">cdf</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">cdf</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Kumulative Wahrscheinlichkeit&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/02_Die_Binomialverteilung_73_0.png" src="_images/02_Die_Binomialverteilung_73_0.png" />
</div>
</div>
</section>
</section>
<section id="mittelwert-und-standardabweichung-einer-binomialen-zufallsvariable">
<h3>Mittelwert und Standardabweichung einer binomialen Zufallsvariable<a class="headerlink" href="#mittelwert-und-standardabweichung-einer-binomialen-zufallsvariable" title="Permalink to this headline">#</a></h3>
<hr class="docutils" />
<p>Der Mittelwert und die Standardabweichung einer binomialen Zufallsvariablen mit den Parametern <span class="math notranslate nohighlight">\(n\)</span> und <span class="math notranslate nohighlight">\(p\)</span> sind jeweils</p>
<div class="math notranslate nohighlight">
\[\mu = np\]</div>
<p>und</p>
<div class="math notranslate nohighlight">
\[\sigma = np(1 - p)\text{,}\]</div>
<p>Erinnern wir uns an das Beispiel aus dem vorherigen Abschnitt. Die Wahrscheinlichkeit, die statistische Abschlussprüfung zu bestehen, beträgt <span class="math notranslate nohighlight">\(0,3\)</span>. Wir betrachten eine Klasse mit <span class="math notranslate nohighlight">\(25\)</span> Studenten. Die Zufallsvariable <span class="math notranslate nohighlight">\(X\)</span>, die dem Erfolg in der Prüfung entspricht, ist eine binomiale Zufallsvariable und folgt einer Binomialverteilung mit den Parametern <span class="math notranslate nohighlight">\(n=25\)</span> und <span class="math notranslate nohighlight">\(p=0,3\)</span>. Somit können der Mittelwert μ und die Standardabweichung <span class="math notranslate nohighlight">\(\sigma\)</span> wie folgt berechnet werden:</p>
<div class="math notranslate nohighlight">
\[\mu = np = 25 \times 0,3 = 7,5\]</div>
<p>und</p>
<div class="math notranslate nohighlight">
\[\sigma = np(1 - p) = 25 \times 0,3 \times (1-0,3) = 5,25\]</div>
<p>Die folgende Grafik zeigt die Binomialverteilung mit den Parametern <span class="math notranslate nohighlight">\(n=25\)</span> und <span class="math notranslate nohighlight">\(p=0,3\)</span> sowie deren Mittelwert <span class="math notranslate nohighlight">\(\mu\)</span> und Standardabweichung <span class="math notranslate nohighlight">\(\sigma\)</span>.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
<span class="n">mu</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">p</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">p</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">bins</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.225</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">26</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Binomialverteilung: n = </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2"> , p = </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Anzahl der Studenten die die Prüfung bestehen&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Wahrscheinlichkeit (P=X)&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">mu</span> <span class="o">-</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">mu</span> <span class="o">+</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="c1"># Annotation</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;$\mu$&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">7.5</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;$-\sigma$&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="s2">&quot;$+\sigma$&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">12.75</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">13.25</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(13.25, 0.2, &#39;$+\\sigma$&#39;)
</pre></div>
</div>
<img alt="_images/02_Die_Binomialverteilung_84_1.png" src="_images/02_Die_Binomialverteilung_84_1.png" />
</div>
</div>
</section>
<section id="binomiale-approximation-der-hypergeometrische-verteilung">
<h3>Binomiale Approximation der hypergeometrische Verteilung<a class="headerlink" href="#binomiale-approximation-der-hypergeometrische-verteilung" title="Permalink to this headline">#</a></h3>
<p>Häufig möchte man den Anteil (Prozentsatz) der Mitglieder einer endlichen Grundgesamtheit bestimmen, die ein bestimmtes Attribut aufweisen. Im Allgemeinen ist die betrachtete Grundgesamtheit zu groß, als dass der Grundgesamtheitsanteil durch eine Zählung ermittelt werden könnte. Nehmen wir an, dass eine einfache Zufallsstichprobe des Umfangs <span class="math notranslate nohighlight">\(n\)</span> aus einer Grundgesamtheit entnommen wird, in der der Anteil der Mitglieder, die ein bestimmtes Merkmal aufweisen, <span class="math notranslate nohighlight">\(p\)</span> ist. Dann ist eine Zufallsvariable von primärer Bedeutung für die Schätzung von <span class="math notranslate nohighlight">\(p\)</span> die Anzahl der Mitglieder der Stichprobe, die das bestimmte Merkmal aufweisen, die wir als <span class="math notranslate nohighlight">\(X\)</span> bezeichnen.Die genaue Wahrscheinlichkeitsverteilung von <span class="math notranslate nohighlight">\(X\)</span> hängt davon ab, ob die Stichprobe <strong>mit</strong> oder <strong>ohne Ersetzung</strong> durchgeführt wird. Wird die Stichprobe mit Ersetzung durchgeführt, handelt es sich um Bernoulli-Versuche: Jede Auswahl eines Mitglieds der Grundgesamtheit entspricht einem Versuch. Ein Versuch ist erfolgreich, wenn das in diesem Versuch ausgewählte Mitglied das angegebene Attribut aufweist; andernfalls ist er nicht erfolgreich. Die Versuche sind <strong>unabhängig</strong>, da die Stichprobe mit Ersetzung durchgeführt wird. Die Erfolgswahrscheinlichkeit bleibt von Versuch zu Versuch gleich, sie ist immer gleich dem Anteil der Grundgesamtheit, der das angegebene Merkmal aufweist. Daher hat die Zufallsvariable <span class="math notranslate nohighlight">\(X\)</span> die <strong>Binomialverteilung</strong> mit den Parametern <span class="math notranslate nohighlight">\(n\)</span> (der Stichprobenumfang) und <span class="math notranslate nohighlight">\(p\)</span> (der Anteil der Grundgesamtheit) (<span id="id7">[<a class="reference internal" href="intro.html#id8" title="Lothar Papula. Mathematik für Ingenieure und Naturwissenschaftler Band 3. Springer, 2016.">Papula, 2016</a>]</span> s.356).</p>
<p>In der Realität werden die Stichproben jedoch in der Regel <strong>ohne Ersetzung</strong> durchgeführt. Unter diesen Umständen handelt es sich bei dem Stichprobenverfahren nicht um Bernoulli-Versuche, da die Versuche <strong>nicht unabhängig</strong> sind und die Erfolgswahrscheinlichkeit von Versuch zu Versuch variiert. Mit anderen Worten: Die Zufallsvariable <span class="math notranslate nohighlight">\(X\)</span> hat keine Binomialverteilung. Ihre Verteilung wird als <a href="https://de.wikipedia.org/wiki/Hypergeometrische_Verteilung">hypergeometrische Verteilung</a> bezeichnet (<span id="id8">[<a class="reference internal" href="intro.html#id8" title="Lothar Papula. Mathematik für Ingenieure und Naturwissenschaftler Band 3. Springer, 2016.">Papula, 2016</a>]</span> s.364).</p>
<p>In der Praxis kann eine hypergeometrische Verteilung jedoch in der Regel durch eine Binomialverteilung angenähert werden. Der Grund dafür ist, dass es bei einem <strong>Stichprobenumfang von nicht mehr als 5 % der Grundgesamtheit</strong> kaum einen Unterschied zwischen einer Stichprobe mit und ohne Ersatz gibt (<span id="id9">[<a class="reference internal" href="intro.html#id8" title="Lothar Papula. Mathematik für Ingenieure und Naturwissenschaftler Band 3. Springer, 2016.">Papula, 2016</a>]</span> s.365).</p>
<section id="stichproben-und-die-binomialverteilung">
<h4>Stichproben und die Binomialverteilung<a class="headerlink" href="#stichproben-und-die-binomialverteilung" title="Permalink to this headline">#</a></h4>
<p>Angenommen, eine einfache Zufallsstichprobe des Umfangs <span class="math notranslate nohighlight">\(n\)</span> wird aus einer endlichen Grundgesamtheit entnommen, in der der Anteil der Mitglieder, die ein bestimmtes Merkmal aufweisen, <span class="math notranslate nohighlight">\(p\)</span> ist. Dann hat die Anzahl der in der Stichprobe enthaltenen Mitglieder, die das bestimmte Merkmal aufweisen</p>
<ul class="simple">
<li><p>eine exakte Binomialverteilung mit den Parametern <span class="math notranslate nohighlight">\(n\)</span> und <span class="math notranslate nohighlight">\(p\)</span>, wenn die Stichprobe mit Ersatz durchgeführt wird</p></li>
<li><p>eine näherungsweise Binomialverteilung mit den Parametern <span class="math notranslate nohighlight">\(n\)</span> und <span class="math notranslate nohighlight">\(p\)</span> wenn die Stichprobenziehung ohne Ersetzung erfolgt und der Stichprobenumfang nicht mehr als <span class="math notranslate nohighlight">\(5 \%\)</span> des Grundgesamtheitsumfangs beträgt (<span id="id10">[<a class="reference internal" href="intro.html#id8" title="Lothar Papula. Mathematik für Ingenieure und Naturwissenschaftler Band 3. Springer, 2016.">Papula, 2016</a>]</span> s.365).</p></li>
</ul>
</section>
</section>
</section>
<span id="document-Kapitel02/03_Die_Poisson_Verteilung"></span><section class="tex2jax_ignore mathjax_ignore" id="die-poisson-verteilung">
<h2>Die Poisson-Verteilung<a class="headerlink" href="#die-poisson-verteilung" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">poisson</span>
</pre></div>
</div>
</div>
</div>
<p>Eine weitere wichtige diskrete Wahrscheinlichkeitsverteilung ist die <a href="https://de.wikipedia.org/wiki/Poisson-Verteilung">Poisson-Verteilung</a>, benannt zu Ehren des französischen Mathematikers und Physikers <a href="https://de.wikipedia.org/wiki/Sim%C3%A9on_Denis_Poisson">Simeon D. Poisson</a> (1781-1840). Die Poisson-Verteilung wird häufig verwendet, um die Wahrscheinlichkeit zu beschreiben, dass eine Reihe von Ereignissen in einem bestimmten Zeit- oder Raumintervall eintritt, wobei die Wahrscheinlichkeit des Auftretens dieser Ereignisse sehr gering ist (<span id="id1">Papula [<a class="reference internal" href="intro.html#id8" title="Lothar Papula. Mathematik für Ingenieure und Naturwissenschaftler Band 3. Springer, 2016.">2016</a>]</span> s.367). Da die Anzahl der Versuche jedoch sehr groß ist, treten diese Ereignisse tatsächlich ein.</p>
<p>Die Zufallsvariable <span class="math notranslate nohighlight">\(X\)</span>, die als <strong>Poisson-Zufallsvariable</strong> bezeichnet wird, ist die Anzahl der Ereignisse (oder des Eintreffens) solcher Ereignisse in einem bestimmten Zeit- oder Raumintervall. Eine Poisson-Zufallsvariable hat unendlich viele mögliche Werte, nämlich alle ganzen Zahlen (<span id="id2">Fahrmeir <em>et al.</em> [<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">2016</a>]</span> s.242).</p>
<p>Unter der Annahme, dass <span class="math notranslate nohighlight">\(\lambda\)</span> der Erwartungswert solcher Ankünfte in einem Zeitintervall fester Länge ist, ist die Wahrscheinlichkeit, genau <span class="math notranslate nohighlight">\(x\)</span> Ereignisse zu beobachten, durch die Wahrscheinlichkeitsfunktion gegeben</p>
<div class="math notranslate nohighlight">
\[P(X = x) = e^{-\lambda}\frac{\lambda^x}{x!}, \qquad x = 0, 1, 2,\dots ,\]</div>
<p>wobei <span class="math notranslate nohighlight">\(\lambda\)</span> eine positive reelle Zahl ist, die die durchschnittliche Anzahl der Ereignisse während eines festen Zeitintervalls darstellt, und <span class="math notranslate nohighlight">\(e≈2,7182818\)</span> (die Eulersche Zahl). Somit wird jede bestimmte Poisson-Verteilung durch einen Parameter identifiziert, der gewöhnlich mit <span class="math notranslate nohighlight">\(\lambda\)</span> (dem griechischen Buchstaben Lambda) bezeichnet wird. Wenn das Ereignis beispielsweise durchschnittlich <span class="math notranslate nohighlight">\(10\)</span> Mal pro Sekunde auftritt, tritt es in <span class="math notranslate nohighlight">\(60\)</span> Sekunden durchschnittlich <span class="math notranslate nohighlight">\(600\)</span> Mal auf und <span class="math notranslate nohighlight">\(\lambda=600\)</span>.</p>
<section id="die-poisson-verteilung-ein-beispiel">
<h3>Die Poisson-Verteilung - ein Beispiel<a class="headerlink" href="#die-poisson-verteilung-ein-beispiel" title="Permalink to this headline">#</a></h3>
<p>Wenden wir die Poisson-Verteilung in Form eines Beispiels an. Wir konzentrieren uns auf das <a href="https://de.wikipedia.org/wiki/Jahrhunderthochwasser">Jahrhunderthochwasser</a>, ein Konzept, das im Flussbau häufig zur Planung von Hochwasserschutzmaßnahmen verwendet wird.</p>
<p>Erinnern wir uns an die mathematische Notation einer <strong>Poisson-Zufallsvariablen</strong>:</p>
<div class="math notranslate nohighlight">
\[ P(X = x) = e^{-\lambda}\frac{\lambda^x}{x!}, \qquad x = 0, 1, 2, \dots ,  \]</div>
<p>wobei <span class="math notranslate nohighlight">\(\lambda\)</span> eine positive reelle Zahl ist, die die durchschnittliche Anzahl der Ereignisse während eines festen Zeitintervalls darstellt, und <span class="math notranslate nohighlight">\(e≈2,7182818\)</span>.</p>
<p>Das <em>Jahrhunderthochwasser</em> ist eine Kurzbezeichnung für ein Hochwasser mit einer jährlichen Überschreitungswahrscheinlichkeit von <span class="math notranslate nohighlight">\(1 \%\)</span> und einem durchschnittlichen Wiederholungsintervall von <span class="math notranslate nohighlight">\(100\)</span> Jahren. Der Begriff kann jedoch für Menschen irreführend sein, denn sie stellen sich vor, dass der Begriff Hochwasser beschreibt, die einmal alle <span class="math notranslate nohighlight">\(100\)</span> Jahre auftreten. Dies ist jedoch nicht der Fall. Ein Hochwasser mit einer jährlichen Überschreitungswahrscheinlichkeit von <span class="math notranslate nohighlight">\(1 \%\)</span> bedeutet, dass in <strong>jedem</strong> einzelnen Jahr mit einer Wahrscheinlichkeit von <span class="math notranslate nohighlight">\(0,01\)</span> ein Hochwasser in einer Größenordnung auftritt, die einem Jahrhunderthochwasser entspricht.</p>
<p>Im Rahmen einer Poisson-Verteilung wird der Erwartungswert <span class="math notranslate nohighlight">\(E(x)=\lambda\)</span> eines solchen Hochwassers während des festen Intervalls von <span class="math notranslate nohighlight">\(100\)</span> Jahren auf <span class="math notranslate nohighlight">\(\lambda=100×0,01=1\)</span> gesetzt. Die Poisson-Zufallsvariable <span class="math notranslate nohighlight">\(X\)</span> ist also die Anzahl der Ereignisse, die natürlich je nach Fragestellung verschiedene Werte annehmen kann. Wir können uns für die Wahrscheinlichkeit interessieren, dass ein solches Hochwasserereignis während des <span class="math notranslate nohighlight">\(100\)</span>-Jahres-Intervalls nicht auftritt, <span class="math notranslate nohighlight">\(P(x=0)\)</span>, oder wir wollen die Wahrscheinlichkeit wissen, dass ein solches Hochwasserereignis genau einmal während des <span class="math notranslate nohighlight">\(100\)</span>-Jahres-Intervalls auftritt, also <span class="math notranslate nohighlight">\(P(x=1)\)</span>, oder wir wollen die Wahrscheinlichkeit wissen, dass zwei oder mehr solcher Hochwasserereignisse während des <span class="math notranslate nohighlight">\(100\)</span>-Jahres-Intervalls auftreten, also <span class="math notranslate nohighlight">\(P(x≥2)\)</span>. Setzt man diese Werte in die obige Gleichung ein, so erhält man</p>
<p><span class="math notranslate nohighlight">\(\lambda = 1, x = 0,1,2,\dots ,n\)</span></p>
<div class="math notranslate nohighlight">
\[P(X = 0) = e^{-1}\frac{1 \times 0}{0!}, \qquad \text{für } \  x = 0\]</div>
<div class="math notranslate nohighlight">
\[P(X = 1) = e^{-1}\frac{1 \times 1}{1!}, \qquad \text{für } \  x = 1\]</div>
<div class="math notranslate nohighlight">
\[ P(X \ge 2) = \sum_{i=2}^n e^{-1}\frac{1 \times x_i}{x_i!}, \qquad  \text{für } \  x_i = 2,3,\dots ,n \]</div>
<p>Wir wenden uns an Python, um die Berechnungen durchzuführen. Wir werden die Funktionen <code class="docutils literal notranslate"><span class="pre">poisson.pmf</span></code> und <code class="docutils literal notranslate"><span class="pre">poisson.cdf</span></code> verwenden.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_0</span> <span class="o">=</span> <span class="n">poisson</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x_0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.36787944117144233
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_1</span> <span class="o">=</span> <span class="n">poisson</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x_1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.36787944117144233
</pre></div>
</div>
</div>
</div>
<div class="math notranslate nohighlight">
\[ P(X \ge 2) = 1 -  P(X = 1) -  P(X = 0) \]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xge2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">x_1</span> <span class="o">-</span> <span class="n">x_0</span>
<span class="n">xge2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.26424111765711533
</pre></div>
</div>
</div>
</div>
<p>Alternativ können wir doe <code class="docutils literal notranslate"><span class="pre">poisson.cdf</span></code> verwenden.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="o">-</span> <span class="n">poisson</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.26424111765711533
</pre></div>
</div>
</div>
</div>
<p>Die Ergebnisse zeigen, dass die Wahrscheinlichkeit, dass während eines Zeitraums von <span class="math notranslate nohighlight">\(100\)</span> Jahren kein Hochwasser <span class="math notranslate nohighlight">\(P(X=0)\)</span> in einer Größenordnung auftritt, die einem Jahrhunderthochwasser entspricht, <span class="math notranslate nohighlight">\(0,37 \)</span> beträgt, was interessanterweise genauso wahrscheinlich ist wie das Auftreten von genau einem Hochwasser <span class="math notranslate nohighlight">\(P(X=1)\)</span>. Die Wahrscheinlichkeit, dass zwei oder mehr <span class="math notranslate nohighlight">\(P(X≥2)\)</span> solcher Hochwasserereignisse innerhalb des <span class="math notranslate nohighlight">\(100\)</span>-Jahres-Intervalls auftreten, ist <span class="math notranslate nohighlight">\(0,26\)</span> und damit geringer. Beachten Sie jedoch, dass die Wahrscheinlichkeit, dass zwei oder mehr <span class="math notranslate nohighlight">\(P(X≥2)\)</span> solcher Hochwasserereignisse während des 100-Jahres-Intervalls eintreten, etwa <span class="math notranslate nohighlight">\(26 \%\)</span> beträgt!</p>
<p>Zur Überprüfung der Richtigkeit addieren wir die Wahrscheinlichkeiten <span class="math notranslate nohighlight">\(P(x=0), P(x=1)\)</span> und <span class="math notranslate nohighlight">\(P(x≥2)\)</span>, was <span class="math notranslate nohighlight">\(1\)</span> ergeben sollte,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_0</span> <span class="o">+</span> <span class="n">x_1</span> <span class="o">+</span> <span class="n">xge2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
<p>Zur besseren Veranschaulichung stellen wir die Wahrscheinlichkeiten der Poisson-Zufallsvariablen <span class="math notranslate nohighlight">\(x=0,1,2,3,4,≥5\)</span> dar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="mi">5</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">poisson</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">poisson</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">res</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label_type</span><span class="o">=</span><span class="s2">&quot;edge&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Anzahl der Jahrhunderthochwasser&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Wahrscheinlichkeit (P=X)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Wahrscheinlichkeit (P=X)&#39;)
</pre></div>
</div>
<img alt="_images/03_Die_Poisson_Verteilung_30_1.png" src="_images/03_Die_Poisson_Verteilung_30_1.png" />
</div>
</div>
</section>
<section id="form-mittelwert-und-standardabweichung-einer-poisson-verteilung">
<h3>Form, Mittelwert und Standardabweichung einer Poisson-Verteilung<a class="headerlink" href="#form-mittelwert-und-standardabweichung-einer-poisson-verteilung" title="Permalink to this headline">#</a></h3>
<hr class="docutils" />
<p>Alle Poisson-Verteilungen sind rechtsschief. Der Mittelwert <span class="math notranslate nohighlight">\(\mu\)</span> und die Standardabweichung <span class="math notranslate nohighlight">\(\sigma\)</span> einer Poisson-Zufallsvariablen mit dem Parameter <span class="math notranslate nohighlight">\(\lambda\)</span> sind</p>
<div class="math notranslate nohighlight">
\[\mu = \lambda\]</div>
<p>und</p>
<div class="math notranslate nohighlight">
\[\sigma = \sqrt{\lambda}\text{.}\]</div>
</section>
<section id="poisson-approximation-an-die-binomialverteilung">
<h3>Poisson-Approximation an die Binomialverteilung<a class="headerlink" href="#poisson-approximation-an-die-binomialverteilung" title="Permalink to this headline">#</a></h3>
<hr class="docutils" />
<p>In Situationen, in denen <span class="math notranslate nohighlight">\(n\)</span> groß und <span class="math notranslate nohighlight">\(p\)</span> sehr klein ist, kann die Poisson-Verteilung zur Annäherung an die Binomialverteilung verwendet werden. Erinnern Sie sich an die binomische Wahrscheinlichkeitsverteilung:</p>
<div class="math notranslate nohighlight">
\[P(X = x) = {n \choose x}p^x(1-p)^{n-x}, \qquad x = 0, 1, 2, \dots , n \]</div>
<p>Wie im früheren Beispiel “Jahrhunderthochwasser” ist <span class="math notranslate nohighlight">\(n\)</span> eine große Zahl <span class="math notranslate nohighlight">\((100)\)</span> und <span class="math notranslate nohighlight">\(p\)</span> eine kleine Zahl <span class="math notranslate nohighlight">\((0,01)\)</span>. Einsetzen in die Gleichung von oben <span class="math notranslate nohighlight">\(P(x=1)\)</span> ergibt</p>
<p><span class="math notranslate nohighlight">\( P(X = 1)  = {100 \choose 1}\times 0,01^1\times (1 - 0,01)^{100 -1} \)</span></p>
<p><span class="math notranslate nohighlight">\( = 100\times 0,01\times 0,3697296 \)</span></p>
<p><span class="math notranslate nohighlight">\( = 0,3697296 \)</span></p>
<p>Das Ergebnis kommt dem oben ermittelten Ergebnis sehr nahe <code class="docutils literal notranslate"><span class="pre">poisson.pmf(1,1)</span></code> <span class="math notranslate nohighlight">\(= 0,3678794\)</span>. Die geeignete Poisson-Verteilung ist diejenige, deren Mittelwert gleich dem der Binomialverteilung ist, d. h. <span class="math notranslate nohighlight">\(\lambda=np\)</span>, was in unserem Beispiel <span class="math notranslate nohighlight">\(\lambda=100×0,01=1\)</span> ist.</p>
<p>Zum Abschluss dieses Abschnitts und um Ihnen eine Vorstellung von den Formen der verschiedenen Poisson-Wahrscheinlichkeitsverteilungen zu geben, werden im Folgenden drei verschiedene Poisson-Wahrscheinlichkeitsverteilungen und die entsprechenden kumulativen Poisson-Wahrscheinlichkeitsverteilungen für <span class="math notranslate nohighlight">\(\lambda=2,5, \lambda=7\)</span> und <span class="math notranslate nohighlight">\(\lambda=12\)</span> angegeben.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lambdas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">lambdas</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
<span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">_lambda</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lambdas</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">poisson</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">_lambda</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
    <span class="n">bins</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Anzahl der Ereignisse&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Wahrscheinlichkeit (P=X)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;$\mu$ = </span><span class="si">{</span><span class="n">_lambda</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">cdf</span> <span class="o">=</span> <span class="n">poisson</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">_lambda</span><span class="p">)</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Kumulative Wahrscheinlichkeit&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">cdf</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/03_Die_Poisson_Verteilung_43_0.png" src="_images/03_Die_Poisson_Verteilung_43_0.png" />
</div>
</div>
</section>
</section>
<span id="document-Aufgaben/Kapitel02/Aufgaben"></span><section class="tex2jax_ignore mathjax_ignore" id="ubungsaufgaben">
<h2>Übungsaufgaben<a class="headerlink" href="#ubungsaufgaben" title="Permalink to this headline">#</a></h2>
<div class="toctree-wrapper compound">
<span id="document-Aufgaben/Kapitel02/Hewert"></span><section class="tex2jax_ignore mathjax_ignore" id="haufigkeiten-und-erwartungswert">
<h3>Häufigkeiten und Erwartungswert<a class="headerlink" href="#haufigkeiten-und-erwartungswert" title="Permalink to this headline">#</a></h3>
<p>Betrachten wir den Würfelwurf für einen fairen sechseitigen Würfel.
Bei <span class="math notranslate nohighlight">\(10\)</span> Würfen werden die folgenden Zahlen gewürfelt: <span class="math notranslate nohighlight">\(1,1,2,5,6,3,4,2,4,5\)</span></p>
<ol class="simple">
<li><p>Erklären Sie anhand dieser Stichprobe relative und absolute Häufigkeiten.</p></li>
<li><p>Berechnen Sie den Erwartungswert der Stichprobe.</p></li>
<li><p>Berechnen Sie den Erwartungswert für einen Würfel unter der Annahme von Laplacewahrscheinlichkeit (gleicher Wahrscheinlichkeit für alle <span class="math notranslate nohighlight">\(x_i\)</span> von <span class="math notranslate nohighlight">\(X\)</span>)</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 1 ...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 2 ...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 3 ...</span>
</pre></div>
</div>
</div>
</div>
<section id="losungen">
<h4>Lösungen<a class="headerlink" href="#losungen" title="Permalink to this headline">#</a></h4>
<p><strong>Frage 1</strong></p>
<p><strong>Absolute Häufigkeiten</strong> <span class="math notranslate nohighlight">\(h(a_j)=h_j\)</span> entsprechen der Anzahl der Ereignisse/Elemente/Messergebnisse <span class="math notranslate nohighlight">\(x_i\)</span> für die gilt <span class="math notranslate nohighlight">\(x_i = a_j\)</span>.
<strong>Relative Häufigkeiten</strong>  entsprechen den <strong>absoluten Häufigkeiten</strong> geteilt durch die Gesamtanzahl <span class="math notranslate nohighlight">\(n\)</span> betrachteten Ereignisse/Elemente/Messergebnisse <span class="math notranslate nohighlight">\(f(a_j)=f_j=\frac{h_j}{n}\)</span>
(<span id="id1">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.30).</p>
<p>Angewandt auf die Stichprobe ergeben sich die absoluten und relativen Häufigkeiten wie folgt:</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(X\)</span></p></th>
<th class="text-align:center head"><p>Absolute Häufigkeit</p></th>
<th class="text-align:center head"><p>Relative Häufigkeit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td class="text-align:center"><p>2</p></td>
<td class="text-align:center"><p>0,2</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td class="text-align:center"><p>2</p></td>
<td class="text-align:center"><p>0,2</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p>0,1</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td class="text-align:center"><p>2</p></td>
<td class="text-align:center"><p>0,2</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td class="text-align:center"><p>2</p></td>
<td class="text-align:center"><p>0,2</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p>0,1</p></td>
</tr>
</tbody>
</table>
<p><strong>Frage 2</strong></p>
<div class="math notranslate nohighlight">
\[E(X) = \sum_{i=1}^6 P(x_i) x_i = 1 \cdot 0,2 + 2 \cdot 0,2 + 3 \cdot 0,1 + 4 \cdot 0,2 + 5 \cdot 0,2 + 6 \cdot 0,1 = 3,3\]</div>
<p><strong>Frage 3</strong></p>
<p>Da von Laplacewahrscheinlichkeit ausgegangen werden kann gilt: <span class="math notranslate nohighlight">\(P(x_i)= \frac{1}{6} \approx 0,167\)</span></p>
<div class="math notranslate nohighlight">
\[E(X) = \sum_{i=1}^6 P(x_i) x_i = 1 \cdot 0,167 + 2 \cdot 0,167 + 3 \cdot 0,167 + 4 \cdot 0,167 + 5 \cdot 0,167 + 6 \cdot 0,167 = 3,5\]</div>
</section>
</section>
<span id="document-Aufgaben/Kapitel02/Normierung"></span><section class="tex2jax_ignore mathjax_ignore" id="normierung">
<h3>Normierung<a class="headerlink" href="#normierung" title="Permalink to this headline">#</a></h3>
<p>Eine Zufallsvariable <span class="math notranslate nohighlight">\(X\)</span> kann die Werte <span class="math notranslate nohighlight">\(1,2,3,4\)</span> annehmen. Angenommen <span class="math notranslate nohighlight">\(f(x) = P(X = x)\)</span> ist die dazugehörige Wahrscheinlichkeitsfunktion und ist gegeben durch:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
     f(x)=\left\{\begin{array}{ll} \frac{x (b - x)}{10}, &amp; x\in \{ 1,2,3,4 \} \\
         0, &amp; \text{sonst}\end{array}\right. .
  \end{split}\]</div>
<p>Wie muß <span class="math notranslate nohighlight">\(b\)</span> gewählt werden um die Normierung der Wahrscheinlichkeitsfunktion zu gewährleisten ?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 1 ...</span>
</pre></div>
</div>
</div>
</div>
<section id="losungen">
<h4>Lösungen<a class="headerlink" href="#losungen" title="Permalink to this headline">#</a></h4>
<p>Um die Wahrscheinlichkeitsfunktion zu normieren muß</p>
<div class="math notranslate nohighlight">
\[\sum_{i=1}^n f(x_i) = 1\]</div>
<p>gelten.</p>
<div class="math notranslate nohighlight">
\[\sum_{i=1}^4 f(x_i) = \frac{1 \cdot (b-1)}{10} + \frac{2 \cdot (b-2)}{10} + \frac{3 \cdot (b-3)}{10} + \frac{4 \cdot (b-4)}{10} = 1\]</div>
<div class="math notranslate nohighlight">
\[ (b-1)+ (2b-4) + (3b-9) + (4b - 16)  = 10\]</div>
<div class="math notranslate nohighlight">
\[ b + 2b + 3b + 4b-1-4-9-16  = 10\]</div>
<div class="math notranslate nohighlight">
\[  10b-30  = 10 \]</div>
<div class="math notranslate nohighlight">
\[\Rightarrow b = 4\]</div>
</section>
</section>
<span id="document-Aufgaben/Kapitel02/binomial"></span><section class="tex2jax_ignore mathjax_ignore" id="binomialverteilung">
<h3>Binomialverteilung<a class="headerlink" href="#binomialverteilung" title="Permalink to this headline">#</a></h3>
<p>In einer Fabrik werden serienmäßig Tübel mit einem Ausschussanteil von <span class="math notranslate nohighlight">\(4,5\%\)</span> hergestellt, d. h. unter <span class="math notranslate nohighlight">\(1000\)</span> hergestellten Tübel befinden sich im Mittel genau <span class="math notranslate nohighlight">\(45\)</span> unbrauchbare Tübel.</p>
<ol class="simple">
<li><p>Mit welchen Wahrscheinlichkeiten finden wir in einer Zufallsstichprobe von <span class="math notranslate nohighlight">\(10\)</span> Tübel genau <span class="math notranslate nohighlight">\(0, 1, 3, 5, 8\)</span> unbrauchbare Tübel?</p></li>
<li><p>Mit welchen Wahrscheinlichkeiten finden wir in einer Zufallsstichprobe von <span class="math notranslate nohighlight">\(10\)</span> Tübel <span class="math notranslate nohighlight">\(3\)</span> oder mehr unbrauchbare Tübel?</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 1 ...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 2 ...</span>
</pre></div>
</div>
</div>
</div>
<section id="losungen">
<h4>Lösungen<a class="headerlink" href="#losungen" title="Permalink to this headline">#</a></h4>
<p>Es handelt sich hier um ein Bernoulli-Experiment. Die Wahrscheinlichkeit, beim Ziehen eines Tübels einen unbrauchbaren Tübels zu erhalten, liegt bei <span class="math notranslate nohighlight">\(p=0,04\)</span>. Die Zufallsvariable folgt der Binomialverteilung mit den Parametern <span class="math notranslate nohighlight">\(n=10\)</span> und <span class="math notranslate nohighlight">\(p=0,4\)</span>.</p>
<p>Somit ergbit sich</p>
<div class="math notranslate nohighlight">
\[P(X=x)= \binom{10}{x} \times 0,04^x \times (1-0,04)^{(10-x)} \qquad (x=0,1,3,5,8)\]</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">binom</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">]:</span>
    <span class="n">rv</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;For x=</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2"> the probabilty is </span><span class="si">{</span><span class="n">rv</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>For x=0 the probabilty is 0.6648326359915008
For x=1 the probabilty is 0.277013598329792
For x=3 the probabilty is 0.00577111663187067
For x=5 the probabilty is 2.104052938702848e-05
For x=8 the probabilty is 2.7179089920000016e-10
</pre></div>
</div>
</div>
</div>
<div class="math notranslate nohighlight">
\[P(X \geq3) = 1 - P(X =0) - P(X =1) - P(X =2)\]</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">binom</span>

<span class="c1"># version 1</span>
<span class="n">rv</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
    <span class="n">rv</span> <span class="o">+=</span> <span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[version 1] The probabilty is is </span><span class="si">{</span><span class="mi">1</span> <span class="o">-</span> <span class="n">rv</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># version 2</span>
<span class="n">rv</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">binom</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[version 2] The probabilty is is </span><span class="si">{</span><span class="n">rv</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[version 1] The probabilty is is 0.00621371599187126
[version 2] The probabilty is is 0.006213715991870816
</pre></div>
</div>
</div>
</div>
</section>
</section>
</div>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-Lernziele/Kapitel3_Lernziele"></span><section class="tex2jax_ignore mathjax_ignore" id="lernziele">
<h2>Lernziele<a class="headerlink" href="#lernziele" title="Permalink to this headline">#</a></h2>
<section id="stetige-zufallsvariablen">
<h3>Stetige Zufallsvariablen<a class="headerlink" href="#stetige-zufallsvariablen" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Die Konzepte von diskreten Zufallsvariablen werden auf stetige Zufallsvariablen und ihre Wahrscheinlichkeitsverteilungen verallgemeinert</p></li>
<li><p>Die Wahrscheinlichkeitsdichtefunktion und ihre Rolle in der  Konstruktion von Wahrscheinlichkeitsverteilungen wird erläutert. Insbesonders werden Normalverteilung, die Standard-Normalverteilung und die Umrechnung auf standardisierte Zufallsvariablen, kontinuierliche gleichmäßige Verteilung, Studentsche t-Verteilung, Chi-Quadrat-Verteilung und F-Verteilung besprochen</p></li>
<li><p>Es wird erklärt wie diese Warscheinlichkeitsverteilungen berechnet werden können und deren Syntax und Anwendungen durch Beispiele in Python veranschaulicht</p></li>
<li><p>Zusammengefasst werden folgende Begriffe und Methoden besprochen : stetige Zufallsvariablen, Wahrscheinlichkeitsdichtefunktionen, Normalverteilung, Standard-Normalverteilung, kontinuierliche gleichmäßige Verteilung, Studentsche t-Verteilung, Chi-Quadrat-Verteilung, F-Verteilung</p></li>
</ul>
</section>
</section>
<span id="document-Kapitel03/01_stetige_Zufallsvariablen"></span><section class="tex2jax_ignore mathjax_ignore" id="stetige-zufallsvariablen-und-ihre-wahrscheinlichkeitsverteilungen">
<h2>Stetige Zufallsvariablen und ihre Wahrscheinlichkeitsverteilungen<a class="headerlink" href="#stetige-zufallsvariablen-und-ihre-wahrscheinlichkeitsverteilungen" title="Permalink to this headline">#</a></h2>
<p>Eine <a href="https://de.wikipedia.org/wiki/Zufallsvariable">Zufallsvariable</a>, deren Werte nicht abzählbar sind, nennt man eine <strong>stetige Zufallsvariable</strong>. D.h. eine kontinuierliche Zufallsvariable kann jeden Wert annehmen (z.B. reelle Zahlenwerte), der in einem oder mehreren Intervallen enthalten ist. Da die Anzahl der in einem Intervall enthaltenen Werte unendlich ist, ist auch die mögliche Anzahl der Werte, die eine kontinuierliche Zufallsvariable annehmen kann, unendlich (<span id="id1">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.251).</p>
<p>Es gibt viel mehr <a href="https://de.wikipedia.org/wiki/Liste_univariater_Wahrscheinlichkeitsverteilungen#Stetige_Verteilungen">kontinuierliche Wahrscheinlichkeitsverteilungen</a>, als wir hier besprechen können. Beachten Sie jedoch, dass in Python mittlerweile eine große Anzahl verschiedener diskreter und kontinuierlicher Wahrscheinlichkeitsverteilungen implementiert sind, siehe <a href="https://docs.scipy.org/doc/scipy/reference/stats.html">hier</a>.</p>
<p>In Python sind Wahrscheinlichkeitsfunktionen durch allgemeine Methoden wie <code class="docutils literal notranslate"><span class="pre">rvs</span></code>, <code class="docutils literal notranslate"><span class="pre">pdf</span></code>, <code class="docutils literal notranslate"><span class="pre">cdf</span></code> und <code class="docutils literal notranslate"><span class="pre">ppf</span></code> zugänglich. <code class="docutils literal notranslate"><span class="pre">rvs</span></code> ist das allgemeine Syntax für Zufallsvariablengeneratoren wie <code class="docutils literal notranslate"><span class="pre">uniform.rvs()</span></code> für die Gleichverteilung oder <code class="docutils literal notranslate"><span class="pre">norm.rvs()</span></code> für die Normalverteilung. <code class="docutils literal notranslate"><span class="pre">pdf</span></code> ist Methode für die Wahrscheinlichkeitsdichtefunktion wie <code class="docutils literal notranslate"><span class="pre">uniform.pdf</span></code> und <code class="docutils literal notranslate"><span class="pre">norm.pdf()</span></code>. Das <code class="docutils literal notranslate"><span class="pre">cdf</span></code> ist der Syntax für die kumulative Dichtefunktion wie <code class="docutils literal notranslate"><span class="pre">uniform.cdf()</span></code> und <code class="docutils literal notranslate"><span class="pre">norm.cdf()</span></code>. Das <code class="docutils literal notranslate"><span class="pre">ppf</span></code> ist der allgemeine Syntax für die Quantilfunktion, wie <code class="docutils literal notranslate"><span class="pre">uniform.ppf()</span></code> und <code class="docutils literal notranslate"><span class="pre">norm.ppf()</span></code>. Behalten Sie das im Hinterkopf, wenn wir die Kapazitäten in Python weiter erforschen.</p>
<section id="wahrscheinlichkeitsdichtefunktionen">
<h3>Wahrscheinlichkeitsdichtefunktionen<a class="headerlink" href="#wahrscheinlichkeitsdichtefunktionen" title="Permalink to this headline">#</a></h3>
<p>Die Form der Verteilung einer Zufallsvariablen kann durch eine glatte Kurve veranschaulicht werden. Solche Kurven, die die Verteilung von kontinuierlichen Variablen darstellen, werden <strong>Wahrscheinlichkeitsdichtefunktionen (PDF)</strong> oder einfach <strong>Dichtefunktionen</strong> genannt. <a href="https://de.wikipedia.org/wiki/Wahrscheinlichkeitsdichtefunktion">Wahrscheinlichkeitsdichtefunktionen</a> haben drei Haupteigenschaften (<span id="id2">[<a class="reference internal" href="intro.html#id8" title="Lothar Papula. Mathematik für Ingenieure und Naturwissenschaftler Band 3. Springer, 2016.">Papula, 2016</a>]</span> s.327):</p>
<ol class="simple">
<li><p>Eine PDF wird immer auf oder über der horizontalen Achse gezeichnet</p></li>
<li><p>Die Gesamtfläche zwischen einer PDF und der horizontalen Achse ist gleich <span class="math notranslate nohighlight">\(1\)</span> und somit liegt  jeder Wert in jedem Teilintervall der PDF im Bereich von <span class="math notranslate nohighlight">\(0\)</span> bis <span class="math notranslate nohighlight">\(1\)</span></p></li>
<li><p>Alle möglichen Beobachtungen der Variablen, die innerhalb eines bestimmten Bereichs liegen, entsprechen der entsprechenden Fläche unter der Dichtefunktion und können als prozentueller Anteil ausgedrückt werden.</p></li>
</ol>
<p>Die Fläche unter der Kurve wird durch das Integral des Wertes <span class="math notranslate nohighlight">\(x\)</span> von <span class="math notranslate nohighlight">\(-\infty\)</span> bis <span class="math notranslate nohighlight">\(+\infty\)</span> berechnet und in der Regel auf den Wert <span class="math notranslate nohighlight">\(1\)</span> normiert.</p>
<div class="math notranslate nohighlight">
\[ \int_{-\infty}^{+\infty} f(x)dx = 1 \]</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">f</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">v1</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">v2</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="c1"># ax.fill_between(x, f.pdf(x), where=x &lt;= z, color=&quot;r&quot;, alpha=0.5)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dfn</span><span class="o">=</span><span class="n">v1</span><span class="p">,</span> <span class="n">dfd</span><span class="o">=</span><span class="n">v2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="mi">2</span><span class="p">,</span>
    <span class="mf">0.7</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="s2">&quot;Die Fläche unter der Kurve</span><span class="se">\n</span><span class="s2">beträgt 1 oder 100%&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="mi">2</span><span class="p">,</span>
    <span class="mf">0.4</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\int_{-\infty}^\infty f(x)dx=1$&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(2, 0.4, &#39;$\\int_{-\\infty}^\\infty f(x)dx=1$&#39;)
</pre></div>
</div>
<img alt="_images/01_stetige_Zufallsvariablen_10_1.png" src="_images/01_stetige_Zufallsvariablen_10_1.png" />
</div>
</div>
<p>Die Wahrscheinlichkeit, dass eine stetige Zufallsvariable <span class="math notranslate nohighlight">\(x\)</span> einen Wert innerhalb eines bestimmten Intervalls annimmt, ist durch die Fläche unter der Kurve zwischen den beiden Grenzen des Intervalls gegeben. Die farbige Fläche unter der Kurve für das Intervall <span class="math notranslate nohighlight">\(]-\infty \ \)</span>,<span class="math notranslate nohighlight">\( \ a]\)</span> (linkes Feld) und für das Intervall <span class="math notranslate nohighlight">\([a \ \)</span>,<span class="math notranslate nohighlight">\( \ +\infty[\)</span> (rechtes Feld) ist in der folgenden Abbildung dargestellt.</p>
<p>Die Wahrscheinlichkeit, dass <span class="math notranslate nohighlight">\(x\)</span> in das Intervall <span class="math notranslate nohighlight">\(]-\infty \ \)</span>,<span class="math notranslate nohighlight">\( \ a]\)</span> fällt, ist</p>
<div class="math notranslate nohighlight">
\[P(X \le a) = \int_{-\infty}^{a}f(x)dx\]</div>
<p>und die Wahrscheinlichkeit, dass <span class="math notranslate nohighlight">\(x\)</span> in das Intervall <span class="math notranslate nohighlight">\([a \ \)</span>,<span class="math notranslate nohighlight">\( \ \infty[\)</span> fällt, ist</p>
<div class="math notranslate nohighlight">
\[P(X \ge a) = 1 - P(X \le a) = \int_{a}^{\infty}f(x)dx\]</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">f</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">a</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">v1</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">v2</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>


<span class="k">for</span> <span class="n">_ax</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">:</span>
    <span class="n">_ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
    <span class="n">_ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
    <span class="n">_ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">_ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
        <span class="mf">2.5</span><span class="p">,</span>
        <span class="mf">0.7</span><span class="p">,</span>
        <span class="n">s</span><span class="o">=</span><span class="s2">&quot;Die Fläche unter der Kurve</span><span class="se">\n</span><span class="s2">liegt zwischen 0 und 1&quot;</span><span class="p">,</span>
        <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span>
    <span class="p">)</span>


<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dfn</span><span class="o">=</span><span class="n">v1</span><span class="p">,</span> <span class="n">dfd</span><span class="o">=</span><span class="n">v2</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">a</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="mf">2.5</span><span class="p">,</span>
    <span class="mf">0.45</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$P(X \leq a) = \int_{-\infty}^a f(x)dx$&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
<span class="p">)</span>


<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dfn</span><span class="o">=</span><span class="n">v1</span><span class="p">,</span> <span class="n">dfd</span><span class="o">=</span><span class="n">v2</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">a</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="mf">2.5</span><span class="p">,</span>
    <span class="mf">0.45</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$P(X \geq a) = \int_a^\infty f(x)dx$&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(2.5, 0.45, &#39;$P(X \\geq a) = \\int_a^\\infty f(x)dx$&#39;)
</pre></div>
</div>
<img alt="_images/01_stetige_Zufallsvariablen_16_1.png" src="_images/01_stetige_Zufallsvariablen_16_1.png" />
</div>
</div>
<p>Die Wahrscheinlichkeit, dass eine kontinuierliche Zufallsvariable <span class="math notranslate nohighlight">\(x\)</span> einen Wert innerhalb eines bestimmten Intervalls annimmt, ist durch die Fläche unter der Kurve zwischen den beiden Grenzen des Intervalls gegeben. Der Wert der farbige Fläche unter der Kurve von <span class="math notranslate nohighlight">\(a\)</span> bis <span class="math notranslate nohighlight">\(b\)</span> in der folgenden Abbildung gibt die Wahrscheinlichkeit an, dass <span class="math notranslate nohighlight">\(x\)</span> in das Intervall <span class="math notranslate nohighlight">\([a \ \)</span>,<span class="math notranslate nohighlight">\( \ b]\)</span> fällt.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">f</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">a</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">b</span> <span class="o">=</span> <span class="mf">1.6</span>
<span class="n">v1</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">v2</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dfn</span><span class="o">=</span><span class="n">v1</span><span class="p">,</span> <span class="n">dfd</span><span class="o">=</span><span class="n">v2</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">a</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="mi">2</span><span class="p">,</span>
    <span class="mf">0.7</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="s2">&quot;Die Fläche unter der Kurve</span><span class="se">\n</span><span class="s2">entspricht der Wahrscheinlichkeit</span><span class="se">\n</span><span class="s2">$P(a\leq  x\leq  b)$&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="mf">2.2</span><span class="p">,</span>
    <span class="mf">0.4</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$P(a\leq  x\leq  b) = \int_a^b f(x)dx$&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(2.2, 0.4, &#39;$P(a\\leq  x\\leq  b) = \\int_a^b f(x)dx$&#39;)
</pre></div>
</div>
<img alt="_images/01_stetige_Zufallsvariablen_18_1.png" src="_images/01_stetige_Zufallsvariablen_18_1.png" />
</div>
</div>
<p><span class="math notranslate nohighlight">\( P(a \le x \le b) = \int_{a}^{b}f(x)dx\)</span></p>
<p><span class="math notranslate nohighlight">\( = P(x \le b) - P(x \le a) \)</span></p>
<p><span class="math notranslate nohighlight">\( = \int_{-\infty}^{b}f(x)dx - \int_{-\infty}^{a}f(x)dx \)</span></p>
<p>Man beachte, dass das Intervall <span class="math notranslate nohighlight">\(a\le x \le b\)</span> besagt, dass <span class="math notranslate nohighlight">\(x\)</span> größer oder gleich <span class="math notranslate nohighlight">\(a\)</span>, aber kleiner oder gleich <span class="math notranslate nohighlight">\(b\)</span> ist.</p>
<p>Bei einer kontinuierlichen Wahrscheinlichkeitsverteilung wird die Wahrscheinlichkeit immer für ein Intervall berechnet. <strong>Die Wahrscheinlichkeit, dass eine kontinuierliche Zufallsvariable <span class="math notranslate nohighlight">\(x\)</span> einen einzigen Wert annimmt, ist immer Null</strong>. Das liegt daran, dass die Wahrscheinlichkeit, genau einen Wert aus einer unendlichen Anzahl von Werten <span class="math notranslate nohighlight">\(\in \mathbb R\)</span> zu wählen, gleich Null ist. Im geometrischen Sinne bedeutet dies, dass die Fläche einer Linie, die einen einzigen Punkt darstellt, Null ist.</p>
<div class="math notranslate nohighlight">
\[P(x) = 0\]</div>
<p>Daraus lässt sich ableiten, dass für eine stetige Zufallsvariable gilt</p>
<div class="math notranslate nohighlight">
\[P(a \le x \le b) = P(a &lt; x &lt; b)\]</div>
<p>Mit anderen Worten: Die Wahrscheinlichkeit, dass <span class="math notranslate nohighlight">\(x\)</span> einen Wert im Intervall <span class="math notranslate nohighlight">\(a\)</span> bis <span class="math notranslate nohighlight">\(b\)</span> annimmt, ist gleich groß, unabhängig davon, ob die Werte <span class="math notranslate nohighlight">\(a\)</span> und <span class="math notranslate nohighlight">\(b\)</span> im Intervall enthalten sind oder nicht.</p>
</section>
</section>
<span id="document-Kapitel03/02_Die Normalverteilung"></span><section class="tex2jax_ignore mathjax_ignore" id="die-normalverteilung">
<h2>Die Normalverteilung<a class="headerlink" href="#die-normalverteilung" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">smi</span>
</pre></div>
</div>
</div>
</div>
<p>Die <a href="https://de.wikipedia.org/wiki/Normalverteilung">Normalverteilung</a> wird in der Wahrscheinlichkeitstheorie, der Statistik sowie in den Natur- und Sozialwissenschaften häufig verwendet. Sie wird auch <strong>Gauß-Verteilung</strong> genannt, weil <a href="https://de.wikipedia.org/wiki/Carl_Friedrich_Gau%C3%9F">Carl Friedrich Gauß</a> <span class="math notranslate nohighlight">\((1777-1855)\)</span> einer der ersten war, der sie für die Analyse astronomischer Daten verwendete (<span id="id1">Fahrmeir <em>et al.</em> [<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">2016</a>]</span> s.83,s.271).</p>
<p>Die <strong>Normalverteilung</strong> oder die <strong>Normalkurve</strong> ist eine glockenförmige (symmetrische) Kurve. Ihr Mittelwert wird mit <span class="math notranslate nohighlight">\(\mu\)</span> und ihre Standardabweichung mit <span class="math notranslate nohighlight">\(\sigma\)</span> bezeichnet. Eine kontinuierliche Zufallsvariable <span class="math notranslate nohighlight">\(x\)</span>, die eine Normalverteilung aufweist, wird als <strong>normale Zufallsvariable</strong> bezeichnet.</p>
<p>Die Notation für eine Normalverteilung lautet <span class="math notranslate nohighlight">\(X \sim N( \mu, \sigma)\)</span>. Die Wahrscheinlichkeitsdichtefunktion (PDF) wird geschrieben als</p>
<div class="math notranslate nohighlight">
\[f(x) = \frac{1}{\sigma \sqrt{2 \pi}}e^{-\frac{1}{2}\left(\frac{x-\mu}{\sigma}\right)^2}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(e \approx 2,71828\)</span> und <span class="math notranslate nohighlight">\(\pi \approx 3,14159\)</span>. Die Wahrscheinlichkeitsdichtefunktion <span class="math notranslate nohighlight">\(f(x)\)</span> gibt den vertikalen Abstand zwischen der horizontalen Achse und der Normalkurve im Punkt <span class="math notranslate nohighlight">\(x\)</span> an.</p>
<p>Die Normalverteilung wird durch zwei Parameter beschrieben, den Mittelwert <span class="math notranslate nohighlight">\(\mu\)</span> und die Standardabweichung <span class="math notranslate nohighlight">\(\sigma\)</span>. Jeder unterschiedliche Satz von Werten für <span class="math notranslate nohighlight">\(\mu\)</span> und <span class="math notranslate nohighlight">\(\sigma\)</span> ergibt eine andere Normalverteilung. Der Wert von <span class="math notranslate nohighlight">\(\mu\)</span> bestimmt den Mittelpunkt einer Normalverteilungskurve auf der horizontalen Achse, und der Wert von <span class="math notranslate nohighlight">\(\sigma\)</span> gibt die Streuung der Werte um den Mittelpunkt an.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">mu</span> <span class="o">=</span> <span class="o">-</span><span class="mi">45</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.002</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$\mu$ = </span><span class="si">{</span><span class="n">mu</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="n">mu</span><span class="p">,</span>
    <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.05</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$\sigma$ = </span><span class="si">{</span><span class="n">sigma</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.002</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$\mu$ = </span><span class="si">{</span><span class="n">mu</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="n">mu</span><span class="p">,</span>
    <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.05</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$\sigma$ = </span><span class="si">{</span><span class="n">sigma</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mi">55</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.002</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$\mu$ = </span><span class="si">{</span><span class="n">mu</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="n">mu</span><span class="p">,</span>
    <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.05</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$\sigma$ = </span><span class="si">{</span><span class="n">sigma</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s2">&quot;Drei Wahrscheinlichkeitsdichtefunktionen der Normalverteilung</span><span class="se">\n</span><span class="s2">mit unterschiedlichen Millelwerten aber mit identischen Standardabweichungen&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.003</span><span class="p">,</span> <span class="mf">0.031</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-0.003, 0.031)
</pre></div>
</div>
<img alt="_images/02_Die Normalverteilung_9_1.png" src="_images/02_Die Normalverteilung_9_1.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.003</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$\mu$ = </span><span class="si">{</span><span class="n">mu</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">sigma</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mu</span> <span class="o">*</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$\sigma$ = </span><span class="si">{</span><span class="n">sigma</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">sigma</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mu</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.3</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$\sigma$ = </span><span class="si">{</span><span class="n">sigma</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">sigma</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mu</span> <span class="o">*</span> <span class="mf">4.5</span><span class="p">,</span> <span class="mf">0.015</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$\sigma$ = </span><span class="si">{</span><span class="n">sigma</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s2">&quot;Drei Wahrscheinlichkeitsdichtefunktionen der Normalverteilung</span><span class="se">\n</span><span class="s2">mit unterschiedlichen Standardabweichungen aber mit identischen Mittelwerten&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Drei Wahrscheinlichkeitsdichtefunktionen der Normalverteilung\nmit unterschiedlichen Standardabweichungen aber mit identischen Mittelwerten&#39;)
</pre></div>
</div>
<img alt="_images/02_Die Normalverteilung_10_1.png" src="_images/02_Die Normalverteilung_10_1.png" />
</div>
</div>
<p>Eine Normalverteilung ist unter anderem durch die folgenden Merkmale gekennzeichnet (<span id="id2">Fahrmeir <em>et al.</em> [<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">2016</a>]</span> s.272):</p>
<ol class="simple">
<li><p>Die Gesamtfläche unter einer Normalverteilungskurve beträgt <span class="math notranslate nohighlight">\(1,0\)</span>, also <span class="math notranslate nohighlight">\(100 \%\)</span>.</p></li>
<li><p>Eine Normalverteilungskurve ist symmetrisch um den Mittelwert. Folglich liegen <span class="math notranslate nohighlight">\(50 \%\)</span> der Gesamtfläche unter einer Normalverteilungskurve auf der linken Seite des Mittelwerts und <span class="math notranslate nohighlight">\(50 \%\)</span> liegen auf der rechten Seite des Mittelwerts.</p></li>
<li><p>Die Ausläufer einer Normalverteilungskurve erstrecken sich unendlich weit in beide Richtungen, ohne die horizontale Achse zu berühren oder zu kreuzen. Obwohl eine Normalverteilungskurve niemals die horizontale Achse berührt, kommt sie jenseits der Punkte, durch <span class="math notranslate nohighlight">\(\mu-3\sigma\)</span>
und <span class="math notranslate nohighlight">\(\mu+3\sigma\)</span> dargestellten Punkte so nahe an diese Achse heran, dass die Fläche unter der Kurve jenseits dieser Punkte in beiden Richtungen praktisch als Null angenommen werden kann.</p></li>
</ol>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="k">for</span> <span class="n">_x</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=-</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;$\mu$ </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">$\sigma$&quot;</span> <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;$\mu$&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x</span><span class="p">])</span>


<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="o">-</span><span class="mf">3.6</span><span class="p">,</span>
    <span class="mf">0.06</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\int_{-\infty}^{\mu-3\sigma} f(x)dx \approx 0.001$&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="o">-</span><span class="mf">2.5</span><span class="p">,</span>
    <span class="mf">0.36</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="s2">&quot;$\int_{-\infty}^\mu f(x)dx=0.5$&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">4.7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="mf">2.5</span><span class="p">,</span>
    <span class="mf">0.36</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="s2">&quot;$\int_\mu^\infty f(x)dx=0.5$&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">4.7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="mf">3.5</span><span class="p">,</span>
    <span class="mf">0.06</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\int_{\mu+3\sigma}^\infty f(x)dx \approx 0.001$&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-5.0, 5.0)
</pre></div>
</div>
<img alt="_images/02_Die Normalverteilung_13_1.png" src="_images/02_Die Normalverteilung_13_1.png" />
</div>
</div>
<section id="die-standard-normalverteilung">
<h3>Die Standard-Normalverteilung<a class="headerlink" href="#die-standard-normalverteilung" title="Permalink to this headline">#</a></h3>
<p>Die <a href="https://de.wikipedia.org/wiki/Normalverteilung#Transformation_zur_Standardnormalverteilung">Standardnormalverteilung</a> ist ein Spezialfall der Normalverteilung. Bei der Standardnormalverteilung ist der Wert des Mittelwerts gleich Null <span class="math notranslate nohighlight">\((\mu=0)\)</span> und der Wert der Standardabweichung gleich <span class="math notranslate nohighlight">\(1\)</span> <span class="math notranslate nohighlight">\((\sigma=1)\)</span>.</p>
<p>Wenn man also <span class="math notranslate nohighlight">\(\mu =0\)</span> und <span class="math notranslate nohighlight">\(\sigma =1\)</span> in die PDF der Normalverteilung einsetzt, vereinfacht sich die Gleichung zu</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align}
f(x)&amp; = \frac{1}{\sigma \sqrt{2 \pi}}e^{-\frac{1}{2}\left(\frac{x-\mu}{\sigma}\right)^2} \\
 &amp; =\frac{1}{1 \times  \sqrt{2 \pi}}e^{-\frac{1}{2}\left(\frac{x-0}{1}\right)^2} \\
 &amp; = \frac{1}{\sqrt{2\pi}}e^{-\frac{1}{2}x^2} 
\end{align} \end{split}\]</div>
<p>Die Zufallsvariable, die die Standardnormalverteilung erfüllt, wird mit <span class="math notranslate nohighlight">\(z\)</span> bezeichnet. Folglich werden die Einheiten für die Kurve der Standardnormalverteilung mit <span class="math notranslate nohighlight">\(z\)</span> bezeichnet und als <span class="math notranslate nohighlight">\(z\)</span>-<strong>Werte</strong>, <span class="math notranslate nohighlight">\(z\)</span>-<strong>Scores</strong> oder <span class="math notranslate nohighlight">\(z\)</span>-<strong>Statistik</strong> bezeichnet.</p>
<p>Die <strong>kumulative Verteilungsfunktion (CDF)</strong> der Standardnormalverteilung, die der Fläche unter der Kurve für das Intervall <span class="math notranslate nohighlight">\(]-\infty \ \)</span>,<span class="math notranslate nohighlight">\( \ z]\)</span> entspricht und gewöhnlich mit dem griechischen Großbuchstaben <em><span class="math notranslate nohighlight">\(\phi\)</span></em> bezeichnet wird, ist gegeben durch</p>
<div class="math notranslate nohighlight">
\[F(x&lt;z) = \phi (z) = \frac{1}{\sqrt{2\pi}} \int_{-\infty}^{z}e^{-\frac{1}{2}x^2}dx\]</div>
<p>wobei <span class="math notranslate nohighlight">\(e \approx 2,71828\)</span> und <span class="math notranslate nohighlight">\(\pi \approx 3,14159\)</span>.</p>
<section id="grundlegende-eigenschaften-der-standardnormalkurve">
<h4>Grundlegende Eigenschaften der Standardnormalkurve<a class="headerlink" href="#grundlegende-eigenschaften-der-standardnormalkurve" title="Permalink to this headline">#</a></h4>
<p>Die Standardnormalkurve ist ein Spezialfall der Normalverteilung und damit auch eine Wahrscheinlichkeitsverteilungskurve. Daher gelten die grundlegenden Eigenschaften der Normalverteilung auch für die Standardnormalkurve (<span id="id3">Fahrmeir <em>et al.</em> [<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">2016</a>]</span> s.85).</p>
<ol class="simple">
<li><p>Die Gesamtfläche unter der Standardnormalkurve ist <span class="math notranslate nohighlight">\(1\)</span> (diese Eigenschaft ist allen Dichtekurven gemeinsam).</p></li>
<li><p>Die Standardnormalkurve erstreckt sich unendlich in beide Richtungen und nähert sich dabei der horizontalen Achse, berührt sie aber nie.</p></li>
<li><p>Die Standardnormalkurve ist glockenförmig, ihr Mittelpunkt liegt bei <span class="math notranslate nohighlight">\(z=0\)</span>. Fast die gesamte Fläche unter der Standardnormalkurve liegt zwischen <span class="math notranslate nohighlight">\(z=-3\)</span> und <span class="math notranslate nohighlight">\(z=3\)</span>.</p></li>
</ol>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">z</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">ticks</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="k">for</span> <span class="n">_x</span> <span class="ow">in</span> <span class="n">ticks</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">_x</span> <span class="o">!=</span> <span class="n">z</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=-</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s2">&quot;z&quot;</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">z</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ticks</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">z</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;z-score&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;$\phi(z)$&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">28</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;$f(x) = \frac</span><span class="si">{1}</span><span class="s2">{\sqrt{2\pi}}e^{-\frac</span><span class="si">{1}{2}</span><span class="s2">x^2}$&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">2.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">28</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Die Wahrscheinlichkeitsdichtefunktion der Normalverteilung&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Die Wahrscheinlichkeitsdichtefunktion der Normalverteilung&#39;)
</pre></div>
</div>
<img alt="_images/02_Die Normalverteilung_25_1.png" src="_images/02_Die Normalverteilung_25_1.png" />
</div>
</div>
<p>Die <span class="math notranslate nohighlight">\(z\)</span>-Werte auf der rechten Seite des Mittelwerts sind positiv und die auf der linken Seite sind negativ. Der <span class="math notranslate nohighlight">\(z\)</span>-Wert für einen Punkt auf der horizontalen Achse gibt den Abstand zwischen dem Mittelwert <span class="math notranslate nohighlight">\((z=0)\)</span> und diesem Punkt in Form der Standardabweichung an. Ein Punkt mit einem Wert von <span class="math notranslate nohighlight">\(z=2\)</span> liegt zum Beispiel zwei Standardabweichungen rechts vom Mittelwert. Ebenso liegt ein Punkt mit einem Wert von <span class="math notranslate nohighlight">\(z=-2\)</span> zwei Standardabweichungen links vom Mittelwert.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">z</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">ticks</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="k">for</span> <span class="n">_x</span> <span class="ow">in</span> <span class="n">ticks</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">_x</span> <span class="o">!=</span> <span class="n">z</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=-</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s2">&quot;z&quot;</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">z</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ticks</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">z</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;z-score&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;$\phi(z) = \frac</span><span class="si">{1}</span><span class="s2">{\sqrt{2\pi}}\int_{-\infty}^ze^{-\frac</span><span class="si">{1}{2}</span><span class="s2">x^2}dx$&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">28</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s2">&quot;Die kumulative Wahrscheinlichkeitsdichtefunktion der Normalverteilung&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">22</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Die kumulative Wahrscheinlichkeitsdichtefunktion der Normalverteilung&#39;)
</pre></div>
</div>
<img alt="_images/02_Die Normalverteilung_27_1.png" src="_images/02_Die Normalverteilung_27_1.png" />
</div>
</div>
<p>Das Methode die Wahrscheinlichkeiten durch Berechnung der Fläche unter der Standardnormalkurve zu bestimmen, kommt häufig zur Anwendung. Aus diesem Grund gibt es <a href="https://de.wikipedia.org/wiki/Standardnormalverteilungstabelle">Wahrscheinlichkeitstabellen</a>, um die Fläche für einen bestimmten <span class="math notranslate nohighlight">\(z\)</span>-Wert zu ermitteln. Python ist jedoch ein so leistungsfähiges Werkzeug, dass wir die Fläche unter der Kurve für einen bestimmten <span class="math notranslate nohighlight">\(z\)</span>-Wert berechnen können.</p>
<p>Um die Fläche unter der Kurve für eine Standardnormalverteilung zu berechnen, verwenden wir zunächst die Funktion <code class="docutils literal notranslate"><span class="pre">norm</span></code> aus dem <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> Paket um eine Standardnormalverteilung zu generieren und wenden darauf die Methode <code class="docutils literal notranslate"><span class="pre">cdf</span></code> an um die kumulative Wahrscheinlichkeit zu berechnen. Die Funktion <code class="docutils literal notranslate"><span class="pre">norm</span></code> ist definiert als <code class="docutils literal notranslate"><span class="pre">norm(loc</span> <span class="pre">=</span> <span class="pre">Mittelwert</span> <span class="pre">,</span> <span class="pre">scale</span> <span class="pre">=</span> <span class="pre">Standardabweichung)</span></code>. Um die Standardwerte zu Erhalten setzen wir den Mittelwert und die Standardabweichung jeweils auf <span class="math notranslate nohighlight">\(0\)</span> und <span class="math notranslate nohighlight">\(1\)</span> sind. Wenden wir die Methode <code class="docutils literal notranslate"><span class="pre">cdf</span></code> an bekommen wir die kumulative Wahrscheinlichkeit bis zum angegebenen Punkt. Wir berechnen die Fläche unter der Kurve für <span class="math notranslate nohighlight">\(z=-3,-2,-1,0,1,2,3\)</span> oder formeller geschrieben:</p>
<div class="math notranslate nohighlight">
\[P(x\le z) \qquad \forall \  z \in  (-3, -2, -1, 0, 1, 2, 3)\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0013498980316300933
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.022750131948179195
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.15865525393145707
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8413447460685429
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9772498680518208
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9986501019683699
</pre></div>
</div>
</div>
</div>
<p>Perfekt! Wir haben einige der oben genannten Eigenschaften einer Standardnormalkurve bestätigt. Wir erinnern uns, dass wir die Fläche unter der Kurve für das Intervall <span class="math notranslate nohighlight">\(]-\infty \ \)</span>,<span class="math notranslate nohighlight">\( \ z]\)</span> berechnet haben. Der Aufruf von <code class="docutils literal notranslate"><span class="pre">norm.cdf(-3)</span></code> ergibt eine sehr geringe Zahl. Nur etwa <span class="math notranslate nohighlight">\(0,1 \%\)</span> der gesamten Fläche unter der Kurve befinden sich links von <span class="math notranslate nohighlight">\(z=-3\)</span>, was dem Abstand der dreifachen Standardabweichung vom Mittelwert entspricht. Außerdem ergibt <code class="docutils literal notranslate"><span class="pre">norm.cdf(0)</span></code>  <span class="math notranslate nohighlight">\(50 \%\)</span>. Fantastisch! Daraus schließen wir, dass die Fläche unter der Kurve für das Intervall <span class="math notranslate nohighlight">\(]-\infty \ \)</span>,<span class="math notranslate nohighlight">\( \ 0]\)</span> die gleiche ist wie die Fläche unter der Kurve für das Intervall <span class="math notranslate nohighlight">\([0 \ \)</span>,<span class="math notranslate nohighlight">\( \ \infty[\)</span> und dass die Fläche unter der Kurve sich zu <span class="math notranslate nohighlight">\(1\)</span> aufsummiert. Auch hier haben wir eine der oben genannten Eigenschaften einer Standardnormalkurve bestätigt. Und schließlich ergibt der Aufruf von <code class="docutils literal notranslate"><span class="pre">norm.cdf(3)</span></code>  eine hohe Zahl nahe bei <span class="math notranslate nohighlight">\(1\)</span>. Somit sind etwa <span class="math notranslate nohighlight">\(99,9 \%\)</span> der Fläche unter der Kurve im Intervall <span class="math notranslate nohighlight">\(]-\infty \ \)</span>,<span class="math notranslate nohighlight">\( \ 3]\)</span> zu finden. Für den Bereich jenseits von <span class="math notranslate nohighlight">\(z=3\)</span> bleibt nur wenig übrig.</p>
<p>Es sei daran erinnert, dass wir die Fläche unter der Kurve für jedes beliebige Intervall explizit berechnen können</p>
<p><span class="math notranslate nohighlight">\( P(a \le z \le b) = P(z \le b) - P(z \le a) \)</span></p>
<p><span class="math notranslate nohighlight">\( =\int_{a}^{b}f(z)dz\)</span></p>
<p><span class="math notranslate nohighlight">\( = \int_{-\infty}^{b}f(x)dx - \int_{-\infty}^{a}f(x)dx \)</span></p>
<p>Berechnen wir die Fläche unter der Kurve für die folgenden Intervalle: <span class="math notranslate nohighlight">\([−1 \ \)</span>,<span class="math notranslate nohighlight">\( \ 1],[−2 \ \)</span>,<span class="math notranslate nohighlight">\( \ 2],[−3 \ \)</span>,<span class="math notranslate nohighlight">\( \ 3]\)</span>. Oder in Worten: Bestimmen wir die Fläche unter der Kurve für <span class="math notranslate nohighlight">\(±1\)</span> Standardabweichung, für <span class="math notranslate nohighlight">\(±2\)</span> Standardabweichungen und für <span class="math notranslate nohighlight">\(±3\)</span> Standardabweichungen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6826894921370859
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9544997361036416
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9973002039367398
</pre></div>
</div>
</div>
</div>
<p>Toll, wir haben soeben die Empirische Regel (<span id="id4">Fahrmeir <em>et al.</em> [<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">2016</a>]</span> s.86), auch bekannt als <strong><span class="math notranslate nohighlight">\(68-95-99,7\)</span>-Regel</strong>, bestätigt, die sich auf den <a href="https://de.wikipedia.org/wiki/Tschebyscheffsche_Ungleichung">Tschebyscheffsche Ungleichung</a> bezieht. Für eine glockenförmige Verteilung sind die <span class="math notranslate nohighlight">\(3\)</span> Regeln dass ungefähr</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(68 \%\)</span> der Beobachtungen liegen innerhalb einer Standardabweichung des Mittelwerts,</p></li>
<li><p><span class="math notranslate nohighlight">\(95 \%\)</span> der Beobachtungen liegen innerhalb von zwei Standardabweichungen des Mittelwerts, und</p></li>
<li><p><span class="math notranslate nohighlight">\(99,7 \%\)</span> der Beobachtungen liegen innerhalb von drei Standardabweichungen des Mittelwerts.</p></li>
</ol>
<p>Um unsere Intuition zu stärken, wird die empirische Regel im Folgenden veranschaulicht.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>


<span class="k">for</span> <span class="n">_x</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=-</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">))</span>

<span class="n">ticks</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="o">-</span><span class="mf">2.5</span><span class="p">,</span>
    <span class="mf">0.36</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="s2">&quot;$\phi(z) = \int_{-1}^1 f(z)dz=P(z \leq 1) - P(z \leq-1)$&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mf">0.15</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\phi(z) \approx 0.68$&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
<span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;z-score&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Die Fläche des Intervalls $z=[-1,1]$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Die Fläche des Intervalls $z=[-1,1]$&#39;)
</pre></div>
</div>
<img alt="_images/02_Die Normalverteilung_48_1.png" src="_images/02_Die Normalverteilung_48_1.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>


<span class="k">for</span> <span class="n">_x</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=-</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">))</span>

<span class="n">ticks</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="o">-</span><span class="mf">2.5</span><span class="p">,</span>
    <span class="mf">0.36</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="s2">&quot;$\phi(z) = \int_{-2}^2 f(z)dz=P(z \leq 2) - P(z \leq-2)$&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mf">0.15</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\phi(z) \approx 0.95$&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
<span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;z-score&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Die Fläche des Intervalls $z=[-2,2]$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Die Fläche des Intervalls $z=[-2,2]$&#39;)
</pre></div>
</div>
<img alt="_images/02_Die Normalverteilung_49_1.png" src="_images/02_Die Normalverteilung_49_1.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>


<span class="k">for</span> <span class="n">_x</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=-</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">))</span>

<span class="n">ticks</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="o">-</span><span class="mf">2.5</span><span class="p">,</span>
    <span class="mf">0.36</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="s2">&quot;$\phi(z) = \int_{-3}^3 f(z)dz=P(z \leq 3) - P(z \leq-3)$&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mf">0.15</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\phi(z) \approx 0.97$&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
<span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;z-score&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Die Fläche des Intervalls $z=[-3,3]$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Die Fläche des Intervalls $z=[-3,3]$&#39;)
</pre></div>
</div>
<img alt="_images/02_Die Normalverteilung_50_1.png" src="_images/02_Die Normalverteilung_50_1.png" />
</div>
</div>
</section>
</section>
<section id="bestimmung-des-z-wertes-bei-bekannter-flache-unter-der-normalverteilungskurve">
<h3>Bestimmung des z-Wertes, bei bekannter Fläche unter der Normalverteilungskurve<a class="headerlink" href="#bestimmung-des-z-wertes-bei-bekannter-flache-unter-der-normalverteilungskurve" title="Permalink to this headline">#</a></h3>
<hr class="docutils" />
<p>Bisher haben wir <span class="math notranslate nohighlight">\(z\)</span>-Scores verwendet, um die Fläche unter der Kurve zu berechnen. Jetzt machen wir es andersherum. Wir berechnen den oder die <span class="math notranslate nohighlight">\(z\)</span>-Score(s), die einer bestimmten Fläche unter der Standardnormalkurve entsprechen. Das Auffinden des <span class="math notranslate nohighlight">\(z\)</span>-Scores, der eine bestimmte Fläche hat, ist so häufig, dass es eine spezielle Notation gibt. Das Symbol <span class="math notranslate nohighlight">\(z_{\alpha}\)</span> wird verwendet, um den <span class="math notranslate nohighlight">\(z\)</span>-Score zu bezeichnen, der eine Fläche von <span class="math notranslate nohighlight">\( \alpha \)</span> (alpha) zu seiner Rechten unter der Standardnormalkurve aufweist.</p>
<p>Ermitteln wir <span class="math notranslate nohighlight">\(z_{0,05}\)</span>, den <span class="math notranslate nohighlight">\(z\)</span>-Wert, der unter der Standardnormalkurve eine Fläche von <span class="math notranslate nohighlight">\(0,05\)</span> zu seiner Rechten hat. Der Wert von <span class="math notranslate nohighlight">\(\alpha\)</span> entspricht der Wahrscheinlichkeit, einen bestimmten Wert zu erhalten, der dem Intervall <span class="math notranslate nohighlight">\([z \ \)</span>,<span class="math notranslate nohighlight">\( \ \infty[\)</span>entspricht. Denn die Fläche rechts davon ist <span class="math notranslate nohighlight">\(0,05\)</span>. Die Fläche links davon ist <span class="math notranslate nohighlight">\(1-0,05=0,95\)</span>, was dem Intervall <span class="math notranslate nohighlight">\(]- \alpha \ \)</span>,<span class="math notranslate nohighlight">\( \ z]\)</span> (siehe Grafik unten).</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>


<span class="k">for</span> <span class="n">_x</span> <span class="ow">in</span> <span class="p">[</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=-</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">))</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)</span>
<span class="n">ticks</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">z</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ticks</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mf">0.15</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$Fläche = 0.95$&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="mf">1.85</span><span class="p">,</span>
    <span class="mf">0.11</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$z_</span><span class="si">{0.05}</span><span class="s2">$&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;$Fläche=0.05$&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">2.4</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
<span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;z-score&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[]
</pre></div>
</div>
<img alt="_images/02_Die Normalverteilung_54_1.png" src="_images/02_Die Normalverteilung_54_1.png" />
</div>
</div>
<p>Um den entsprechenden <span class="math notranslate nohighlight">\(z\)</span>-Score zu erhalten, kann man ihn in einer <a href="https://de.wikipedia.org/wiki/Standardnormalverteilungstabelle">Wahrscheinlichkeitstabelle</a> nachschlagen oder Python verwenden. Daher wenden wir die Funktion <code class="docutils literal notranslate"><span class="pre">norm.ppf</span></code> an. Die <code class="docutils literal notranslate"><span class="pre">norm.ppf</span></code>-Funktion wird geschrieben als <code class="docutils literal notranslate"><span class="pre">norm.ppf(p,</span> <span class="pre">mean</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">scale</span> <span class="pre">=</span> <span class="pre">1,</span> <span class="pre">loc</span> <span class="pre">=</span> <span class="pre">0)</span></code>. Wir behalten die Standardwerte für die Argumente <code class="docutils literal notranslate"><span class="pre">mean</span></code>, <code class="docutils literal notranslate"><span class="pre">sd</span></code> und <code class="docutils literal notranslate"><span class="pre">loc</span></code> bei. Allerdings müssen wir vorsichtig sein auf welchen Bereich der Fläche unter der Normalverteilung wir uns beziehen. Für <code class="docutils literal notranslate"><span class="pre">norm.ppf(p)</span></code> erhalten wir den <span class="math notranslate nohighlight">\(z\)</span>-Score, bei dem das p-Argument der Bereich links von <span class="math notranslate nohighlight">\(z\)</span> ist. Wenn wir dagegen <code class="docutils literal notranslate"><span class="pre">norm.ppf(1-p)</span></code> berechnen, erhalten wir den <span class="math notranslate nohighlight">\(z\)</span>-Score, bei dem das p-Argument der Bereich rechts von <span class="math notranslate nohighlight">\(z\)</span> ist. Wenden wir uns an Python um dies zu verdeutlichen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.6448536269514729
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.6448536269514722
</pre></div>
</div>
</div>
</div>
<p>Es ist interessant zu erwähnen das die Perzentile Punkt Funktion <code class="docutils literal notranslate"><span class="pre">norm.ppf</span></code> die inverse Funktion der kumulativen Wahrscheinlichkeitsfunktion <code class="docutils literal notranslate"><span class="pre">norm.cdf</span></code> ist</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.95</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.95
</pre></div>
</div>
</div>
</div>
<p>Da die Standardnormalverteilung symmetrisch ist, erhalten wir zweimal die gleiche Zahl, aber mit einem anderen Vorzeichen. Das bedeutet, dass bei einem z-Wert von etwa <span class="math notranslate nohighlight">\(1,64 \ \)</span>  <span class="math notranslate nohighlight">\( 95 \%\)</span> aller Werte links von <span class="math notranslate nohighlight">\(z_{0,05}\)</span> und <span class="math notranslate nohighlight">\(5 \%\)</span> aller Werte rechts davon liegen. Im Gegensatz dazu liegen für einen <span class="math notranslate nohighlight">\(z\)</span>-Wert von etwa <span class="math notranslate nohighlight">\(-1,64 \ \)</span> <span class="math notranslate nohighlight">\(5 \%\)</span> aller Werte links von <span class="math notranslate nohighlight">\(z_{0,05}\)</span> und <span class="math notranslate nohighlight">\(95 \%\)</span> aller Werte rechts davon. Kombiniert man diese, erhält man das Intervall <span class="math notranslate nohighlight">\(z \in [-1,64 \ \)</span>,<span class="math notranslate nohighlight">\( \ 1,64 ]\)</span>, das <span class="math notranslate nohighlight">\(90 \%\)</span> aller Werte abdeckt.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">z1</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">z2</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)</span>


<span class="k">for</span> <span class="n">_x</span> <span class="ow">in</span> <span class="p">[</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.05</span><span class="p">),</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=-</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">))</span>

<span class="n">ticks</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">z2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="n">z1</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="n">z2</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ticks</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mf">0.15</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$Fläche = 0.9 = 90\%$&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
<span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;$Fläche=0.05$&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">2.4</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;$Fläche=0.05$&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">3.7</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;z-score&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[]
</pre></div>
</div>
<img alt="_images/02_Die Normalverteilung_61_1.png" src="_images/02_Die Normalverteilung_61_1.png" />
</div>
</div>
</section>
<section id="standardisierung-einer-normalverteilten-variable">
<h3>Standardisierung einer normalverteilten Variable<a class="headerlink" href="#standardisierung-einer-normalverteilten-variable" title="Permalink to this headline">#</a></h3>
<hr class="docutils" />
<p>Bevor wir das Konzept der Standardnormalverteilung auf einen realen Datensatz anwenden können, müssen wir das Konzept der <strong>Standardisierung einer Normalverteilung</strong> diskutieren. Wir wissen, dass eine Normalverteilung durch zwei Parameter parametrisiert ist, ihren Mittelwert <span class="math notranslate nohighlight">\(\mu \in \mathbb R&gt;0\)</span> und ihre Standardabweichung <span class="math notranslate nohighlight">\(\sigma \in \mathbb R&gt;0,X \sim N(\mu,\sigma)\)</span>. Der tatsächliche Wert dieser Parameter hängt von der Population und den zur Beschreibung ihrer Merkmale verwendeten Metriken ab. Um ein bestimmtes <span class="math notranslate nohighlight">\(\mu\)</span> und <span class="math notranslate nohighlight">\(\sigma\)</span>, das sich auf eine bestimmte Zufallsvariable X bezieht, in <span class="math notranslate nohighlight">\(\mu=0\)</span> und <span class="math notranslate nohighlight">\(\sigma=1\)</span> umzuwandeln, müssen wir den <span class="math notranslate nohighlight">\(x\)</span>-Wert in einen <span class="math notranslate nohighlight">\(z\)</span>-Wert umwandeln, indem wir die folgende Gleichung anwenden.</p>
<div class="math notranslate nohighlight">
\[z = \frac{x-\mu}{\sigma}\]</div>
<p>Als Ergebnis erhalten wir eine Standardnormalverteilung für eine bestimmte Normalverteilung. Dieses Verfahren ist unerlässlich, wenn Sie die <span class="math notranslate nohighlight">\(z\)</span>-Scores oder eine auf einen <span class="math notranslate nohighlight">\(z\)</span>-Score bezogene Wahrscheinlichkeit <span class="math notranslate nohighlight">\((P(z))\)</span> bestimmen müssen indem man sie in einer Tabelle nachschlägt. Wir werden später sehen, dass Python ein so mächtiges Werkzeug ist, dass der Schritt der Standardisierung überflüssig ist.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># axis 0</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">mu</span> <span class="o">=</span> <span class="o">-</span><span class="mi">45</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="n">mu</span><span class="p">,</span>
    <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.05</span> <span class="o">+</span> <span class="mf">0.005</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$\mu$ = </span><span class="si">{</span><span class="n">mu</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="n">mu</span><span class="p">,</span>
    <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.05</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$\sigma$ = </span><span class="si">{</span><span class="n">sigma</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="n">mu</span><span class="p">,</span>
    <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.05</span> <span class="o">+</span> <span class="mf">0.005</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$\mu$ = </span><span class="si">{</span><span class="n">mu</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="n">mu</span><span class="p">,</span>
    <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.05</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$\sigma$ = </span><span class="si">{</span><span class="n">sigma</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mi">36</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">18</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="n">mu</span><span class="p">,</span>
    <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.05</span> <span class="o">+</span> <span class="mf">0.005</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$\mu$ = </span><span class="si">{</span><span class="n">mu</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="n">mu</span><span class="p">,</span>
    <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.05</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$\sigma$ = </span><span class="si">{</span><span class="n">sigma</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.003</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">)</span>

<span class="c1"># axis 1</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mf">0.2</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$\mu$ = </span><span class="si">{</span><span class="n">mu</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mf">0.17</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$\sigma$ = </span><span class="si">{</span><span class="n">sigma</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="o">-</span><span class="mi">3</span><span class="p">,</span>
    <span class="mf">0.25</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$z = \frac{X-\mu}{\sigma}$&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">26</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="o">-</span><span class="mf">2.1</span><span class="p">,</span>
    <span class="mf">0.45</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$z = \frac{X-(-45)}</span><span class="si">{10}</span><span class="s2">$&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="o">-</span><span class="mf">0.3</span><span class="p">,</span>
    <span class="mf">0.5</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$z = \frac{X-12}</span><span class="si">{7}</span><span class="s2">$&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="mf">1.7</span><span class="p">,</span>
    <span class="mf">0.35</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$z = \frac{X-36}</span><span class="si">{18}</span><span class="s2">$&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Add line from one subplot to the other</span>
<span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">ConnectionPatch</span>

<span class="k">for</span> <span class="n">xy</span> <span class="ow">in</span> <span class="p">[</span>
    <span class="p">([</span><span class="mi">45</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">]),</span>
    <span class="p">([</span><span class="mi">14</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.42</span><span class="p">]),</span>
    <span class="p">([</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]),</span>
<span class="p">]:</span>
    <span class="n">xyA</span> <span class="o">=</span> <span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">xyB</span> <span class="o">=</span> <span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># ConnectionPatch handles the transform internally so no need to get fig.transFigure</span>
    <span class="n">arrow</span> <span class="o">=</span> <span class="n">ConnectionPatch</span><span class="p">(</span>
        <span class="n">xyA</span><span class="p">,</span>
        <span class="n">xyB</span><span class="p">,</span>
        <span class="n">coordsA</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">transData</span><span class="p">,</span>
        <span class="n">coordsB</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">transData</span><span class="p">,</span>
        <span class="c1"># Default shrink parameter is 0 so can be omitted</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
        <span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-|&gt;&quot;</span><span class="p">,</span>  <span class="c1"># &quot;normal&quot; arrow</span>
        <span class="n">mutation_scale</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>  <span class="c1"># controls arrow head size</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">patches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arrow</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.003</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">)</span>
<span class="k">for</span> <span class="n">_ax</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">:</span>
    <span class="n">_ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/02_Die Normalverteilung_66_0.png" src="_images/02_Die Normalverteilung_66_0.png" />
</div>
</div>
</section>
<section id="die-standard-normalverteilung-ein-beispiel-in-python">
<h3>Die Standard-Normalverteilung: Ein Beispiel in Python<a class="headerlink" href="#die-standard-normalverteilung-ein-beispiel-in-python" title="Permalink to this headline">#</a></h3>
<section id="vorbereitung-der-daten">
<h4>Vorbereitung der Daten<a class="headerlink" href="#vorbereitung-der-daten" title="Permalink to this headline">#</a></h4>
<p>Jetzt sind wir bereit, einige Übungen zu machen. Dazu laden wir den <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz. Sie können die Datei <code class="docutils literal notranslate"><span class="pre">students.csv</span></code> <a href="https://userpage.fu-berlin.de/soga/200/2010_data_sets/students.csv">hier</a> herunterladen. Zuerst laden wir den Datensatz und geben ihm einen passenden Namen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lese Datei students.csv als Dataframe ein</span>
<span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../data/students.csv&quot;</span><span class="p">)</span>
<span class="c1"># Lese Spalte &#39;height&#39; ein</span>
<span class="n">height</span> <span class="o">=</span> <span class="n">students</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Der <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz besteht aus <span class="math notranslate nohighlight">\(8239\)</span> Zeilen, von denen jede einen bestimmten Studenten repräsentiert, und <span class="math notranslate nohighlight">\(16\)</span> Spalten, von denen jede einer Variable/einem Merkmal entspricht, das sich auf diesen bestimmten Studenten bezieht. Diese selbsterklärenden Variablen sind: <em>stud_id, Name, Geschlecht, Alter, Größe, Gewicht, Religion, nc_score, Semester, Hauptfach, Nebenfach, score1, score2, online_tutorial, graduated, salary</em>. In diesem Abschnitt verwenden wir die Variable <code class="docutils literal notranslate"><span class="pre">height</span></code>, um das bisher Besprochene zu üben.</p>
<p>Zunächst wollen wir sicherstellen, dass wir es mit normalverteilten Daten zu tun haben. Wenn eine Variable normalverteilt ist, sollte ein Histogramm der Beobachtungen bei einer großen Stichprobe in etwa die Form einer Glocke haben.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plotte die Werte als Histogramm</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="c1"># Erzeuge Labels</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Häufigkeit&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Größe in cm&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;Größe in cm&#39;)
</pre></div>
</div>
<img alt="_images/02_Die Normalverteilung_72_1.png" src="_images/02_Die Normalverteilung_72_1.png" />
</div>
</div>
<p>Aus dem Diagramm kann man schließen, dass die Variable <code class="docutils literal notranslate"><span class="pre">height</span></code> normalverteilt ist. Allerdings ist es vor allem bei kleinen Stichproben oft schwierig, eine klare Form in einem Histogramm festzustellen, insbesondere, ob sie glockenförmig ist. Daher ist eine empfindlichere grafische Technik zur Beurteilung der Normalität erforderlich. <strong>Normal-Quantil-Plot</strong> bieten eine solche Technik. Die Idee hinter einem Normal-Quantil-Plot oder kurz Q-Q Plot ist einfach: Man vergleicht die beobachteten Werte der Variablen mit den Beobachtungen, die für eine normalverteilte Variable erwartet werden. Genauer gesagt ist ein Q-Q Plot eine Darstellung der beobachteten Werte der Variablen im Vergleich zu den Werten, die für eine Variable mit der Standardnormalverteilung erwartet werden. Wenn die Variable normalverteilt ist, sollte der Q-Q Plot in etwa linear sein (d. h. in etwa auf einer Geraden liegen) (<span id="id5">Fahrmeir <em>et al.</em> [<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">2016</a>]</span> s.88).</p>
<p>Bei der Verwendung eines Normal-Quantil-Plots zur Beurteilung der Normalität einer Variablen sind zwei Dinge zu beachten:</p>
<ol class="simple">
<li><p>Die Entscheidung, ob eine normale Wahrscheinlichkeitsverteilung annähernd linear ist, ist eine subjektive Entscheidung, und</p></li>
<li><p>dass wir nur eine begrenzte Anzahl von Beobachtungen dieser bestimmten Variablen verwenden, um ein Urteil über alle möglichen Beobachtungen der Variablen zu fällen.</p></li>
</ol>
<p>In Python können wir die Funktion <code class="docutils literal notranslate"><span class="pre">qqplot()</span></code> verwenden, um Normalwahrscheinlichkeitsplots zu erstellen, die auch als <a href="https://de.wikipedia.org/wiki/Quantil-Quantil-Diagramm">Q-Q-Plots</a> bezeichnet werden.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Erzeuge Q-Q Plot</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">smi</span><span class="o">.</span><span class="n">qqplot</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/02_Die Normalverteilung_77_0.png" src="_images/02_Die Normalverteilung_77_0.png" />
</div>
</div>
<p>Bei der Betrachtung des Diagramms sehen wir, dass die Quantile der Stichprobe im Vergleich zu den theoretischen Quantilen am unteren und oberen Ende etwas abweichen. Dieser Tatsache muss etwas mehr Aufmerksamkeit geschenkt werden! Was könnte der Grund für die Abweichung am oberen und unteren Ende der Verteilung sein? Irgendeine Vermutung?</p>
<p>Was ist mit dem Geschlecht? Ehrlich gesagt scheint es natürlich zu sein, dass die durchschnittliche Körpergröße von Männern und Frauen unterschiedlich ist. Stellen wir ein Histogramm der Körpergröße von Männern und Frauen auf.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">male_height</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">students</span><span class="p">[</span><span class="s2">&quot;gender&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Male&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">]</span>
<span class="n">female_height</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">students</span><span class="p">[</span><span class="s2">&quot;gender&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Female&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plotte die Werte als Histogramm</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="c1"># Bestimme Anzahl Bins</span>
<span class="n">bins_male</span> <span class="o">=</span> <span class="n">male_height</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">male_height</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">male_height</span><span class="p">,</span> <span class="n">bins_male</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="c1"># Bestimme Anzahl Bins</span>
<span class="n">bins_female</span> <span class="o">=</span> <span class="n">female_height</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">female_height</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">female_height</span><span class="p">,</span> <span class="n">bins_female</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="c1"># Erzeuge Labels</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Häufigkeit&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Größe in cm&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;Größe in cm&#39;)
</pre></div>
</div>
<img alt="_images/02_Die Normalverteilung_81_1.png" src="_images/02_Die Normalverteilung_81_1.png" />
</div>
</div>
<p>Das ist es! Offensichtlich haben die beiden Gruppen unterschiedliche Mittelwerte, so dass die Zusammenfassung zu einer Gruppe dazu führt, dass die linken und rechten Ausläufer der sich ergebenden Verteilung weiter reichen, als bei einer normalverteilten Variablen zu erwarten wäre. Um fortzufahren, betrachten wir also nur die Körpergröße der Studentinnen. Der Klarheit halber zeichnen wir noch einmal den Normalwahrscheinlichkeitsplit der Größenvariablen, um sicherzustellen, dass unsere Zielvariablen normalverteilt sind.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Erzeuge Q-Q Plot</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">smi</span><span class="o">.</span><span class="n">qqplot</span><span class="p">(</span><span class="n">female_height</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/02_Die Normalverteilung_83_0.png" src="_images/02_Die Normalverteilung_83_0.png" />
</div>
</div>
<p>Bevor wir mit den eigentlichen Übungen beginnen, berechnen wir zunächst den Mittelwert <span class="math notranslate nohighlight">\(\bar{x}\)</span> und die Standardabweichung <span class="math notranslate nohighlight">\(s\)</span> der Zielvariablen. Außerdem standardisieren wir die Variable, um eine Standardnormalverteilung mit <span class="math notranslate nohighlight">\(\bar{x}=0\)</span> und <span class="math notranslate nohighlight">\(s=1\)</span> zu erhalten, und weisen ihr einen geeigneten Variablennamen zu.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Heights</span>
<span class="n">height_mean</span> <span class="o">=</span> <span class="n">female_height</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">height_mean</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>163.65328467153284
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">height_sd</span> <span class="o">=</span> <span class="n">female_height</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">height_sd</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7.919725792052593
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">height_z</span> <span class="o">=</span> <span class="p">(</span><span class="n">female_height</span> <span class="o">-</span> <span class="n">height_mean</span><span class="p">)</span> <span class="o">/</span> <span class="n">height_sd</span>
</pre></div>
</div>
</div>
</div>
<p>Die Variable <code class="docutils literal notranslate"><span class="pre">height</span></code> hat einen Mittelwert von <span class="math notranslate nohighlight">\(163,7\)</span> cm und eine Standardabweichung von <span class="math notranslate nohighlight">\(7,9\)</span> cm.</p>
</section>
<section id="suche-nach-dem-bereich-links-von-einem-angegebenen-z-scores-oder-x-wertes">
<h4>Suche nach dem Bereich links von einem angegebenen <span class="math notranslate nohighlight">\(z\)</span>-Scores oder <span class="math notranslate nohighlight">\(x\)</span>-Wertes<a class="headerlink" href="#suche-nach-dem-bereich-links-von-einem-angegebenen-z-scores-oder-x-wertes" title="Permalink to this headline">#</a></h4>
<p><strong>Frage 1</strong></p>
<p>Wie hoch ist die Wahrscheinlichkeit, dass eine zufällig ausgewählte Studentin aus dem <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz eine Körpergröße von <span class="math notranslate nohighlight">\(168\)</span> cm oder weniger hat? Wir suchen also nach <span class="math notranslate nohighlight">\(P(x \le 168)\)</span>.</p>
<p>Zunächst berechnen wir die Wahrscheinlichkeit für die standardisierte Variable. Dazu müssen wir den Wert, der uns interessiert (<span class="math notranslate nohighlight">\(168\)</span> cm), in einen <span class="math notranslate nohighlight">\(z\)</span>-Score umwandeln.</p>
<div class="math notranslate nohighlight">
\[z = \frac{x-\mu}{\sigma} = \frac{ 168- 163,7}{7,9}  = 0,55\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">height_z2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">168</span> <span class="o">-</span> <span class="n">height_mean</span><span class="p">)</span> <span class="o">/</span> <span class="n">height_sd</span>
<span class="n">height_z2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5488466952768823
</pre></div>
</div>
</div>
</div>
<p>Dann müssen wir die Fläche unter der Kurve links neben dem erhaltenen <span class="math notranslate nohighlight">\(z\)</span>-Wert berechnen. Zur Erinnerung: Die Fläche unter der Kurve einer normalverteilten Variablen kann mit Hilfe der Funktion <code class="docutils literal notranslate"><span class="pre">norm.cdf()</span></code>  berechnet werden. Die <code class="docutils literal notranslate"><span class="pre">norm.cdf()</span></code> -Funktion wird als <code class="docutils literal notranslate"><span class="pre">norm.cdf(q,</span> <span class="pre">loc</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">scale</span> <span class="pre">=</span> <span class="pre">1)</span></code> geschrieben. Für dieses spezielle Beispiel können wir alle Standardargumente akzeptieren.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">height_z2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7084446690628331
</pre></div>
</div>
</div>
</div>
<p>Genial, wir haben ein Ergebnis: <span class="math notranslate nohighlight">\(P(z\le 0,55) \approx 0,71\)</span></p>
<p>Nun führen wir die gleiche Berechnung durch, überspringen aber diesmal den Schritt der Standardisierung. Dank der Leistungsfähigkeit von Python müssen wir uns nicht auf Tabellen verlassen, sondern können den Stichprobenmittelwert <span class="math notranslate nohighlight">\(\bar x\)</span> und die Standardabweichung der Stichprobe, <span class="math notranslate nohighlight">\(s\)</span>, in die Funktion <code class="docutils literal notranslate"><span class="pre">stats.norm.cdf</span></code> eingeben.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">168</span>
<span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">height_mean</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">height_sd</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7084446690628331
</pre></div>
</div>
</div>
</div>
<p>Perfekt! Die Zahlen stimmen überein: <span class="math notranslate nohighlight">\(P(x \le 168) \approx 0,71\)</span>. Um sicherzustellen, dass wir verstehen, was vor sich geht, werden unten sowohl die Fläche unter der Kurve für die standardisierte Variable in <span class="math notranslate nohighlight">\(z\)</span>-Werten (linkes Feld) als auch die Fläche für die nicht standardisierte Variable in cm (rechtes Feld) dargestellt.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># axis 0</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">3.2</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">z</span> <span class="o">=</span> <span class="mf">0.55</span>
<span class="n">ticks</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">))</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">z</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ticks</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">z</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;$Fläche \approx 0.71$&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">3.45</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$P(z \leq 0.55)$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="c1"># axis 1</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">height_mean</span> <span class="o">+</span> <span class="n">height_sd</span> <span class="o">*</span> <span class="o">-</span><span class="mf">3.2</span><span class="p">,</span> <span class="n">height_mean</span> <span class="o">+</span> <span class="n">height_sd</span> <span class="o">*</span> <span class="mf">3.2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">mu</span> <span class="o">=</span> <span class="n">height_mean</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="n">height_sd</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">z</span> <span class="o">=</span> <span class="mi">168</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">))</span>

<span class="n">ticks</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">ticks</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">ticks</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="mi">170</span><span class="p">))</span>
<span class="n">ticks</span> <span class="o">=</span> <span class="n">ticks</span> <span class="o">+</span> <span class="p">[</span><span class="n">z</span><span class="p">]</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">z</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;$Fläche \approx 0.71$&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">163</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">137</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">),</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$P(z \leq 168)$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="k">for</span> <span class="n">_ax</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">:</span>
    <span class="n">_ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/02_Die Normalverteilung_99_0.png" src="_images/02_Die Normalverteilung_99_0.png" />
</div>
</div>
</section>
<section id="ermitteln-der-flache-rechts-von-einem-bestimmten-x-wert">
<h4>Ermitteln der Fläche rechts von einem bestimmten <span class="math notranslate nohighlight">\(x\)</span>-Wert<a class="headerlink" href="#ermitteln-der-flache-rechts-von-einem-bestimmten-x-wert" title="Permalink to this headline">#</a></h4>
<p><strong>Frage 2</strong></p>
<p>Wie hoch ist die Wahrscheinlichkeit, dass eine zufällig ausgewählte Studentin aus dem <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz eine Körpergröße von <span class="math notranslate nohighlight">\(185\)</span> cm oder mehr hat? Wir suchen also nach <span class="math notranslate nohighlight">\(P(x \ge 175)\)</span>. Um die Fläche unter der Kurve rechts vom interessierenden Wert zu erhalten, müssen wir in die Funktion <code class="docutils literal notranslate"><span class="pre">stats.norm.sf()</span></code> oder <code class="docutils literal notranslate"><span class="pre">1-stats.norm.cdf</span></code> verwenden.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">175</span>  <span class="c1"># height in cm</span>
<span class="n">norm</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">height_mean</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">height_sd</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.07596955321865
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">175</span>  <span class="c1"># height in cm</span>
<span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">height_mean</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">height_sd</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.92403044678135
</pre></div>
</div>
</div>
</div>
<p>Antwort: : <span class="math notranslate nohighlight">\(P(x \ge 175) \approx 0,08\)</span></p>
</section>
<section id="ermitteln-der-flache-zwischen-zwei-angegebenen-x-werten">
<h4>Ermitteln der Fläche zwischen zwei angegebenen <span class="math notranslate nohighlight">\(x\)</span>-Werten<a class="headerlink" href="#ermitteln-der-flache-zwischen-zwei-angegebenen-x-werten" title="Permalink to this headline">#</a></h4>
<p>Um die Fläche unter einer Kurve für ein Intervall <span class="math notranslate nohighlight">\([a \ \)</span>,<span class="math notranslate nohighlight">\( \ b]\)</span> zu bestimmen, verwenden wir die Gleichung</p>
<div class="math notranslate nohighlight">
\[P(a \le x \le b)  = \int_{a}^{b}f(x)dx = P(x \le b)- P(x \le a)\text{.}\]</div>
<p><strong>Frage 3</strong></p>
<p>Wie hoch ist die Wahrscheinlichkeit, dass eine zufällig ausgewählte Studentin aus dem <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz eine Körpergröße zwischen <span class="math notranslate nohighlight">\(155\)</span> und <span class="math notranslate nohighlight">\(165\)</span> cm hat, <span class="math notranslate nohighlight">\(P(155≤x≤165)\)</span>?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_lower</span> <span class="o">=</span> <span class="mi">155</span>  <span class="c1"># height in cm</span>
<span class="n">x_upper</span> <span class="o">=</span> <span class="mi">165</span>  <span class="c1"># height in cm</span>

<span class="n">cdf_upper</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x_upper</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">height_mean</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">height_sd</span><span class="p">)</span>
<span class="n">cdf_lower</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x_lower</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">height_mean</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">height_sd</span><span class="p">)</span>
<span class="n">cdf_upper</span> <span class="o">-</span> <span class="n">cdf_lower</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.4302335028797312
</pre></div>
</div>
</div>
</div>
<p>Antwort: : <span class="math notranslate nohighlight">\(P(155≤x≤165)≈0,43\)</span></p>
<p><strong>Frage 4</strong></p>
<p>Wie hoch ist die Wahrscheinlichkeit, dass eine zufällig ausgewählte Studentin aus dem Studentendatensatz eine Körpergröße zwischen <span class="math notranslate nohighlight">\(170\)</span> und <span class="math notranslate nohighlight">\(180\)</span> cm hat, <span class="math notranslate nohighlight">\(P(170≤x≤180)\)</span>?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_lower</span> <span class="o">=</span> <span class="mi">170</span>  <span class="c1"># height in cm</span>
<span class="n">x_upper</span> <span class="o">=</span> <span class="mi">180</span>  <span class="c1"># height in cm</span>

<span class="n">cdf_upper</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x_upper</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">height_mean</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">height_sd</span><span class="p">)</span>
<span class="n">cdf_lower</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x_lower</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">height_mean</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">height_sd</span><span class="p">)</span>
<span class="n">cdf_upper</span> <span class="o">-</span> <span class="n">cdf_lower</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.19194918877717126
</pre></div>
</div>
</div>
</div>
<p>Antwort: : <span class="math notranslate nohighlight">\(P(170≤x≤180)≈0,19\)</span></p>
</section>
<section id="z-alpha-finden">
<h4><span class="math notranslate nohighlight">\(z_\alpha\)</span> finden<a class="headerlink" href="#z-alpha-finden" title="Permalink to this headline">#</a></h4>
<p><strong>Frage 5</strong></p>
<p>Wir möchten wissen, welche Körpergröße der Studentinnen in unserem <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz mit einer Wahrscheinlichkeit von <span class="math notranslate nohighlight">\(0,60\)</span> übereinstimmt. Oder anders ausgedrückt: Wenn wir eine Anzahl von <span class="math notranslate nohighlight">\(n\)</span> Studenten aus dem <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz zufällig auswählen, welche Größe teilt die Stichprobe in <span class="math notranslate nohighlight">\(60 \%\)</span> der <span class="math notranslate nohighlight">\(n\)</span> Studierenden, die kleiner sind, und <span class="math notranslate nohighlight">\(40 \%\)</span> der n Studentinnen, die größer als diese bestimmte Größe sind. Wir suchen also nach <span class="math notranslate nohighlight">\(P(X&lt;?)=0,60\)</span>.</p>
<p>Um <span class="math notranslate nohighlight">\(P(X&lt;?)=0,60\)</span> zu lösen, werden wir zwei Ansätze wählen. Der erste Ansatz verwendet den <span class="math notranslate nohighlight">\(z\)</span>-Score, und der zweite verwendet Python, um den Standardisierungsschritt überflüssig zu machen. .</p>
<p>Für beide Ansätze verwenden wir die <code class="docutils literal notranslate"><span class="pre">norm.ppf()</span></code>-Funktion, die wie folgt geschrieben wird: <code class="docutils literal notranslate"><span class="pre">norm.ppf(p,</span> <span class="pre">loc</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">scale</span> <span class="pre">=</span> <span class="pre">1)</span></code>.</p>
<p>Für den ersten Ansatz müssen wir die Gleichung für die Standardisierung von oben umstellen und sie für <span class="math notranslate nohighlight">\(x\)</span> lösen</p>
<div class="math notranslate nohighlight">
\[z = \frac{x-\mu}{\sigma} \implies x = z \sigma + \mu\]</div>
<p>Für die Berechnung von <span class="math notranslate nohighlight">\(x\)</span> benötigen wir den Mittelwert (<code class="docutils literal notranslate"><span class="pre">height_mean</span></code>) und die Standardabweichung (<code class="docutils literal notranslate"><span class="pre">height_sd</span></code>) für die Variable <code class="docutils literal notranslate"><span class="pre">height</span></code>, die <span class="math notranslate nohighlight">\(163,7\)</span> cm bzw. <span class="math notranslate nohighlight">\(7,9\)</span> cm beträgt. Außerdem müssen wir einen <span class="math notranslate nohighlight">\(z\)</span>-Score für die gegebene Wahrscheinlichkeit von <span class="math notranslate nohighlight">\(0,60\)</span> erhalten. Wir können diesen <span class="math notranslate nohighlight">\(z\)</span>-Score in einer Tabelle nachschlagen oder die <code class="docutils literal notranslate"><span class="pre">norm.ppf()</span></code>-Funktion in Python anwenden. Wir wollen den <span class="math notranslate nohighlight">\(z\)</span>-Score ermitteln, bei dem der Bereich links von diesem <span class="math notranslate nohighlight">\(z\)</span>-Score <span class="math notranslate nohighlight">\(0,60\)</span> entspricht; erinnern Sie sich, dass wir nach <span class="math notranslate nohighlight">\(P(X&lt;?)=0,60\)</span> suchen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">z</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.2533471031357997
</pre></div>
</div>
</div>
</div>
<p>Da wir nun <span class="math notranslate nohighlight">\(z\)</span> kennen, können wir in die Gleichung von oben einsetzen</p>
<p><span class="math notranslate nohighlight">\( x = z \sigma + \mu \)</span></p>
<p><span class="math notranslate nohighlight">\( = 0,25 \times 7,9 + 163,7 \)</span></p>
<p><span class="math notranslate nohighlight">\( \approx 165,66 \)</span></p>
<p>Perfekt, wir sind fertig: <span class="math notranslate nohighlight">\(P(X&lt;165,66)=0,60\)</span></p>
<p>Nun gehen wir den zweiten Ansatz durch, bei dem wir den Schritt der <span class="math notranslate nohighlight">\(z\)</span>-Berechnung überspringen. Alles, was wir tun müssen, ist, die <code class="docutils literal notranslate"><span class="pre">norm.ppf()</span></code>-Funktion mit dem Mittelwert und der Standardabweichung unserer Variablen <code class="docutils literal notranslate"><span class="pre">height</span></code> zu füttern.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">height_mean</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">height_sd</span><span class="p">)</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>165.65972425857925
</pre></div>
</div>
</div>
</div>
<p>Keine Überraschung, die Zahlen stimmen überein: <span class="math notranslate nohighlight">\(P(X&lt;165,66)=0,60\)</span>.</p>
</section>
</section>
</section>
<span id="document-Kapitel03/03_Die_kontinuierliche_gleichmäßige_Verteilung"></span><section class="tex2jax_ignore mathjax_ignore" id="die-kontinuierliche-gleichmaszige-verteilung">
<h2>Die kontinuierliche gleichmäßige Verteilung<a class="headerlink" href="#die-kontinuierliche-gleichmaszige-verteilung" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">uniform</span>
</pre></div>
</div>
</div>
</div>
<p>Die <a href="https://de.wikipedia.org/wiki/Stetige_Gleichverteilung">Gleichverteilung</a> ist die einfachste Wahrscheinlichkeitsverteilung, aber sie spielt eine wichtige Rolle in der Statistik, da sie bei der Modellierung von Zufallsvariablen sehr nützlich ist. Die Gleichverteilung ist eine kontinuierliche Wahrscheinlichkeitsverteilung und befasst sich mit Ereignissen, deren Auftreten gleich wahrscheinlich ist. Die kontinuierliche Zufallsvariable <span class="math notranslate nohighlight">\(X\)</span> gilt als gleichmäßig verteilt oder hat eine rechteckige Verteilung auf dem Intervall <span class="math notranslate nohighlight">\([a \ \)</span>,<span class="math notranslate nohighlight">\( \ b]\)</span>. Wir schreiben <span class="math notranslate nohighlight">\(X \sim U(a \ \)</span>,<span class="math notranslate nohighlight">\( \ b)\)</span>, wenn seine Wahrscheinlichkeitsdichtefunktion gleich <span class="math notranslate nohighlight">\(f(x)=\frac{1}{b-a},x \in [a \ \)</span>,<span class="math notranslate nohighlight">\( \ b]\)</span> und ansonsten gleich <span class="math notranslate nohighlight">\(0\)</span> ist (<span id="id1">Papula [<a class="reference internal" href="intro.html#id8" title="Lothar Papula. Mathematik für Ingenieure und Naturwissenschaftler Band 3. Springer, 2016.">2016</a>]</span> s.331).</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x) =
\begin{cases}
\frac{1}{b-a},  &amp; \text{wenn   $a \le x \le b$} \\[2ex]
0, &amp; \text{wenn   $x &lt; a$   oder   $x &gt; b$}
\end{cases}
\end{split}\]</div>
<p>Die folgende Abbildung zeigt eine kontinuierliche Gleichverteilung <span class="math notranslate nohighlight">\(X \sim U(-2 \ \)</span>,<span class="math notranslate nohighlight">\( \ 0,8)\)</span>, also eine Verteilung, bei der alle Werte von <span class="math notranslate nohighlight">\(x\)</span> innerhalb des Intervalls <span class="math notranslate nohighlight">\([-2 \ \)</span>,<span class="math notranslate nohighlight">\( \ 0,8] \)</span> gleich <span class="math notranslate nohighlight">\( \frac{1}{b-a}(=\frac{1}{0,8-(-2)}\approx 0,36)\)</span> sind, während alle anderen Werte von <span class="math notranslate nohighlight">\(x\)</span> gleich <span class="math notranslate nohighlight">\(0\)</span> sind.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">4.2</span><span class="p">,</span> <span class="mf">4.2</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">uniform</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span> <span class="o">+</span> <span class="mf">0.8</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$X \sim U(-2, 0.8)$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Wahrscheinlichkeitsdichte&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Wahrscheinlichkeitsdichte&#39;)
</pre></div>
</div>
<img alt="_images/03_Die_kontinuierliche_gleichmäßige_Verteilung_6_1.png" src="_images/03_Die_kontinuierliche_gleichmäßige_Verteilung_6_1.png" />
</div>
</div>
<p>Der Mittelwert und der Median sind gegeben durch</p>
<div class="math notranslate nohighlight">
\[\mu = \frac{a+b}{2}\text{.}\]</div>
<p>Die kumulative Dichtefunktion ist unten dargestellt und ergibt sich aus der Gleichung</p>
<div class="math notranslate nohighlight">
\[\begin{split}F(x) =
\begin{cases}
0,  &amp; \text{for $x &lt; a$} \\[2ex]
\frac{x-a}{b-a},  &amp; \text{for $x \in [a,b)$} \\[2ex]
1, &amp; \text{for $x \ge b$}
\end{cases}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">4.2</span><span class="p">,</span> <span class="mf">4.2</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">uniform</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span> <span class="o">+</span> <span class="mf">0.8</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$X \sim U(-2, 0.8)$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Kummulierte Wahrscheinlichkeitsdichte&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Kummulierte Wahrscheinlichkeitsdichte&#39;)
</pre></div>
</div>
<img alt="_images/03_Die_kontinuierliche_gleichmäßige_Verteilung_11_1.png" src="_images/03_Die_kontinuierliche_gleichmäßige_Verteilung_11_1.png" />
</div>
</div>
<section id="die-kontinuierliche-gleichmaszige-verteilung-in-python">
<h3>Die kontinuierliche gleichmäßige Verteilung in Python<a class="headerlink" href="#die-kontinuierliche-gleichmaszige-verteilung-in-python" title="Permalink to this headline">#</a></h3>
<p>Python ermöglicht den Zugriff auf die Gleichverteilung mit den Funktionen <code class="docutils literal notranslate"><span class="pre">uniform.pmf()</span></code>, <code class="docutils literal notranslate"><span class="pre">uniform.cdf()</span></code>, <code class="docutils literal notranslate"><span class="pre">uniform.ppf()</span></code> und <code class="docutils literal notranslate"><span class="pre">uniform.rvs()</span></code>. Wenden Sie die Funktion <code class="docutils literal notranslate"><span class="pre">dir()</span></code> auf diese Funktionen an, um weitere Informationen zu erhalten.</p>
<p>Die Funktion <code class="docutils literal notranslate"><span class="pre">uniform.rvs()</span></code> erzeugt Zufallsabweichungen der Gleichverteilung und wird als <code class="docutils literal notranslate"><span class="pre">uniform.rvs(loc,</span> <span class="pre">loc+scale,</span> <span class="pre">size)</span></code> geschrieben. Wir können auf einfache Weise <span class="math notranslate nohighlight">\(n\)</span> Zufallsstichproben innerhalb eines beliebigen Intervalls erzeugen indem wir die Zahlenwerte für minimalen (<span class="math notranslate nohighlight">\(a\)</span>) und maximalen Wert (<span class="math notranslate nohighlight">\(b\)</span>) in <code class="docutils literal notranslate"><span class="pre">random.uniform(a,b,</span> <span class="pre">size)</span></code> einsetzen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="n">u_rvs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0.55350404, -0.5063741 ,  0.27693478, -0.01248995,  0.42136667,
       -0.88218112, -0.32680424, -0.60184261, -0.81018128, -0.22311094,
        0.73246515,  0.82206639,  0.03968141, -0.19140758, -0.28929085,
        0.80735843, -0.24146944, -0.62780628, -0.65186347,  0.04502945,
        0.788791  , -0.10186822,  0.57706557,  0.92354773, -0.53027695,
       -0.31410927,  0.24158495,  0.05209293,  0.0781444 , -0.90943591,
       -0.89527451, -0.57726987, -0.20234426, -0.36999402,  0.39019899,
        0.89189551, -0.40571908,  0.44073491, -0.84262219, -0.92066239])
</pre></div>
</div>
</div>
</div>
<p>Wir können die Dichtefunktion für <span class="math notranslate nohighlight">\(X \sim U(-2 \ \)</span>,<span class="math notranslate nohighlight">\( \ 0,8)\)</span> mit Hilfe der Funktion <code class="docutils literal notranslate"><span class="pre">uniform.rvs()</span></code> approximieren und die Ergebnisse als Histogramm darstellen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Erzeuge gleichverteilte werte</span>
<span class="n">u_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>

<span class="c1"># Plotte Histogramm</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Histogramm für rand.uniform&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Wahrscheinlichkeitsdichte&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">u_rvs</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([510., 517., 534., 518., 516., 472., 526., 511., 546., 486., 511.,
        434., 480., 478., 502., 486., 456., 508., 524., 485.]),
 array([-1.99999386, -1.86000446, -1.72001506, -1.58002567, -1.44003627,
        -1.30004687, -1.16005747, -1.02006807, -0.88007868, -0.74008928,
        -0.60009988, -0.46011048, -0.32012108, -0.18013169, -0.04014229,
         0.09984711,  0.23983651,  0.37982591,  0.5198153 ,  0.6598047 ,
         0.7997941 ]),
 &lt;BarContainer object of 20 artists&gt;)
</pre></div>
</div>
<img alt="_images/03_Die_kontinuierliche_gleichmäßige_Verteilung_16_1.png" src="_images/03_Die_kontinuierliche_gleichmäßige_Verteilung_16_1.png" />
</div>
</div>
<p>Außerdem stellen wir sowohl das Dichtehistogramm von oben als auch die gleichmäßige Wahrscheinlichkeitsverteilung für das Intervall <span class="math notranslate nohighlight">\([-2 \ \)</span>,<span class="math notranslate nohighlight">\( \ 0,8]\)</span> dar, indem wir die Funktion <code class="docutils literal notranslate"><span class="pre">uniform.pdf()</span></code> anwenden.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Erzeuge x-werte</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2.2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="c1"># Erzeuge gleichverteilte werte</span>
<span class="n">u_rvs</span> <span class="o">=</span> <span class="n">uniform</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>

<span class="c1"># Plotte Histogramm und uniforme pdf</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Histogramm für rand.uniform&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Wahrscheinlichkeitsdichte&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">u_rvs</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">uniform</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span> <span class="o">+</span> <span class="nb">max</span><span class="p">(</span><span class="n">u_rvs</span><span class="p">)),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fb18d9103a0&gt;]
</pre></div>
</div>
<img alt="_images/03_Die_kontinuierliche_gleichmäßige_Verteilung_18_1.png" src="_images/03_Die_kontinuierliche_gleichmäßige_Verteilung_18_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unif_mean</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.6</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">unif_mean</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.7
</pre></div>
</div>
</div>
</div>
<p>Die Abbildung zeigt, dass unsere <span class="math notranslate nohighlight">\(10.000\)</span> Stichproben, die nach dem Zufallsprinzip aus einer Gleichverteilung gezogen wurden (Histogramm), sich der Gleichverteilung <span class="math notranslate nohighlight">\(X \sim U(-2 \ \)</span>,<span class="math notranslate nohighlight">\( \ 0,8)\)</span> (Liniendiagramm).</p>
<p>Außerdem können wir die Funktion <code class="docutils literal notranslate"><span class="pre">uniform.cdf()</span></code> verwenden, um die Fläche unter der Kurve für einen bestimmten Schwellenwert zu berechnen, oder wir können die Funktion <code class="docutils literal notranslate"><span class="pre">uniform.ppf()</span></code> verwenden, um einen Schwellenwert für eine bestimmte Wahrscheinlichkeit zurückzugeben.</p>
<section id="ubung">
<h4>Übung<a class="headerlink" href="#ubung" title="Permalink to this headline">#</a></h4>
<p>Betrachten wir die gleichmäßige Wahrscheinlichkeitsverteilung, die durch <span class="math notranslate nohighlight">\(X \sim U(-3 \ \)</span>,<span class="math notranslate nohighlight">\( \ 5,5)\)</span> gegeben ist.</p>
<p><strong>Frage 1</strong></p>
<p>Wie lautet der Mittelwert <span class="math notranslate nohighlight">\(\mu\)</span> für die gegebene Gleichverteilung.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unif_mean</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span> <span class="o">+</span> <span class="mf">5.5</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">unif_mean</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.25
</pre></div>
</div>
</div>
</div>
<p>Der Mittelwert <span class="math notranslate nohighlight">\(\mu\)</span> für die durch <span class="math notranslate nohighlight">\(X \sim U(-3 \ \)</span>,<span class="math notranslate nohighlight">\( \ 5,5)\)</span> gegebene gleichmäßige Wahrscheinlichkeitsverteilung beträgt <span class="math notranslate nohighlight">\(1,25\)</span>.</p>
<p><strong>Frage 2</strong></p>
<p>Welcher Wert von <span class="math notranslate nohighlight">\(x\)</span> entspricht dem Wert, der die gegebene Gleichverteilung in zwei gleiche Teile teilt, oder anders ausgedrückt: <span class="math notranslate nohighlight">\(P(X \lt ?)=0,5\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_50</span> <span class="o">=</span> <span class="n">uniform</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mf">8.5</span><span class="p">)</span>
<span class="n">p_50</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.25
</pre></div>
</div>
</div>
</div>
<p>Das ist überhaupt keine Überraschung. Der Wert von <span class="math notranslate nohighlight">\(x\)</span>, der die Gleichverteilung in zwei gleiche Teile teilt, beträgt <span class="math notranslate nohighlight">\(1,25\)</span> und ist somit gleich <span class="math notranslate nohighlight">\(\mu\)</span>.</p>
<p><strong>Frage 3</strong></p>
<p>Angenommen, die obige Verteilung beschreibt ein physikalisches Phänomen. Wie groß ist die Wahrscheinlichkeit, dass bei einer Messung des physikalischen Prozesses, der das Phänomen bestimmt, ein Wert <span class="math notranslate nohighlight">\(\ge 4\)</span> gemessen wird, oder anders ausgedrückt: <span class="math notranslate nohighlight">\(P(X \ge 4)\)</span>. Aufgrund des Charakters einer Gleichverteilung ist die Messung eines beliebigen Wertes innerhalb des Intervalls <span class="math notranslate nohighlight">\([-3 \ \)</span>,<span class="math notranslate nohighlight">\( \ 5,5]\)</span> gleich wahrscheinlich ist.</p>
<p>Wir werden diese Frage auf zwei Arten lösen, numerisch und analytisch. Um die Frage numerisch zu lösen, müssen wir zunächst ein Experiment durchführen. Wir wiederholen unsere Messung eine große Anzahl von Malen und zählen dann, wie oft wir einen Wert <span class="math notranslate nohighlight">\(\ge 4\)</span> registriert haben
. Dank der Leistungsfähigkeit von Python und dem integrierten Zufallszahlengenerator <code class="docutils literal notranslate"><span class="pre">uniform.rvs()</span></code> für gleichmäßig verteilte Daten) ist die Wiederholungsaufgabe sehr einfach, allerdings sollte man sich darüber im Klaren sein, dass in realen Anwendungen oft nur eine sehr begrenzte Anzahl von Messungen verfügbar ist.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Erzeuge gleichverteilte Zufallsvariablen und Variable count</span>
<span class="n">u_rvs</span> <span class="o">=</span> <span class="n">uniform</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mf">8.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>

<span class="c1"># Zähle Werte größer gleich 4</span>
<span class="n">count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">u_rvs</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">)</span>

<span class="c1"># Dividiere durch Gesamtanzahl der Werte</span>
<span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">u_rvs</span><span class="p">)</span>
<span class="n">count</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.1784
</pre></div>
</div>
</div>
</div>
<p>Die Ergebnisse zeigen, dass etwa <span class="math notranslate nohighlight">\(18 \%\)</span> der Messungen Werte <span class="math notranslate nohighlight">\(\ge 4\)</span> ergeben.</p>
<p>Zweitens, um die Frage analytisch zu lösen, verwenden wir die kumulative Wahrscheinlichkeitsdichtefunktion, die in Python für gleichmäßige Verteilungen durch die Funktion <code class="docutils literal notranslate"><span class="pre">uniform.cdf()</span></code> implementiert ist.
Wir interessieren uns also für die Fläche unter der Kurve bis zum Wert von <span class="math notranslate nohighlight">\(x=4\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="o">-</span> <span class="n">uniform</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mf">8.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.17647058823529416
</pre></div>
</div>
</div>
</div>
<p>Der analytische Ansatz ergibt ein Ergebnis von <span class="math notranslate nohighlight">\(0,1764706\)</span> oder anders ausgedrückt, mit einer Wahrscheinlichkeit von <span class="math notranslate nohighlight">\(17,65 \%\)</span> erhalten wir Werte <span class="math notranslate nohighlight">\(\ge 4\)</span>, also <span class="math notranslate nohighlight">\(P(X \ge 4) \approx 0,18\)</span>.</p>
<p>Es ist offensichtlich, dass beide Ansätze sehr ähnliche Ergebnisse liefern. Es ist jedoch zu beachten, dass das Ergebnis des numerischen Ansatzes eine Annäherung an das analytische Ergebnis darstellt. Bedenken Sie, dass die Qualität einer solchen Annäherung sehr stark von der Anzahl der Zufallsvariablen abhängt, aus denen die Stichprobe besteht, in unserem Fall von der Anzahl der Messungen.</p>
</section>
</section>
</section>
<span id="document-Kapitel03/04_Die_Student_t_Verteilung"></span><section class="tex2jax_ignore mathjax_ignore" id="die-student-t-verteilung">
<h2>Die Student t-Verteilung<a class="headerlink" href="#die-student-t-verteilung" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">t</span>
</pre></div>
</div>
</div>
</div>
<p>Die Studentsche <span class="math notranslate nohighlight">\(t\)</span>-Verteilung ist nach <a href="https://de.wikipedia.org/wiki/William_Sealy_Gosset">William Sealy Gosset</a> (<span class="math notranslate nohighlight">\(1876-1937\)</span>) benannt, der sie <span class="math notranslate nohighlight">\(1908\)</span> erstmals bestimmte. Gosset war einer der besten Oxford-Absolventen in Chemie und Mathematik seiner Generation. Im Jahr <span class="math notranslate nohighlight">\(1899\)</span> nahm er eine Stelle als Brauer bei <a href="https://en.wikipedia.org/wiki/Guinness_Brewery">Arthur Guinness Son &amp; Co, Ltd</a> in Dublin, Irland, an. Bei seiner Arbeit für die Guinness-Brauerei interessierte er sich für die Qualitätskontrolle anhand kleiner Proben in verschiedenen Stadien des Produktionsprozesses. Da Guinness seinen Angestellten die Veröffentlichung von Papieren untersagte, um die Weitergabe vertraulicher Informationen zu verhindern, hatte Gosset seine Arbeit unter dem Pseudonym “Student” veröffentlicht, und seine Identität war einige Zeit nach der Veröffentlichung seiner berühmtesten Errungenschaften nicht bekannt, so dass die Verteilung den Namen “Studentsche” oder “<span class="math notranslate nohighlight">\(t\)</span>-Distribution” erhielt, wodurch sein Name weniger bekannt wurde als seine wichtigen Ergebnisse in der Statistik (<span id="id1">[<a class="reference internal" href="intro.html#id9" title="Lutz Dümbgen. Einführung in die Statistik. Springer, 2016.">Dümbgen, 2016</a>]</span> s.81).</p>
<p>Die <span class="math notranslate nohighlight">\(t\)</span>-Verteilungskurve ist, wie die Normalverteilungskurve, symmetrisch (glockenförmig) um den Mittelwert. Die <span class="math notranslate nohighlight">\(t\)</span>-Verteilungskurve ist jedoch flacher als die Standard-Normalverteilungskurve. Folglich hat die <span class="math notranslate nohighlight">\(t\)</span>-Verteilungskurve eine geringere Höhe und eine breitere Streuung als die Standardnormalverteilung.</p>
<p>Die <span class="math notranslate nohighlight">\(t\)</span>-Verteilung hat nur einen Parameter, die sogenannten <a href="https://de.wikipedia.org/wiki/Anzahl_der_Freiheitsgrade_(Statistik)"><strong>Freiheitsgrade</strong></a> (<span class="math notranslate nohighlight">\(df\)</span>). Die Form einer bestimmten <span class="math notranslate nohighlight">\(t\)</span>-Verteilungskurve hängt von der Anzahl der Freiheitsgrade (<span class="math notranslate nohighlight">\(df\)</span>) ab. Die Anzahl der Freiheitsgrade für eine <span class="math notranslate nohighlight">\(t\)</span>-Verteilung ist gleich dem Stichprobenumfang minus eins, das heißt,</p>
<div class="math notranslate nohighlight">
\[df = n - 1\]</div>
<p>Wenn der Stichprobenumfang <span class="math notranslate nohighlight">\(n\)</span> und damit <span class="math notranslate nohighlight">\(df\)</span> zunimmt, nähert sich die <span class="math notranslate nohighlight">\(t\)</span>-Verteilung der Standardnormalverteilung an. Die Einheiten einer <span class="math notranslate nohighlight">\(t\)</span>-Verteilung werden mit <span class="math notranslate nohighlight">\(t\)</span> bezeichnet. Der Mittelwert der <span class="math notranslate nohighlight">\(t\)</span>-Verteilung ist gleich <span class="math notranslate nohighlight">\(0\)</span>, und ihre Standardabweichung beträgt <span class="math notranslate nohighlight">\( \sqrt{df/(df-2)}\)</span> (<span id="id2">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.280,s.284).</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">t</span><span class="p">,</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">df</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="k">for</span> <span class="n">_df</span> <span class="ow">in</span> <span class="n">df</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">_df</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;df=</span><span class="si">{</span><span class="n">_df</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;normal&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s2">&quot;Vergleich der t-Warscheinlichkeitsdichtefunktion</span><span class="se">\n</span><span class="s2">mit unterschiedlichen Freiheitsgraden (df) und</span><span class="se">\n</span><span class="s2">der Warscheinlichkeitsdichtefunktion der Normalverteilung&quot;</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fcff0ac74c0&gt;
</pre></div>
</div>
<img alt="_images/04_Die_Student_t_Verteilung_8_1.png" src="_images/04_Die_Student_t_Verteilung_8_1.png" />
</div>
</div>
<section id="grundlegende-eigenschaften-von-t-kurven">
<h3>Grundlegende Eigenschaften von t-Kurven<a class="headerlink" href="#grundlegende-eigenschaften-von-t-kurven" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Die Gesamtfläche unter einer <span class="math notranslate nohighlight">\(t\)</span>-Kurve ist gleich <span class="math notranslate nohighlight">\(1\)</span>.</p></li>
<li><p>Eine <span class="math notranslate nohighlight">\(t\)</span>-Kurve erstreckt sich unendlich in beide Richtungen und nähert sich dabei der horizontalen Achse, berührt sie aber nie.</p></li>
<li><p>Eine <span class="math notranslate nohighlight">\(t\)</span>-Kurve ist symmetrisch um <span class="math notranslate nohighlight">\(0\)</span>.</p></li>
<li><p>Mit zunehmender Anzahl von Freiheitsgraden ähneln <span class="math notranslate nohighlight">\(t\)</span>-Kurven immer mehr der Standard-Normalverteilung.</p></li>
</ul>
</section>
<section id="die-studentsche-t-verteilung-in-python">
<h3>Die Studentsche-t-Verteilung in Python<a class="headerlink" href="#die-studentsche-t-verteilung-in-python" title="Permalink to this headline">#</a></h3>
<hr class="docutils" />
<p>Python ermöglicht den Zugriff auf die <span class="math notranslate nohighlight">\(t\)</span>-Verteilung mit den Funktionen <code class="docutils literal notranslate"><span class="pre">t.pdf()</span></code>, <code class="docutils literal notranslate"><span class="pre">t.cdf()</span></code>, <code class="docutils literal notranslate"><span class="pre">t.ppf()</span></code> und <code class="docutils literal notranslate"><span class="pre">t.rvs()</span></code>. Wenden Sie die Funktion <code class="docutils literal notranslate"><span class="pre">dir()</span></code> auf diese Funktionen an, um weitere Informationen zu erhalten.</p>
<p>Die Funktion <code class="docutils literal notranslate"><span class="pre">t.rvs()</span></code> erzeugt Zufallsabweichungen der <span class="math notranslate nohighlight">\(t\)</span>-Verteilung und wird als<code class="docutils literal notranslate"><span class="pre">t.rvs(df,</span> <span class="pre">loc</span> <span class="pre">,</span> <span class="pre">scale,</span> <span class="pre">size)</span></code> geschrieben. Wir können leicht eine Anzahl von <span class="math notranslate nohighlight">\(n\)</span> Zufallsstichproben erzeugen. Erinnern Sie sich daran, dass die Anzahl der Freiheitsgrade für eine <span class="math notranslate nohighlight">\(t\)</span>-Verteilung gleich dem Stichprobenumfang minus eins ist, d.h.,</p>
<div class="math notranslate nohighlight">
\[df = n - 1\text{.}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generiere Zufallswerte der t Verteilung mit df = 29 und Stichprobengrösse = 30</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">t</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 1.75796339,  1.25988302,  0.03460015,  0.28527209, -0.1855501 ,
       -0.37495924, -1.20257828,  1.51033189,  1.09330665,  0.2899731 ,
        0.62937941, -2.66230945, -0.61542361,  0.80543983,  0.00678409,
        0.31994789,  0.60442283, -0.77053244,  0.56309041, -0.36940274,
        0.81056419,  0.48666856, -0.96164215,  0.62611688,  0.97183549,
        1.89225228,  0.4836484 ,  1.21490386,  0.21622918, -0.78240916])
</pre></div>
</div>
</div>
</div>
<p>Außerdem können wir eine sehr große Anzahl von Stichproben erzeugen und sie als Histogramm darstellen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generiere Zufallswerte der t Verteilung mit df = 9999 und Stichprobengrösse = 10000</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Histogramm der Stichproben&quot;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/04_Die_Student_t_Verteilung_16_0.png" src="_images/04_Die_Student_t_Verteilung_16_0.png" />
</div>
</div>
<p>Mit der Funktion <code class="docutils literal notranslate"><span class="pre">t.pdf()</span></code> können wir die Wahrscheinlichkeitsdichtefunktion und damit den vertikalen Abstand zwischen der horizontalen Achse und der <span class="math notranslate nohighlight">\(t\)</span>-Kurve an jedem beliebigen Punkt berechnen. Zur Demonstration konstruieren wir eine <span class="math notranslate nohighlight">\(t\)</span>-Verteilung mit <span class="math notranslate nohighlight">\(df=5\)</span> und berechnen die Wahrscheinlichkeitsdichtefunktion bei <span class="math notranslate nohighlight">\(t=-4,-2,0,2,4\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">y_t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">y_t</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.00512373, 0.06509031, 0.37960669, 0.06509031, 0.00512373])
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Erzeuge x-werte</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="c1"># Plotte t-Verteilung</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;t-Verteilung, df = 5&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;t-Werte&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Wahrscheinlichkeitsdichte&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
<span class="k">for</span> <span class="n">_t</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">_t</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=-</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">_t</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/04_Die_Student_t_Verteilung_19_0.png" src="_images/04_Die_Student_t_Verteilung_19_0.png" />
</div>
</div>
<p>Eine weitere sehr nützliche Funktion ist die Funktion <code class="docutils literal notranslate"><span class="pre">t.cdf()</span></code>, die die Fläche unter der <span class="math notranslate nohighlight">\(t\)</span>-Kurve für ein beliebiges Intervall liefert. Berechnen wir die Fläche unter der Kurve für die Intervalle <span class="math notranslate nohighlight">\(j_i= \ ]-\infty \ \)</span>,<span class="math notranslate nohighlight">\( \ -2]\)</span> , <span class="math notranslate nohighlight">\(]-\infty \ \)</span>,<span class="math notranslate nohighlight">\( \ 0]\)</span> , <span class="math notranslate nohighlight">\(]-\infty \ \)</span>,<span class="math notranslate nohighlight">\( \ 2]\)</span> und <span class="math notranslate nohighlight">\(k_i=[-2 \ \)</span>,<span class="math notranslate nohighlight">\( \ \infty[\)</span> , <span class="math notranslate nohighlight">\([0 \ \)</span>,<span class="math notranslate nohighlight">\( \ \infty[\)</span> , <span class="math notranslate nohighlight">\([2 \ \)</span>,<span class="math notranslate nohighlight">\( \ \infty[\)</span> für eine Zufallsvariable mit einer <span class="math notranslate nohighlight">\(t\)</span>-Verteilung mit <span class="math notranslate nohighlight">\(df=5\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_cdf_left</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Berechne kumulitative Wahrscheinlichkeit links von Wert _t</span>
<span class="k">for</span> <span class="n">_t</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">_t</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wert für Fläche links von </span><span class="si">{</span><span class="n">_t</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">res</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">x_cdf_left</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Wert für Fläche links von -2: 0.05096973941492914
Wert für Fläche links von 0: 0.5
Wert für Fläche links von 2: 0.9490302605850709
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">t</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">df</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="c1"># axis 0</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">3.2</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">_t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">_t</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">_t</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
        <span class="o">-</span><span class="mf">0.7</span><span class="p">,</span>
        <span class="mf">0.4</span><span class="p">,</span>
        <span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$P(X \leq </span><span class="si">{t}</span><span class="s2">) = \int_{-\infty}^</span><span class="si">{t}</span><span class="s2">f(x)dx$&quot;</span><span class="p">,</span>
        <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
        <span class="mi">2</span><span class="p">,</span>
        <span class="mf">0.3</span><span class="p">,</span>
        <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Fläche = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">_t</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;$t=</span><span class="si">{</span><span class="n">_t</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="k">for</span> <span class="n">_ax</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">:</span>
    <span class="n">_ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/04_Die_Student_t_Verteilung_22_0.png" src="_images/04_Die_Student_t_Verteilung_22_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_cdf_right</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Berechne kumulitative Wahrscheinlichkeit rechts von Wert _t</span>
<span class="k">for</span> <span class="n">_t</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
    <span class="n">res</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">t</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">_t</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wert für Fläche rechts von </span><span class="si">{</span><span class="n">_t</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">res</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">x_cdf_right</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Wert für Fläche rechts von -2: 0.9490302605850709
Wert für Fläche rechts von 0: 0.5
Wert für Fläche rechts von 2: 0.050969739414929105
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">t</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">df</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="c1"># axis 0</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">3.2</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">_t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">_t</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">_t</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
        <span class="o">-</span><span class="mf">0.7</span><span class="p">,</span>
        <span class="mf">0.4</span><span class="p">,</span>
        <span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$P(X \leq </span><span class="si">{t}</span><span class="s2">) = \int_{-\infty}^</span><span class="si">{t}</span><span class="s2">f(x)dx$&quot;</span><span class="p">,</span>
        <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
        <span class="mi">2</span><span class="p">,</span>
        <span class="mf">0.3</span><span class="p">,</span>
        <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Fläche = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">t</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">_t</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;$t=</span><span class="si">{</span><span class="n">_t</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="k">for</span> <span class="n">_ax</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">:</span>
    <span class="n">_ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/04_Die_Student_t_Verteilung_24_0.png" src="_images/04_Die_Student_t_Verteilung_24_0.png" />
</div>
</div>
<p>Die Funktion <code class="docutils literal notranslate"><span class="pre">t.ppf()</span></code> liefert die Quantilfunktion und ist damit die Umkehrfunktion von <code class="docutils literal notranslate"><span class="pre">t.cdf()</span></code>. Für die Intervalle <span class="math notranslate nohighlight">\(j_i= ]-\infty \ \)</span>,<span class="math notranslate nohighlight">\( \ -2]\)</span> , <span class="math notranslate nohighlight">\(]-\infty \ \)</span>,<span class="math notranslate nohighlight">\( \ 0]\)</span> , <span class="math notranslate nohighlight">\(]-\infty \ \)</span>,<span class="math notranslate nohighlight">\( \ 2]\)</span> einer Zufallsvariablen, die einer <span class="math notranslate nohighlight">\(t\)</span>-Verteilung mit <span class="math notranslate nohighlight">\(df=5\)</span> folgt, liefert die Funktion <code class="docutils literal notranslate"><span class="pre">t.ppf()</span></code>…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_cdf_left</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.05096973941492914, 0.5, 0.9490302605850709]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_cdf_left</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.05: -2.0
0.5: 0.0
0.95: 2.0
</pre></div>
</div>
</div>
</div>
<p>… und für die Intervalle <span class="math notranslate nohighlight">\(k_i=[-2 \ \)</span>,<span class="math notranslate nohighlight">\( \ \infty[\)</span> , <span class="math notranslate nohighlight">\([0 \ \)</span>,<span class="math notranslate nohighlight">\( \ \infty[\)</span> , <span class="math notranslate nohighlight">\([2 \ \)</span>,<span class="math notranslate nohighlight">\( \ \infty[\)</span> einer Zufallsvariablen, die einer <span class="math notranslate nohighlight">\(t\)</span>-Verteilung mit <span class="math notranslate nohighlight">\(df=5\)</span> folgt, liefert die Funktion <code class="docutils literal notranslate"><span class="pre">t.ppf</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_cdf_right</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.95: 2.0
0.5: 0.0
0.05: -2.0
</pre></div>
</div>
</div>
</div>
</section>
</section>
<span id="document-Kapitel03/05_Die_Chi_Quadrat_Verteilung"></span><section class="tex2jax_ignore mathjax_ignore" id="die-chi-quadrat-verteilung">
<h2>Die Chi-Quadrat-Verteilung<a class="headerlink" href="#die-chi-quadrat-verteilung" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chi2</span>
</pre></div>
</div>
</div>
</div>
<p>Die Chi-Quadrat (<span class="math notranslate nohighlight">\(\chi^2\)</span>) ist eine der wichtigsten kontinuierlichen Wahrscheinlichkeitsverteilungen mit vielen Anwendungen in der statistischen Theorie und Inferenz (<span id="id1">[<a class="reference internal" href="intro.html#id8" title="Lothar Papula. Mathematik für Ingenieure und Naturwissenschaftler Band 3. Springer, 2016.">Papula, 2016</a>]</span> s.441).</p>
<p>Sei <span class="math notranslate nohighlight">\(n \gt 0\)</span> eine positive ganze Zahl. Für eine Zufallsvariable, die eine (<span class="math notranslate nohighlight">\(\chi^2\)</span>)-Verteilung mit <span class="math notranslate nohighlight">\(n\)</span> Freiheitsgraden (<span class="math notranslate nohighlight">\(df\)</span>) hat, lautet die Wahrscheinlichkeitsdichtefunktion</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x) =
\begin{cases}
0 &amp; \text{wenn $x \le 0$} \\
\frac{x^{(n/2-1)}e^{-x/2}}{2^{n/2}\Gamma \left(\frac{k}{2}\right)} &amp; \text{wenn $x &gt; 0$}
\end{cases}
\end{split}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(\Gamma\)</span> die <a href="https://de.wikipedia.org/wiki/Gammafunktion">Gamma-Funktion</a> bezeichnet. Die (<span class="math notranslate nohighlight">\(\chi^2\)</span>)-Verteilung (mit <span class="math notranslate nohighlight">\(n\)</span> Freiheitsgraden) ist gleich der <span class="math notranslate nohighlight">\(\Gamma\)</span>-Verteilung mit den Parametern <span class="math notranslate nohighlight">\((n/2,2)\)</span>, d. h. mit Mittelwert und Varianz gleich <span class="math notranslate nohighlight">\(n\)</span> bzw. <span class="math notranslate nohighlight">\(2n\)</span>.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chi2</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">df</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="k">for</span> <span class="n">_df</span> <span class="ow">in</span> <span class="n">df</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">chi2</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">_df</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;df=</span><span class="si">{</span><span class="n">_df</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s2">&quot;$\chi^2$-Warscheinlichkeitsdichtefunktion mit unterschiedlichen Freiheitsgraden (df)&quot;</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.lines.Line2D at 0x7f5650fcd060&gt;
</pre></div>
</div>
<img alt="_images/05_Die_Chi_Quadrat_Verteilung_6_1.png" src="_images/05_Die_Chi_Quadrat_Verteilung_6_1.png" />
</div>
</div>
<p><strong>Grundlegende Eigenschaften von <span class="math notranslate nohighlight">\(\chi^2\)</span>-Kurven</strong></p>
<p>Die Gesamtfläche unter einer <span class="math notranslate nohighlight">\(\chi^2\)</span></p>
<ul class="simple">
<li><p>Kurve ist gleich <span class="math notranslate nohighlight">\(1\)</span></p></li>
<li><p>Eine <span class="math notranslate nohighlight">\(\chi^2\)</span>-Kurve beginnt bei <span class="math notranslate nohighlight">\(0\)</span> auf der horizontalen Achse und erstreckt sich unendlich weit nach rechts, wobei sie sich der horizontalen Achse nähert, diese aber nie berührt.</p></li>
<li><p>Eine <span class="math notranslate nohighlight">\(\chi^2\)</span>-Kurve ist rechtsschief.</p></li>
<li><p>Mit zunehmender Anzahl von Freiheitsgraden sehen <span class="math notranslate nohighlight">\(\chi^2\)</span>-Kurven zunehmend wie normalverteilt aus.</p></li>
</ul>
<section id="die-chi-quadrat-verteilung-in-python">
<h3>Die Chi-Quadrat-Verteilung in Python<a class="headerlink" href="#die-chi-quadrat-verteilung-in-python" title="Permalink to this headline">#</a></h3>
<hr class="docutils" />
<p>Die wichtigsten Funktionen zur Interaktion mit der <span class="math notranslate nohighlight">\(\chi^2\)</span>-Verteilung sind <code class="docutils literal notranslate"><span class="pre">chi2.pdf</span></code>(), <code class="docutils literal notranslate"><span class="pre">chi2.cdf()</span></code>, <code class="docutils literal notranslate"><span class="pre">chi2.ppf()</span></code>, <code class="docutils literal notranslate"><span class="pre">chi2.rvs()</span></code>. Die Funktion <code class="docutils literal notranslate"><span class="pre">chi2.pdf()</span></code> liefert die Dichte, die Funktion <code class="docutils literal notranslate"><span class="pre">chi2.cdf()</span></code> die Verteilungsfunktion, die Funktion <code class="docutils literal notranslate"><span class="pre">chi2.ppf()</span></code> die Quantilfunktion und die Funktion <code class="docutils literal notranslate"><span class="pre">chi2.rvs()</span></code> die Zufallsabweichungen.</p>
<p>Wir verwenden die Funktion <code class="docutils literal notranslate"><span class="pre">chi2.pdf()</span></code>, um die Dichte für die ganzzahligen Werte <span class="math notranslate nohighlight">\(4\)</span> bis <span class="math notranslate nohighlight">\(8\)</span> einer <span class="math notranslate nohighlight">\(\chi^2\)</span>-Kurve mit <span class="math notranslate nohighlight">\(df=7\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">chi2</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="mi">7</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.11518072856146785
0.12204152134938738
0.11676521599113947
0.10411977480817192
0.08817913751079275
</pre></div>
</div>
</div>
</div>
<p>Wir verwenden <code class="docutils literal notranslate"><span class="pre">chi2.cdf()</span></code>, um die Fläche unter der Kurve für das Intervall <span class="math notranslate nohighlight">\([0,6]\)</span> und das Intervall <span class="math notranslate nohighlight">\([6,\infty[\)</span> einer<span class="math notranslate nohighlight">\(\chi^2\)</span>-Kurve mit <span class="math notranslate nohighlight">\(df=7\)</span> zu berechnen. Weiter fragen wir Python, ob die Summe der Intervalle <span class="math notranslate nohighlight">\([0,6]\)</span> und <span class="math notranslate nohighlight">\([6,\infty[\)</span> den Wert <span class="math notranslate nohighlight">\(1\)</span> ergibt.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chi2_cdf1</span> <span class="o">=</span> <span class="n">chi2</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">chi2_cdf1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.4602506496044429
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chi2_cdf2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">chi2</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">chi2_cdf2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.539749350395557
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chi2_cdf1</span> <span class="o">+</span> <span class="n">chi2_cdf2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
<p>Wir verwenden <code class="docutils literal notranslate"><span class="pre">chi2.ppf()</span></code>, um das Quantil für eine bestimmte Fläche (= Wahrscheinlichkeit) unter der Kurve für eine <span class="math notranslate nohighlight">\(\chi^2\)</span>-Kurve mit <span class="math notranslate nohighlight">\(df=7\)</span> zu berechnen, die <span class="math notranslate nohighlight">\(q=0,25\)</span>,<span class="math notranslate nohighlight">\(0,5\)</span>,<span class="math notranslate nohighlight">\(0,75\)</span> und <span class="math notranslate nohighlight">\(0,999\)</span> entspricht.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chi2</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.2548521835465145
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chi2</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6.345811195521515
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chi2</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9.037147547908143
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chi2</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.999</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>24.321886347856854
</pre></div>
</div>
</div>
</div>
<p>Wir verwenden die Funktion <code class="docutils literal notranslate"><span class="pre">chi2.rvs()</span></code>, um <span class="math notranslate nohighlight">\(100.000\)</span> Zufallswerte aus der<span class="math notranslate nohighlight">\(\chi^2\)</span>-Verteilung mit <span class="math notranslate nohighlight">\(df=7\)</span> zu erzeugen. Anschließend zeichnen wir ein Histogramm und vergleichen es mit der Wahrscheinlichkeitsdichtefunktion der <span class="math notranslate nohighlight">\(\chi^2\)</span>-Verteilung mit <span class="math notranslate nohighlight">\(df=7\)</span> (orangefarbene Linie).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Erzeuge Chi^2 Werte</span>
<span class="n">chi2_rvs</span> <span class="o">=</span> <span class="n">chi2</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10000000</span><span class="p">)</span>

<span class="c1"># Erzeuge x-werte</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="c1"># Plotte chi2-Verteilung</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Histogramm der $\chi^2$ Verteilung mit 7 Freiheitsgraden&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Wahrscheinlichkeitsdichte&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">chi2_rvs</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">chi2</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="mi">7</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f564ecd6500&gt;]
</pre></div>
</div>
<img alt="_images/05_Die_Chi_Quadrat_Verteilung_22_1.png" src="_images/05_Die_Chi_Quadrat_Verteilung_22_1.png" />
</div>
</div>
</section>
</section>
<span id="document-Kapitel03/06_Die_F_Verteilung"></span><section class="tex2jax_ignore mathjax_ignore" id="die-f-verteilung">
<h2>Die F-Verteilung<a class="headerlink" href="#die-f-verteilung" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">f</span>
</pre></div>
</div>
</div>
</div>
<p>Die Snedecor-<span class="math notranslate nohighlight">\(F\)</span>-Verteilung oder die Fisher-Snedecor-Verteilung (nach <a href="https://de.wikipedia.org/wiki/Ronald_Aylmer_Fisher">Sir Ronald A. Fisher</a> und <a href="https://de.wikipedia.org/wiki/George_W._Snedecor">George W. Snedecor</a>) oder kurz die <strong><span class="math notranslate nohighlight">\(F\)</span>-Verteilung</strong> ist eine kontinuierliche Wahrscheinlichkeitsverteilung mit dem Bereich <span class="math notranslate nohighlight">\([0 \ \)</span>,<span class="math notranslate nohighlight">\( \ +\infty[\)</span>, abhängig von zwei Parametern, die mit <span class="math notranslate nohighlight">\(v_1,v_2\)</span> bezeichnet werden (<span id="id1">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.281, <span id="id2">[<a class="reference internal" href="intro.html#id14" title="Stefanie Scheid, Sandro und Vogl. Data Science: Grundlagen, Methode und Modelle der Statistik. Carl Hanser Verlag GmbH Co KG, 2021.">Scheid, 2021</a>]</span> s.179). In statistischen Anwendungen sind <span class="math notranslate nohighlight">\(v_1,v_2\)</span>
positive ganze Zahlen.</p>
<p>Seien <span class="math notranslate nohighlight">\(Y_1\)</span> und <span class="math notranslate nohighlight">\(Y_2\)</span> seien zwei unabhängige Zufallsvariablen, die <strong>Chi-Quadrat</strong>-verteilt sind, mit <span class="math notranslate nohighlight">\(v_1\)</span> bzw. <span class="math notranslate nohighlight">\(v_2\)</span> Freiheitsgraden. Dann wird die Verteilung des Verhältnisses (<span class="math notranslate nohighlight">\(Z\)</span>)</p>
<div class="math notranslate nohighlight">
\[Z = \frac{Y_1/v_1}{Y_2/v_2}\]</div>
<p>als <span class="math notranslate nohighlight">\(F\)</span>-Verteilung mit <span class="math notranslate nohighlight">\(v_1\)</span> und <span class="math notranslate nohighlight">\(v_2\)</span> Freiheitsgraden bezeichnet. Die <span class="math notranslate nohighlight">\(F\)</span>-Verteilung wird häufig auch als <em>Verteilung des Varianzverhältnisses</em> bezeichnet (<span id="id3">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.281).</p>
<p>Eine <span class="math notranslate nohighlight">\(F\)</span>-Verteilung hat zwei Zahlen von Freiheitsgraden, <span class="math notranslate nohighlight">\(v_1\)</span> und <span class="math notranslate nohighlight">\(v_2\)</span>, die ihre Form bestimmen. Die erste Zahl der Freiheitsgrade, <span class="math notranslate nohighlight">\(v_1\)</span>, wird als die <strong>Freiheitsgrade des Zählers</strong> und die zweite, <span class="math notranslate nohighlight">\(v_2\)</span>, als die <strong>Freiheitsgrade des Nenners</strong> bezeichnet.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">f</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">v1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="n">v2</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="k">for</span> <span class="n">_df</span> <span class="ow">in</span> <span class="n">v1</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dfn</span><span class="o">=</span><span class="n">_df</span><span class="p">,</span> <span class="n">dfd</span><span class="o">=</span><span class="n">v2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$v_1$=</span><span class="si">{</span><span class="n">_df</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s2">&quot;F-Warscheinlichkeitsdichtefunktion mit unterschiedlichen Freiheitsgraden ($v_1$, $v_2 =20$)&quot;</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.lines.Line2D at 0x7f1c98049120&gt;
</pre></div>
</div>
<img alt="_images/06_Die_F_Verteilung_7_1.png" src="_images/06_Die_F_Verteilung_7_1.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">f</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">v1</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">v2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="k">for</span> <span class="n">_df</span> <span class="ow">in</span> <span class="n">v2</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dfn</span><span class="o">=</span><span class="n">v1</span><span class="p">,</span> <span class="n">dfd</span><span class="o">=</span><span class="n">_df</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$v_1$=</span><span class="si">{</span><span class="n">_df</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s2">&quot;F-Warscheinlichkeitsdichtefunktion mit unterschiedlichen Freiheitsgraden ($v_1=20$, $v_2$)&quot;</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.lines.Line2D at 0x7f1c9584faf0&gt;
</pre></div>
</div>
<img alt="_images/06_Die_F_Verteilung_8_1.png" src="_images/06_Die_F_Verteilung_8_1.png" />
</div>
</div>
<p><strong>Grundlegende Eigenschaften von F-Kurven</strong></p>
<ul class="simple">
<li><p>Die Gesamtfläche unter einer <span class="math notranslate nohighlight">\(F\)</span>-Kurve ist gleich <span class="math notranslate nohighlight">\(1\)</span>.
-Eine <span class="math notranslate nohighlight">\(F\)</span>-Kurve beginnt bei <span class="math notranslate nohighlight">\(0\)</span> auf der horizontalen Achse und erstreckt sich unendlich weit nach rechts, wobei sie sich der horizontalen Achse nähert, diese aber nie berührt.</p></li>
<li><p>Eine <span class="math notranslate nohighlight">\(F\)</span>-Kurve ist rechtsschief.</p></li>
</ul>
<section id="die-f-verteilung-in-python">
<h3>Die F-Verteilung in Python<a class="headerlink" href="#die-f-verteilung-in-python" title="Permalink to this headline">#</a></h3>
<hr class="docutils" />
<p>Die wichtigsten Funktionen zur Interaktion mit der <span class="math notranslate nohighlight">\(F\)</span>-Verteilung sind <code class="docutils literal notranslate"><span class="pre">f.pdf()</span></code>, <code class="docutils literal notranslate"><span class="pre">f.cdf()</span></code>, <code class="docutils literal notranslate"><span class="pre">f.ppf()</span></code>, <code class="docutils literal notranslate"><span class="pre">f.rvs()</span></code>. Die Funktion <code class="docutils literal notranslate"><span class="pre">f.pdf</span></code>() liefert die Dichte, die Funktion <code class="docutils literal notranslate"><span class="pre">f.cdf()</span></code> die Verteilungsfunktion, die Funktion <code class="docutils literal notranslate"><span class="pre">f.ppf()</span></code> die Quantilfunktion und die Funktion <code class="docutils literal notranslate"><span class="pre">f.rvs()</span></code> erzeugt Zufallsabweichungen.</p>
<p>Wir verwenden die Funktion <code class="docutils literal notranslate"><span class="pre">f.pdf()</span></code>, um die Dichte bei einem Wert von <span class="math notranslate nohighlight">\(1,2\)</span> einer <span class="math notranslate nohighlight">\(F\)</span>-Kurve mit <span class="math notranslate nohighlight">\(v_1=10\)</span> und <span class="math notranslate nohighlight">\(v_2=20\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5626124566227062
</pre></div>
</div>
</div>
</div>
<p>Wir verwenden <code class="docutils literal notranslate"><span class="pre">f.cdf()</span></code>, um die Fläche unter der Kurve für das Intervall <span class="math notranslate nohighlight">\([0 \ \)</span>,<span class="math notranslate nohighlight">\( \ 1,5]\)</span> und das Intervall <span class="math notranslate nohighlight">\([1,5 \ \)</span>,<span class="math notranslate nohighlight">\( \ +\infty[\)</span> einer F-Kurve mit <span class="math notranslate nohighlight">\(v_1=10\)</span> und <span class="math notranslate nohighlight">\(v_2=20\)</span> zu berechnen. Weiter fragen wir Python, ob die Summe der Intervalle <span class="math notranslate nohighlight">\([0 \ \)</span>,<span class="math notranslate nohighlight">\( \ 1,5]\)</span> und <span class="math notranslate nohighlight">\([1,5 \ \)</span>,<span class="math notranslate nohighlight">\( \ +\infty[\)</span> den Wert <span class="math notranslate nohighlight">\(1\)</span> ergibt.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_cdf1</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">f_cdf1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7890535374813874
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_cdf2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">f</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">f_cdf2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.2109464625186126
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_cdf1</span> <span class="o">+</span> <span class="n">f_cdf2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
<p>Wir verwenden <code class="docutils literal notranslate"><span class="pre">f.ppf()</span></code>, um das Quantil für eine bestimmte Fläche (= Wahrscheinlichkeit) unter der Kurve für eine <span class="math notranslate nohighlight">\(F\)</span>-Kurve mit <span class="math notranslate nohighlight">\(v_1=10\)</span> und <span class="math notranslate nohighlight">\(v_2=20\)</span> zu berechnen, die <span class="math notranslate nohighlight">\(q=0,25,0,5,0,75\)</span> und <span class="math notranslate nohighlight">\(0,999\)</span> entspricht.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.999</span><span class="p">]</span>
<span class="n">f</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.65639363, 0.96626389, 1.39948744, 5.07524621])
</pre></div>
</div>
</div>
</div>
<p>Wir verwenden die Funktion <code class="docutils literal notranslate"><span class="pre">f.rvs()</span></code>, um <span class="math notranslate nohighlight">\(100.000\)</span> Zufallswerte aus der <span class="math notranslate nohighlight">\(F\)</span>-Verteilung mit <span class="math notranslate nohighlight">\(v_1=10\)</span> und <span class="math notranslate nohighlight">\(v_2=20\)</span> zu erzeugen. Anschließend zeichnen wir ein Histogramm und vergleichen es mit der Wahrscheinlichkeitsdichtefunktion der <span class="math notranslate nohighlight">\(F\)</span>-Verteilung mit <span class="math notranslate nohighlight">\(v_1=10\)</span> und <span class="math notranslate nohighlight">\(v_2=20\)</span> (orange Linie).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Erzeuge Chi^2 Werte</span>
<span class="n">f_rvs</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>

<span class="c1"># Erzeuge x-werte</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="c1"># Plotte t-Verteilung</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="c1"># plt.xlim(0,4.5)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Histogramm der F-Verteilung mit $v_1=10$ und $v_2=20$ Freiheitsgraden&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Wahrscheinlichkeitsdichte&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">f_rvs</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f1c958f1ab0&gt;]
</pre></div>
</div>
<img alt="_images/06_Die_F_Verteilung_21_1.png" src="_images/06_Die_F_Verteilung_21_1.png" />
</div>
</div>
</section>
</section>
<span id="document-Aufgaben/Kapitel03/Aufgaben"></span><section class="tex2jax_ignore mathjax_ignore" id="ubungsaufgaben">
<h2>Übungsaufgaben<a class="headerlink" href="#ubungsaufgaben" title="Permalink to this headline">#</a></h2>
<div class="toctree-wrapper compound">
<span id="document-Aufgaben/Kapitel03/PDF"></span><section class="tex2jax_ignore mathjax_ignore" id="wahrscheinlichkeitsdichtefunktion">
<h3>Wahrscheinlichkeitsdichtefunktion<a class="headerlink" href="#wahrscheinlichkeitsdichtefunktion" title="Permalink to this headline">#</a></h3>
<ol class="simple">
<li><p>Nennen Sie die <span class="math notranslate nohighlight">\(3\)</span> Haupteigenschaften von Wahrscheinlichkeitsdichtfunktionen (PDF).</p></li>
<li><p>Wie kann das Flächenintegral über eine Wahrscheinlichkeitsdichtfunktion interpretiert werden?</p></li>
<li><p>Mit welcher Python Funktion kann die Warscheinlichkeitsdichtefunkten der Normaverteilung bestimmt werden?</p></li>
</ol>
<hr class="docutils" />
<section id="losungen">
<h4>Lösungen<a class="headerlink" href="#losungen" title="Permalink to this headline">#</a></h4>
<div class="toggle docutils container">
<ul class="simple">
<li><p>Eine PDF wird immer auf oder über der horizontalen Achse gezeichnet</p></li>
<li><p>Die Gesamtfläche zwischen einer PDF und der horizontalen Achse ist gleich <span class="math notranslate nohighlight">\(1\)</span> und somit liegt jeder Wert in jedem Teilintervall der PDF im Bereich von <span class="math notranslate nohighlight">\(0\)</span> bis <span class="math notranslate nohighlight">\(1\)</span></p></li>
<li><p>Alle möglichen Beobachtungen der Variablen, die innerhalb eines bestimmten Bereichs liegen, entsprechen der entsprechenden Fläche unter der Dichtefunktion und können als prozentueller Anteil ausgedrückt werden.</p></li>
</ul>
<p>(<span id="id1">[<a class="reference internal" href="intro.html#id8" title="Lothar Papula. Mathematik für Ingenieure und Naturwissenschaftler Band 3. Springer, 2016.">Papula, 2016</a>]</span> s.327)</p>
</div>
<div class="toggle docutils container">
<p>Das Integral über einer Wahrscheinlichkeitsdichte entspricht der Wahrscheinlichkeit das die entsprechende Zufallsvariable in diesem Bereich liegt.</p>
</div>
<div class="toggle docutils container">
<p>Das Paket Scipy liefert die für alle geläufigen Wahrscheinlichkeitsdichtefunktionen, so auch für die Normalverteilung die Funktion <code class="docutils literal notranslate"><span class="pre">pdf</span></code> (z.B. <code class="docutils literal notranslate"><span class="pre">scipy.stats.norm.pdf()</span></code>, siehe auch <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.norm.html">https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.norm.html</a>)</p>
</div>
</section>
</section>
<span id="document-Aufgaben/Kapitel03/689599_Regel"></span><section class="tex2jax_ignore mathjax_ignore" id="die-68-95-99-7-regel">
<h3>Die 68-95-99,7-Regel<a class="headerlink" href="#die-68-95-99-7-regel" title="Permalink to this headline">#</a></h3>
<ol class="simple">
<li><p>Was sind die Hauptaussagen der <span class="math notranslate nohighlight">\(68-95-99,7\)</span>-Regel?</p></li>
<li><p>Berechnen Sie die entsprechenden Integrale nach der <span class="math notranslate nohighlight">\(68-95-99,7\)</span>-Regel für die Normalverteilung <span class="math notranslate nohighlight">\(X \sim N( -2, 2)\)</span></p></li>
</ol>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 2 ...</span>
</pre></div>
</div>
</div>
</div>
<section id="losungen">
<h4>Lösungen<a class="headerlink" href="#losungen" title="Permalink to this headline">#</a></h4>
<p><strong>Frage 1</strong></p>
<div class="toggle docutils container">
<p>Die Kernaussagen der <span class="math notranslate nohighlight">\(68-95-99,7\)</span>-Regel lauten:</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(68 \%\)</span> der Beobachtungen liegen innerhalb <strong>einer</strong> Standardabweichung des Mittelwerts,</p></li>
<li><p><span class="math notranslate nohighlight">\(95 \%\)</span> der Beobachtungen liegen innerhalb von <strong>zwei</strong> Standardabweichungen des Mittelwerts, und</p></li>
<li><p><span class="math notranslate nohighlight">\(99,7 \%\)</span> der Beobachtungen liegen innerhalb von <strong>drei</strong> Standardabweichungen des Mittelwerts.</p></li>
</ol>
<p>(<span id="id1">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.86)</p>
</div>
<p><strong>Frage 2</strong></p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>

<span class="n">loc</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="n">scale</span> <span class="o">=</span> <span class="mi">2</span>
<span class="k">for</span> <span class="n">sd</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sd</span><span class="si">}</span><span class="s2"> Standardabweichung(en):&quot;</span><span class="p">,</span>
        <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">loc</span> <span class="o">+</span> <span class="n">sd</span> <span class="o">*</span> <span class="n">scale</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
        <span class="o">-</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">loc</span> <span class="o">-</span> <span class="n">sd</span> <span class="o">*</span> <span class="n">scale</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">),</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 Standardabweichung(en): 0.6826894921370859
2 Standardabweichung(en): 0.9544997361036416
3 Standardabweichung(en): 0.9973002039367398
</pre></div>
</div>
</div>
</div>
</section>
</section>
<span id="document-Aufgaben/Kapitel03/Normalverteilung"></span><section class="tex2jax_ignore mathjax_ignore" id="die-normalverteilung">
<h3>Die Normalverteilung<a class="headerlink" href="#die-normalverteilung" title="Permalink to this headline">#</a></h3>
<ol class="simple">
<li><p>Welche Kenngrößen charakterisieren die Normalverteilung</p></li>
<li><p>Was ist die Standardnormalverteilung und in welchem Bezug steht sie zur Normalverteilung?</p></li>
<li><p>Generieren Sie <span class="math notranslate nohighlight">\(10.000\)</span> Zufallswerte für die Normalverteilung mit Mittelwert <span class="math notranslate nohighlight">\(\mu = 1\)</span> und Standardabweichung <span class="math notranslate nohighlight">\(\sigma = 3\)</span>, unter Verwendung der Funktion <code class="docutils literal notranslate"><span class="pre">np.random.normal(loc,</span> <span class="pre">scale,</span> <span class="pre">size)</span></code>, und stellen Sie das Ergebnis als Histogramm dar.</p></li>
<li><p>Führen Sie eine <span class="math notranslate nohighlight">\(z\)</span>-Transformation für diese Werte durch und plotten Sie das Ergebnis.</p></li>
</ol>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 3 ...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 4 ...</span>
</pre></div>
</div>
</div>
</div>
<section id="losungen">
<h4>Lösungen<a class="headerlink" href="#losungen" title="Permalink to this headline">#</a></h4>
<div class="toggle docutils container">
<p>Die Normalverteilung wird durch ihren Mittelwert <span class="math notranslate nohighlight">\(\mu\)</span> und ihre Standardabweichung <span class="math notranslate nohighlight">\(\sigma\)</span> beschrieben. <span class="math notranslate nohighlight">\(X \sim N( \mu, \sigma)\)</span></p>
</div>
<div class="toggle docutils container">
<p>Die Standardnormalverteilung ist die Normalverteilung mit Mittelwert <span class="math notranslate nohighlight">\(\mu=0\)</span> und Standardabweichung <span class="math notranslate nohighlight">\(\sigma=1\)</span>. Sie entspricht also der Normalverteilung mit <span class="math notranslate nohighlight">\(X \sim N( 0, 1)\)</span>. Durch die Anwendung der <span class="math notranslate nohighlight">\(z\)</span>-Transformation <span class="math notranslate nohighlight">\(z = \frac{x-\mu}{\sigma}\)</span> können beliebige Normalverteilungen auf die Standardnormalverteilung abgebildet werden.</p>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">loc</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">scale</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Normalverteilung_9_0.png" src="_images/Normalverteilung_9_0.png" />
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Normalverteilung_10_0.png" src="_images/Normalverteilung_10_0.png" />
</div>
</div>
</section>
</section>
</div>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-Lernziele/Kapitel4_Lernziele"></span><section class="tex2jax_ignore mathjax_ignore" id="lernziele">
<h2>Lernziele<a class="headerlink" href="#lernziele" title="Permalink to this headline">#</a></h2>
<section id="zentraler-grenzwertsatz">
<h3>Zentraler Grenzwertsatz<a class="headerlink" href="#zentraler-grenzwertsatz" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Die Kernaussagen des zentralen Grenzwertsatzes werden vorgestellt und anhand von interaktiven Beispielen wird veranschaulicht, daß durch Entnahme von Stichproben geeigneten Umfangs, Aussagen über die zugrundeliegende Grundgesamtheit getroffen werden können</p></li>
<li><p>Die Studierenden lernen, daß die entnommene Stichprobe als neue Zufallsvariable aufzufassen ist und können selbständig überprüfen, daß Folgen von Stichproben, unabhängig von ihrer ursprünglichen Verteilung, in ihrem Mittelwert, bei <span class="math notranslate nohighlight">\(n\)</span>-facher Wiederholung der Stichprobe, gegen eine Normalverteilung um denselben Mittlewert konvergieren</p></li>
<li><p>Die Studierenden lernen den Standardfehler <span class="math notranslate nohighlight">\( \sigma_{\bar{x}} \)</span> anhand des Beispiels des Standardfehlers des Mittlewerts <span class="math notranslate nohighlight">\(\sigma_{\bar{x}} = \frac{\sigma}{\sqrt{n}} \)</span> kennen</p></li>
<li><p>Zusammengefasst werden folgende Begriffe und Methoden besprochen : Zentraler Grenzwertsatz, Grundgesamtheit, Stichprobenverteilungen, Stichprobenfehler, Standardfehler</p></li>
</ul>
</section>
</section>
<span id="document-Kapitel04/01_Zentraler_Grenzwertsatz"></span><section class="tex2jax_ignore mathjax_ignore" id="der-zentrale-grenzwertsatz">
<h2>Der zentrale Grenzwertsatz<a class="headerlink" href="#der-zentrale-grenzwertsatz" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span><span class="p">,</span> <span class="n">uniform</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span>
</pre></div>
</div>
</div>
</div>
<p>Der <strong><a href="https://de.wikipedia.org/wiki/Zentraler_Grenzwertsatz">zentrale Grenzwertsatz</a></strong> ist eines der nützlichsten Konzepte der Statistik. Bei diesem Theorem geht es um die Ziehung von Stichproben einer endlichen Größe <span class="math notranslate nohighlight">\(n\)</span> aus einer Grundgesamtheit. Das Theorem besagt, dass, wenn man Stichproben mit einem ausreichend großen Stichprobenumfang <span class="math notranslate nohighlight">\(n\)</span> sammelt und den Mittelwert jeder Stichprobe berechnet, die Form des Histogramms dieser Mittelwerte sich einer Gauß-Verteilung annähert. Die Nützlichkeit des zentralen Grenzwertsatzes ergibt sich aus der Tatsache, dass <strong>die Verteilung der Stichprobenmittelwerte unabhängig von der Verteilung der ursprünglichen Verteilung der Zufallsvariablen der Normalverteilung folgt</strong> (<span id="id1">Papula [<a class="reference internal" href="intro.html#id8" title="Lothar Papula. Mathematik für Ingenieure und Naturwissenschaftler Band 3. Springer, 2016.">2016</a>]</span> s.436).</p>
<section id="die-grundgesamtheitsverteilung">
<h3>Die Grundgesamtheitsverteilung<a class="headerlink" href="#die-grundgesamtheitsverteilung" title="Permalink to this headline">#</a></h3>
<p>Die <strong>Grundgesamtheitsverteilung</strong> ist die Wahrscheinlichkeitsverteilung, die sich aus der Kenntnis aller Elemente einer Grundgesamtheit ergibt (<span id="id2">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.302). Wir wissen, dass die interessierende Zufallsvariable je nach der betrachteten Grundgesamtheit eine diskrete Variable sein kann, d. h. eine Variable, die zumindest im Prinzip abzählbar ist (abzählbar unendlich), oder die Zufallsvariable kann eine kontinuierliche Variable sein, d. h. eine Variable, die jeden Wert innerhalb eines bestimmten Intervalls annehmen kann (überabzählbar unendlich). Sowohl die diskrete als auch die kontinuierliche Wahrscheinlichkeitsverteilung kann durch statistische Parameter wie den Mittelwert, die Standardabweichung, den Median, den Modalwert und andere beschrieben werden. Diese Parameter, die die Grundgesamtheit beschreiben, sind jedoch <strong>immer konstant</strong>, da die Grundgesamtheit die Menge aller Elemente ist und sich somit die Grundgesamtheitsstatistik nicht ändert. So gibt es beispielsweise für jeden Populationsdatensatz <strong>nur einen Wert</strong> für den Populationsmittelwert, <strong>einen Wert</strong> für die Standardabweichung usw.</p>
</section>
<section id="grundgesamtheitsstatistiken-und-stichprobenstatistiken">
<h3>Grundgesamtheitsstatistiken und Stichprobenstatistiken<a class="headerlink" href="#grundgesamtheitsstatistiken-und-stichprobenstatistiken" title="Permalink to this headline">#</a></h3>
<p>Betrachten wir ein einfaches Beispiel für eine kleine diskrete Grundgesamtheit, die aus den ersten zehn ganzen Zahlen <span class="math notranslate nohighlight">\(\{1,2,3,4,5,6,7,8,9,10\}\)</span> besteht.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">population</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">population</span><span class="p">)</span>
<span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">population</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mittelwert (Grundgesamtheit):         </span><span class="si">{</span><span class="n">mean</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Standartabweichung (Grundgesamtheit): </span><span class="si">{</span><span class="n">std</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mittelwert (Grundgesamtheit):         5.5
Standartabweichung (Grundgesamtheit): 2.8722813232690143
</pre></div>
</div>
</div>
</div>
<p>Der Populationsmittelwert <span class="math notranslate nohighlight">\(μ\)</span>, und die Populationsstandardabweichung <span class="math notranslate nohighlight">\(σ\)</span> beträgt <span class="math notranslate nohighlight">\(5,5\)</span> bzw. etwa <span class="math notranslate nohighlight">\(2,872\)</span>. Es ist wichtig zu erkennen, dass sich diese Parameter, die Populationsparameter, nicht ändern! Sie sind durch die Grundgesamtheit festgelegt.</p>
<p>Nehmen wir nun eine Zufallsstichprobe ohne Ersetzung mit dem Umfang <span class="math notranslate nohighlight">\(n=3\)</span> aus dieser Grundgesamtheit.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">my_sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">population</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">my_sample</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 3, 10,  7])
</pre></div>
</div>
</div>
</div>
<p>Nun berechnen wir den Mittelwert und die Standardabweichung der gegebenen Stichprobe. Da wir uns aber auf eine bestimmte Stichprobe beziehen, nennen wir den statistischen Parameter diesmal <strong>Stichprobenstatistik</strong> oder, wenn wir uns auf die Verteilung der Werte (Elemente) beziehen, <strong>Stichprobenverteilung</strong>. Um dies zu verdeutlichen, wird der Stichprobenmittelwert mit <span class="math notranslate nohighlight">\(\bar{x}\)</span> und die Stichprobenstandardabweichung mit <span class="math notranslate nohighlight">\(s\)</span> bezeichnet.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_bar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">my_sample</span><span class="p">)</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">my_sample</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mittelwert (Stichprobe):         </span><span class="si">{</span><span class="n">x_bar</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Standartabweichung (Stichprobe): </span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mittelwert (Stichprobe):         6.666666666666667
Standartabweichung (Stichprobe): 3.5118845842842465
</pre></div>
</div>
</div>
</div>
<p>Bitte beachten Sie, dass sich die Stichprobenstatistiken je nach den tatsächlichen Elementen in der Stichprobe von Stichprobe zu Stichprobe ändern.</p>
</section>
<section id="der-schatzfehler">
<h3>Der Schätzfehler<a class="headerlink" href="#der-schatzfehler" title="Permalink to this headline">#</a></h3>
<hr class="docutils" />
<p>Wir wiederholen die Stichprobe aus dem vorigen Abschnitt fünfmal und geben den Mittelwert <span class="math notranslate nohighlight">\(\bar{x}\)</span> für jede einzelne Stichprobe aus.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">population</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">my_sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">population</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">my_sample</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Die </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">. Stichprobe hat einen Mittelwert von </span><span class="si">{</span><span class="n">mean</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Die 1. Stichprobe hat einen Mittelwert von 6.666666666666667
Die 2. Stichprobe hat einen Mittelwert von 6.333333333333333
Die 3. Stichprobe hat einen Mittelwert von 4.0
Die 4. Stichprobe hat einen Mittelwert von 6.666666666666667
Die 5. Stichprobe hat einen Mittelwert von 5.333333333333333
</pre></div>
</div>
</div>
</div>
<p>Es liegt auf der Hand, dass verschiedene Stichproben (mit derselben Grösse), die aus derselben Grundgesamtheit ausgewählt wurden, unterschiedliche Stichprobenstatistiken ergeben, da sie unterschiedliche Elemente enthalten. Darüber hinaus unterscheidet sich jede aus einer Stichprobe gewonnene Stichprobenstatistik, z. B. der Stichprobenmittelwert <span class="math notranslate nohighlight">\(\bar{x}\)</span>, von dem Ergebnis, das aus der entsprechenden Grundgesamtheit, dem Grundgesamtheitsmittelwert <span class="math notranslate nohighlight">\(μ\)</span>, gewonnen wird. Die Differenz zwischen dem Wert einer aus einer Stichprobe gewonnenen Statistik und dem Wert des entsprechenden, aus der Grundgesamtheit gewonnenen Parameters wird als <strong><a href="https://de.wikipedia.org/wiki/Sch%C3%A4tzfehler">Schätzfehler</a></strong> bezeichnet. Im Fall des Mittelwerts kann der Schätzfehler wie folgt geschrieben werden</p>
<div class="math notranslate nohighlight">
\[ \text{Schätzfehler} = \bar{x} - \mu\]</div>
<p>Aufgrund des Charakters von Zufallsstichproben und willkürlichen Ziehung einer Reihe von Werten aus der Grundgesamtheit ist der daraus resultierende Schätzfehler zufällig, oder anders gesagt, der Schätzfehler ist eine Zufallsvariable. Es ist jedoch zu beachten, dass es neben der beschriebenen Zufälligkeit noch andere Fehlerquellen gibt. Diese Fehler hängen oft mit dem Prozess der Datenerzeugung zusammen. Solche Fehler werden beispielsweise durch die menschliche Handhabung der Daten, Kalibrierungsfehler der Messgeräte etc. verursacht.</p>
<p>Um ein Gefühl für die Art des Schätzfehlers zu bekommen, führen wir ein Experiment durch. Bei diesem Experiment besteht die interessierende Grundgesamtheit aus den ersten <span class="math notranslate nohighlight">\(100\)</span> ganzen Zahlen <span class="math notranslate nohighlight">\(\{1,2,3,...,100\}\)</span>. Wir wollen den Einfluss des Stichprobenumfangs <span class="math notranslate nohighlight">\(n\)</span> auf den Schätzfehler untersuchen. Der Einfachheit halber wählen wir den Stichprobenmittelwert als die interessierende Statistik. Für eine ausreichend große Anzahl von Versuchen (z.B. <span class="math notranslate nohighlight">\(5000\)</span> Versuche) berechnen wir den Schätzfehler für Stichproben mit dem Umfang <span class="math notranslate nohighlight">\(n=10,25,50,75\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trial_size</span> <span class="o">=</span> <span class="mi">5000</span>  <span class="c1"># 5000 Versuche</span>
<span class="n">sample_size</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">]</span>  <span class="c1"># Stichprobenumfang</span>
<span class="n">population</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>
<span class="n">mean_pop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">population</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">sample_size</span><span class="p">:</span>
    <span class="n">error_sample</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">trial_size</span><span class="p">):</span>
        <span class="n">my_sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">population</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">my_sample</span><span class="p">)</span>
        <span class="n">error_sample</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">mean</span> <span class="o">-</span> <span class="n">mean_pop</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Schätzfehler (n=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">error_sample</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Schätzfehler (n=10): 6.886
Schätzfehler (n=25): 4.034
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Schätzfehler (n=50): 2.339
Schätzfehler (n=75): 1.359
</pre></div>
</div>
</div>
</div>
<p>Aus dem obigen Experiment können wir schließen, dass der Schätzfehler umso kleiner ist, je größer der Stichprobenumfang ist. Mit anderen Worten: Je größer der Stichprobenumfang ist, desto mehr nähert sich der Stichprobenmittelwert <span class="math notranslate nohighlight">\(\bar{x}\)</span> dem Grundgesamtheitsmittelwert <span class="math notranslate nohighlight">\(μ\)</span> an. Dies ist eine wichtige Erkenntnis, die im Abschnitt über die <em>Inferenzstatistik</em> ausführlicher behandelt werden wird.</p>
</section>
<section id="die-stichprobenverteilung">
<h3>Die Stichprobenverteilung<a class="headerlink" href="#die-stichprobenverteilung" title="Permalink to this headline">#</a></h3>
<p>Ausgehend von unserer Intuition der Zufälligkeit im Stichprobenprozess führen wir die <strong><a href="https://de.wikipedia.org/wiki/Sch%C3%A4tzfunktion">Stichprobenverteilung</a></strong> ein. Die Stichprobenverteilung ist eine Verteilung einer Stichprobenstatistik <em>(<span id="id3">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.337)</em>. Oft wird der Name der berechneten Statistik als Teil des Titels hinzugefügt. Wenn es sich bei der berechneten Statistik beispielsweise um den Stichprobenmittelwert handelt, würde die Stichprobenverteilung den Titel <strong>Stichprobenverteilung des Stichprobenmittelwerts</strong> tragen.</p>
<p>Erinnern wir uns an das einfache Beispiel aus dem vorigen Abschnitt, bei dem die Grundgesamtheit durch die ersten <span class="math notranslate nohighlight">\(100\)</span> ganzen Zahlen <span class="math notranslate nohighlight">\(\{ 1,2,3,\dots,100 \}\)</span> repräsentiert wurde. Wenn wir wiederholt Stichproben aus dieser Grundgesamtheit ziehen und jedes Mal die Stichprobenstatistik (z. B. <span class="math notranslate nohighlight">\(\bar{x}\)</span> oder <span class="math notranslate nohighlight">\(s\)</span>,…) berechnen, wird <strong>die resultierende Verteilung der Stichprobenstatistik als Stichprobenverteilung dieser Statistik</strong> bezeichnet.</p>
<p>Aus dieser Grundgesamtheit nehmen wir wiederholt Zufallsstichproben <span class="math notranslate nohighlight">\((x)\)</span> ohne Ersetzung mit der Größe <span class="math notranslate nohighlight">\(n=30\)</span>. Die Zufallsstichproben könnten Mengen erzeugen, die wie folgt aussehen :</p>
<div class="math notranslate nohighlight">
\[\{19, 79, 33, 38, 14, 67, 7, 9, 12, 27, 4, 89, 34, 77, 78, 32, 65, 10, 84, 64, 90, 55, 88, 56, 11, 80, 15, 5, 91, 54\}\]</div>
<p>oder</p>
<div class="math notranslate nohighlight">
\[\{43, 52, 56, 8, 65, 60, 46, 15, 64, 19, 82, 91, 88, 1, 5, 9, 4, 92, 67, 36, 72, 31, 50, 96, 87, 6, 93, 84, 78, 16\}\]</div>
<p>… etc.</p>
<p>Für jede Stichprobe berechnen wir eine Stichprobenstatistik. In diesem Beispiel nehmen wir den Mittelwert, <span class="math notranslate nohighlight">\(\bar{x}\)</span>, jeder Stichprobe. Beachten Sie jedoch, dass es sich bei der Stichprobenstatistik um eine beliebige deskriptive Statistik handeln kann, z. B. um den Median, die Standardabweichung, einen Anteil usw. Sobald wir die Stichprobenmittelwerte für alle Stichproben erhalten haben, listen wir alle ihre verschiedenen Werte und die Anzahl ihres Auftretens (Häufigkeiten) auf, um relative Häufigkeiten oder <strong>empirische Wahrscheinlichkeiten</strong> zu erhalten.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">dot_diagram</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">min_max</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">70</span><span class="p">)):</span>
    <span class="sd">&quot;&quot;&quot;Function to compute a dotplot.</span>
<span class="sd">    Inspried by https://stackoverflow.com/a/66398730&quot;&quot;&quot;</span>

    <span class="n">values</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">data_range</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
    <span class="c1"># fig_width = data_range / 2 if data_range &lt; 30 else 15</span>
    <span class="n">fig_width</span> <span class="o">=</span> <span class="mi">16</span>
    <span class="n">fig_height</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span> <span class="k">if</span> <span class="n">data_range</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="k">else</span> <span class="nb">max</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span>
    <span class="n">marker_size</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fig_width</span><span class="p">,</span> <span class="n">fig_height</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">value</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">counts</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="p">[</span><span class="n">value</span><span class="p">]</span> <span class="o">*</span> <span class="n">count</span><span class="p">,</span>
            <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">)),</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:blue&quot;</span><span class="p">,</span>
            <span class="n">markersize</span><span class="o">=</span><span class="n">marker_size</span><span class="p">,</span>
            <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="s2">&quot;left&quot;</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">spine</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># ax.set_ylim(-1, max(counts))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">18</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">min_max</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">min_max</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">min_max</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">min_max</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">population</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">))</span>
<span class="n">mean_pop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">population</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">_axes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>
<span class="n">trials</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">3000</span><span class="p">]</span>
<span class="n">SAMPLE_SIZE</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">trial</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">trials</span><span class="p">):</span>
    <span class="n">sample_statistic</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">trial</span><span class="p">):</span>
        <span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">population</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">SAMPLE_SIZE</span><span class="p">)</span>
        <span class="n">mean_sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
        <span class="n">sample_statistic</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean_sample</span><span class="p">)</span>
    <span class="n">dot_diagram</span><span class="p">(</span><span class="n">sample_statistic</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">_axes</span><span class="p">[</span><span class="n">e</span><span class="p">])</span>
    <span class="n">_axes</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">trials</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="si">}</span><span class="s2"> Stichproben&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">_axes</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">mean_pop</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$\mu$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
    <span class="n">_axes</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">mean_pop</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/01_Zentraler_Grenzwertsatz_23_0.png" src="_images/01_Zentraler_Grenzwertsatz_23_0.png" />
</div>
</div>
<p>Je häufiger wir eine Stichprobe nehmen, desto besser nähert sich die relative Häufigkeitsverteilung der Stichprobenstatistik der Grundgesamtheitsverteilung an. Mit anderen Worten: Wenn die Anzahl der Stichproben gegen unendlich geht, nähert sich die resultierende Häufigkeitsverteilung der Grundgesamtheitsverteilung an. <strong>Die Stichprobenverteilung einer Statistik</strong> ist eine Wahrscheinlichkeitsverteilung dieser Statistik, die aus allen möglichen Stichproben mit demselben Umfang aus der Grundgesamtheit abgeleitet wird. Die Stichprobenverteilung sollte jedoch nicht mit einer Grundgesamtheitsverteilung verwechselt werden: Letztere beschreibt die Verteilung der Werte (Elemente) in der Grundgesamtheit.</p>
</section>
<section id="der-standardfehler">
<h3>Der Standardfehler<a class="headerlink" href="#der-standardfehler" title="Permalink to this headline">#</a></h3>
<p>Ebenso wie die Verteilungen der Grundgesamtheit können auch die Stichprobenverteilungen mit Parametern beschrieben werden. Der Erwartungswert (Mittelwert) einer beliebigen Verteilung kann durch das Symbol <span class="math notranslate nohighlight">\(\mu\)</span> dargestellt werden. Im Falle der Stichprobenverteilung wird der Mittelwert <span class="math notranslate nohighlight">\(\mu\)</span> oft mit einem tiefgestellten Index geschrieben, um anzugeben, welche Stichprobenverteilung beschrieben wird. Der Erwartungswert der Stichprobenverteilung des Mittelwerts wird zum Beispiel durch das Symbol <span class="math notranslate nohighlight">\(\mu_{\bar{x}}\)</span> dargestellt. Der Wert von <span class="math notranslate nohighlight">\(\mu_{\bar{x}}\)</span> kann als der theoretische Mittelwert der Verteilung der Stichprobenmittelwerte angesehen werden.</p>
<p>Wenn wir aus einer Grundgesamtheit eine ausreichend große Anzahl von Stichproben (mit gleichem Umfang) auswählen und deren Mittelwerte berechnen, dann nähert sich der Mittelwert (<span class="math notranslate nohighlight">\(\mu_{\bar{x}}\)</span>) all dieser Stichprobenmittelwerte dem Mittelwert (<span class="math notranslate nohighlight">\(\mu\)</span>) der Grundgesamtheit an. Deshalb wird der Stichprobenmittelwert <span class="math notranslate nohighlight">\(\bar{x}\)</span> als Schätzer des Populationsmittelwertes <span class="math notranslate nohighlight">\(\mu\)</span> bezeichnet. Somit ist der Mittelwert der Stichprobenverteilung gleich dem Mittelwert der Grundgesamtheit.</p>
<div class="math notranslate nohighlight">
\[\mu_{\bar{x}} = \mu\]</div>
<p>Für die Standardabweichung einer Stichprobenverteilung gibt es eine besondere Bezeichnung, den <strong><a href="https://de.wikipedia.org/wiki/Standardfehler">Standardfehler</a></strong>. Der Standardfehler der Stichprobenverteilung einer Statistik, bezeichnet als <span class="math notranslate nohighlight">\(\sigma_{\bar{x}}\)</span>, beschreibt das Ausmaß, in dem die berechneten Statistiken erwartungsgemäß voneinander abweichen, wenn sie anhand einer Stichprobe ähnlichen Umfangs berechnet und aus ähnlichen Grundgesamtheitsmodellen ausgewählt werden. Je größer der Standardfehler einer bestimmten Statistik ist, desto größer sind die Unterschiede zwischen den berechneten Statistiken für die verschiedenen Stichproben (<span id="id4">[<a class="reference internal" href="intro.html#id10" title="Udo Kuckartz, Stefan Rädiker, Thomas Ebert, and Julia Schehl. Statistik: eine verständliche Einführung. Springer-Verlag, 2013.">Kuckartz <em>et al.</em>, 2013</a>]</span> s.133).</p>
<p>Es ist jedoch zu beachten, dass der Standardfehler <span class="math notranslate nohighlight">\(\sigma_{\bar{x}}\)</span> nicht gleich der Standardabweichung <span class="math notranslate nohighlight">\(\sigma\)</span> der Verteilung der Grundgesamtheit ist (es sei denn, <span class="math notranslate nohighlight">\(n=1\)</span>). Der Standardfehler ist gleich der Standardabweichung der Grundgesamtheit geteilt durch die Quadratwurzel des Stichprobenumfangs :</p>
<div class="math notranslate nohighlight">
\[\sigma_{\bar{x}} = \frac{\sigma}{\sqrt{n}}\]</div>
<p>Diese Gleichung gilt nur, wenn die Stichprobe entweder mit Ersatz aus einer endlichen Grundgesamtheit oder mit oder ohne Ersatz aus einer unendlichen Grundgesamtheit gezogen wird. Dies entspricht der Bedingung, dass der Stichprobenumfang <span class="math notranslate nohighlight">\((n)\)</span> im Vergleich zum Grundgesamtheitsumfang <span class="math notranslate nohighlight">\((N)\)</span> klein ist. Der Stichprobenumfang gilt als klein im Vergleich zum Umfang der Grundgesamtheit, wenn der Stichprobenumfang gleich oder weniger als <span class="math notranslate nohighlight">\(5\%\)</span> des Umfangs der Grundgesamtheit ist, d. h., wenn</p>
<div class="math notranslate nohighlight">
\[\frac{n}{N} \leq 0,05\]</div>
<p>Wenn diese Bedingung nicht erfüllt ist, wird die folgende Gleichung zur Berechnung von <span class="math notranslate nohighlight">\(\sigma_{\bar{x}}\)</span> verwendet :</p>
<div class="math notranslate nohighlight">
\[\sigma_{\bar{x}} = \frac{\sigma}{\sqrt{n}} \sqrt{\frac{N-n}{N-1}}\]</div>
<p>In den meisten praktischen Anwendungen ist der Stichprobenumfang jedoch klein im Vergleich zur Grundgesamtheit.</p>
</section>
<section id="stichproben-aus-einer-normalverteilten-grundgesamtheit">
<h3>Stichproben aus einer normalverteilten Grundgesamtheit<a class="headerlink" href="#stichproben-aus-einer-normalverteilten-grundgesamtheit" title="Permalink to this headline">#</a></h3>
<section id="form-der-stichprobenverteilung">
<h4>Form der Stichprobenverteilung<a class="headerlink" href="#form-der-stichprobenverteilung" title="Permalink to this headline">#</a></h4>
<p>Die Form der Stichprobenverteilung bezieht sich auf die beiden folgenden Fälle :</p>
<ol class="simple">
<li><p>Die Grundgesamtheit, aus der die Stichproben gezogen werden, ist normalverteilt.</p></li>
<li><p>Die Grundgesamtheit, aus der die Stichproben gezogen werden, ist nicht normalverteilt.</p></li>
</ol>
</section>
<section id="id5">
<h4>Stichproben aus einer normalverteilten Grundgesamtheit<a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h4>
<p>Wenn die Grundgesamtheit, aus der die Stichproben gezogen werden, normalverteilt ist und ihr Mittelwert gleich <span class="math notranslate nohighlight">\(\mu\)</span> und ihre Standardabweichung gleich <span class="math notranslate nohighlight">\(\sigma\)</span> ist, dann gilt :</p>
<ol class="simple">
<li><p>Der Mittelwert der Stichprobenmittel, <span class="math notranslate nohighlight">\(\mu_{\bar{x}}\)</span>, ist gleich dem Mittelwert der Grundgesamtheit, <span class="math notranslate nohighlight">\(\mu\)</span></p></li>
<li><p>Die Standardabweichung der Stichprobenmittelwerte,<span class="math notranslate nohighlight">\(\sigma_{\bar{x}}\)</span>
ist gleich <span class="math notranslate nohighlight">\(\frac{\sigma}{\sqrt{n}}\)</span>, wobei <span class="math notranslate nohighlight">\(\frac{n}{N} ≤ 0,05\)</span> angenommen wird.</p></li>
<li><p>Die Form der Stichprobenverteilung der Stichprobenmittelwerte <span class="math notranslate nohighlight">\(\bar{x}\)</span> ist normal, unabhängig vom Wert von <span class="math notranslate nohighlight">\(n\)</span>.</p></li>
</ol>
<p>Betrachten wir eine normalverteilte Grundgesamtheit. Der Einfachheit halber verwenden wir die Standardnormalverteilung, <span class="math notranslate nohighlight">\(N∼(\mu,\sigma)\)</span>, mit <span class="math notranslate nohighlight">\(\mu=0\)</span> und <span class="math notranslate nohighlight">\(\sigma=1\)</span>. Berechnen wir nun <span class="math notranslate nohighlight">\(\mu_{\bar{x}}\)</span> und <span class="math notranslate nohighlight">\(\sigma_{\bar{x}}\)</span> für Stichproben mit dem Stichprobenumfang <span class="math notranslate nohighlight">\(n=5,15,30,50\)</span>.</p>
<p>Es sei daran erinnert, dass für eine hinreichend große Anzahl wiederholter Stichproben <span class="math notranslate nohighlight">\(\mu_{\bar{x}}≈\mu\)</span>. Somit <span class="math notranslate nohighlight">\(\mu_{\bar{x}}\)</span> der verschiedenen betrachteten Stichprobenverteilungen :</p>
<div class="math notranslate nohighlight">
\[\mu_{\bar x_{n=5}} = \mu_{\bar x_{n=15}} = \mu_{\bar x_{n=30}} = \mu_{\bar x_{n=50}} = \mu = 0\]</div>
<p>Wir erinnern uns an den Standardfehler der Stichprobenverteilung <span class="math notranslate nohighlight">\(\sigma_{\bar{x}}=\frac{\sigma}{\sqrt{n}}\)</span>. Wir können also <span class="math notranslate nohighlight">\(\sigma_{\bar{x}}\)</span> für <span class="math notranslate nohighlight">\(n=5,15,30,50\)</span> Elemente leicht berechnen. Die verschiedenen Stichprobenverteilungen werden im Folgenden visualisiert.</p>
<div class="math notranslate nohighlight">
\[\sigma_{\bar x_{n=5}} = \frac{\sigma}{\sqrt{n}} = \frac{1}{\sqrt{5}}\approx 0,447\]</div>
<div class="math notranslate nohighlight">
\[ \sigma_{\bar x_{n=15}} = \frac{\sigma}{\sqrt{n}} = \frac{1}{\sqrt{15}}\approx 0,258 \]</div>
<div class="math notranslate nohighlight">
\[ \sigma_{\bar x_{n=30}} = \frac{\sigma}{\sqrt{n}} = \frac{1}{\sqrt{30}}\approx 0,183 \]</div>
<div class="math notranslate nohighlight">
\[ \sigma_{\bar x_{n=50}} = \frac{\sigma}{\sqrt{n}} = \frac{1}{\sqrt{50}} \approx 0,141 \]</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">mu</span> <span class="o">-</span> <span class="mf">2.5</span><span class="p">,</span> <span class="n">mu</span> <span class="o">+</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">_n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">_n</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">_n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Grundgesamtheit ($\mu=0$ und $\sigma=1$)&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;$\overline</span><span class="si">{x}</span><span class="s2">$ for&quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; n = </span><span class="si">{</span><span class="n">_n</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="s2">&quot;$\mu_\overline</span><span class="si">{x}</span><span class="s2">=\mu$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/01_Zentraler_Grenzwertsatz_29_0.png" src="_images/01_Zentraler_Grenzwertsatz_29_0.png" />
</div>
</div>
<p>Es gibt zwei wichtige Beobachtungen bezüglich der Stichprobenverteilung von <span class="math notranslate nohighlight">\(\bar{x}\)</span></p>
<ol class="simple">
<li><p>Die Streuung der Stichprobenverteilung ist kleiner als die Streuung der entsprechenden Grundgesamtheitsverteilung. Mit anderen Worten: <span class="math notranslate nohighlight">\(\sigma_{\bar{x}}&lt;\sigma\)</span></p></li>
<li><p>Die Standardabweichung der Stichprobenverteilung nimmt mit zunehmendem Stichprobenumfang ab.</p></li>
</ol>
<p>Um die <span class="math notranslate nohighlight">\(3\)</span>. Behauptung von oben, dass die Form der Stichprobenverteilung von <span class="math notranslate nohighlight">\(\bar{x}\)</span> unabhängig vom Wert von <span class="math notranslate nohighlight">\(n\)</span> normal ist, zu überprüfen, führen wir eine numerische Simulation durch. Für eine ausreichend große Anzahl von Versuchen (Versuche = <span class="math notranslate nohighlight">\(1000\)</span>) ziehen wir Stichproben aus der Standardnormalverteilung <span class="math notranslate nohighlight">\(N∼(\mu=0,\sigma=1)\)</span>, wobei jede einzelne Stichprobe einen Stichprobenumfang von <span class="math notranslate nohighlight">\(n=5,15,30,50\)</span> hat. Für jede Stichprobe berechnen wir den Stichprobenmittelwert <span class="math notranslate nohighlight">\(\bar{x}\)</span> und stellen die empirischen Wahrscheinlichkeiten dar. Anschließend vergleichen wir die empirische Verteilung dieser Wahrscheinlichkeiten mit den aus den obigen Gleichungen berechneten Stichprobenverteilungen.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">mu</span> <span class="o">-</span> <span class="mf">2.5</span><span class="p">,</span> <span class="n">mu</span> <span class="o">+</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">_n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">_n</span><span class="p">)</span>
    <span class="n">random_sample</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">random_sample</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;n = </span><span class="si">{</span><span class="n">_n</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;C</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/01_Zentraler_Grenzwertsatz_31_0.png" src="_images/01_Zentraler_Grenzwertsatz_31_0.png" />
</div>
</div>
<p>Die Abbildung verifiziert die <span class="math notranslate nohighlight">\(3\)</span>. Behauptung von oben: Die Form der Stichprobenverteilung von <span class="math notranslate nohighlight">\(\bar{x}\)</span> ist für jeden Wert von <span class="math notranslate nohighlight">\(n\)</span> normal.</p>
<p>Darüber hinaus zeigt die Abbildung, dass die Verteilung der empirischen Wahrscheinlichkeiten (Balken) gut mit der Stichprobenverteilung (farbige Linie) übereinstimmt und dass die Standardabweichung der Stichprobenverteilung von <span class="math notranslate nohighlight">\(\bar{x}\)</span> mit zunehmendem Stichprobenumfang abnimmt. Es sei daran erinnert, dass die <span class="math notranslate nohighlight">\(y\)</span>-Achse die <em>Dichte</em> darstellt, d. h. die <strong>Wahrscheinlichkeit pro Einheitswert</strong> der Zufallsvariablen. Aus diesem Grund kann die Wahrscheinlichkeitsdichte einen Wert größer als <span class="math notranslate nohighlight">\(1\)</span> annehmen, aber nur über einen Bereich mit einer Größe kleiner als <span class="math notranslate nohighlight">\(1\)</span>.</p>
</section>
</section>
<section id="stichproben-aus-einer-nicht-normalverteilten-grundgesamtheit">
<h3>Stichproben aus einer nicht normalverteilten Grundgesamtheit<a class="headerlink" href="#stichproben-aus-einer-nicht-normalverteilten-grundgesamtheit" title="Permalink to this headline">#</a></h3>
<p>Im vorangegangenen Abschnitt haben wir die Form von Stichprobenverteilungen erörtert, wenn eine Stichprobe aus einer normalverteilten Grundgesamtheit gezogen wird. In realen Anwendungen kennen wir jedoch oft nicht die tatsächliche Form der Grundgesamtheit.</p>
<p>Um zu verstehen, wie die Form der Verteilung der interessierenden Grundgesamtheit die Form der Stichprobenverteilung beeinflusst, führen wir ein Experiment durch. Wir betrachten drei verschiedene kontinuierliche Wahrscheinlichkeitsdichtefunktionen: die <a href="https://de.wikipedia.org/wiki/Stetige_Gleichverteilung"><strong>Gleichverteilung</strong></a>, die <a href="https://de.wikipedia.org/wiki/Beta-Verteilung"><strong>Beta-Verteilung</strong></a> und die <a href="https://de.wikipedia.org/wiki/Gammaverteilung"><strong>Gamma-Verteilung</strong></a>. Wir gehen hier nicht ins Detail, aber die folgende Abbildung zeigt, dass diese drei PDF´s (Probability Density Functions) nicht normalverteilt sind.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titles</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Uniform distribution (a=0.2, b=0.8)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Beta distribution (alpha=2, beta=5)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Gamma distribution (alpha=1, beta=2)&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">uniform</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">beta</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">gamma</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">_ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ax</span><span class="p">):</span>
    <span class="n">_ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">_ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">titles</span><span class="p">[</span><span class="n">e</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/01_Zentraler_Grenzwertsatz_35_0.png" src="_images/01_Zentraler_Grenzwertsatz_35_0.png" />
</div>
</div>
<p>Nun führen wir das gleiche Experiment wie im vorherigen Abschnitt durch. Für eine ausreichend große Anzahl von Versuchen (Versuche = 1000) ziehen wir aus jeder einzelnen Verteilung eine Stichprobe. Diesmal hat jedoch jede einzelne Stichprobe einen Stichprobenumfang <span class="math notranslate nohighlight">\(n=2,5,15,30\)</span>. Für jede Stichprobe berechnen wir den Stichprobenmittelwert <span class="math notranslate nohighlight">\(\bar{x}\)</span> und stellen die empirischen Wahrscheinlichkeiten nach <span class="math notranslate nohighlight">\(1000\)</span> Versuchen dar.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TRIALS</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">sample_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span>
<span class="n">titles</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Uniform distribution (a=0.2, b=0.8)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Beta distribution (alpha=2, beta=5)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Gamma distribution (alpha=1, beta=2)&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">xlim</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.48</span><span class="p">,</span> <span class="mf">0.52</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.27</span><span class="p">,</span> <span class="mf">0.30</span><span class="p">),</span> <span class="p">(</span><span class="mf">2.9</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">sample_size</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sample_sizes</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">distribution</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">),</span> <span class="n">beta</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">gamma</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]):</span>
        <span class="n">sample</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">TRIALS</span><span class="p">):</span>
            <span class="n">sample</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">distribution</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">sample_sizes</span><span class="p">)))</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
            <span class="n">sample</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;C</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">titles</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">for sample size </span><span class="si">{</span><span class="n">sample_size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/01_Zentraler_Grenzwertsatz_37_0.png" src="_images/01_Zentraler_Grenzwertsatz_37_0.png" />
</div>
</div>
<p>Die Abbildung zeigt, dass im Falle einer nicht normalverteilten Grundgesamtheit die Stichprobenverteilungen nicht normalverteilt sind, wenn <span class="math notranslate nohighlight">\(n&lt;30\)</span>. Allerdings nähern sich die Stichprobenverteilungen einer Normalverteilung an, wenn <span class="math notranslate nohighlight">\(n&gt;30\)</span>. Man sieht auch, dass die Streuung der Stichprobenverteilung mit zunehmendem Stichprobenumfang abnimmt.</p>
<p>Nach dem <a href="https://de.wikipedia.org/wiki/Zentraler_Grenzwertsatz"><strong>zentralen Grenzwertsatz</strong></a> ist die Stichprobenverteilung bei einem großen Stichprobenumfang <span class="math notranslate nohighlight">\((n &gt; 30)\)</span> annähernd normal, unabhängig von der Form der Grundgesamtheitsverteilung.</p>
<p>Der Mittelwert und die Standardabweichung der Stichprobenverteilung von <span class="math notranslate nohighlight">\(\bar{x}\)</span> sind jeweils,</p>
<div class="math notranslate nohighlight">
\[\mu_{\bar{x}} = \mu \text{ und } \sigma_{\bar{x}} = \frac{\sigma}{\sqrt{n}}\]</div>
<p>Der Stichprobenumfang wird gewöhnlich als groß angesehen, wenn <span class="math notranslate nohighlight">\(n \geq 30\)</span> ist.</p>
<p>Da die Stichprobenverteilung eine Normalverteilung approximiert, liefert die Fläche unter der Kurve der Stichprobenverteilung probabilistische Informationen über die Stichprobenstatistik.</p>
<p>Erinnern Sie sich an die <strong>empirische Regel</strong> (<span id="id6">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.86), auch bekannt als die <strong>68-95-99,7-Regel</strong>. Auf die Stichprobenverteilung angewandt bedeutet die <span class="math notranslate nohighlight">\(68-95-99,7\)</span>-Regel folglich, dass</p>
<ul class="simple">
<li><p>etwa <span class="math notranslate nohighlight">\(68,26\)</span>% der Stichprobenmittelwerte innerhalb einer Standardabweichung des Populationsmittelwerts liegen werden,</p></li>
<li><p><span class="math notranslate nohighlight">\(95,44\)</span>% der Stichprobenmittelwerte innerhalb von zwei Standardabweichungen des Populationsmittelwertes liegen und</p></li>
<li><p>etwa <span class="math notranslate nohighlight">\(99,74\)</span>% der Stichprobenmittelwerte innerhalb von drei Standardabweichungen des Mittelwerts der Grundgesamtheit liegen.</p></li>
</ul>
</section>
</section>
<span id="document-Aufgaben/Kapitel04/Aufgaben"></span><section class="tex2jax_ignore mathjax_ignore" id="ubungsaufgaben">
<h2>Übungsaufgaben<a class="headerlink" href="#ubungsaufgaben" title="Permalink to this headline">#</a></h2>
<div class="toctree-wrapper compound">
<span id="document-Aufgaben/Kapitel04/CLT"></span><section class="tex2jax_ignore mathjax_ignore" id="der-zentrale-grenzwertsatz">
<h3>Der Zentrale Grenzwertsatz<a class="headerlink" href="#der-zentrale-grenzwertsatz" title="Permalink to this headline">#</a></h3>
<p>Erklären Sie den Zentralen Grenzwertsatz.</p>
<div class="toggle docutils container">
<p>Zentraler Grenzwertsatz (informell)</p>
<p>Die Summe von unabhängigen Zufallsvariablen besitzt eine Verteilung, die
sich durch eine Normalverteilung approximieren lässt, sofern die Anzahl der
Summanden gross ist. Die Approximation gelingt um so besser, je grösser
die Anzahl der Summanden ist <span id="id1">[<a class="reference internal" href="intro.html#id2" title="Christoph Weigand. Statistik mit und ohne Zufall. Springer, 2006.">Weigand, 2006</a>]</span>.</p>
</div>
</section>
<span id="document-Aufgaben/Kapitel04/Schaetzfehler"></span><section class="tex2jax_ignore mathjax_ignore" id="stichprobenfehler">
<h3>Stichprobenfehler<a class="headerlink" href="#stichprobenfehler" title="Permalink to this headline">#</a></h3>
<p>Berechnen Sie aus der gegebenen Grundgesamtheit <span class="math notranslate nohighlight">\(pop\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>den Mittelwert der Grundgesamtheit</p></li>
<li><p>den Mittelwert und Stichprobenfehler einer Stichprobe mit Umfang <span class="math notranslate nohighlight">\(n = 10\)</span></p></li>
</ol>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 1 ...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 2 ...</span>
</pre></div>
</div>
</div>
</div>
<section id="losungen">
<h4>Lösungen<a class="headerlink" href="#losungen" title="Permalink to this headline">#</a></h4>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">pop_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">pop</span><span class="p">)</span>
<span class="n">pop_mean</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8.2
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>

<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># for reproducibility</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">sample_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stichprobe:        </span><span class="si">{</span><span class="n">sample</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stichprobenmittel: </span><span class="si">{</span><span class="n">sample_mean</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Schätzfehler:      </span><span class="si">{</span><span class="n">sample_mean</span><span class="o">-</span><span class="n">pop_mean</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Stichprobe:        [17, 4, 15, 3, 0, 10, 2, 10, 10, 14]
Stichprobenmittel: 8.5
Schätzfehler:      0.3000000000000007
</pre></div>
</div>
</div>
</div>
</section>
</section>
<span id="document-Aufgaben/Kapitel04/Wuerfel"></span><section class="tex2jax_ignore mathjax_ignore" id="wurfelexperiment">
<h3>Würfelexperiment<a class="headerlink" href="#wurfelexperiment" title="Permalink to this headline">#</a></h3>
<ol class="simple">
<li><p>Generieren Sie <span class="math notranslate nohighlight">\(100.000\)</span> (gleichwahrscheinliche) Würfe eines Würfels und berechnen Sie Mittelwert und Standardabweichung der Würfelsumme.</p></li>
<li><p>Wählen Sie aus den Würfelsummen <span class="math notranslate nohighlight">\(200\)</span> Stichproben mit einer Stichprobengrösse von <span class="math notranslate nohighlight">\(50\)</span> aus. Berechnen Sie den Standardfehler mit</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\sigma_{\bar{x}} = \frac{\sigma}{\sqrt{n}}\]</div>
<p>        wobei <span class="math notranslate nohighlight">\(\sigma_{\bar{x}}\)</span> als Standardfehler, <span class="math notranslate nohighlight">\(\sigma\)</span> als Standardabweichung der Stichprobe und <span class="math notranslate nohighlight">\(\sqrt{n}\)</span> als Wurzel aus der Stichprobengrösse</p>
<ol class="simple">
<li><p>Wiederholen Sie das Experiment für <span class="math notranslate nohighlight">\(10\)</span> Würfel</p></li>
</ol>
<p><strong>Hilfsfunktionen</strong></p>
<div class="cell tag_thebe-init docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="k">def</span> <span class="nf">dice_roll</span><span class="p">(</span><span class="n">nrolls</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nsides</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Function to simulate a dice roll</span>
<span class="sd">    params:</span>
<span class="sd">       nrolls: number of rolls/dices</span>
<span class="sd">       nsides: number of sides</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nsides</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrolls</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 1 ...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 2 ...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 3 ...</span>
</pre></div>
</div>
</div>
</div>
<section id="losungen">
<h4>Lösungen<a class="headerlink" href="#losungen" title="Permalink to this headline">#</a></h4>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Experiment</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">experiment</span> <span class="o">=</span> <span class="n">dice_roll</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Statistik des Experiments</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mittelwert Würfelsumme: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">experiment</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Standardabweichung Würfelsumme: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">experiment</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mittelwert Würfelsumme: 3.50312
Standardabweichung Würfelsumme: 1.7075333863793118
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Stichprobenverteilung und Standardfehler</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">sample_means</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">):</span>
    <span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">sample_means</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample</span><span class="p">))</span>
<span class="n">std_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">sample_means</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Der Standardfehler beträgt </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">std_error</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Der Standardfehler beträgt 0.0312.
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># experiment</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">experiment</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">roll</span> <span class="o">=</span> <span class="n">dice_roll</span><span class="p">(</span><span class="n">nrolls</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">roll_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">roll</span><span class="p">)</span>
    <span class="n">experiment</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">roll_sum</span><span class="p">)</span>

<span class="c1"># Statistik des Experiments</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mittelwert Würfelsumme:&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">experiment</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Standardabweichung Würfelsumme:&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">experiment</span><span class="p">))</span>

<span class="c1"># Stichprobenverteilung und Standardfehler</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">sample_means</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">):</span>
    <span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">sample_means</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample</span><span class="p">))</span>
<span class="n">std_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">sample_means</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Der Standardfehler beträgt </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">std_error</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mittelwert Würfelsumme: 34.99722
Standardabweichung Würfelsumme: 5.39307076456447
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Der Standardfehler beträgt 0.1067.
</pre></div>
</div>
</div>
</div>
</section>
</section>
<span id="document-Aufgaben/Kapitel04/Test_auf_Normalverteilung"></span><section class="tex2jax_ignore mathjax_ignore" id="test-auf-normalverteilung">
<h3>Test auf Normalverteilung<a class="headerlink" href="#test-auf-normalverteilung" title="Permalink to this headline">#</a></h3>
<p>Generieren Sie in 100.000 (gleichwahrscheinliche) Würfe eines Würfels und berechnen Sie Mittelwert und Standardabweichung der Würfelsumme. Wählen Sie aus den Würfelwürfen 200 Stichproben mit unterschiedlichen Stichprobenumfängen. Ab welchem Stichprobenumfang (<code class="docutils literal notranslate"><span class="pre">3,</span> <span class="pre">5,</span> <span class="pre">7,</span> <span class="pre">10,</span> <span class="pre">15,</span> <span class="pre">20,</span> <span class="pre">30,</span> <span class="pre">50</span></code>) können wir dafon ausgehen, dass die Stichprobenverteilung des Mittelwertes normalverteilt ist. Nutzen sie zur Validierung der Hypothese den Wilk-Shapiro Test.</p>
<p><strong>Hilfsfunktionen</strong></p>
<div class="cell tag_thebe-init docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>


<span class="k">def</span> <span class="nf">test_for_normal_distribution</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Function to test if a sample is normally distributed.</span>
<span class="sd">    Therefore the Shapiro-Wilk test is employed. If the p-value is &lt;0.05 we recject the null hypothesis and hence</span>
<span class="sd">    conclude that the data is not normally distrubuted for reference see</span>
<span class="sd">    https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.shapiro.html&quot;&quot;&quot;</span>
    <span class="n">shapiro_test</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">shapiro</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">pvalue</span> <span class="o">=</span> <span class="n">shapiro_test</span><span class="o">.</span><span class="n">pvalue</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">pvalue</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pvalue</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The null hypothesis is rejected, the data is NOT normally distributed.&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Given the data the null hypothesis cannot be rejected, the data is likely normally distributed.&quot;</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">pvalue</span>


<span class="k">def</span> <span class="nf">dice_roll</span><span class="p">(</span><span class="n">nrolls</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nsides</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Function to simulate a dice roll</span>
<span class="sd">    params:</span>
<span class="sd">       nrolls: number of rolls/dices</span>
<span class="sd">       nsides: number of sides</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nsides</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrolls</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 1 ...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># experiment</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">experiment</span> <span class="o">=</span> <span class="n">dice_roll</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>

<span class="c1"># Validierung</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">]:</span>
    <span class="n">sample_means</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">):</span>
        <span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">sample_means</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sample size: </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">pvalue</span> <span class="o">=</span> <span class="n">test_for_normal_distribution</span><span class="p">(</span><span class="n">sample_means</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sample size: 3
p-value: 0.011156341060996056
The null hypothesis is rejected, the data is NOT normally distributed.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sample size: 5
p-value: 0.017443347722291946
The null hypothesis is rejected, the data is NOT normally distributed.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sample size: 7
p-value: 0.1828618347644806
Given the data the null hypothesis cannot be rejected, the data is likely normally distributed.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sample size: 10
p-value: 0.11042634397745132
Given the data the null hypothesis cannot be rejected, the data is likely normally distributed.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sample size: 15
p-value: 0.10826049000024796
Given the data the null hypothesis cannot be rejected, the data is likely normally distributed.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sample size: 20
p-value: 0.40129151940345764
Given the data the null hypothesis cannot be rejected, the data is likely normally distributed.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sample size: 30
p-value: 0.5366109013557434
Given the data the null hypothesis cannot be rejected, the data is likely normally distributed.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sample size: 50
p-value: 0.6726436614990234
Given the data the null hypothesis cannot be rejected, the data is likely normally distributed.
</pre></div>
</div>
</div>
</div>
</section>
</div>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-Lernziele/Kapitel5_Lernziele"></span><section class="tex2jax_ignore mathjax_ignore" id="lernziele">
<h2>Lernziele<a class="headerlink" href="#lernziele" title="Permalink to this headline">#</a></h2>
<section id="inferenzstatistik-und-konfidenzintervalle">
<h3>Inferenzstatistik und Konfidenzintervalle<a class="headerlink" href="#inferenzstatistik-und-konfidenzintervalle" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Die Methodik der Inferenzstatistik wird theoretisch wie praktisch diskutiert</p></li>
<li><p>Die Begriffe Konfidenzintervalle und Intervallschätzung und ihre Anwendung in der Schätzung von Grungesamtheitsparametern wird veranschaulicht</p></li>
<li><p>Die <span class="math notranslate nohighlight">\(z\)</span>-Verteilung und <span class="math notranslate nohighlight">\(t\)</span>-Verteilung werden sowohl theoretisch als auch durch Beispielen in Python beschrieben</p></li>
<li><p>Zusammengefasst werden folgende Begriffe und Methoden besprochen : Inferenzstatistik, Konfidenzintervalle, Punkteschätzung, Intervall-Schätzung, <span class="math notranslate nohighlight">\(𝑧\)</span>-Verteilung, <span class="math notranslate nohighlight">\(t\)</span>-Verteilung</p></li>
</ul>
</section>
</section>
<span id="document-Kapitel05/01_Inferenzstatistik_und_Konfidenzintervalle"></span><section class="tex2jax_ignore mathjax_ignore" id="inferenzstatistik-und-konfidenzintervalle">
<h2>Inferenzstatistik und Konfidenzintervalle<a class="headerlink" href="#inferenzstatistik-und-konfidenzintervalle" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span><span class="p">,</span> <span class="n">t</span>
</pre></div>
</div>
</div>
</div>
<p>Die <a href="https://de.wikipedia.org/wiki/Statistische_Inferenz">Inferenzstatistik</a> besteht aus Methoden, die Stichprobenergebnisse verwenden, um Entscheidungen oder Vorhersagen über eine Grundgesamtheit zu treffen (<span id="id1">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.12, <span id="id2">[<a class="reference internal" href="intro.html#id11" title="Günther Bourier. Wahrscheinlichkeitsrechnung und schließende Statistik. Springer, 2002.">Bourier, 2002</a>]</span> s.237). Dieser Bereich der angewandten Statistik ist in allen Situationen von grundlegender Bedeutung, in denen das Wissen über die Grundgesamtheit begrenzt ist oder sogar gänzlich fehlt, was bei den meisten Anwendungen im wirklichen Leben der Fall ist. Außerdem ist es in vielen Fällen einfach zu teuer, sehr zeitaufwändig oder praktisch unmöglich, die Daten aller Mitglieder einer Grundgesamtheit zu erfassen. Daher wird eine Stichprobe aus der Grundgesamtheit gezogen und eine geeignete Stichprobenstatistik berechnet. Auf der Grundlage des Wertes der Stichprobenstatistik wird dann dem entsprechenden (unbekannten) Grundgesamtheitsparameter ein Wert zugewiesen.</p>
<p>Dieses Verfahren, bei dem Grundgesamtheitsparameter auf der Grundlage von Stichproben ein numerischer Wert zugewiesen wird, wird als <a href="https://de.wikipedia.org/wiki/Sch%C3%A4tzung">Schätzung</a> bezeichnet.Der numerische Wert wird als <strong>Schätzung</strong> des Grundgesamtheitsparameters bezeichnet. Die zur Schätzung eines Populationsparameters verwendete Stichprobenstatistik wird als <strong>Schätzer</strong> bezeichnet (<span id="id3">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.339).</p>
<section id="die-punkteschatzung">
<h3>Die Punkteschätzung<a class="headerlink" href="#die-punkteschatzung" title="Permalink to this headline">#</a></h3>
<p>Bei einer Stichprobe ergibt der Wert der berechneten Stichprobenstatistik eine <strong>Punktschätzung</strong> (<span id="id4">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.338) des entsprechenden Populationsparameters. Beispielsweise ist der Stichprobenmittelwert (<span class="math notranslate nohighlight">\(\bar{x}\)</span>) eine Punktschätzung des entsprechenden Populationsmittelwerts <span class="math notranslate nohighlight">\(\mu\)</span>, oder die Stichprobenstandardabweichung <span class="math notranslate nohighlight">\(s\)</span> ist eine Punktschätzung für die Standardabweichung der Grundgesamtheit <span class="math notranslate nohighlight">\(\sigma\)</span>. Es ist jedoch zu beachten, dass jede zufällig ausgewählte Stichprobe aus einer Population voraussichtlich einen anderen Wert der Stichprobenstatistik ergibt. Mit anderen Worten, der Stichprobenmittelwert <span class="math notranslate nohighlight">\(\bar{x}\)</span> und die Stichprobenstandardabweichung <span class="math notranslate nohighlight">\(s\)</span> variieren von Stichprobe zu Stichprobe, während der Grundgesamtheitsmittelwert <span class="math notranslate nohighlight">\(\mu\)</span> und die Grundgesamtheitsstandardabweichung <span class="math notranslate nohighlight">\(\sigma\)</span> fest sind. Folglich weicht der Punktschätzer fast immer vom wahren Wert der Grundgesamtheit ab. Daher sollte jeder Punktschätzung eine Information beigefügt werden, die die Genauigkeit dieser Schätzung angibt.</p>
</section>
<section id="die-intervall-schatzung">
<h3>Die Intervall-Schätzung<a class="headerlink" href="#die-intervall-schatzung" title="Permalink to this headline">#</a></h3>
<p>Anstatt einem Grundgesamtheitsparameter einen einzelnen Wert zuzuordnen, gibt eine <strong>Intervallschätzung</strong> eine probabilistische Aussage, die das gegebene Intervall mit der Wahrscheinlichkeit in Beziehung setzt, dass dieses Intervall tatsächlich den wahren (unbekannten) Grundgesamtheitsparameter enthält.</p>
<p>Das <strong>Konfidenzniveau</strong> wird a priori gewählt und hängt somit von den Präferenzen des Nutzers ab. Es wird bezeichnet durch</p>
<div class="math notranslate nohighlight">
\[ 100(1-\alpha)\% \]</div>
<p>Obwohl jeder beliebige Wert für das Konfidenzniveau gewählt werden kann, sind die gebräuchlichsten Werte <span class="math notranslate nohighlight">\(90 \%, 95 \%\)</span> und <span class="math notranslate nohighlight">\(99 \%\)</span>. Wird das Konfidenzniveau als Wahrscheinlichkeit ausgedrückt, wird es als <strong>Konfidenzkoeffizient</strong> bezeichnet und mit <span class="math notranslate nohighlight">\((1-\alpha)\)</span>. Die gebräuchlichsten Vertrauenskoeffizienten sind <span class="math notranslate nohighlight">\(0,90\)</span>, <span class="math notranslate nohighlight">\(0,95\)</span> bzw. <span class="math notranslate nohighlight">\(0,99\)</span>.</p>
<p>Ein <span class="math notranslate nohighlight">\(100(1-α) \%\)</span>-iges <a href="https://de.wikipedia.org/wiki/Konfidenzintervall">Konfidenzintervall</a> ist eine Intervallschätzung um einen Populationsparameter <span class="math notranslate nohighlight">\(\theta\)</span> (hier ist der griechische Buchstabe <span class="math notranslate nohighlight">\(\theta\)</span> ein Platzhalter für einen beliebigen Populationsparameter von Interesse, wie z. B. den Mittelwert <span class="math notranslate nohighlight">\(\mu\)</span> oder die Standardabweichung <span class="math notranslate nohighlight">\(\sigma\)</span>), von dem bei wiederholten Stichproben der Größe <span class="math notranslate nohighlight">\(N\)</span> erwartet wird, dass er den wahren Wert von <span class="math notranslate nohighlight">\(\theta\)</span> in <span class="math notranslate nohighlight">\(100(1-α) \%\)</span> der Fälle einschließt (<span id="id5">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.358).</p>
<p>Die tatsächliche Zahl, die zur Punktschätzung addiert oder von ihr subtrahiert wird, wird als Fehlermarge bezeichnet.</p>
<div class="math notranslate nohighlight">
\[CI: \text{Punktschätzung} \pm \text{Fehlermarge}\]</div>
<p>Die Fehlermarge besteht aus zwei Elementen. Zum einen aus dem so genannten <strong>kritischen Wert</strong> und zum anderen aus einem Maß für die Variabilität der <a href="https://de.wikipedia.org/wiki/Sch%C3%A4tzfunktion#Stichprobenverteilung">Stichprobenverteilung</a>. Der kritische Wert ist ein numerischer Wert, der dem a priori festgelegten Vertrauensniveau entspricht. Er wird manchmal als <span class="math notranslate nohighlight">\(z^*\)</span> oder <span class="math notranslate nohighlight">\(z^*_{\alpha/2}\)</span> bezeichnet. Das Maß für die Variabilität ist der <a href="https://de.wikipedia.org/wiki/Standardfehler">Standardfehler</a>, der als <span class="math notranslate nohighlight">\(\frac{\sigma}{\sqrt{n}}\)</span> bezeichnet wird.</p>
<p>Die Fehlermarge (<span class="math notranslate nohighlight">\(FM\)</span>) wird also ausgedrückt als</p>
<div class="math notranslate nohighlight">
\[FM = z^*_{\alpha/2} \times \frac{\sigma}{\sqrt{n}}\]</div>
<p>Schauen wir uns zum besseren Verständnis eine Abbildung an.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>


<span class="n">z</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.64</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.64</span><span class="p">]</span>
<span class="k">for</span> <span class="n">_x</span> <span class="ow">in</span> <span class="n">z</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">_x</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=-</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=-</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>

<span class="n">ticks</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;$\times \frac{\sigma}{\sqrt</span><span class="si">{n}</span><span class="s2">}$&quot;</span> <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="sa">r</span><span class="s2">&quot;$\bar</span><span class="si">{x}</span><span class="s2">$&quot;</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ticks</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">z</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># ax.set_ylabel(r&quot;$f(x)$&quot;)</span>
<span class="c1"># ax.set_xlabel(r&quot;z-score&quot;)</span>
<span class="c1"># ax.annotate(</span>
<span class="c1">#     r&quot;$\phi(z)$&quot;,</span>
<span class="c1">#     xy=(-0.5, 0.15),</span>
<span class="c1">#     xytext=(-2, 0.3),</span>
<span class="c1">#     # textcoords=&quot;data&quot;,</span>
<span class="c1">#     arrowprops=dict(headwidth=15, headlength=30, width=4, color=&quot;k&quot;),</span>
<span class="c1">#     size=28,</span>
<span class="c1"># )</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$1- \alpha$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">28</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\bar</span><span class="si">{x}</span><span class="s2"> - z_{\alpha/2} \times \frac{\sigma}{\sqrt</span><span class="si">{n}</span><span class="s2">}$&quot;</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=-</span><span class="mf">1.64</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="mf">0.33</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\bar</span><span class="si">{x}</span><span class="s2"> + z_{\alpha/2} \times \frac{\sigma}{\sqrt</span><span class="si">{n}</span><span class="s2">}$&quot;</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="mf">1.64</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="mf">0.33</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;$\frac{\alpha}</span><span class="si">{2}</span><span class="s2">$&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">28</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;$\frac{\alpha}</span><span class="si">{2}</span><span class="s2">$&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">2.7</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">28</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.015</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.34</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.015</span><span class="p">,</span> <span class="mf">1.34</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;Fehlermarge&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;Fehlermarge&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[]
</pre></div>
</div>
<img alt="_images/01_Inferenzstatistik_und_Konfidenzintervalle_14_1.png" src="_images/01_Inferenzstatistik_und_Konfidenzintervalle_14_1.png" />
</div>
</div>
<p>Dementsprechend lautet die vollständige Gleichung für das Konfidenzintervall wie folgt</p>
<div class="math notranslate nohighlight">
\[CI: \text{Punktschätzung} \pm z^*_{\alpha/2} \times \frac{\sigma}{\sqrt{n}}\]</div>
<p>Um den entsprechenden Wert für <span class="math notranslate nohighlight">\(z^*_{\alpha/2}\)</span> zu erhalten, kann man ihn in einer <a href="https://de.wikipedia.org/wiki/Standardnormalverteilungstabelle">Tabelle</a> nachschlagen oder die Funktion <code class="docutils literal notranslate"><span class="pre">norm.ppf()</span></code> in Python verwenden. Lassen Sie uns zur Übung einige Konfidenzintervalle konstruieren.</p>
<p><strong>Konfidenzniveau von</strong> <span class="math notranslate nohighlight">\(90 \% (\alpha=0,1)\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.6448536269514729
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.6448536269514722
</pre></div>
</div>
</div>
</div>
<p>Die untere und obere Grenze des Intervalls, das einen Bereich von <span class="math notranslate nohighlight">\(90 \%\)</span> um den Mittelwert abdeckt, wird durch die <span class="math notranslate nohighlight">\(z\)</span>-Werte <span class="math notranslate nohighlight">\(-1,64\)</span> bzw. <span class="math notranslate nohighlight">\(1,64\)</span> angegeben.</p>
<p>Bei einem Konfidenzniveau von <span class="math notranslate nohighlight">\(90 \% (\alpha=0,1)\)</span> ergibt sich aus der obigen Gleichung</p>
<div class="math notranslate nohighlight">
\[CI_{90\%}: \text{Punktschätzung} \pm 1,64 \times \frac{\sigma}{\sqrt{n}}\]</div>
<p><strong>Konfidenzniveau von</strong> <span class="math notranslate nohighlight">\(95 \% (\alpha=0,05)\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.025</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.9599639845400545
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.975</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.959963984540054
</pre></div>
</div>
</div>
</div>
<p>Die untere und obere Grenze des Intervalls, das einen Bereich von <span class="math notranslate nohighlight">\(90 \%\)</span> um den Mittelwert abdeckt, wird durch die <span class="math notranslate nohighlight">\(z\)</span>-Werte <span class="math notranslate nohighlight">\(-1,96\)</span> bzw. <span class="math notranslate nohighlight">\(1,96\)</span> angegeben.</p>
<p>Bei einem Konfidenzniveau von <span class="math notranslate nohighlight">\(95 \% (\alpha=0,05)\)</span> ergibt sich aus der obigen Gleichung</p>
<div class="math notranslate nohighlight">
\[CI_{95\%}: \text{Punktschätzung} \pm 1,96 \times \frac{\sigma}{\sqrt{n}}\]</div>
<p><strong>Konfidenzniveau von</strong> <span class="math notranslate nohighlight">\(99 \% (\alpha=0,01)\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.005</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-2.575829303548901
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.995</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.5758293035489004
</pre></div>
</div>
</div>
</div>
<p>Die untere und obere Grenze des Intervalls, das einen Bereich von <span class="math notranslate nohighlight">\(90 \%\)</span> um den Mittelwert abdeckt, wird durch die <span class="math notranslate nohighlight">\(z\)</span>-Werte <span class="math notranslate nohighlight">\(-2,58\)</span> bzw. <span class="math notranslate nohighlight">\(2,58\)</span> angegeben.</p>
<p>Bei einem Konfidenzniveau von <span class="math notranslate nohighlight">\(99 \% (\alpha=0,01)\)</span> ergibt sich aus der obigen Gleichung</p>
<div class="math notranslate nohighlight">
\[CI_{99\%}: \text{Punktschätzung} \pm 2,58 \times \frac{\sigma}{\sqrt{n}}\]</div>
</section>
<section id="die-breite-eines-konfidenzintervalls-und-der-kompromiss-zwischen-prazision-und-genauigkeit">
<h3>Die Breite eines Konfidenzintervalls und der Kompromiss zwischen Präzision und Genauigkeit<a class="headerlink" href="#die-breite-eines-konfidenzintervalls-und-der-kompromiss-zwischen-prazision-und-genauigkeit" title="Permalink to this headline">#</a></h3>
<section id="ein-gedankenexperiment">
<h4>Ein Gedankenexperiment<a class="headerlink" href="#ein-gedankenexperiment" title="Permalink to this headline">#</a></h4>
<p>Betrachten wir die durchschnittliche Tagestemperatur in Berlin an einem schönen Sommertag im Juni. Nehmen wir an, wir messen eine mittlere Tagestemperatur von <span class="math notranslate nohighlight">\(19^\circ\text{C}\)</span>. Nun geht es darum, die mittlere Temperatur von morgen zu schätzen.</p>
<p>Es gibt natürlich mehrere mehr oder weniger ausgeklügelte Ansätze, um diese Aufgabe zu lösen. Man kann in den Datenarchiven nachsehen und die Schätzung auf deskriptive Statistiken stützen, oder man kann sogar einen sehr ausgeklügelten Modellierungsansatz mit einer Unmenge von Modellparametern anwenden, oder man kann einfach eine Schätzung auf der Grundlage des gesunden Menschenverstands vornehmen. Unabhängig davon, welcher Ansatz gewählt wird, wird das Ergebnis immer eine Schätzung sein, die mit einem gewissen Grad an Unsicherheit verbunden ist.</p>
<p>Um dieser Unsicherheit Rechnung zu tragen, präsentieren wir keine Punktschätzung der morgigen Temperatur, sondern eine Intervallschätzung. Um eine hohe <strong>Genauigkeit</strong> unserer Schätzung zu erreichen, also, dass wir sehr sicher sein wollen, dass unser Intervall den tatsächlichen Wert enthält, wenden wir eine sehr große Fehlermarge an. Wir sagen zum Beispiel, dass die morgige Temperatur <span class="math notranslate nohighlight">\(19 \pm 20^\circ\text{C}\)</span> beträgt. Nach gesundem Menschenverstand würden wir wahrscheinlich zustimmen, dass die durchschnittliche Tagestemperatur an einem Sommertag im Juni in Berlin zwischen <span class="math notranslate nohighlight">\(-1\)</span> und <span class="math notranslate nohighlight">\(39^\circ\text{C}\)</span> liegt.</p>
<p>Obwohl das Intervall sehr groß ist und vielleicht sogar alle mittleren Tagestemperaturen im Juni für Berlin in der Geschichte der Wetterbeobachtung enthält, besteht immer noch eine kleine Chance, dass wir uns irren. Stellen Sie sich ein natürliches oder vom Menschen verursachtes katastrophales Ereignis wie einen gewaltigen Vulkanausbruch, einen Asteroideneinschlag oder einen Atomkrieg vor; in diesen glücklicherweise sehr unwahrscheinlichen Fällen kann selbst eine so große Fehlermarge nicht garantieren, dass die morgige Durchschnittstemperatur innerhalb des angegebenen Intervalls liegt. Dennoch ist es wichtig zu beachten, dass wir, <strong>um eine hohe Genauigkeit zu erreichen, das Konfidenzniveau und damit die Breite des Konfidenzintervalls erhöhen</strong>.</p>
<p>OK, wir sagen, dass die morgige Temperatur im Bereich von <span class="math notranslate nohighlight">\(19 \pm 20^\circ\text{C}\)</span> liegt. Aber ist eine solche Aussage, obwohl sie sehr genau ist, überhaupt von Wert? Hilft uns diese Schätzung bei der Entscheidung, welche Kleidung wir morgen tragen sollen? Nein, ganz und gar nicht!</p>
<p>In vielen Anwendungen sind wir also nicht nur an der <strong>Genauigkeit</strong> interessiert, sondern auch an der <strong>Präzision</strong> einer Schätzung. Eine Schätzung der morgigen Temperatur mit höherer Genauigkeit wäre <span class="math notranslate nohighlight">\(19 \pm 2^\circ\text{C}\)</span>. Eine solche Vorhersage hilft uns zwar bei der Entscheidung, welche Kleidung wir anziehen sollen, aber die Wahrscheinlichkeit, dass wir uns irren, ist viel größer. Daher ist es wichtig, sich zu vergegenwärtigen, dass eine <strong>Erhöhung der Genauigkeit die Breite des Konfidenzintervalls verkleinert und somit das Konfidenzniveau verringert</strong>. Diese Abwägung zwischen Genauigkeit und Präzision bei der Auswahl eines geeigneten Konfidenzniveaus ist in der Praxis sehr wichtig.</p>
</section>
</section>
<section id="schatzung-des-mittelwerts-einer-grundgesamtheit-die-z-verteilung">
<h3>Schätzung des Mittelwerts einer Grundgesamtheit - Die <span class="math notranslate nohighlight">\(z\)</span>-Verteilung<a class="headerlink" href="#schatzung-des-mittelwerts-einer-grundgesamtheit-die-z-verteilung" title="Permalink to this headline">#</a></h3>
<p>Die Schätzung des Mittelwerts einer Grundgesamtheit anhand einer Stichprobe ist eine sehr häufige Aufgabe. Wenn die Standardabweichung der Grundgesamtheit (<span class="math notranslate nohighlight">\(\sigma\)</span>) bekannt ist, basiert die Konstruktion eines Konfidenzintervalls für den Grundgesamtheitsmittelwert (<span class="math notranslate nohighlight">\(\mu\)</span>) auf der normalverteilten Stichprobenverteilung der Stichprobenmittelwerte (gewährleistet durch den <a href="https://de.wikipedia.org/wiki/Zentraler_Grenzwertsatz">zentralen Grenzwertsatz</a>). Wenn die Grundgesamtheit, aus der die Stichprobe gezogen wird, nicht normalverteilt ist, sollte der Stichprobenumfang <span class="math notranslate nohighlight">\(n \gt 30\)</span> sein.</p>
<p>Das <span class="math notranslate nohighlight">\(100(1-α) \%\)</span>ige Konfidenzintervall für <span class="math notranslate nohighlight">\(\mu\)</span> ist gegeben durch</p>
<div class="math notranslate nohighlight">
\[CI: \bar x \pm z^*_{\alpha/2}\times \sigma_{\bar x}\]</div>
<div class="math notranslate nohighlight">
\[\text{wobei}\qquad \sigma_{\bar x} = \frac{\sigma}{\sqrt{n}}\]</div>
<p>Der Wert von <span class="math notranslate nohighlight">\(z^*_{\alpha/2}\)</span> entspricht dem kritischen Wert und wird aus der <a href="https://de.wikipedia.org/wiki/Standardnormalverteilungstabelle">Standardnormaltabelle</a> entnommen oder mit der Funktion <code class="docutils literal notranslate"><span class="pre">norm.ppf()</span></code> in Python berechnet. Der kritische Wert ist eine Größe, die mit dem gewünschten Konfidenzniveau zusammenhängt. Typische Werte für <span class="math notranslate nohighlight">\(z^*_{\alpha/2}\)</span> sind <span class="math notranslate nohighlight">\(1,64\)</span>, <span class="math notranslate nohighlight">\(1,96\)</span> und <span class="math notranslate nohighlight">\(2,58\)</span>, was einem Konfidenzniveau von <span class="math notranslate nohighlight">\(90 \%, 95 \%\)</span> und <span class="math notranslate nohighlight">\(99 \%\)</span> entspricht. Dieser kritische Wert wird mit dem Standardfehler (<span class="math notranslate nohighlight">\(\sigma_{\bar{x}}\)</span>)multipliziert, um die Fehlermarge zu vergrößern oder zu verkleinern.</p>
<p>Der Standardfehler (<span class="math notranslate nohighlight">\(\sigma_{\bar{x}}\)</span>) ergibt sich aus dem Verhältnis zwischen der Standardabweichung der Grundgesamtheit (<span class="math notranslate nohighlight">\(\sigma\)</span>) und der Quadratwurzel des Stichprobenumfangs <span class="math notranslate nohighlight">\(n\)</span>. Er beschreibt das Ausmaß, in dem die berechnete Stichprobenstatistik von einer Stichprobe zur anderen abweichen kann. Das Produkt aus dem kritischen Wert und dem Standardfehler wird als Fehlermarge bezeichnet. Es ist die Größe, die vom Wert von <span class="math notranslate nohighlight">\(\bar{x}\)</span> subtrahiert und zu diesem addiert wird, um das Konfidenzintervall für <span class="math notranslate nohighlight">\(\mu\)</span> zu erhalten.</p>
</section>
<section id="intervallschatzung-fur-einen-mittelwert-die-z-verteilung">
<h3>Intervallschätzung für einen Mittelwert - Die <span class="math notranslate nohighlight">\(z\)</span>-Verteilung<a class="headerlink" href="#intervallschatzung-fur-einen-mittelwert-die-z-verteilung" title="Permalink to this headline">#</a></h3>
<p>Zum besseren Verständnis der Schätzung eines Populationsmittelwerts und der Konstruktion eines Konfidenzintervalls diskutieren wir das Verfahren anhand eines Datensatzes. Dazu laden wir den <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz. Sie können die Datei <code class="docutils literal notranslate"><span class="pre">students.csv</span></code> <a href="https://userpage.fu-berlin.de/soga/200/2010_data_sets/students.csv">hier</a> herunterladen. Zunächst importieren wir den Datensatz und geben ihm einen passenden Namen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lese Datei students.csv als Dataframe ein</span>
<span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../data/students.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Der <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz besteht aus <span class="math notranslate nohighlight">\(8239\)</span> Zeilen, von denen jede einen bestimmten Studenten repräsentiert, und <span class="math notranslate nohighlight">\(16\)</span> Spalten, von denen jede einer Variable/einem Merkmal entspricht, das sich auf diesen bestimmten Studenten bezieht. Diese selbsterklärenden Variablen sind: <em>stud_id, name, gender, age, height, weight, religion, nc_score, semester, major, minor, score1, score2, online_tutorial, graduated, salary</em>.</p>
<p>In diesem Abschnitt konzentrieren wir uns auf die Größe von Studentinnen. Wir gehen davon aus, dass die im Datensatz angegebenen Größenmessungen eine sehr gute Annäherung an die interessierende Population darstellen, nämlich die Größe der Studentinnen in cm. Die Variable <code class="docutils literal notranslate"><span class="pre">height</span></code> der Studentinnen ist annähernd normalverteilt - was durch die symmetrische Glockenform des Populationshistogramms bestätigt wird.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">female</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">students</span><span class="p">[</span><span class="s2">&quot;gender&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Female&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Bestimme Anzahl Bins</span>
<span class="n">bins</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">female</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">female</span><span class="p">)</span>

<span class="c1"># Plotte die Werte als Histogramm</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">female</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>

<span class="c1"># Erzeuge Labels</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Häufigkeit&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Größe in cm&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;Größe in cm&#39;)
</pre></div>
</div>
<img alt="_images/01_Inferenzstatistik_und_Konfidenzintervalle_49_1.png" src="_images/01_Inferenzstatistik_und_Konfidenzintervalle_49_1.png" />
</div>
</div>
<p>Auf der Grundlage der gegebenen Daten berechnen wir zunächst den Populationsmittelwert <span class="math notranslate nohighlight">\(\mu\)</span> und die Populationsstandardabweichung <span class="math notranslate nohighlight">\(\sigma\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">female</span><span class="p">)</span>
<span class="n">f_mean</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>163.65328467153284
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">female</span><span class="p">)</span>
<span class="n">f_std</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7.918762263149209
</pre></div>
</div>
</div>
</div>
<p>Anschließend konstruieren wir eine Wahrscheinlichkeitsverteilung, indem wir die Funktion <code class="docutils literal notranslate"><span class="pre">norm.pdf()</span></code> anwenden, die durch die zuvor berechneten Parameter <span class="math notranslate nohighlight">\(\mu\)</span> und <span class="math notranslate nohighlight">\(\sigma\)</span> definiert ist, und stellen sie über dem Histogramm dar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">125</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f_mean</span><span class="p">,</span> <span class="n">f_std</span><span class="p">)</span>

<span class="c1"># Bestimme Anzahl Bins</span>
<span class="n">bins</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">female</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">female</span><span class="p">)</span>

<span class="c1"># Plotte die Werte als Histogramm</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">female</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="c1"># Erzeuge Labels</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Häufigkeit&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Größe in cm&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;Größe in cm&#39;)
</pre></div>
</div>
<img alt="_images/01_Inferenzstatistik_und_Konfidenzintervalle_54_1.png" src="_images/01_Inferenzstatistik_und_Konfidenzintervalle_54_1.png" />
</div>
</div>
<p>Eine gute Übereinstimmung!</p>
<p>Nun nehmen wir eine Zufallsstichprobe mit einem Stichprobenumfang von <span class="math notranslate nohighlight">\(n=10\)</span>
aus der Wahrscheinlichkeitsverteilung, indem wir die Funktion <code class="docutils literal notranslate"><span class="pre">norm.rvs()</span></code> anwenden und den Stichprobenmittelwert <span class="math notranslate nohighlight">\(\bar{x}\)</span> berechnen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Grösse der Stichprobe</span>
<span class="n">sample_size</span> <span class="o">=</span> <span class="mi">10</span>

<span class="c1"># Wähle normalverteilte Zufallszahlen mit Mittelwert f_mean und Standardabweichung f_std aus</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">f_mean</span><span class="p">,</span> <span class="n">f_std</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sample</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([176.51608944, 158.80893107, 159.47081813, 155.15670124,
       170.50624195, 145.42794689, 177.47003423, 157.62546819,
       166.17967943, 161.67857995])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<span class="n">sample_mean</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>162.88404905120882
</pre></div>
</div>
</div>
</div>
<p>Unsere Stichprobe ergibt einen Stichprobenmittelwert <span class="math notranslate nohighlight">\(\bar{x}\)</span> von etwa <span class="math notranslate nohighlight">\(162,884\)</span>. Dies ist unser Punktschätzer für den interessierenden Grundgesamtheitsparameter, der in diesem Fall die durchschnittliche Körpergröße der Studentinnen (<span class="math notranslate nohighlight">\(\mu\)</span>).</p>
<p>Wie genau ist unsere Punktschätzung? Wir fragen Python, ob unsere Schätzung mit dem wahren Grundgesamtheitsparameter übereinstimmt.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_mean</span> <span class="o">==</span> <span class="n">f_mean</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<p>OK, das haben wir erwartet!</p>
<p>Berechnen wir nun einige Intervallschätzungen, indem wir die <span class="math notranslate nohighlight">\(90\%-, 95\%-\)</span> und <span class="math notranslate nohighlight">\(99\%-\)</span> Konfidenzintervalle konstruieren. Erinnern Sie sich an die Gleichung für ein Konfidenzintervall.</p>
<div class="math notranslate nohighlight">
\[CI: \text{Punktschätzung} \pm z^*_{\alpha/2} \times \frac{\sigma}{\sqrt{n}}\]</div>
<p>Der kritische Wert <span class="math notranslate nohighlight">\(z^*_{\alpha/2}\)</span> beträgt <span class="math notranslate nohighlight">\(1,64\)</span>, <span class="math notranslate nohighlight">\(1,96\)</span> und <span class="math notranslate nohighlight">\(2,58\)</span> für Konfidenzniveaus von <span class="math notranslate nohighlight">\(90\%, 95\%\)</span> bzw. <span class="math notranslate nohighlight">\(99\%\)</span>.</p>
<p>Angewandt auf unsere Daten ergibt die Gleichung</p>
<div class="math notranslate nohighlight">
\[CI_{90\%}: 162,884 \pm 1,64 \times \frac{7,92}{\sqrt{10}} = 162,884 \pm 4,12\]</div>
<p>Wir können also mit <span class="math notranslate nohighlight">\(90\%\)</span>iger Sicherheit sagen, dass die durchschnittliche Körpergröße der Studenten (der Grundgesamtheitsparameter <span class="math notranslate nohighlight">\(\mu\)</span>) zwischen <span class="math notranslate nohighlight">\(158,764\)</span> und <span class="math notranslate nohighlight">\(167,004\)</span> cm liegt.</p>
<div class="math notranslate nohighlight">
\[CI_{95\%}: 162,884 \pm 1,96 \times \frac{7,92}{\sqrt{10}} = 162,884 \pm 4,91\]</div>
<p>Wir können also mit 95%iger Sicherheit sagen, dass die durchschnittliche Körpergröße der Studenten zwischen <span class="math notranslate nohighlight">\(157,974\)</span> und <span class="math notranslate nohighlight">\(167,794\)</span> cm liegt.</p>
<div class="math notranslate nohighlight">
\[CI_{99\%}: 162,884 \pm 2,58 \times \frac{7,92}{\sqrt{10}} = 162,884 \pm 6,45\]</div>
<p>Wir können also mit <span class="math notranslate nohighlight">\(99\%\)</span>iger Sicherheit sagen, dass die durchschnittliche Körpergröße der Studenten zwischen <span class="math notranslate nohighlight">\(156,434\)</span> und <span class="math notranslate nohighlight">\(169,334\)</span> cm liegt.</p>
<p>Es liegt auf der Hand, <strong>dass die Fehlerspanne größer wird, wenn man eine höhere Sicherheit haben will, dass der unbekannte Grundgesamtheitsparameter im Intervall enthalten ist</strong>.</p>
<p>Zur Überprüfung der Richtigkeit wollen wir untersuchen, ob wir mit unseren Intervallschätzungen tatsächlich den wahren Wert der Grundgesamtheit erfasst haben. Es ist wichtig, sich daran zu erinnern, dass das Konfidenzintervall unserem Stichprobenmittelwert keine Wahrscheinlichkeit zuweist, sondern besagt, dass das Konfidenzintervall bei wiederholten Zufallsstichproben den Mittelwert der Grundgesamtheit in <span class="math notranslate nohighlight">\(100(1-\alpha)\%\)</span> der Fälle enthalten soll. Um diese Behauptung zu testen, schreiben wir selbst eine einfache Python-Funktion.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">CI_eval</span><span class="p">(</span><span class="n">pop_mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">estimate</span><span class="p">,</span> <span class="n">alpha</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Funktion zur Evaluierung des Konfidenzintervalls&quot;&quot;&quot;</span>
    <span class="n">out</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">:</span> <span class="p">{}</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">alpha</span><span class="p">}</span>

    <span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">_alpha</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">alpha</span><span class="p">):</span>
        <span class="n">key</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">_alpha</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span><span class="si">}</span><span class="s2">%&quot;</span>
        <span class="n">out</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;true value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pop_mean</span>
        <span class="n">out</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;estimate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">estimate</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="n">estimate</span> <span class="o">+</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">_alpha</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">sigma</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">out</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;upper&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">upper</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="n">estimate</span> <span class="o">-</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">_alpha</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">sigma</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">out</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;lower&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lower</span>
        <span class="n">out</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;test&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pop_mean</span> <span class="o">&gt;=</span> <span class="n">lower</span> <span class="ow">and</span> <span class="n">pop_mean</span> <span class="o">&lt;=</span> <span class="n">upper</span>

    <span class="k">return</span> <span class="n">out</span>
</pre></div>
</div>
</div>
</div>
<p>Wenden wir nun unsere selbst erstellte Funktion <code class="docutils literal notranslate"><span class="pre">CI_eval()</span></code> auf unsere Daten an. Wir setzen <code class="docutils literal notranslate"><span class="pre">pop_mean</span> <span class="pre">=</span> <span class="pre">f_mean</span></code>, <code class="docutils literal notranslate"><span class="pre">sigma</span> <span class="pre">=</span> <span class="pre">f_std</span></code>, <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">=</span> <span class="pre">sample_size</span></code>, <code class="docutils literal notranslate"><span class="pre">estimate</span> <span class="pre">=</span> <span class="pre">sample_mean</span></code>, <code class="docutils literal notranslate"><span class="pre">alpha</span> <span class="pre">=</span> <span class="pre">[0.1,</span> <span class="pre">0.05,</span> <span class="pre">0.01]</span></code>, um zu evaluieren, ob die drei oben konstruierten Konfidenzintervalle (<span class="math notranslate nohighlight">\(90\%, 95\%\)</span> und <span class="math notranslate nohighlight">\(99\%\)</span>) den Grundgesamtheitsmittelwert enthalten. Schließlich wandeln wir den resultierenden Vektor in ein <code class="docutils literal notranslate"><span class="pre">dataframe</span></code> -Objekt um, um die Lesbarkeit zu verbessern.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
    <span class="n">CI_eval</span><span class="p">(</span>
        <span class="n">pop_mean</span><span class="o">=</span><span class="n">f_mean</span><span class="p">,</span>
        <span class="n">sigma</span><span class="o">=</span><span class="n">f_std</span><span class="p">,</span>
        <span class="n">n</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span>
        <span class="n">estimate</span><span class="o">=</span><span class="n">sample_mean</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>90%</th>
      <th>95%</th>
      <th>99%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>true value</th>
      <td>163.653285</td>
      <td>163.653285</td>
      <td>163.653285</td>
    </tr>
    <tr>
      <th>estimate</th>
      <td>162.884049</td>
      <td>162.884049</td>
      <td>162.884049</td>
    </tr>
    <tr>
      <th>upper</th>
      <td>167.00298</td>
      <td>167.792059</td>
      <td>169.334267</td>
    </tr>
    <tr>
      <th>lower</th>
      <td>158.765118</td>
      <td>157.97604</td>
      <td>156.433831</td>
    </tr>
    <tr>
      <th>test</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Ein interessantes Ergebnis. Der wahre Mittelwert der Grundgesamtheit (<code class="docutils literal notranslate"><span class="pre">f_mean</span></code> = <span class="math notranslate nohighlight">\(163,65\)</span>) wird von allen drei Konfidenzintervallen erfasst. Der Mittelwert unserer Zufallsstichprobe (<code class="docutils literal notranslate"><span class="pre">sample_mean</span></code> = <span class="math notranslate nohighlight">\(162,884\)</span>) war ein recht guter Schätzer.</p>
</section>
<section id="schatzung-des-mittelwerts-einer-grundgesamtheit-die-t-verteilung">
<h3>Schätzung des Mittelwerts einer Grundgesamtheit - Die <span class="math notranslate nohighlight">\(t\)</span>-Verteilung<a class="headerlink" href="#schatzung-des-mittelwerts-einer-grundgesamtheit-die-t-verteilung" title="Permalink to this headline">#</a></h3>
<p>Bisher haben wir uns auf <span class="math notranslate nohighlight">\(\sigma\)</span>, die Standardabweichung der Grundgesamtheit, gestützt, um auf den Mittelwert der Grundgesamtheit zu schließen. Der Populationsparameter <span class="math notranslate nohighlight">\(\sigma\)</span> wird zur Berechnung des Standardfehlers (<span class="math notranslate nohighlight">\(SF=\frac{\sigma}{\sqrt{n}}\)</span>) verwendet, der ein Bestandteil der Fehlermarge ist. Was aber, wenn man die Standardabweichung der Grundgesamtheit nicht kennt, was in der Regel der Fall ist? Man kann die Standardabweichung der Stichprobe, die mit <span class="math notranslate nohighlight">\(s\)</span> bezeichnet wird, als Schätzwert für die Standardabweichung der Grundgesamtheit verwenden.</p>
<div class="math notranslate nohighlight">
\[\text{wenn } \  s \approx \sigma \  \text{ dann } \  SF = \frac{s}{\sqrt{n}}\]</div>
<p>Es ist jedoch zu beachten, dass im Gegensatz zu <span class="math notranslate nohighlight">\(\sigma\)</span> die Standardabweichung der Stichprobe, <span class="math notranslate nohighlight">\(s\)</span>, von Stichprobe zu Stichprobe variiert und dass <span class="math notranslate nohighlight">\(s \lt \sigma\)</span> ist. Man kann den Stichprobenumfang <span class="math notranslate nohighlight">\(n\)</span> erhöhen, und damit wird <span class="math notranslate nohighlight">\(s\)</span> zu einer besseren Schätzung für <span class="math notranslate nohighlight">\(\sigma\)</span>. Solange wir jedoch <span class="math notranslate nohighlight">\(\sigma\)</span> nicht kennen, müssen wir bei der Durchführung des Inferenzverfahrens in jedem Fall zwei Größen schätzen: sowohl den Mittelwert <span class="math notranslate nohighlight">\(\mu\)</span> als auch die Standardabweichung <span class="math notranslate nohighlight">\(\sigma\)</span>. Aus diesem Grund führt die Verwendung von <span class="math notranslate nohighlight">\(s\)</span> als Schätzung für <span class="math notranslate nohighlight">\(\sigma\)</span> zu einer größeren Unsicherheit bei der Schätzung des Mittelwerts <span class="math notranslate nohighlight">\(\mu\)</span>. Um dieser zusätzlichen Unsicherheit entgegenzuwirken, wenden wir die so genannte <a href="https://de.wikipedia.org/wiki/Studentsche_t-Verteilung"><span class="math notranslate nohighlight">\(t\)</span>-Verteilung</a> oder <strong>Studentsche-Verteilung</strong> an, um die Fehlermarge (<span class="math notranslate nohighlight">\(FM\)</span>) zu berechnen.</p>
<p>Das Verfahren zur Ermittlung eines Konfidenzintervalls für einen Grundgesamtheitsmittelwert, wenn die Standardabweichung <span class="math notranslate nohighlight">\(\sigma\)</span> der Grundgesamtheit nicht bekannt ist, ist im Wesentlichen dasselbe wie bei bekannter Standardabweichung der Grundgesamtheit, mit der Ausnahme, dass jetzt die <span class="math notranslate nohighlight">\(t\)</span>-Verteilung und die Standardabweichung <span class="math notranslate nohighlight">\(s\)</span> der Stichprobe anstelle der Standardnormalverteilung (<span class="math notranslate nohighlight">\(z\)</span>-Scores) bzw. der Standardabweichung <span class="math notranslate nohighlight">\(\sigma\)</span> der Grundgesamtheit herangezogen werden.</p>
<p>Erinnern Sie sich an die Konstruktion eines Konfidenzintervalls</p>
<div class="math notranslate nohighlight">
\[CI: \text{Punktschätzung} \pm FM\]</div>
<p>Die Fehlermarge (<span class="math notranslate nohighlight">\(FM\)</span>) besteht aus dem kritischen Wert und einem Maß für die Variabilität der Stichprobenverteilung. Der kritische Wert ist <span class="math notranslate nohighlight">\(t^*_{df,\,\alpha/2}\)</span> für das gegebene Konfidenzniveau und die Freiheitsgrade. Sein Wert ergibt sich aus einer <span class="math notranslate nohighlight">\(t\)</span>-Verteilungstabelle für <span class="math notranslate nohighlight">\(n-1\)</span> Freiheitsgrade oder wird in Python mit der Funktion <code class="docutils literal notranslate"><span class="pre">t.cdf()</span></code> berechnet. Das Maß für die Variabilität der Stichprobenverteilung ist der Standardfehler (<span class="math notranslate nohighlight">\(SF\)</span>). Da die Standardabweichung <span class="math notranslate nohighlight">\(\sigma\)</span> der Grundgesamtheit nicht bekannt ist, wird sie durch die Standardabweichung <span class="math notranslate nohighlight">\(s\)</span> der Stichprobe ersetzt, was zu <span class="math notranslate nohighlight">\(SF=\frac{s}{\sqrt{n}}\)</span> führt.</p>
<p>Folglich ist das <span class="math notranslate nohighlight">\(100(1-α) \%\)</span>ige
Konfidenzintervall für <span class="math notranslate nohighlight">\(\mu\)</span> gleich</p>
<div class="math notranslate nohighlight">
\[CI: \bar x \pm t^*_{df,\, \alpha/2} \frac{s}{\sqrt{n}}\]</div>
<p>Lassen Sie uns zur Übung einige Konfidenzintervalle konstruieren. Für den Zweck dieser Übung wird <span class="math notranslate nohighlight">\(df\)</span> auf <span class="math notranslate nohighlight">\(12\)</span> gesetzt.</p>
<p><strong>Konfidenzniveau von</strong> <span class="math notranslate nohighlight">\(90 \%\)</span> (<span class="math notranslate nohighlight">\(\alpha=0,1\)</span>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.7822875556491593
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.782287555649159
</pre></div>
</div>
</div>
</div>
<p>Die untere und obere Grenze des Intervalls (bei <span class="math notranslate nohighlight">\(df=12\)</span>), das einen Bereich von <span class="math notranslate nohighlight">\(90 \%\)</span> um den Mittelwert abdeckt, entspricht den <span class="math notranslate nohighlight">\(t\)</span>-Werten <span class="math notranslate nohighlight">\(-1,78\)</span> und <span class="math notranslate nohighlight">\(1,78\)</span></p>
<p>Bei einem Konfidenzniveau von <span class="math notranslate nohighlight">\(90 \% (\alpha=0,1)\)</span> ergibt sich aus der obigen Gleichung</p>
<div class="math notranslate nohighlight">
\[CI_{90\%}: \text{Punktschätzung} \pm 1,78 \times \frac{s}{\sqrt{n}}\]</div>
<p><strong>Konfidenzniveau von</strong> <span class="math notranslate nohighlight">\(95 \%\)</span> (<span class="math notranslate nohighlight">\(\alpha=0,05\)</span>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-2.178812829663418
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.975</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.1788128296634177
</pre></div>
</div>
</div>
</div>
<p>Die untere und obere Grenze des Intervalls (bei <span class="math notranslate nohighlight">\(df=12\)</span>), das einen Bereich von <span class="math notranslate nohighlight">\(95 \%\)</span> um den Mittelwert abdeckt, entspricht den <span class="math notranslate nohighlight">\(t\)</span>-Werten <span class="math notranslate nohighlight">\(-2,18\)</span> und <span class="math notranslate nohighlight">\(2,18\)</span></p>
<p>Bei einem Konfidenzniveau von <span class="math notranslate nohighlight">\(95 \% (\alpha=0,05)\)</span> ergibt sich aus der obigen Gleichung</p>
<div class="math notranslate nohighlight">
\[CI_{95\%}: \text{Punktschätzung} \pm 2,18 \times \frac{s}{\sqrt{n}}\]</div>
<p><strong>Konfidenzniveau von</strong> <span class="math notranslate nohighlight">\(99 \%\)</span> (<span class="math notranslate nohighlight">\(\alpha=0,01\)</span>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.005</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-3.054539588336871
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.995</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.0545395883368704
</pre></div>
</div>
</div>
</div>
<p>Die untere und obere Grenze des Intervalls (bei <span class="math notranslate nohighlight">\(df=12\)</span>), das einen Bereich von <span class="math notranslate nohighlight">\(99 \%\)</span> um den Mittelwert abdeckt, entspricht den <span class="math notranslate nohighlight">\(t\)</span>-Werten <span class="math notranslate nohighlight">\(-3,05\)</span> und <span class="math notranslate nohighlight">\(3,05\)</span></p>
<p>Bei einem Konfidenzniveau von <span class="math notranslate nohighlight">\(99 \% (\alpha=0,01)\)</span> ergibt sich aus der obigen Gleichung</p>
<div class="math notranslate nohighlight">
\[CI_{99\%}: \text{Punktschätzung} \pm 3,05 \times \frac{s}{\sqrt{n}}\]</div>
</section>
<section id="intervallschatzung-fur-einen-mittelwert-die-t-verteilung">
<h3>Intervallschätzung für einen Mittelwert - Die <span class="math notranslate nohighlight">\(t\)</span>-Verteilung<a class="headerlink" href="#intervallschatzung-fur-einen-mittelwert-die-t-verteilung" title="Permalink to this headline">#</a></h3>
<p>Wir üben das Verfahren “The One-Mean t-Interval Procedure”, um Konfidenzintervalle mit einem Datensatz zu konstruieren. Dazu laden wir den <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz. Sie können die Datei <code class="docutils literal notranslate"><span class="pre">students.csv</span></code> <a href="https://userpage.fu-berlin.de/soga/200/2010_data_sets/students.csv">hier</a> herunterladen. Zunächst importieren wir den Datensatz und geben ihm einen passenden Namen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lese Datei students.csv als Dataframe ein; Indexspalte wird übersprungen</span>
<span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../data/students.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Der <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz besteht aus <span class="math notranslate nohighlight">\(8239\)</span> Zeilen, von denen jede einen bestimmten Studenten repräsentiert, und <span class="math notranslate nohighlight">\(16\)</span> Spalten, von denen jede einer Variable/einem Merkmal entspricht, das sich auf diesen bestimmten Studenten bezieht. Diese selbsterklärenden Variablen sind: <em>stud_id, name, gender, age, height, weight, religion, nc_score, semester, major, minor, score1, score2, online_tutorial, graduated, salary</em>.</p>
<p>In diesem Abschnitt konzentrieren wir uns wieder auf die Körpergröße von Studentinnen. Gehen wir davon aus, dass die im Datensatz angegebenen Größenmessungen eine sehr gute Annäherung an die interessierende Grundgesamtheit darstellen, so dass wir eine Stichprobe aus der Wahrscheinlichkeitsdichtefunktion auf der Grundlage des Mittelwerts und der Standardabweichung des Datensatzes ziehen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">female</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">students</span><span class="p">[</span><span class="s2">&quot;gender&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Female&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">]</span>
<span class="n">f_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">female</span><span class="p">)</span>
<span class="n">f_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">female</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_mean</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>163.65328467153284
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_std</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7.918762263149209
</pre></div>
</div>
</div>
</div>
<p>Wir ziehen eine Zufallsstichprobe mit einem Stichprobenumfang von <span class="math notranslate nohighlight">\(n=6\)</span> aus der Wahrscheinlichkeitsverteilung, die durch den Mittelwert und die Standardabweichung der Höhenvariablen definiert ist, und berechnen den Stichprobenmittelwert <span class="math notranslate nohighlight">\(\bar{x}\)</span>und die Stichprobenstandardabweichung <span class="math notranslate nohighlight">\(s\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_size</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">sample_size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">f_mean</span><span class="p">,</span> <span class="n">f_std</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sample_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<span class="n">sample_mean</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>161.44236164394297
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10.09685230523463
</pre></div>
</div>
</div>
</div>
<p>Unsere Zufallsstichprobe ergibt einen Stichprobenmittelwert <span class="math notranslate nohighlight">\(\bar{x}\)</span> von etwa <span class="math notranslate nohighlight">\(161,44\)</span> und eine Stichprobenstandardabweichung <span class="math notranslate nohighlight">\(s\)</span> von ungefähr <span class="math notranslate nohighlight">\(10,1\)</span>. Dies sind unsere Punktschätzungen für die interessierende Grundgesamtheit, die in diesem Fall die Körpergröße der Studentinnen in unserem Datensatz ist.</p>
<p>Wie genau ist unsere Punktschätzung? Wir fragen Python, ob unsere Schätzungen mit dem wahren Grundgesamtheitsparameter übereinstimmen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_mean</span> <span class="o">==</span> <span class="n">f_mean</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">==</span> <span class="n">f_std</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">&lt;</span> <span class="n">f_std</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<p>OK, das haben wir erwartet!</p>
<p>Berechnen wir nun die Intervallschätzungen, indem wir die <span class="math notranslate nohighlight">\(90\%-\)</span>, <span class="math notranslate nohighlight">\(95\%-\)</span> und <span class="math notranslate nohighlight">\(99\%-\)</span>Konfidenzintervalle konstruieren. Erinnern Sie sich an die Gleichung für ein Konfidenzintervall und wie man den Freiheitsgrad berechnet.</p>
<div class="math notranslate nohighlight">
\[CI: \text{Punktschätzung} \pm t^*_{df,\,\alpha/2} \times \frac{s}{\sqrt{n}}\]</div>
<div class="math notranslate nohighlight">
\[df = n-1\]</div>
<p>Der kritische Wert <span class="math notranslate nohighlight">\(t^*_{5,\,\alpha/2}\)</span> beträgt <span class="math notranslate nohighlight">\(2,02\)</span>, <span class="math notranslate nohighlight">\(2,57\)</span> und <span class="math notranslate nohighlight">\(4,03\)</span> für Konfidenzniveaus von <span class="math notranslate nohighlight">\(90\%\)</span>, <span class="math notranslate nohighlight">\(95\%\)</span> bzw. <span class="math notranslate nohighlight">\(99\%\)</span>.</p>
<p>Angewandt auf unsere Höhendaten ergibt die Gleichung</p>
<div class="math notranslate nohighlight">
\[CI_{90\%}: 161,44 \pm 2,02 \times \frac{10,1}{\sqrt{6}} = 161,44 \pm 8,32\]</div>
<p>Wir können also mit <span class="math notranslate nohighlight">\(90 \%\)</span>iger Sicherheit sagen, dass die durchschnittliche Körpergröße der Studentinnen (der Populationsparameter <span class="math notranslate nohighlight">\(\mu\)</span>) zwischen <span class="math notranslate nohighlight">\(153,12\)</span> und <span class="math notranslate nohighlight">\(169,76\)</span> cm liegt.</p>
<div class="math notranslate nohighlight">
\[CI_{95\%}: 161,44 \pm 2,57 \times \frac{10,1}{\sqrt{6}} = 161,44 \pm 10,6\]</div>
<p>Wir können also mit <span class="math notranslate nohighlight">\(95\%\)</span>iger Sicherheit sagen, dass die durchschnittliche Körpergröße der Schülerinnen zwischen <span class="math notranslate nohighlight">\(150,84\)</span> und <span class="math notranslate nohighlight">\(172,04\)</span> cm liegt.</p>
<div class="math notranslate nohighlight">
\[CI_{99\%}: 161,44 \pm 4,03 \times \frac{10,1}{\sqrt{6}} = 161,44 \pm 16,6\]</div>
<p>Wir können also mit <span class="math notranslate nohighlight">\(99\%\)</span>iger Sicherheit sagen, dass die durchschnittliche Körpergröße der Studentinnen zwischen <span class="math notranslate nohighlight">\(144,84\)</span> und <span class="math notranslate nohighlight">\(178,04\)</span> cm liegt.</p>
<p>Es liegt auf der Hand, <strong>dass die Fehlerspanne größer ist, wenn wir eine höhere Sicherheit haben wollen, dass der unbekannte Grundgesamtheitsparameter im Intervall enthalten ist</strong>.</p>
<p>Zur Überprüfung der Korrektheit untersuchen wir, ob wir mit unserer Intervallschätzung tatsächlich den wahren Grundgesamtheitswert erfasst haben. Es ist wichtig, sich daran zu erinnern, dass das Konfidenzintervall unserem Stichprobenmittelwert keine Wahrscheinlichkeit zuweist, sondern besagt, dass das Konfidenzintervall bei wiederholten Zufallsstichproben den Mittelwert der Grundgesamtheit in <span class="math notranslate nohighlight">\(100(1-\alpha)\%\)</span> der Fälle einschließen sollte. Um diese Behauptung zu testen, ändern wir die von uns im vorherigen Abschnitt geschriebene Python-Funktion leicht ab.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">CI_eval_t</span><span class="p">(</span><span class="n">pop_mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">estimate</span><span class="p">,</span> <span class="n">alpha</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Funktion zur Evaluierung des Konfidenzintervalls&quot;&quot;&quot;</span>
    <span class="n">out</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">:</span> <span class="p">{}</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">alpha</span><span class="p">}</span>

    <span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">_alpha</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">alpha</span><span class="p">):</span>
        <span class="n">key</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">_alpha</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span><span class="si">}</span><span class="s2">%&quot;</span>
        <span class="n">out</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;true value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pop_mean</span>
        <span class="n">out</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;estimate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">estimate</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="n">estimate</span> <span class="o">+</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">_alpha</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">sigma</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">out</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;upper&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">upper</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="n">estimate</span> <span class="o">-</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">_alpha</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">sigma</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">out</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;lower&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lower</span>
        <span class="n">out</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;test&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pop_mean</span> <span class="o">&gt;=</span> <span class="n">lower</span> <span class="ow">and</span> <span class="n">pop_mean</span> <span class="o">&lt;=</span> <span class="n">upper</span>

    <span class="k">return</span> <span class="n">out</span>
</pre></div>
</div>
</div>
</div>
<p>Wenden wir nun unsere selbst erstellte Funktion <code class="docutils literal notranslate"><span class="pre">CI.eval.t()</span></code> auf unsere Daten an. Wir setzen <code class="docutils literal notranslate"><span class="pre">pop.mean</span> <span class="pre">=</span> <span class="pre">f_mean</span></code>, <code class="docutils literal notranslate"><span class="pre">sigma</span> <span class="pre">=</span> <span class="pre">s</span></code>, <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">=</span> <span class="pre">sample.size</span></code>, <code class="docutils literal notranslate"><span class="pre">estimate</span> <span class="pre">=</span> <span class="pre">x.bar</span></code>, <code class="docutils literal notranslate"><span class="pre">alpha</span> <span class="pre">=</span> <span class="pre">[0.1,0.05,0.01]</span></code>, um zu evaluieren, ob die drei oben konstruierten Konfidenzintervalle (<span class="math notranslate nohighlight">\(90\%\)</span>, <span class="math notranslate nohighlight">\(95\%\)</span> und <span class="math notranslate nohighlight">\(99\%\)</span>) den Populationsmittelwert enthalten. Schließlich wandeln wir den resultierenden Vektor in ein <code class="docutils literal notranslate"><span class="pre">dataframe</span></code> -Objekt um, um die Lesbarkeit zu verbessern.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
    <span class="n">CI_eval_t</span><span class="p">(</span>
        <span class="n">pop_mean</span><span class="o">=</span><span class="n">f_mean</span><span class="p">,</span>
        <span class="n">sigma</span><span class="o">=</span><span class="n">s</span><span class="p">,</span>
        <span class="n">n</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span>
        <span class="n">estimate</span><span class="o">=</span><span class="n">sample_mean</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>90%</th>
      <th>95%</th>
      <th>99%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>true value</th>
      <td>163.653285</td>
      <td>163.653285</td>
      <td>163.653285</td>
    </tr>
    <tr>
      <th>estimate</th>
      <td>161.442362</td>
      <td>161.442362</td>
      <td>161.442362</td>
    </tr>
    <tr>
      <th>upper</th>
      <td>169.748437</td>
      <td>172.038358</td>
      <td>178.062947</td>
    </tr>
    <tr>
      <th>lower</th>
      <td>153.136287</td>
      <td>150.846365</td>
      <td>144.821777</td>
    </tr>
    <tr>
      <th>test</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_mean</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>163.65328467153284
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_mean</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>161.44236164394297
</pre></div>
</div>
</div>
</div>
<p>Nun, ein interessantes Ergebnis. Der wahre Mittelwert der Population (<code class="docutils literal notranslate"><span class="pre">f_mean</span></code> = <span class="math notranslate nohighlight">\(163,65\)</span>) wird von allen drei Konfidenzintervallen erfasst. Der Mittelwert unserer Zufallsstichprobe (<code class="docutils literal notranslate"><span class="pre">sample_mean</span></code> = <span class="math notranslate nohighlight">\(161,4\)</span>) war ein recht guter Schätzer.</p>
</section>
</section>
<span id="document-Aufgaben/Kapitel05/Aufgaben"></span><section class="tex2jax_ignore mathjax_ignore" id="ubungsaufgaben">
<h2>Übungsaufgaben<a class="headerlink" href="#ubungsaufgaben" title="Permalink to this headline">#</a></h2>
<div class="toctree-wrapper compound">
<span id="document-Aufgaben/Kapitel05/Konfidenzintervall"></span><section class="tex2jax_ignore mathjax_ignore" id="konfidenzintervall">
<h3>Konfidenzintervall<a class="headerlink" href="#konfidenzintervall" title="Permalink to this headline">#</a></h3>
<ol class="simple">
<li><p>Berechnen Sie das <span class="math notranslate nohighlight">\(95 \%\)</span> Konfidenzintervall umd den Mittelwert einer Normalverteilung <span class="math notranslate nohighlight">\(N(-2,3)\)</span></p></li>
<li><p>Stellen Sie die Normalverteilung inklusive des Konfidenzintervalls dar.</p></li>
</ol>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 1 ...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 2 ...</span>
</pre></div>
</div>
</div>
</div>
<section id="losung">
<h4>Lösung<a class="headerlink" href="#losung" title="Permalink to this headline">#</a></h4>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>

<span class="n">loc</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="n">scale</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>

<span class="n">upper</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span>
<span class="n">lower</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Upper </span><span class="si">{</span><span class="nb">int</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="si">}</span><span class="s2">%-CI: </span><span class="si">{</span><span class="n">upper</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Lower </span><span class="si">{</span><span class="nb">int</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="si">}</span><span class="s2">%-CI: </span><span class="si">{</span><span class="n">lower</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Upper 95%-CI: 5.839855938160216
Lower 95%-CI: -9.839855938160218
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">xaxis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">xaxis</span><span class="p">,</span>
    <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">),</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Wahrscheinlichkeitsdichtefunktion&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">upper</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Upper CI&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C2&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Lower CI&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f573e72b430&gt;
</pre></div>
</div>
<img alt="_images/Konfidenzintervall_8_1.png" src="_images/Konfidenzintervall_8_1.png" />
</div>
</div>
</section>
</section>
<span id="document-Aufgaben/Kapitel05/Punkschaetzer"></span><section class="tex2jax_ignore mathjax_ignore" id="punktschatzungen-bei-unbekanntem-sigma">
<h3>Punktschätzungen bei unbekanntem <span class="math notranslate nohighlight">\(\sigma\)</span><a class="headerlink" href="#punktschatzungen-bei-unbekanntem-sigma" title="Permalink to this headline">#</a></h3>
<ol class="simple">
<li><p>Welche Wahrscheinlichkeitsverteilung wird für die Berechnungen von Punktschätzungen bei unbekannter Standardabweichnung der Grundgesamtheit und kleiner Stichprobengrösse (<span class="math notranslate nohighlight">\(n\lt 30\)</span>) verwendet?</p></li>
<li><p>Wir simulieren eine Grundgesamtheit an Daten indem wir <span class="math notranslate nohighlight">\(100\)</span> Zufallszahlen zwischen <span class="math notranslate nohighlight">\(-100\)</span> und <span class="math notranslate nohighlight">\(100\)</span> generieren. Berechnen Sie Mittelwert und Standardabweichung für diese Zufallsdaten.</p></li>
<li><p>Nehmen Sie eine Stichprobe vom Umfang <span class="math notranslate nohighlight">\(n=10\)</span>. Berechnen Sie Mittelwert und Konfidenzintervall (<span class="math notranslate nohighlight">\(\alpha = 0,05\)</span>) für die Stichprobe unter der Verwendung einer geeigneten Wahrscheinlichkeitsverteilung und überprüfen Sie ob der Mittelwert der Grundgesamtheit innerhalb des Konfidenzintervalls liegt.</p></li>
</ol>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 2 ...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 3 ...</span>
</pre></div>
</div>
</div>
</div>
<section id="losungen">
<h4>Lösungen<a class="headerlink" href="#losungen" title="Permalink to this headline">#</a></h4>
<div class="toggle docutils container">
<p>Im Fall unbekannter Standardabweichung der Grundgesamtheit <span class="math notranslate nohighlight">\(\sigma\)</span> kann die Standardabweichung der Stichprobe, <span class="math notranslate nohighlight">\(s\)</span>, als Schätzer verwendet werden.
<span class="math notranslate nohighlight">\(s\)</span> ist gegeben durch <span class="math notranslate nohighlight">\(s =\sqrt{\sum_i \frac{x_i - \bar x}{n-1}}\)</span> und ihre Verteilung wird durch die <span class="math notranslate nohighlight">\(t\)</span>-Verteilung beschrieben.</p>
<p>(<span id="id1">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.360)</p>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Erzeuge Random seed</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Generiere Zufallszahlen</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)]</span>

<span class="c1"># Berechne Mittelwert und Standardabweichung</span>
<span class="n">data_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mittelwert: </span><span class="si">{</span><span class="n">data_mean</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">data_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Standardabweichung: </span><span class="si">{</span><span class="n">data_std</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mittelwert: -0.83
Standardabweichung: 59.96016260818511
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">t</span>

<span class="c1"># Nehme Stichprobe</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="c1"># Berechne Mittelwert und Standardabweichung der Stichprobe</span>
<span class="n">sample_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mittelwert der Stichprobe: </span><span class="si">{</span><span class="n">sample_mean</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">sample_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Standardabweichung der Stichprobe: </span><span class="si">{</span><span class="n">sample_mean</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">lower</span> <span class="o">=</span> <span class="n">data_mean</span> <span class="o">-</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">sample_std</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<span class="n">upper</span> <span class="o">=</span> <span class="n">data_mean</span> <span class="o">+</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">sample_std</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Lower: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2"> &lt;= Sample mean: </span><span class="si">{</span><span class="n">sample_mean</span><span class="si">}</span><span class="s2"> &lt;= Upper: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">upper</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>

<span class="k">assert</span> <span class="n">lower</span> <span class="o">&lt;=</span> <span class="n">data_mean</span> <span class="ow">and</span> <span class="n">data_mean</span> <span class="o">&lt;=</span> <span class="n">upper</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mittelwert der Stichprobe: -19.1
Standardabweichung der Stichprobe: -19.1
Lower: -35.699 &lt;= Sample mean: -19.1 &lt;= Upper: 34.039
</pre></div>
</div>
</div>
</div>
</section>
</section>
<span id="document-Aufgaben/Kapitel05/Punkt_Intervall"></span><section class="tex2jax_ignore mathjax_ignore" id="punkt-und-intervallschatzungen">
<h3>Punkt- und Intervallschätzungen<a class="headerlink" href="#punkt-und-intervallschatzungen" title="Permalink to this headline">#</a></h3>
<ol class="simple">
<li><p>Erklären Sie was man unter Punktschätzung beziehungsweise Intervallschätzung versteht.</p></li>
<li><p>Wie viel größer muß die Stichprobe bei einer Intervallschätzung sein um die Länge der Konfidenzintervalle zu halbieren?</p></li>
</ol>
<hr class="docutils" />
<section id="losung">
<h4>Lösung<a class="headerlink" href="#losung" title="Permalink to this headline">#</a></h4>
<div class="toggle docutils container">
<p><strong>Punktschätzung</strong></p>
<p>Mit Schätzverfahren zur Punktschätzung wird versucht aus Stichproben möglichst genaue Näherungswerte für Grundgesamtheitsparameter zu finden. Man unterscheidet unspezifische Parameter, wie z.B. Lage- bzw. Streuungsparameter, Median, Quantille und Korrelation, und spezifische Parameter eines Verteilungsmodells, wie beispielsweise <span class="math notranslate nohighlight">\(\mu\)</span> und <span class="math notranslate nohighlight">\(\sigma\)</span> der Normalverteilung <span class="math notranslate nohighlight">\(N(\mu,\sigma)\)</span> oder den Parameter <span class="math notranslate nohighlight">\(\lambda\)</span> der Poissonverteilung <span class="math notranslate nohighlight">\(P(\lambda)\)</span>.</p>
<p>(<span id="id1">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.338)</p>
<p><strong>Intervallschätzung</strong></p>
<p>Die Intervallschätzung gibt die Präzision des Schätzverfahrens für die entprechende Punktschätzung an. Es wird eine obere und untere Grenze um die Punktschätzung konstruiert in dem mit der Wahrscheinlichkeit <span class="math notranslate nohighlight">\(1-\alpha\)</span> der Wert der Grundgesamtheit enthalten ist. <span class="math notranslate nohighlight">\(\alpha\)</span> entspricht der <em>Irrtumswahrscheinlichkeit</em> und wird als Signifikanzniveau bezeichnet während <span class="math notranslate nohighlight">\(1-\alpha\)</span> die <em>Überdeckungswahrscheinlichkeit</em> ist.</p>
<p>(<span id="id2">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.356)</p>
</div>
<div class="toggle docutils container">
<p>Die Breite des Konfidenzintervalls ist gegeben durch <span class="math notranslate nohighlight">\(CI: \text{Punktschätzung} \pm \text{kritischer Punkt} \times \frac{s}{\sqrt{n}}\)</span>. Der Stichprobenumfang geht also als Faktor <span class="math notranslate nohighlight">\(\frac{1}{\sqrt{n}}\)</span> in die Gleichung ein. Um die Breite zu halbieren (bei ungefähr gleicher Stichprobenstandardabweichung) muß <span class="math notranslate nohighlight">\(n\)</span> also vervierfacht werden. <span class="math notranslate nohighlight">\(\frac{1}{\sqrt{4n}} = \frac{1}{2\sqrt{n}}\)</span></p>
</div>
</section>
</section>
</div>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-Lernziele/Kapitel6_Lernziele"></span><section class="tex2jax_ignore mathjax_ignore" id="lernziele">
<h2>Lernziele<a class="headerlink" href="#lernziele" title="Permalink to this headline">#</a></h2>
<section id="hypothesentests">
<h3>Hypothesentests<a class="headerlink" href="#hypothesentests" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Die Grundlagen des Hypothesentests sowie das Aufstellen von Null- und Alternativhypothese, Wahl des Signifikanzniveaus und Umgang mit Fehlern 1ter und 2ter Art, kritischer Wert und <span class="math notranslate nohighlight">\(p\)</span>-Wert Ansatz wird den Studierenden vermittelt und anhand von Beispielen verdeutlicht</p></li>
<li><p>Verschiedene Testverfahren wie : Einstichproben <span class="math notranslate nohighlight">\(t\)</span>-Test , Zweistichproben <span class="math notranslate nohighlight">\(t\)</span>-Test , Chi-Quadrat-Test auf Anpassungsgüte , Chi-Quadrat-Unabhängigkeitstest , <span class="math notranslate nohighlight">\(t\)</span>-Test für die Korrelation werden vorgestellt und exemplarisch in Python behandelt</p></li>
<li><p>Die Studierenden sollen lernen schrittweise eigenständig Hypothesentests nachzuvollziehen und durchzuführen</p></li>
<li><p>Zusammengefasst werden folgende Begriffe und Methoden besprochen : Hypothesentests , Formulierung der Nullhypothese und der Alternativhypothese , links-,rechts-,beidseitige Tests , Fehler 1ter und 2ter Art , Signifikanzniveau , kritische Wert und der 𝑝-Wert-Ansatz , Einstichproben <span class="math notranslate nohighlight">\(t\)</span>-Test , Zweistichproben <span class="math notranslate nohighlight">\(t\)</span>-Test , Chi-Quadrat-Test auf Anpassungsgüte , Chi-Quadrat-Unabhängigkeitstest , <span class="math notranslate nohighlight">\(t\)</span>-Test für die Korrelation</p></li>
</ul>
</section>
</section>
<span id="document-Kapitel06/01_Hypothesentests"></span><section id="hypothesentests">
<h2>Hypothesentests<a class="headerlink" href="#hypothesentests" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<p>Ein sehr häufiges Problem, mit dem Wissenschaftler konfrontiert sind, ist die <strong>Bewertung der Signifikanz</strong> von verstreuten statistischen Daten. Aufgrund der begrenzten Verfügbarkeit von Beobachtungsdaten wenden Wissenschaftler inferenzstatistische Methoden an, um zu entscheiden, ob die beobachteten Daten signifikante Informationen enthalten oder ob die verstreuten Daten nichts weiter als die Manifestation der inhärent probabilistischen Natur des Datenerzeugungsprozesses sind.</p>
<p>Im Allgemeinen formuliert ein Wissenschaftler ein solches Problem wie folgt. Der Wissenschaftler erstellt ein Modell, das lediglich eine Vereinfachung des Datenerzeugungsprozesses darstellt, und betrachtet eine bestimmte Annahme - eine so genannte <a href="https://de.wikipedia.org/wiki/Hypothese">Hypothese</a> - dieses Modells. Anhand von Daten will er diese vorläufige Hypothese bewerten.</p>
<p>Bei der Hypothesenprüfung geht es darum, <strong>auf der Grundlage von Stichproben aus der Grundgesamtheit statistische Rückschlüsse auf diese Grundgesamtheit zu ziehen</strong>. Eine Möglichkeit zur Schätzung eines Grundgesamtheitsparameters ist die Erstellung von Konfidenzintervallen. Eine andere Möglichkeit besteht darin, eine Entscheidung über einen Parameter in Form eines Tests zu treffen. Jeder Hypothesentest erfordert die Erhebung von Daten (Stichproben). Wenn die Hypothese als richtig angenommen wird, kann der Wissenschaftler die erwarteten Ergebnisse eines Experiments berechnen. Weichen die beobachteten Daten erheblich von den erwarteten Ergebnissen ab, so gilt die Annahme als falsch. Auf der Grundlage der beobachteten Daten trifft der Wissenschaftler also eine Entscheidung darüber, ob es aufgrund der Analyse der Daten genügend Beweise dafür gibt, dass das Modell - die Hypothese - verworfen werden sollte, oder ob es keine ausreichenden Beweise für die Verwerfung der angegebenen Hypothese gibt.</p>
</section>
<section id="einfuhrung-in-hypothesentests">
<h2>Einführung in Hypothesentests<a class="headerlink" href="#einfuhrung-in-hypothesentests" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<p>In der <strong>Inferenzstatistik</strong> geht es darum, Entscheidungen oder Urteile über den Wert einer bestimmten Beobachtung oder Messung zu treffen. Eine der am häufigsten verwendeten Methoden, um solche Entscheidungen zu treffen, ist die Durchführung eines <a href="https://de.wikipedia.org/wiki/Statistischer_Test">Hypothesentests</a>. Eine <a href="https://de.wikipedia.org/wiki/Hypothese">Hypothese</a> ist ein Erklärungsvorschlag für ein Phänomen. Im Zusammenhang mit statistischen Hypothesentests ist der Begriff Hypothese eine Aussage über etwas, von dem angenommen wird, dass es wahr ist.</p>
<p>Zu einem Hypothesentest gehören zwei Hypothesen: die <strong>Nullhypothese</strong> und die <strong>Alternativhypothese</strong>. Die Nullhypothese (<span class="math notranslate nohighlight">\(H_0\)</span>) ist eine zu prüfende Aussage. Die Alternativhypothese (<span class="math notranslate nohighlight">\(H_A\)</span>) ist eine Aussage, die als Alternative zur Nullhypothese betrachtet wird.</p>
<p>Mit dem Hypothesentest soll geprüft werden, ob die Nullhypothese zugunsten der Alternativhypothese verworfen werden sollte. Die grundlegende Logik eines Hypothesentests besteht darin, zwei statistische Datensätze zu vergleichen. Ein Datensatz wird durch eine Stichprobe gewonnen, der andere Datensatz stammt aus einem idealisierten Modell. Wenn die Stichprobendaten mit dem idealisierten Modell übereinstimmen, wird die Nullhypothese nicht verworfen; wenn die Stichprobendaten nicht mit dem idealisierten Modell übereinstimmen und somit eine Alternativhypothese unterstützen, wird die Nullhypothese zugunsten der Alternativhypothese verworfen.</p>
<p>Das Kriterium für die Entscheidung über die Ablehnung der Nullhypothese ist eine so genannte <a href="https://de.wikipedia.org/wiki/Teststatistik">Teststatistik</a>. Die Teststatistik ist eine Zahl, die aus dem Datensatz berechnet wird, der durch Messungen und Beobachtungen oder, allgemeiner, durch Stichproben gewonnen wird.</p>
</section>
<section id="formulierung-der-hypothese">
<h2>Formulierung der Hypothese<a class="headerlink" href="#formulierung-der-hypothese" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<p>Jeder Hypothesentest beginnt mit der Formulierung der Nullhypothese und der Alternativhypothese. Dieser Abschnitt konzentriert sich auf Hypothesentests für einen Grundgesamtheitsmittelwert, <span class="math notranslate nohighlight">\(\mu\)</span> jedoch gilt das allgemeine Verfahren für jeden Hypothesentest.</p>
<p>Die Nullhypothese für einen Hypothesentest für einen Mittelwert der Grundgesamtheit, <span class="math notranslate nohighlight">\(\mu\)</span>
wird ausgedrückt als</p>
<div class="math notranslate nohighlight">
\[ H_0: \mu = \mu_0, \]</div>
<p>wobei <span class="math notranslate nohighlight">\(\mu_0\)</span> eine Zahl ist.</p>
<p>Die Formulierung der Alternativhypothese hängt vom Zweck des Hypothesentests ab. Es gibt drei Möglichkeiten, eine Alternativhypothese zu formulieren (<span id="id1">Fahrmeir <em>et al.</em> [<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">2016</a>]</span> s.369, <span id="id2">Bruce and Bruce [<a class="reference internal" href="intro.html#id13" title="Peter Bruce and Peter Bruce, Andrew und Gedeck. Praktische Statistik für Data Scientists. dpunkt.verlag, 2021.">2021</a>]</span> s.97).</p>
<p>Wenn es bei dem Hypothesentest darum geht, zu entscheiden, ob ein Grundgesamtheitsmittelwert von dem angegebenen Wert <span class="math notranslate nohighlight">\(\mu_0\)</span> abweicht, wird die Alternativhypothese wie folgt formuliert</p>
<div class="math notranslate nohighlight">
\[H_A: \mu  \ne \mu_0\text{.}\]</div>
<p>Ein solcher Hypothesentest wird als <strong>zweiseitiger Test</strong> bezeichnet.</p>
<p>Wenn es bei dem Hypothesentest darum geht, zu entscheiden, ob der Mittelwert der Grundgesamtheit, <span class="math notranslate nohighlight">\(\mu\)</span>
kleiner ist als der angegebene Wert <span class="math notranslate nohighlight">\(\mu_0\)</span>, wird die Alternativhypothese wie folgt ausgedrückt</p>
<div class="math notranslate nohighlight">
\[H_A: \mu &lt; \mu_0\text{.}\]</div>
<p>Ein solcher Hypothesentest wird als <strong>linksseitiger Test</strong> bezeichnet.</p>
<p>Geht es bei dem Hypothesentest darum, zu entscheiden, ob der Mittelwert der Grundgesamtheit, <span class="math notranslate nohighlight">\(\mu\)</span>
größer als ein bestimmter Wert <span class="math notranslate nohighlight">\(\mu_0\)</span> ist, wird die Alternativhypothese wie folgt ausgedrückt</p>
<div class="math notranslate nohighlight">
\[H_A: \mu &gt; \mu_0\text{.}\]</div>
<p>Ein solcher Hypothesentest wird als <strong>rechtsseitiger Test</strong> bezeichnet.</p>
<p>Man beachte, dass ein Hypothesentest als <strong>einseitiger</strong> Test bezeichnet wird, wenn er entweder “linksseitig” oder “rechtsseitig” ist.</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="text-align:center head"><p>zweiseitiger Test</p></th>
<th class="text-align:center head"><p>linksseitiger Test</p></th>
<th class="text-align:center head"><p>rechtsseitiger Test</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Beziehung zwischen <span class="math notranslate nohighlight">\(\mu\)</span>, <span class="math notranslate nohighlight">\(\mu_0\)</span> Ablehnung</p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(\ne\)</span></p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(\lt\)</span></p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(\gt\)</span></p></td>
</tr>
</tbody>
</table>
</section>
<section id="fehler-vom-typ-i-fehler-vom-typ-ii-und-signifikanzniveau">
<h2>Fehler vom Typ I, Fehler vom Typ II und Signifikanzniveau<a class="headerlink" href="#fehler-vom-typ-i-fehler-vom-typ-ii-und-signifikanzniveau" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<p>Jede Entscheidung, die auf der Grundlage eines Hypothesentests getroffen wird, kann falsch sein. Im Rahmen von Hypothesentests gibt es zwei Arten von Fehlern: <a href="https://de.wikipedia.org/wiki/Fehler_1._und_2._Art">Fehler vom Typ I und Fehler vom Typ II</a>. Ein Fehler vom Typ I tritt auf, wenn eine wahre Nullhypothese abgelehnt wird (ein “falsches Positiv”), während ein Fehler vom Typ II auftritt, wenn eine falsche Nullhypothese nicht abgelehnt wird (ein “falsches Negativ”). Mit anderen Worten, ein Fehler vom Typ I besteht darin, dass ein Effekt festgestellt wird, der nicht vorhanden ist, während ein Fehler vom Typ II darin besteht, dass ein Effekt nicht festgestellt wird, der vorhanden ist.</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(H_0\)</span> trifft zu</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(H_0\)</span> trifft nicht zu</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(H_0\)</span> nicht ablehnen</p></td>
<td><p>korrekte Entscheidung</p></td>
<td><p>Typ II Fehler</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(H_0\)</span>  ablehnen</p></td>
<td><p>Typ I Fehler</p></td>
<td><p>korrekte Entscheidung</p></td>
</tr>
</tbody>
</table>
<p>Wenn Sie sich nicht sicher sind, ob es sich um einen Fehler des Typs I oder des Typs II handelt, hilft Ihnen vielleicht eine Illustration (<a href="https://effectsizefaq.com/2010/05/31/i-always-get-confused-about-type-i-and-ii-errors-can-you-show-me-something-to-help-me-remember-the-difference/">hier</a>).</p>
<p>Die Durchführung eines Hypothesentests bedeutet immer, dass die Möglichkeit besteht, eine falsche Entscheidung zu treffen. Die Wahrscheinlichkeit eines Fehlers vom Typ I (eine wahre Nullhypothese wird abgelehnt) wird allgemein als <a href="https://de.wikipedia.org/wiki/Statistische_Signifikanz">Signifikanzniveau</a> des Hypothesentests bezeichnet und mit <span class="math notranslate nohighlight">\(\alpha\)</span> angegeben. Die Wahrscheinlichkeit eines Fehlers vom Typ II (eine falsche Nullhypothese wird nicht abgelehnt) wird mit <span class="math notranslate nohighlight">\(\beta\)</span> angegeben. Beachten Sie, dass bei einem festen Stichprobenumfang die Wahrscheinlichkeit <span class="math notranslate nohighlight">\(\beta\)</span> umso größer ist, je kleiner das Signifikanzniveau <span class="math notranslate nohighlight">\(\alpha\)</span> ist, eine falsche Nullhypothese nicht zurückzuweisen (<span id="id3">Fahrmeir <em>et al.</em> [<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">2016</a>]</span> s.385).</p>
<p>Das Ergebnis eines Hypothesentests ist eine Aussage zu Gunsten der Nullhypothese oder zu Gunsten der Alternativhypothese. Wenn die Nullhypothese abgelehnt wird, liefern die Daten genügend Beweise, um die Alternativhypothese zu stützen. Wenn die Nullhypothese nicht verworfen wird, liefern die Daten keine ausreichenden Beweise für die Alternativhypothese. Wenn der Hypothesentest auf dem Signifikanzniveau <span class="math notranslate nohighlight">\(\alpha\)</span> durchgeführt wird, kann man sagen, dass die Testergebnisse auf dem <strong><span class="math notranslate nohighlight">\(\alpha\)</span>-Niveau statistisch signifikant sind</strong>. Wenn die Nullhypothese auf dem Signifikanzniveau <span class="math notranslate nohighlight">\(\alpha\)</span> nicht abgelehnt wird, kann man sagen, dass die Testergebnisse auf dem <strong><span class="math notranslate nohighlight">\(\alpha\)</span>-Niveau statistisch nicht signifikant sind</strong>.</p>
</section>
<section id="der-kritische-wert-und-der-p-wert-ansatz-bei-der-hypothesenprufung">
<h2>Der kritische Wert und der <span class="math notranslate nohighlight">\(p\)</span>-Wert-Ansatz bei der Hypothesenprüfung<a class="headerlink" href="#der-kritische-wert-und-der-p-wert-ansatz-bei-der-hypothesenprufung" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<p>Um zu entscheiden, ob die Nullhypothese abzulehnen ist, wird eine <strong>Teststatistik</strong> berechnet. Die Entscheidung wird auf der Grundlage des numerischen Wertes der Teststatistik getroffen. Es gibt zwei Ansätze, um zu dieser Entscheidung zu gelangen: Der Ansatz des <strong>kritischen Wertes</strong> und der Ansatz des <strong><span class="math notranslate nohighlight">\(p\)</span>-Wertes</strong>.</p>
<section id="der-ansatz-des-kritischen-wertes">
<h3>Der Ansatz des kritischen Wertes<a class="headerlink" href="#der-ansatz-des-kritischen-wertes" title="Permalink to this headline">#</a></h3>
<p>Mit dem Ansatz des <strong>kritischen Wertes</strong> wird festgestellt, ob die beobachtete Teststatistik zu stark von einem definiertem kritischen Wert abweicht oder nicht. Dazu wird die beobachtete Teststatistik (berechnet auf der Grundlage der Stichprobendaten) mit dem kritischen Wert, einer Art Grenzwert, verglichen. Wenn die Teststatistik extremer ist als der kritische Wert, wird die Nullhypothese abgelehnt. Wenn die Teststatistik nicht so extrem ist wie der kritische Wert, wird die Nullhypothese nicht verworfen. Der kritische Wert wird auf der Grundlage des vorgegebenen Signifikanzniveaus <span class="math notranslate nohighlight">\(\alpha\)</span> und der Art der Wahrscheinlichkeitsverteilung des idealisierten Modells berechnet. Der kritische Wert teilt die Fläche unter der Wahrscheinlichkeitsverteilungskurve in die <strong>Ablehnungsregion(en)</strong> und in die <strong>Nichtablehnungsregion</strong>.</p>
<p>Die folgenden drei Abbildungen zeigen einen rechtsseitigen Test, einen linksseitigen Test und einen zweiseitigen Test. Das idealisierte Modell in den Abbildungen, und damit <span class="math notranslate nohighlight">\(H_0\)</span> wird durch eine glockenförmige normale Wahrscheinlichkeitskurve beschrieben.</p>
<p>Bei einem <strong>zweiseitigen</strong> Test wird die Nullhypothese abgelehnt, wenn die Teststatistik entweder zu klein oder zu groß ist. Der Ablehnungsbereich für einen solchen Test besteht also aus zwei Teilen: einem links und einem rechts.</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="k">def</span> <span class="nf">range_brace</span><span class="p">(</span>
    <span class="n">x_min</span><span class="p">,</span>
    <span class="n">x_max</span><span class="p">,</span>
    <span class="n">mid</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
    <span class="n">beta1</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span>
    <span class="n">beta2</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">initial_divisions</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
    <span class="n">resolution_factor</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
<span class="p">):</span>
    <span class="c1"># determine x0 adaptively values using second derivitive</span>
    <span class="c1"># could be replaced with less snazzy:</span>
    <span class="c1">#   x0 = np.arange(0, 0.5, .001)</span>
    <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(())</span>
    <span class="n">tmpx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">initial_divisions</span><span class="p">)</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">beta1</span><span class="o">**</span><span class="mi">2</span>
        <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">beta1</span> <span class="o">*</span> <span class="n">tmpx</span><span class="p">))</span>
        <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">beta1</span> <span class="o">*</span> <span class="n">tmpx</span><span class="p">))</span>
        <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">beta1</span> <span class="o">*</span> <span class="n">tmpx</span><span class="p">)),</span> <span class="mi">3</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">tmp</span> <span class="o">+=</span> <span class="p">(</span>
        <span class="n">beta2</span><span class="o">**</span><span class="mi">2</span>
        <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">beta2</span> <span class="o">*</span> <span class="p">(</span><span class="n">tmpx</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)))</span>
        <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">beta2</span> <span class="o">*</span> <span class="p">(</span><span class="n">tmpx</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)))</span>
        <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">beta2</span> <span class="o">*</span> <span class="p">(</span><span class="n">tmpx</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">))),</span> <span class="mi">3</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmpx</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span>
                <span class="n">resolution_factor</span>
                <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]))</span>
                <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">initial_divisions</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tmpx</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">tmpx</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">t</span><span class="p">))</span>
    <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">x0</span><span class="p">))</span>  <span class="c1"># sort and remove dups</span>
    <span class="c1"># half brace using sum of two logistic functions</span>
    <span class="n">y0</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">beta1</span> <span class="o">*</span> <span class="n">x0</span><span class="p">)))</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">y0</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">mid</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">beta2</span> <span class="o">*</span> <span class="p">(</span><span class="n">x0</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">))))</span>
    <span class="c1"># concat and scale x</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="o">*</span> <span class="nb">float</span><span class="p">((</span><span class="n">x_max</span> <span class="o">-</span> <span class="n">x_min</span><span class="p">))</span> <span class="o">+</span> <span class="n">x_min</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">y0</span><span class="p">,</span> <span class="n">y0</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="n">height</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">x_min</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span>
<span class="n">x_max</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>


<span class="n">ticks</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]</span>
<span class="k">for</span> <span class="n">_x</span> <span class="ow">in</span> <span class="n">ticks</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">ticks</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">range_brace</span><span class="p">(</span>
    <span class="n">ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">ticks</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">height</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">y</span><span class="p">,</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">range_brace</span><span class="p">(</span>
    <span class="n">x_min</span><span class="p">,</span>
    <span class="n">ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">height</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">y</span><span class="p">,</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">range_brace</span><span class="p">(</span>
    <span class="n">ticks</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">x_max</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">y</span><span class="p">,</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;Ablehnen der $H_0$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="mf">3.9</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;Ablehnen der $H_0$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;Nicht ablehnen der $H_0$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;Region der Ablehnung&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="mf">3.9</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="mf">0.08</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;Region der Ablehnung&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="mf">0.08</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;Region der Nicht-Ablehnung&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="mf">0.08</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$1-\alpha$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;$\alpha/2$&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">2.4</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;$\alpha/2$&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">2.6</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;Kritischer Wert&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">ticks</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.3</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">2.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
    <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;Kritischer Wert&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">0.3</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">3.4</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
    <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-0.05, 0.5)
</pre></div>
</div>
<img alt="_images/01_Hypothesentests_26_1.png" src="_images/01_Hypothesentests_26_1.png" />
</div>
</div>
<p>Bei einem <strong>linksseitigen Test</strong> wird die Nullhypothese abgelehnt, wenn die Teststatistik zu klein ist. Der Ablehnungsbereich für einen solchen Test besteht also aus einem Teil, der links von der Mitte liegt.</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">x_min</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span>
<span class="n">x_max</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>


<span class="n">ticks</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.5</span><span class="p">]</span>
<span class="k">for</span> <span class="n">_x</span> <span class="ow">in</span> <span class="n">ticks</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">range_brace</span><span class="p">(</span>
    <span class="n">ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">x_max</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">y</span><span class="p">,</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">range_brace</span><span class="p">(</span>
    <span class="n">x_min</span><span class="p">,</span>
    <span class="n">ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">height</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">y</span><span class="p">,</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">y</span><span class="p">,</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;Ablehnen der $H_0$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="mf">3.9</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;Nicht ablehnen der $H_0$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;Region der Ablehnung&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="mf">3.9</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="mf">0.08</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;Region der Nicht-Ablehnung&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="mf">0.08</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$1-\alpha$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;$\alpha$&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">2.6</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
<span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;Kritischer Wert&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">0.3</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">3.4</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
    <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-0.05, 0.5)
</pre></div>
</div>
<img alt="_images/01_Hypothesentests_28_1.png" src="_images/01_Hypothesentests_28_1.png" />
</div>
</div>
<p>Bei einem <strong>rechtsseitigen Test</strong> wird die Nullhypothese abgelehnt, wenn die Teststatistik zu groß ist. Der Ablehnungsbereich für einen solchen Test besteht also aus einem Teil, der sich rechts von der Mitte befindet.</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">x_min</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span>
<span class="n">x_max</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>


<span class="n">ticks</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">]</span>
<span class="k">for</span> <span class="n">_x</span> <span class="ow">in</span> <span class="n">ticks</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">range_brace</span><span class="p">(</span>
    <span class="n">x_min</span><span class="p">,</span>
    <span class="n">ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">height</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">y</span><span class="p">,</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>


<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">range_brace</span><span class="p">(</span>
    <span class="n">ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">x_max</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">y</span><span class="p">,</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;Ablehnen der $H_0$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;Nicht ablehnen der $H_0$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;Region der Ablehnung&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="mf">0.08</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;Region der Nicht-Ablehnung&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="mf">2.2</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="mf">0.08</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$1-\alpha$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;$\alpha$&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">2.4</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;Kritischer Wert&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">0.3</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">2.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
    <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-0.05, 0.5)
</pre></div>
</div>
<img alt="_images/01_Hypothesentests_30_1.png" src="_images/01_Hypothesentests_30_1.png" />
</div>
</div>
</section>
<section id="der-p-wert-ansatz">
<h3>Der <span class="math notranslate nohighlight">\(p\)</span>-Wert-Ansatz<a class="headerlink" href="#der-p-wert-ansatz" title="Permalink to this headline">#</a></h3>
<p>Bei der <span class="math notranslate nohighlight">\(p\)</span>-Wert-Methode wird die Wahrscheinlichkeit (<span class="math notranslate nohighlight">\(p\)</span>-Wert) des numerischen Wertes der Teststatistik mit dem angegebenen Signifikanzniveau (<span class="math notranslate nohighlight">\(\alpha\)</span>) des Hypothesentests verglichen.</p>
<p>Der <span class="math notranslate nohighlight">\(p\)</span>-Wert entspricht der Wahrscheinlichkeit, Stichprobendaten zu beobachten, die mindestens so extrem sind wie die tatsächlich erhaltene Teststatistik. Kleine <span class="math notranslate nohighlight">\(p\)</span>-Werte sind ein Beweis gegen die Nullhypothese. Je kleiner (näher an <span class="math notranslate nohighlight">\(0\)</span>) der <span class="math notranslate nohighlight">\(p\)</span>-Wert ist, desto stärker ist der Beweis gegen die Nullhypothese.</p>
<p>Ist der <span class="math notranslate nohighlight">\(p\)</span>-Wert kleiner als oder gleich dem angegebenen Signifikanzniveau <span class="math notranslate nohighlight">\(\alpha\)</span> ist, wird die Nullhypothese abgelehnt; andernfalls wird die Nullhypothese nicht abgelehnt. Mit anderen Worten: wenn <span class="math notranslate nohighlight">\(p \le \alpha\)</span>, wird <span class="math notranslate nohighlight">\(H_0\)</span> abgelehnt; andernfalls, wenn <span class="math notranslate nohighlight">\(p \gt \alpha\)</span>, wird <span class="math notranslate nohighlight">\(H_0\)</span> nicht abgelehnt.</p>
<p>Folglich kann durch die Kenntnis des <span class="math notranslate nohighlight">\(p\)</span>-Wertes jedes gewünschte Signifikanzniveau bewertet werden. Beträgt der <span class="math notranslate nohighlight">\(p\)</span>-Wert eines Hypothesentests beispielsweise <span class="math notranslate nohighlight">\(0,01\)</span>, kann die Nullhypothese auf jedem Signifikanzniveau größer oder gleich <span class="math notranslate nohighlight">\(0,01\)</span> abgelehnt werden. Bei einem Signifikanzniveau kleiner als <span class="math notranslate nohighlight">\(0,01\)</span> wird sie nicht verworfen. Daher wird der <span class="math notranslate nohighlight">\(p\)</span>-Wert in der Regel verwendet, um die Stärke des Beweises gegen die Nullhypothese ohne Bezug auf das Signifikanzniveau zu bewerten.</p>
<p>Die folgende Tabelle enthält Leitlinien für die Verwendung des <span class="math notranslate nohighlight">\(p\)</span>-Werts zur Bewertung der Beweise gegen die Nullhypothese (<em><span id="id4">Fahrmeir <em>et al.</em> [<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">2016</a>]</span> s.388</em>).</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{l|l}
\hline
 \text{$p$-Wert} &amp; \text{Hinweise gegen  } H_0   \\
\hline
\ p &gt; 0,10 &amp;  \text{Schwache oder keine Hinweise }   \\
\ 0,05 &lt; p \le 0,10 &amp; \text{Mäßiger Hinweis }    \\
\ 0,01 &lt; p \le 0,05 &amp; \text{Starker Hinweis}    \\
\  p \le 0,01 &amp; \text{Sehr starker Hinweis}    \\
\hline 
\end{array}
\end{split}\]</div>
</section>
</section>
<span id="document-Kapitel06/02_Hypothesentests_Mittelwert_einer_Grundgesamtheit"></span><section id="hypothesentests-fur-den-mittelwert-einer-grundgesamtheit">
<h2>Hypothesentests für den Mittelwert einer Grundgesamtheit<a class="headerlink" href="#hypothesentests-fur-den-mittelwert-einer-grundgesamtheit" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<p>Die einfachste Form eines Hypothesentests ist der <strong>Test auf einen Grundgesamtheitsmittelwert</strong>. Bei diesem Test vergleichen wir den aus der Stichprobe (Beobachtungen) gewonnenen Mittelwert <span class="math notranslate nohighlight">\(\mu\)</span> mit einem angenommenen Grundgesamtheitsmittelwert <span class="math notranslate nohighlight">\(\mu_0\)</span>. Die Nullhypothese besagt, dass der Mittelwert und der Mittelwert der Grundgesamtheit gleich sind, und wird daher wie folgt geschrieben</p>
<div class="math notranslate nohighlight">
\[H_0: \mu = \mu_0\text{.}\]</div>
<p>Weichen die beobachteten Daten (<span class="math notranslate nohighlight">\(\mu\)</span>) signifikant vom angenommenen Mittelwert der Grundgesamtheit (<span class="math notranslate nohighlight">\(\mu_0\)</span>) ab, dann wird die Annahme <span class="math notranslate nohighlight">\(H_0\)</span> zugunsten der Alternativhypothese <span class="math notranslate nohighlight">\(H_A\)</span> verworfen. Je nach der spezifischen Forschungsfrage wird die Alternativhypothese <span class="math notranslate nohighlight">\(H_A\)</span> wie folgt formuliert</p>
<div class="math notranslate nohighlight">
\[H_A: \mu &lt; \mu_0 \quad \text{oder} \quad  \mu &gt; \mu_0 \quad \text{oder} \quad \mu \ne \mu_0 \text{.}\]</div>
<p>Wenn die Daten jedoch nicht genügend Beweise liefern, um die angegebene Hypothese (<span class="math notranslate nohighlight">\(H_0\)</span>) zu verwerfen, verwerfen wir <span class="math notranslate nohighlight">\(H_0\)</span> nicht und schließen, dass die Daten nicht genügend Beweise liefern, um anzunehmen, dass sich der beobachtete Mittelwert <span class="math notranslate nohighlight">\(\mu\)</span> vom angenommenen Grundgesamtheitsmittelwert (<span class="math notranslate nohighlight">\(\mu_0\)</span>) unterscheidet. Die beobachtete Variabilität in den Daten wird auf die inhärent probabilistische Natur des Datenerzeugungsprozesses zurückgeführt, oder mit anderen Worten, die beobachtete Variabilität in den Daten ist auf den Zufall zurückzuführen.</p>
<p>In den nächsten Abschnitten wird gezeigt, dass für die eigentliche Berechnung der statistischen Signifikanz unser Wissen über die Grundgesamtheitsparameter von Bedeutung ist.</p>
</section>
<section id="hypothesentests-fur-einen-grundgesamtheitsmittelwert-bei-bekannter-standardabweichung">
<h2>Hypothesentests für einen Grundgesamtheitsmittelwert bei bekannter Standardabweichung<a class="headerlink" href="#hypothesentests-fur-einen-grundgesamtheitsmittelwert-bei-bekannter-standardabweichung" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
</pre></div>
</div>
</div>
</div>
<p>Wenn die Standardabweichung (<span class="math notranslate nohighlight">\(\sigma\)</span>) der Grundgesamtheit bekannt ist, wird ein Hypothesentest, der für einen Mittelwert der Grundgesamtheit durchgeführt wird, als <strong><span class="math notranslate nohighlight">\(z\)</span>-Test für einen Mittelwert</strong> oder einfach als <strong><span class="math notranslate nohighlight">\(z\)</span>-Test</strong> bezeichnet.</p>
<p>Ein <span class="math notranslate nohighlight">\(z\)</span>-Test ist ein Hypothesentest zum Testen eines Mittelwerts der Grundgesamtheit, <span class="math notranslate nohighlight">\(\mu\)</span>, gegen einen angenommenen Mittelwert der Grundgesamtheit,<span class="math notranslate nohighlight">\(\mu_0\)</span>. Der <span class="math notranslate nohighlight">\(z\)</span>-Test setzt normalverteilte Variablen oder einen großen Stichprobenumfang voraus; dann garantiert der <a href="https://de.wikipedia.org/wiki/Zentraler_Grenzwertsatz">zentrale Grenzwertsatz</a> eine normalverteilte <a href="https://de.wikipedia.org/wiki/Sch%C3%A4tzfunktion#Stichprobenverteilung">Stichprobenverteilung</a>. Darüber hinaus muss <span class="math notranslate nohighlight">\(\sigma\)</span>, die Standardabweichung der Grundgesamtheit, bekannt sein. In der Praxis ist diese Annahme fast nie erfüllt, so dass der <span class="math notranslate nohighlight">\(z\)</span>-Test nur selten angewendet wird. Er ist jedoch der einfachste Hypothesentest und daher ein guter Einstieg in das Thema.</p>
<p>Zur Durchführung des <span class="math notranslate nohighlight">\(z\)</span>-Tests gehen wir schrittweise vor, wie in der folgenden Tabelle dargestellt. Zunächst wird der <strong>Ansatz des kritischen Werts</strong> dargestellt, dann wird in einem zweiten Schritt die Analyse für den <strong>Ansatz des <span class="math notranslate nohighlight">\(p\)</span>-Werts</strong> wiederholt.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{l}
\hline
\ \text{Schritt 1}  &amp; \text{Geben Sie die Nullhypothese } H_0 \text{ und alternative Hypothese } H_A \text{ an.}\\
\ \text{Schritt 2}  &amp; \text{Legen Sie das Signifikanzniveau, } \alpha\text{ fest.} \\
\ \text{Schritt 3}  &amp; \text{Berechnen Sie den Wert der Teststatistik.} \\
\ \text{Schritt 4a} &amp; \text{Ansatz des kritischen Wertes: Bestimmung des kritischen Wertes.}
\\
\ \text{Schritt 4b} &amp;\text{P-Wert-Ansatz: Bestimmen Sie den p-Wert.} \\
\ \text{Schritt 5a} &amp; \text{Ansatz des kritischen Werts: Wenn der Wert der Teststatistik in den Ablehnungsbereich fällt, ist } H_0 \text{ abzulehnen}   \text{; ansonsten } H_0 \text{ nicht ablehnen}  \text{.}
\\
\ \text{Schritt 5b} &amp; \text{P-Wert-Ansatz: Wenn }p \le \alpha \text{, } H_0 \text{ ablehnen } \text{; ansonsten } H_0 \text{ nicht ablehnen} \text{.} \\
\ \text{Schritt 6} &amp;\text{Interpretieren Sie das Ergebnis des Hypothesentests.} \\
\hline 
\end{array}
\end{split}\]</div>
<section id="z-test-mit-einem-mittelwert-ein-beispiel">
<h3><span class="math notranslate nohighlight">\(z\)</span>-Test mit einem Mittelwert: Ein Beispiel<a class="headerlink" href="#z-test-mit-einem-mittelwert-ein-beispiel" title="Permalink to this headline">#</a></h3>
<p>In diesem Abschnitt arbeiten wir mit dem <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz. Sie können die Datei <code class="docutils literal notranslate"><span class="pre">students.csv</span></code> <a href="https://userpage.fu-berlin.de/soga/200/2010_data_sets/students.csv">hier</a> herunterladen. Importieren Sie den Datensatz und geben Sie ihm einen geeigneten Namen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lese Datei students.csv als Dataframe ein; Indexspalte wird übersprungen</span>
<span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../data/students.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Der <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz besteht aus <span class="math notranslate nohighlight">\(8239\)</span> Zeilen, von denen jede einen bestimmten Studenten repräsentiert, und <span class="math notranslate nohighlight">\(16\)</span> Spalten, von denen jede einer Variable/einem Merkmal entspricht, das sich auf diesen bestimmten Studenten bezieht. Diese selbsterklärenden Variablen sind: <em>stud_id, Name, Geschlecht, Alter, Größe, Gewicht, Religion, nc_score, Semester, Hauptfach, Nebenfach, score1, score2, online_tutorial, graduated, salary</em>.</p>
<p>Zur Veranschaulichung der Hypothesentests untersuchen wir das Durchschnittsgewicht der Studenten und vergleichen es mit dem Durchschnittsgewicht der erwachsenen Europäer. <a href="https://bmcpublichealth.biomedcentral.com/articles/10.1186/1471-2458-12-439">Walpole et al. (2012)</a> veröffentlichten Daten über das durchschnittliche Körpergewicht (kg) pro Region, einschließlich Europa. Sie geben die durchschnittliche Körpermasse für die europäische erwachsene Bevölkerung mit <span class="math notranslate nohighlight">\(70,8\)</span> kg an. Wir setzen <span class="math notranslate nohighlight">\(\mu_0\)</span>, den Mittelwert der Bevölkerung, entsprechend fest, <span class="math notranslate nohighlight">\(\mu_0=70,8\)</span>. Aufgrund des methodischen Ansatzes von <span id="id1">Walpole [<a class="reference internal" href="intro.html#id4" title="Walpole. The weight of nations: an estimation of adult human biomass. BMC Public Health, 2012.">2012</a>]</span> haben sie leider keine Standardabweichung (<span class="math notranslate nohighlight">\(\sigma\)</span>) der Gewichte europäischer Erwachsener angegeben. Zu Demonstrationszwecken gehen wir davon aus, dass die Gewichtsdaten aus dem Studentendatensatz eine gute Näherung für die interessierende Population darstellen. Daher setzen wir <span class="math notranslate nohighlight">\(\sigma\)</span> auf die Standardabweichung der Gewichtsvariablen im <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu0</span> <span class="o">=</span> <span class="mf">70.8</span>
<span class="n">sigma_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">students</span><span class="o">.</span><span class="n">weight</span><span class="p">)</span>
<span class="n">sigma_z</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8.634637630634796
</pre></div>
</div>
</div>
</div>
<p>Außerdem nehmen wir eine Zufallsstichprobe mit einem Stichprobenumfang von <span class="math notranslate nohighlight">\(n=14\)</span>. Die Stichprobe besteht aus den Gewichten in kg von <span class="math notranslate nohighlight">\(14\)</span> zufällig ausgewählten Studenten aus dem Studentendatensatz. Schließlich berechnen wir den Stichprobenmittelwert (<span class="math notranslate nohighlight">\(\bar{x}\)</span>), die Stichprobenstatistik unseres Interesses. Die Stichprobenstatistik wird der Variablen <code class="docutils literal notranslate"><span class="pre">x_bar</span></code> zugewiesen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">x_weight</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">x_bar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x_weight</span><span class="p">)</span>
<span class="n">x_bar</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>77.02857142857144
</pre></div>
</div>
</div>
</div>
</section>
<section id="hypothesentests-der-ansatz-des-kritischen-werts">
<h3>Hypothesentests: Der Ansatz des kritischen Werts<a class="headerlink" href="#hypothesentests-der-ansatz-des-kritischen-werts" title="Permalink to this headline">#</a></h3>
<p><strong>Schritt 1: Geben Sie die Nullhypothese (<span class="math notranslate nohighlight">\(H_0\)</span>) und die Alternativhypothese (<span class="math notranslate nohighlight">\(H_A\)</span>) an.</strong></p>
<p>Die Nullhypothese besagt, dass das Durchschnittsgewicht der Studenten (<span class="math notranslate nohighlight">\(\mu\)</span>) gleich dem Durchschnittsgewicht europäischer Erwachsener von <span class="math notranslate nohighlight">\(70,8\)</span> kg (<span class="math notranslate nohighlight">\(\mu_0\)</span>) ist, wie von Walpole et al. (2012) berichtet. Mit anderen Worten: Es gibt keinen Unterschied zwischen dem Durchschnittsgewicht der Studenten und dem Durchschnittsgewicht der europäischen Erwachsenen.</p>
<div class="math notranslate nohighlight">
\[H_0: \quad \mu = 70,8\]</div>
<p>Zur Veranschaulichung testen wir drei Alternativhypothesen.</p>
<p><strong>Alternativhypothese 1</strong>: Das Durchschnittsgewicht der Studenten entspricht nicht dem Durchschnittsgewicht der europäischen Erwachsenen. Mit anderen Worten: Es gibt einen Unterschied zwischen dem Durchschnittsgewicht der Studenten und dem Durchschnittsgewicht der europäischen Erwachsenen.</p>
<div class="math notranslate nohighlight">
\[H_{A_1}: \quad \mu \ne 70,8\]</div>
<p><strong>Alternativhypothese 2</strong>: Das Durchschnittsgewicht der Studenten ist geringer als das Durchschnittsgewicht der europäischen Erwachsenen.</p>
<div class="math notranslate nohighlight">
\[H_{A_2}: \quad \mu  &lt; 70,8\]</div>
<p><strong>Alternativhypothese 3</strong>: Das Durchschnittsgewicht der Studenten ist höher als das Durchschnittsgewicht der europäischen Erwachsenen.</p>
<div class="math notranslate nohighlight">
\[H_{A_3}: \quad \mu &gt; 70,8\]</div>
<p><strong>Schritt 2: Legen Sie das Signifikanzniveau <span class="math notranslate nohighlight">\(\alpha\)</span> fest.</strong></p>
<div class="math notranslate nohighlight">
\[\alpha = 0,05\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Schritt 3: Berechnen Sie den Wert der Teststatistik.</strong></p>
<p>Die folgende Gleichung wird zur Berechnung der Teststatistik <span class="math notranslate nohighlight">\(z\)</span> verwendet.</p>
<div class="math notranslate nohighlight">
\[z = \frac{\bar x-\mu_0}{\sigma/\sqrt{n}}\]</div>
<ul class="simple">
<li><p>Berechnen Sie den Wert der Teststatistik</p></li>
</ul>
<div class="math notranslate nohighlight">
\[z = \frac{\bar x-\mu_0}{\sigma/\sqrt{n}} =  \frac{77,02-70,8}{8,64/ \sqrt{14}} \approx 2,699\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_bar</span> <span class="o">-</span> <span class="n">mu0</span><span class="p">)</span> <span class="o">/</span> <span class="n">sigma_z</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">z</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.699033971278552
</pre></div>
</div>
</div>
</div>
<p><strong>Schritt 4a: Bestimmen Sie den kritischen Wert.</strong></p>
<p>Um den kritischen Wert zu berechnen, wenden wir die Funktion <code class="docutils literal notranslate"><span class="pre">norm.ppf()</span></code> in Python an. Es sei daran erinnert, dass wir auf drei Alternativhypothesen (<span class="math notranslate nohighlight">\(H_{A_1}, H_ {A_2}\)</span> und <span class="math notranslate nohighlight">\(H_{A_3}\)</span>) testen und daher auch drei kritische Werte berechnen müssen (<span class="math notranslate nohighlight">\(z_{A_1} = \pm z_{\alpha/2}, z_{A_2} = -z_\alpha\)</span> und <span class="math notranslate nohighlight">\(z_{A_3} = +z_\alpha\)</span>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z_HA_1</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">z_HA_2</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">))</span>
<span class="n">z_HA_3</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;z HA 1:  </span><span class="si">{</span><span class="n">z_HA_1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;z HA 2:  </span><span class="si">{</span><span class="n">z_HA_2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;z HA 2:  </span><span class="si">{</span><span class="n">z_HA_3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>z HA 1:  1.959963984540054
z HA 2:  -1.6448536269514722
z HA 2:  1.6448536269514722
</pre></div>
</div>
</div>
</div>
<p>Die kritischen Werte sind <span class="math notranslate nohighlight">\(z_{A_1} \approx \pm 1,96\)</span>, <span class="math notranslate nohighlight">\( z_{A_2} \approx-1,64\)</span> und  <span class="math notranslate nohighlight">\( z_{A_3} \approx 1,64\)</span>.</p>
<p><strong>Schritt 5a: Wenn der Wert der Teststatistik in den Verwerfungsbereich fällt, ist <span class="math notranslate nohighlight">\(H_0\)</span> zu verwerfen; andernfalls ist <span class="math notranslate nohighlight">\(H_0\)</span> nicht zu verwerfen.</strong></p>
<p>Der Wert der in Schritt <span class="math notranslate nohighlight">\(3\)</span> ermittelten Teststatistik ist <span class="math notranslate nohighlight">\(z \approx 2,699\)</span>. Es sei daran erinnert, dass wir drei Alternativhypothesen (<span class="math notranslate nohighlight">\(H_{A_1}, H_{A_2}\)</span> und <span class="math notranslate nohighlight">\(H_{A_3}\)</span>) untersuchen. Daher bewerten wir den Ablehnungsbereich für jede einzelne Hypothese.</p>
<ul class="simple">
<li><p><strong>Alternativhypothese</strong> <span class="math notranslate nohighlight">\(H_{A_1}:\quad \mu \ne 70,8\)</span></p></li>
</ul>
<p>Erinnern Sie sich an die kritischen Werte für <span class="math notranslate nohighlight">\(H_{A_1}\)</span>.</p>
<div class="math notranslate nohighlight">
\[z_{A_1} = \pm z_{\alpha/2} = \pm 1,96\]</div>
<p>Fällt die Teststatistik (<span class="math notranslate nohighlight">\(z \approx 2,699\)</span>) in den Ablehnungsbereich? Beachten Sie, dass es sich um einen zweiseitigen Test handelt, d. h. wir werten die obere und die untere Grenze aus.</p>
<ul class="simple">
<li><p>Obere Grenze</p></li>
</ul>
<div class="math notranslate nohighlight">
\[2,699 \gt 1,96\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Obere Grenze</span>
<span class="c1"># Ablehnen?</span>
<span class="nb">print</span><span class="p">(</span><span class="n">z</span> <span class="o">&gt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">z_HA_1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Untere Grenze</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ 2,699 \lt -1,96\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Untere Grenze</span>
<span class="c1"># Ablehnen?</span>
<span class="nb">print</span><span class="p">(</span><span class="n">z</span> <span class="o">&lt;</span> <span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">z_HA_1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">x_min</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span>
<span class="n">x_max</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>


<span class="n">ticks</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">z_HA_1</span><span class="p">,</span> <span class="n">z_HA_1</span><span class="p">]</span>
<span class="k">for</span> <span class="n">_x</span> <span class="ow">in</span> <span class="n">ticks</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># ax.axis(&quot;off&quot;)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">ticks</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;Ablehnen der $H_0$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="mf">3.9</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;Ablehnen der $H_0$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;Nicht ablehnen der $H_0$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$1-\alpha$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;$\alpha/2$&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">2.2</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">2.4</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;$\alpha/2$&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">2.2</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">2.7</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;Kritischer Wert&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">ticks</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.3</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">2.6</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
    <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;Kritischer Wert&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">0.3</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">3.8</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
    <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;$z$&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
<span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-0.05, 0.5)
</pre></div>
</div>
<img alt="_images/02_Hypothesentests_Mittelwert_einer_Grundgesamtheit_53_1.png" src="_images/02_Hypothesentests_Mittelwert_einer_Grundgesamtheit_53_1.png" />
</div>
</div>
<p>Aufgrund der numerischen und grafischen Auswertung fällt der Wert in den Verwerfungsbereich, so dass wir <span class="math notranslate nohighlight">\(H_0\)</span> verwerfen. Die Testergebnisse sind auf dem <span class="math notranslate nohighlight">\(5 \%\)</span>-Niveau statistisch signifikant.</p>
<ul class="simple">
<li><p><strong>Alternativhypothese</strong> <span class="math notranslate nohighlight">\(H_{A_2}:\quad \mu \lt 70,8\)</span></p></li>
</ul>
<p>Erinnern Sie sich an den kritischen Wert für <span class="math notranslate nohighlight">\(H_{A_2}\)</span>.</p>
<div class="math notranslate nohighlight">
\[z_{A_2} = -z_{\alpha} = -1,64\]</div>
<p>Fällt die Teststatistik (<span class="math notranslate nohighlight">\(z \approx 2,699\)</span>) in den Ablehnungsbereich?</p>
<div class="math notranslate nohighlight">
\[2,699 &lt; -1,64\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ablehnen?</span>
<span class="nb">print</span><span class="p">(</span><span class="n">z</span> <span class="o">&lt;</span> <span class="n">z_HA_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">x_min</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span>
<span class="n">x_max</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>


<span class="n">ticks</span> <span class="o">=</span> <span class="p">[</span><span class="n">z_HA_2</span><span class="p">]</span>
<span class="k">for</span> <span class="n">_x</span> <span class="ow">in</span> <span class="n">ticks</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;Ablehnen der $H_0$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="mf">3.9</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;Nicht ablehnen der $H_0$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$1-\alpha$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;$\alpha$&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">2.6</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
<span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;Kritischer Wert&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">0.3</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">3.4</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
    <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;$z$&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-0.05, 0.5)
</pre></div>
</div>
<img alt="_images/02_Hypothesentests_Mittelwert_einer_Grundgesamtheit_61_1.png" src="_images/02_Hypothesentests_Mittelwert_einer_Grundgesamtheit_61_1.png" />
</div>
</div>
<p>Aufgrund der numerischen und grafischen Auswertung fällt der Wert nicht in den Verwerfungsbereich, so dass wir <span class="math notranslate nohighlight">\(H_0\)</span> nicht verwerfen. Die Testergebnisse sind auf dem <span class="math notranslate nohighlight">\(5 \%\)</span>-Niveau statistisch signifikant.</p>
<ul class="simple">
<li><p><strong>Alternativhypothese</strong> <span class="math notranslate nohighlight">\(H_{A_3}:\quad \mu &gt; 70,8\)</span></p></li>
</ul>
<p>Erinnern Sie sich an den kritischen Wert für <span class="math notranslate nohighlight">\(H_{A_3}\)</span>.</p>
<div class="math notranslate nohighlight">
\[z_{A_3} = +z_{\alpha} = 1,64\]</div>
<p>Fällt die Teststatistik (<span class="math notranslate nohighlight">\(z \approx 2,699\)</span>) in den Ablehnungsbereich?</p>
<div class="math notranslate nohighlight">
\[2,699 &gt; 1,64\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ablehnen?</span>
<span class="nb">print</span><span class="p">(</span><span class="n">z</span> <span class="o">&gt;</span> <span class="n">z_HA_3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">x_min</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span>
<span class="n">x_max</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>


<span class="n">ticks</span> <span class="o">=</span> <span class="p">[</span><span class="n">z_HA_3</span><span class="p">]</span>
<span class="k">for</span> <span class="n">_x</span> <span class="ow">in</span> <span class="n">ticks</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;Ablehnen der $H_0$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;Nicht ablehnen der $H_0$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$1-\alpha$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;$\alpha$&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">2.4</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;Kritischer Wert&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">0.3</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">2.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
    <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;$z$&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
<span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-0.05, 0.5)
</pre></div>
</div>
<img alt="_images/02_Hypothesentests_Mittelwert_einer_Grundgesamtheit_69_1.png" src="_images/02_Hypothesentests_Mittelwert_einer_Grundgesamtheit_69_1.png" />
</div>
</div>
<p>Aufgrund der numerischen und grafischen Auswertung fällt der Wert in den Verwerfungsbereich, so dass wir <span class="math notranslate nohighlight">\(H_0\)</span> verwerfen. Die Testergebnisse sind auf dem <span class="math notranslate nohighlight">\(5 \%\)</span>-Niveau statistisch signifikant.</p>
<p><strong>Schritt 6: Interpretieren Sie das Ergebnis des Hypothesentests.</strong></p>
<ul class="simple">
<li><p><strong>Alternativhypothese</strong> <span class="math notranslate nohighlight">\(H_{A_1}:\quad \mu \ne 70,8\)</span></p></li>
</ul>
<p>Bei einem Signifikanzniveau von <span class="math notranslate nohighlight">\(5 \%\)</span> lassen die Daten den Schluss zu, dass sich das Durchschnittsgewicht der Studenten vom Durchschnittsgewicht der europäischen Erwachsenen unterscheidet.</p>
<ul class="simple">
<li><p><strong>Alternativhypothese</strong> <span class="math notranslate nohighlight">\(H_{A_2}:\quad \mu \lt 70,8\)</span></p></li>
</ul>
<p>Bei einem Signifikanzniveau von <span class="math notranslate nohighlight">\(5 \%\)</span> liefern die Daten keine ausreichenden Beweise für die Schlussfolgerung, dass das Durchschnittsgewicht der Studenten geringer ist als das Durchschnittsgewicht der europäischen Erwachsenen</p>
<ul class="simple">
<li><p><strong>Alternativhypothese</strong> <span class="math notranslate nohighlight">\(H_{A_3}:\quad \mu &gt; 70,8\)</span></p></li>
</ul>
<p>Bei einem Signifikanzniveau von <span class="math notranslate nohighlight">\(5 \%\)</span> lassen die Daten den Schluss zu, dass sich das Durchschnittsgewicht der Studenten vom Durchschnittsgewicht der europäischen Erwachsenen unterscheidet.</p>
</section>
<section id="hypothesentests-der-p-wert-ansatz">
<h3>Hypothesentests: Der <span class="math notranslate nohighlight">\(p\)</span>-Wert-Ansatz<a class="headerlink" href="#hypothesentests-der-p-wert-ansatz" title="Permalink to this headline">#</a></h3>
<p><strong>Schritt 1: Geben Sie die Nullhypothese (<span class="math notranslate nohighlight">\(H_0\)</span>) und die Alternativhypothese (<span class="math notranslate nohighlight">\(H_A\)</span>) an.</strong></p>
<p>Die Nullhypothese besagt, dass das Durchschnittsgewicht der Studenten (<span class="math notranslate nohighlight">\(\mu\)</span>
) gleich dem Durchschnittsgewicht europäischer Erwachsener von <span class="math notranslate nohighlight">\(70,8\)</span> kg (<span class="math notranslate nohighlight">\(\mu_0\)</span>) ist, wie von Walpole et al. (2012) berichtet. Mit anderen Worten: Es gibt keinen Unterschied zwischen dem Durchschnittsgewicht der Studenten und dem Durchschnittsgewicht der europäischen Erwachsenen.</p>
<div class="math notranslate nohighlight">
\[H_{A_1}: \quad \mu \ne 70,8\]</div>
<p>Zur Veranschaulichung testen wir drei Alternativhypothesen.</p>
<p><strong>Alternativhypothese 1</strong>: Das Durchschnittsgewicht der Studenten entspricht nicht dem Durchschnittsgewicht der europäischen Erwachsenen. Mit anderen Worten: Es gibt einen Unterschied zwischen dem Durchschnittsgewicht der Studenten und dem Durchschnittsgewicht der europäischen Erwachsenen.</p>
<div class="math notranslate nohighlight">
\[H_{A_1}: \quad \mu \ne 70,8\]</div>
<p><strong>Alternativhypothese 2</strong>: Das Durchschnittsgewicht der Studenten ist geringer als das Durchschnittsgewicht der europäischen Erwachsenen.</p>
<div class="math notranslate nohighlight">
\[H_{A_2}: \quad \mu  &lt; 70,8\]</div>
<p><strong>Alternativhypothese 3</strong>: Das Durchschnittsgewicht der Studenten ist höher als das Durchschnittsgewicht der europäischen Erwachsenen.</p>
<div class="math notranslate nohighlight">
\[H_{A_3}: \quad \mu &gt; 70,8\]</div>
<p><strong>Schritt 2: Legen Sie das Signifikanzniveau <span class="math notranslate nohighlight">\(\alpha\)</span> fest.</strong></p>
<div class="math notranslate nohighlight">
\[\alpha = 0,05\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Schritt 3: Berechnen Sie den Wert der Teststatistik.</strong></p>
<p>Die folgende Gleichung wird zur Berechnung der Teststatistik <span class="math notranslate nohighlight">\(z\)</span> verwendet.</p>
<div class="math notranslate nohighlight">
\[z = \frac{\bar x-\mu_0}{\sigma/\sqrt{n}}\]</div>
<ul class="simple">
<li><p>Berechnen Sie den Wert der Teststatistik</p></li>
</ul>
<div class="math notranslate nohighlight">
\[z = \frac{\bar x-\mu}{\sigma/\sqrt{n}} =  \frac{77,02-70,8}{8,64/ \sqrt{14}} \approx 2,699\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_bar</span> <span class="o">-</span> <span class="n">mu0</span><span class="p">)</span> <span class="o">/</span> <span class="n">sigma_z</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">z</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.699033971278552
</pre></div>
</div>
</div>
</div>
<p><strong>Schritt 4b: Bestimmen Sie den <span class="math notranslate nohighlight">\(p\)</span>-Wert.</strong></p>
<p>Um den <span class="math notranslate nohighlight">\(p\)</span>-Wert zu berechnen, verwenden wir die Funktion <code class="docutils literal notranslate"><span class="pre">norm.cdf()</span></code> in Python. Erinnern Sie sich daran, dass wir auf drei Alternativhypothesen testen (<span class="math notranslate nohighlight">\(H_{A_1}, H_{A_1}\)</span> und <span class="math notranslate nohighlight">\(H_{A_1}\)</span>), daher berechnen wir auch drei <span class="math notranslate nohighlight">\(p\)</span>-Werte (<span class="math notranslate nohighlight">\((P(z_{A_1})\)</span>, <span class="math notranslate nohighlight">\((P(z_{A_2})\)</span> und <span class="math notranslate nohighlight">\((P(z_{A_3})\)</span>).</p>
<ul class="simple">
<li><p><strong>Alternativhypothese</strong> <span class="math notranslate nohighlight">\(H_{A_1}:\quad \mu \ne 70,8\)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Die Wahrscheinlichkeit, einen z-Wert zu beobachten, der größer oder kleiner ist, wenn die Nullhypothese wahr ist</span>
<span class="n">upper</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
<span class="n">lower</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
<span class="n">p_z_1</span> <span class="o">=</span> <span class="n">upper</span> <span class="o">+</span> <span class="n">lower</span>
<span class="n">p_z_1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0069541077277850295
</pre></div>
</div>
</div>
</div>
<p>Aus Schritt <span class="math notranslate nohighlight">\(3\)</span> ergibt sich der Wert der Teststatistik <span class="math notranslate nohighlight">\(z \approx 2,699\)</span>. Der Test ist zweiseitig, d. h. der <span class="math notranslate nohighlight">\(p\)</span>-Wert ist die Wahrscheinlichkeit, dass ein Wert <span class="math notranslate nohighlight">\(z\)</span> in der Größenordnung von <span class="math notranslate nohighlight">\(2,699\)</span> oder mehr oder ein Wert <span class="math notranslate nohighlight">\(z\)</span> in der Größenordnung von <span class="math notranslate nohighlight">\(-2,699\)</span> oder weniger beobachtet wird. Diese Wahrscheinlichkeit beträgt <span class="math notranslate nohighlight">\(0,006954\)</span>. Also <span class="math notranslate nohighlight">\(p \approx 0,007\)</span>.</p>
<ul class="simple">
<li><p><strong>Alternativhypothese</strong> <span class="math notranslate nohighlight">\(H_{A_2}:\quad \mu \lt 70,8\)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Die Wahrscheinlichkeit, einen z-Wert oder einen kleineren Wert zu beobachten, wenn die Nullhypothese wahr ist</span>
<span class="n">p_z_2</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="n">p_z_2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9965229461361075
</pre></div>
</div>
</div>
</div>
<p>Aus Schritt <span class="math notranslate nohighlight">\(3\)</span> ergibt sich der Wert der Teststatistik <span class="math notranslate nohighlight">\(z \approx 2,699\)</span>. Der Test ist linksschief, d. h. der <span class="math notranslate nohighlight">\(p\)</span>-Wert ist die Wahrscheinlichkeit, einen Wert <span class="math notranslate nohighlight">\(z\)</span> von <span class="math notranslate nohighlight">\(2,699\)</span> oder weniger zu beobachten. Diese Wahrscheinlichkeit ist ungefähr <span class="math notranslate nohighlight">\(1\)</span>. <span class="math notranslate nohighlight">\(p \approx 1\)</span>.</p>
<ul class="simple">
<li><p><strong>Alternativhypothese</strong> <span class="math notranslate nohighlight">\(H_{A_3}:\quad \mu &gt; 70,8\)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Die Wahrscheinlichkeit, einen z-Wert oder einen größeren Wert zu beobachten, wenn die Nullhypothese wahr ist</span>
<span class="n">p_z_3</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="n">p_z_3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.003477053863892521
</pre></div>
</div>
</div>
</div>
<p>Aus Schritt <span class="math notranslate nohighlight">\(3\)</span> ergibt sich der Wert der Teststatistik <span class="math notranslate nohighlight">\(z=2,699\)</span>. Der Test ist rechtsschief, d. h. der <span class="math notranslate nohighlight">\(p\)</span>-Wert ist die Wahrscheinlichkeit, einen Wert <span class="math notranslate nohighlight">\(z\)</span> von <span class="math notranslate nohighlight">\(2,699\)</span> oder mehr zu beobachten. Diese Wahrscheinlichkeit ist ungefähr <span class="math notranslate nohighlight">\(0,003477\)</span>; d.h. <span class="math notranslate nohighlight">\(p \approx 0,004\)</span>.</p>
<p><strong>Schritt 5b: Wenn <span class="math notranslate nohighlight">\(p \le α\)</span>, wird <span class="math notranslate nohighlight">\(H_0\)</span> verworfen; andernfalls wird <span class="math notranslate nohighlight">\(H_0\)</span> nicht verworfen.</strong></p>
<p>Der <span class="math notranslate nohighlight">\(p\)</span>-Wert der in Schritt <span class="math notranslate nohighlight">\(4\)</span> ermittelten Teststatistik wird mit dem benutzerdefinierten Signifikanzniveau <span class="math notranslate nohighlight">\(\alpha\)</span> von <span class="math notranslate nohighlight">\(5 \%\)</span> verglichen. Es sei daran erinnert, dass wir drei Alternativhypothesen (<span class="math notranslate nohighlight">\(H_{A_1}, H_{A_2}\)</span> und <span class="math notranslate nohighlight">\(H_{A_3}\)</span>) untersuchen. Wir führen also Vergleiche für jede einzelne Hypothese durch.</p>
<ul class="simple">
<li><p><strong>Alternativhypothese</strong> <span class="math notranslate nohighlight">\(H_{A_1}:\quad \mu \ne 70,8\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[0,007 \le 0,05\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ablehnen?</span>
<span class="n">p_z_1</span> <span class="o">&lt;=</span> <span class="n">alpha</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>Der <span class="math notranslate nohighlight">\(p\)</span>-Wert ist kleiner als das angegebene Signifikanzniveau von <span class="math notranslate nohighlight">\(0,05\)</span> und wir verwerfen <span class="math notranslate nohighlight">\(H_0\)</span>. Die Testergebnisse sind auf dem <span class="math notranslate nohighlight">\(5 \%\)</span>-Niveau statistisch signifikant und liefern einen sehr starken Beweis gegen die Nullhypothese.</p>
<ul class="simple">
<li><p><strong>Alternativhypothese</strong> <span class="math notranslate nohighlight">\(H_{A_2}:\quad \mu \lt 70,8\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[1 \le 0,05\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ablehnen?</span>
<span class="n">p_z_2</span> <span class="o">&lt;=</span> <span class="n">alpha</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<p>Der <span class="math notranslate nohighlight">\(p\)</span>-Wert ist größer als das angegebene Signifikanzniveau von <span class="math notranslate nohighlight">\(0,05\)</span> und wir verwerfen <span class="math notranslate nohighlight">\(H_0\)</span> nicht. Die Testergebnisse sind auf dem <span class="math notranslate nohighlight">\(5 \%\)</span>-Niveau statistisch signifikant und liefern keinen ausreichenden Beweis gegen die Nullhypothese.</p>
<ul class="simple">
<li><p><strong>Alternativhypothese</strong> <span class="math notranslate nohighlight">\(H_{A_3}:\quad \mu &gt; 70,8\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[0,004 \le 0,05\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ablehnen?</span>
<span class="n">p_z_3</span> <span class="o">&lt;=</span> <span class="n">alpha</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>Der <span class="math notranslate nohighlight">\(p\)</span>-Wert ist kleiner als das angegebene Signifikanzniveau von <span class="math notranslate nohighlight">\(0,05\)</span> und wir verwerfen <span class="math notranslate nohighlight">\(H_0\)</span>. Die Testergebnisse sind auf dem <span class="math notranslate nohighlight">\(5 \%\)</span>-Niveau statistisch signifikant und liefern einen sehr starken Beweis gegen die Nullhypothese.</p>
<p><strong>Schritt 6: Interpretieren Sie das Ergebnis des Hypothesentests.</strong></p>
<ul class="simple">
<li><p><strong>Alternativhypothese</strong> <span class="math notranslate nohighlight">\(H_{A_1}:\quad \mu \ne 70,8\)</span></p></li>
</ul>
<p><span class="math notranslate nohighlight">\(p \approx 0,007\)</span>. Bei einem Signifikanzniveau von <span class="math notranslate nohighlight">\(5 \%\)</span> lassen die Daten den Schluss zu, dass sich das Durchschnittsgewicht der Studenten vom Durchschnittsgewicht der europäischen Erwachsenen unterscheidet.</p>
<ul class="simple">
<li><p><strong>Alternativhypothese</strong> <span class="math notranslate nohighlight">\(H_{A_2}:\quad \mu \lt 70,8\)</span></p></li>
</ul>
<p><span class="math notranslate nohighlight">\(p \approx 1\)</span>. Bei einem Signifikanzniveau von <span class="math notranslate nohighlight">\(5 \%\)</span> liefern die Daten keine hinreichenden Anhaltspunkte für die Schlussfolgerung, dass das Durchschnittsgewicht der Studenten geringer ist als das Durchschnittsgewicht der europäischen Erwachsenen.</p>
<ul class="simple">
<li><p><strong>Alternativhypothese</strong> <span class="math notranslate nohighlight">\(H_{A_3}:\quad \mu &gt; 70,8\)</span></p></li>
</ul>
<p><span class="math notranslate nohighlight">\(p \approx 0,004\)</span>. Bei einem Signifikanzniveau von <span class="math notranslate nohighlight">\(5 \%\)</span> lassen die Daten den Schluss zu, dass das Durchschnittsgewicht der Studenten höher ist als das Durchschnittsgewicht der europäischen Erwachsenen.</p>
</section>
</section>
<section id="hypothesentests-fur-den-mittelwert-einer-grundgesamtheit-wenn-sigma-unbekannt-ist">
<h2>Hypothesentests für den Mittelwert einer Grundgesamtheit, wenn <span class="math notranslate nohighlight">\(\sigma\)</span> unbekannt ist<a class="headerlink" href="#hypothesentests-fur-den-mittelwert-einer-grundgesamtheit-wenn-sigma-unbekannt-ist" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">t</span><span class="p">,</span> <span class="n">ttest_1samp</span>
</pre></div>
</div>
</div>
</div>
<p>Ein Hypothesentest für einen Grundgesamtheitsmittelwert, bei dem die Standardabweichung <span class="math notranslate nohighlight">\(\sigma\)</span> der Grundgesamtheit nicht bekannt ist, wird auf die gleiche Weise durchgeführt, wie wenn die Standardabweichung der Grundgesamtheit bekannt ist. Der einzige Unterschied besteht darin, dass die <a href="https://de.wikipedia.org/wiki/Studentsche_t-Verteilung"><span class="math notranslate nohighlight">\(t\)</span>-Verteilung</a> und nicht die Standardnormalverteilung (<span class="math notranslate nohighlight">\(z\)</span>-Verteilung) verwendet wird.</p>
<p>Bei einem Test mit der Nullhypothese <span class="math notranslate nohighlight">\(H_0:\; \mu = \mu_0\)</span> wird die Teststatistik, <span class="math notranslate nohighlight">\(t\)</span>, wie folgt berechnet</p>
<div class="math notranslate nohighlight">
\[t = \frac{\bar x - \mu_0}{s/\sqrt{n}}\]</div>
<p>Dieses Hypothesentestverfahren wird als <strong>Einstichproben <span class="math notranslate nohighlight">\(t\)</span>-Test für einen Mittelwert</strong> oder einfach als <strong><span class="math notranslate nohighlight">\(t\)</span>-Test</strong> bezeichnet. Es sei daran erinnert, dass Hypothesentests einem schrittweisen Verfahren folgen, das wie folgt zusammengefasst wird</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{l}
\hline
\ \text{Schritt 1}  &amp; \text{Geben Sie die Nullhypothese } H_0 \text{ und alternative Hypothese } H_A \text{ an.}\\
\ \text{Schritt 2}  &amp; \text{Legen Sie das Signifikanzniveau, } \alpha\text{ fest.} \\
\ \text{Schritt 3}  &amp; \text{Berechnen Sie den Wert der Teststatistik.} \\
\ \text{Schritt 4a} &amp; \text{Ansatz des kritischen Wertes: Bestimmung des kritischen Wertes.}
\\
\ \text{Schritt 4b} &amp;\text{P-Wert-Ansatz: Bestimmen Sie den p-Wert.} \\
\ \text{Schritt 5a} &amp; \text{Ansatz des kritischen Werts: Wenn der Wert der Teststatistik in den Ablehnungsbereich fällt, ist } H_0 \text{ abzulehnen}   \text{; ansonsten } H_0 \text{ nicht ablehnen}  \text{.}
\\
\ \text{Schritt 5b} &amp; \text{P-Wert-Ansatz: Wenn }p \le \alpha \text{, } H_0 \text{ ablehnen } \text{; ansonsten } H_0 \text{ nicht ablehnen} \text{.} \\
\ \text{Schritt 6} &amp;\text{Interpretieren Sie das Ergebnis des Hypothesentests.} \\
\hline 
\end{array}
\end{split}\]</div>
<p>Ähnlich wie im vorangegangenen Abschnitt stellen wir zunächst den Ansatz des <strong>kritischen Werts</strong> vor und wiederholen dann in einem zweiten Schritt die Analyse für den <strong><span class="math notranslate nohighlight">\(p\)</span>-Wert-Ansatz</strong>. Diesmal verpacken wir jedoch den Ansatz des kritischen Werts in eine selbst erstellte Funktion. Für den <span class="math notranslate nohighlight">\(p\)</span>-Wert-Ansatz werden wir die leistungsstarke Maschinerie von Python nutzen und die vorhandene Funktion <code class="docutils literal notranslate"><span class="pre">ttest_1samp()</span></code> anwenden.</p>
<section id="id2">
<h3>Hypothesentests: Der Ansatz des kritischen Werts<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h3>
<p>Erstellen wir eine Funktion namens <code class="docutils literal notranslate"><span class="pre">simple_ttest()</span></code>. Die Funktion nimmt als Eingangsargumente einen Vektor <code class="docutils literal notranslate"><span class="pre">x</span></code> (Stichprobendaten), <code class="docutils literal notranslate"><span class="pre">mu0</span></code>, das <span class="math notranslate nohighlight">\(\mu_0\)</span> entspricht, den Grundgesamtheitsdurchschnitt, gegen den getestet werden soll, das angegebene Signifikanzniveau <span class="math notranslate nohighlight">\(\alpha\)</span>, bezeichnet als <code class="docutils literal notranslate"><span class="pre">alpha</span></code>, und die Methode des <span class="math notranslate nohighlight">\(t\)</span>-Tests, <code class="docutils literal notranslate"><span class="pre">left</span></code> oder <code class="docutils literal notranslate"><span class="pre">right</span></code> oder der Standardwert <code class="docutils literal notranslate"><span class="pre">two-sided</span></code>, mit dem Funktionsargument namens <code class="docutils literal notranslate"><span class="pre">Methode</span></code>. Die Ausgabe der Funktion ist ein Boolescher Wert, <code class="docutils literal notranslate"><span class="pre">TRUE</span></code> oder <code class="docutils literal notranslate"><span class="pre">FALSE</span></code>. Wenn <code class="docutils literal notranslate"><span class="pre">TRUE</span></code>, wird <span class="math notranslate nohighlight">\(H_0\)</span> abgelehnt, wenn <code class="docutils literal notranslate"><span class="pre">FALSE</span></code>, wird <span class="math notranslate nohighlight">\(H_0\)</span> nicht abgelehnt.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">simple_ttest</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu0</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;two-sided&quot;</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">xbar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Berechne Teststatistik</span>
    <span class="n">tstat</span> <span class="o">=</span> <span class="p">(</span><span class="n">xbar</span> <span class="o">-</span> <span class="n">mu0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">s</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>

    <span class="c1"># Berechne kritischer Wert</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="c1"># für den linksseitigen Test</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span>
        <span class="n">crit_val</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
        <span class="c1"># Werte Ablehnungsbereich aus</span>
        <span class="k">if</span> <span class="n">tstat</span> <span class="o">&lt;</span> <span class="n">crit_val</span><span class="p">:</span>
            <span class="n">reject</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">reject</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># für den rechtsseitigen Test</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span>
        <span class="n">crit_val</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
        <span class="c1"># Werte Ablehnungsbereich aus</span>
        <span class="k">if</span> <span class="n">tstat</span> <span class="o">&gt;</span> <span class="n">crit_val</span><span class="p">:</span>
            <span class="n">reject</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">reject</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># für den zweiseitigen Test (default)</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">:</span>
        <span class="n">crit_val</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
        <span class="c1"># Werte Ablehnungsbereich aus</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">tstat</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">crit_val</span><span class="p">)</span> <span class="ow">and</span> <span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">tstat</span><span class="p">)</span> <span class="o">&lt;</span> <span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">crit_val</span><span class="p">):</span>
            <span class="n">reject</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">reject</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Significance level:&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Degrees of freedom:&quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test statistic:&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">tstat</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Critical value:&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">crit_val</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Reject H0:&quot;</span><span class="p">,</span> <span class="n">reject</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Ein tolles Stück Code :-)</p>
</section>
<section id="t-test-mit-einem-mittelwert-ein-beispiel">
<h3><span class="math notranslate nohighlight">\(t\)</span>-Test mit einem Mittelwert: Ein Beispiel<a class="headerlink" href="#t-test-mit-einem-mittelwert-ein-beispiel" title="Permalink to this headline">#</a></h3>
<p>Nun ist es an der Zeit, unsere Funktion <code class="docutils literal notranslate"><span class="pre">simple_ttest()</span></code> zu testen. Dazu wiederholen wir das Beispiel aus dem vorherigen Abschnitt. Wir verwenden den <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz. Sie können die Datei <code class="docutils literal notranslate"><span class="pre">students.csv</span></code> <a href="https://userpage.fu-berlin.de/soga/200/2010_data_sets/students.csv">hier</a> herunterladen. Importieren Sie den Datensatz und geben Sie ihm einen passenden Namen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lese Datei students.csv als Dataframe ein; Indexspalte wird übersprungen</span>
<span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../data/students.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Der <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz besteht aus <span class="math notranslate nohighlight">\(8239\)</span> Zeilen, von denen jede einen bestimmten Studenten repräsentiert, und <span class="math notranslate nohighlight">\(16\)</span> Spalten, von denen jede einer Variable/einem Merkmal entspricht, das sich auf diesen bestimmten Studenten bezieht. Diese selbsterklärenden Variablen sind: <em>stud_id, name, gender, age, height, weight, religion, nc_score, semester, major, minor, score1, score2, online_tutorial, graduated, salary.</em></p>
<p>Wir untersuchen das Durchschnittsgewicht einer Zufallsstichprobe von Studenten aus dem <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz und vergleichen es mit dem Durchschnittsgewicht aller erwachsenen Europäer. <a href="https://bmcpublichealth.biomedcentral.com/articles/10.1186/1471-2458-12-439">Walpole et al. (2012)</a> veröffentlichten Daten über das durchschnittliche Körpergewicht (kg) pro Region, einschließlich Europa. Sie geben die durchschnittliche Körpermasse für die europäische erwachsene Bevölkerung mit <span class="math notranslate nohighlight">\(70,8\)</span> kg an. Wir setzen daher <span class="math notranslate nohighlight">\(μ_0\)</span>, den Mittelwert der Grundgesamtheit, entsprechend fest (<span class="math notranslate nohighlight">\(μ_0=70,8\)</span>). Ferner ziehen wir eine Zufallsstichprobe (<span class="math notranslate nohighlight">\(x\)</span>) mit einem Umfang von <span class="math notranslate nohighlight">\(n=9\)</span>. Die Stichprobe besteht aus den Gewichten in kg von <span class="math notranslate nohighlight">\(9\)</span> zufällig ausgewählten Studenten.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu0</span> <span class="o">=</span> <span class="mf">70.8</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">9</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>stud_id
883146    56.5
677171    86.5
141515    62.9
159416    62.4
175825    64.4
804998    76.3
746386    65.7
949645    61.4
847488    66.6
Name: weight, dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="uberprufen-der-hypothesen">
<h3>Überprüfen der Hypothesen<a class="headerlink" href="#uberprufen-der-hypothesen" title="Permalink to this headline">#</a></h3>
<p><strong>Schritt 1 : Geben Sie die Nullhypothese <span class="math notranslate nohighlight">\(H_0\)</span> und alternative Hypothese <span class="math notranslate nohighlight">\(H_A\)</span> an</strong></p>
<p>Die Nullhypothese besagt, dass das Durchschnittsgewicht der Studenten dem Durchschnittsgewicht der europäischen Erwachsenen entspricht, wie von Walpole et al. (2012) berichtet. Mit anderen Worten: Es gibt keinen Unterschied zwischen dem Durchschnittsgewicht der Studenten und dem Durchschnittsgewicht der europäischen Erwachsenen.</p>
<div class="math notranslate nohighlight">
\[H_0: \quad \mu = 70,8\]</div>
<p>Erinnern Sie sich daran, dass die Formulierung der Alternativhypothese vorgibt, ob wir einen zweiseitigen, einen links- oder einen rechtsseitigen Hypothesentest durchführen.</p>
<p><strong>Alternativhypothese 1</strong></p>
<div class="math notranslate nohighlight">
\[H_{A_1}: \quad \mu \ne 70,8\]</div>
<p>führt zu einem zweiseitigen Hypothesentest.</p>
<p><strong>Alternativhypothese 2</strong></p>
<div class="math notranslate nohighlight">
\[H_{A_2}: \quad \mu  &lt; 70,8\]</div>
<p>zu einem linksseitigen Hypothesentest und</p>
<p><strong>Alternativhypothese 3</strong></p>
<div class="math notranslate nohighlight">
\[H_{A_3}: \quad \mu &gt; 70,8\]</div>
<p>zu einem rechtsseitigen Hypothesentest</p>
<p><strong>Schritt 2: Legen Sie das Signifikanzniveau,<span class="math notranslate nohighlight">\(\alpha\)</span> fest.</strong></p>
<div class="math notranslate nohighlight">
\[\alpha = 0,05\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Schritt 3, 4 und 5: Berechnen Sie den Wert der Teststatistik, bestimmen Sie den kritischen Wert, und werten Sie den Wert der Teststatistik aus. Wenn er in den Verwerfungsbereich fällt, verwerfen Sie <span class="math notranslate nohighlight">\(H_0\)</span>; andernfalls verwerfen Sie <span class="math notranslate nohighlight">\(H_0\)</span> nicht</strong></p>
<p>Jetzt kommt unsere selbst erstellte Funktion <code class="docutils literal notranslate"><span class="pre">simple_ttest()</span></code> ins Spiel. Wir geben der Funktion eine Zufallsstichprobe in Form eines Vektors, einen Wert für <span class="math notranslate nohighlight">\(\mu_0\)</span>, ein Signifikanzniveau <span class="math notranslate nohighlight">\(\alpha\)</span> und die Methode (<code class="docutils literal notranslate"><span class="pre">two-sided</span></code>, <code class="docutils literal notranslate"><span class="pre">left</span></code> oder <code class="docutils literal notranslate"><span class="pre">right</span></code>) an. Erinnern Sie sich daran, dass zweiseitig der Standardwert ist. Wenn wir also keine Methode angeben, wird die Funktion den zweiseitigen Hypothesentest anwenden.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simple_ttest</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu0</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Significance level: 0.05
Degrees of freedom: 8
Test statistic: -1.271
Critical value: 2.306
Reject H0: False
</pre></div>
</div>
</div>
</div>
<p>Cool! ;-)</p>
<p>Ein rechtsseitiger <span class="math notranslate nohighlight">\(t\)</span>-Test</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simple_ttest</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu0</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Significance level: 0.05
Degrees of freedom: 8
Test statistic: -1.271
Critical value: 1.8595
Reject H0: False
</pre></div>
</div>
</div>
</div>
<p>Ein linksseitiger <span class="math notranslate nohighlight">\(t\)</span>-Test</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simple_ttest</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu0</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Significance level: 0.05
Degrees of freedom: 8
Test statistic: -1.271
Critical value: -1.8595
Reject H0: False
</pre></div>
</div>
</div>
</div>
<p><strong>Schritt 6: Interpretieren Sie das Ergebnis des Hypothesentests</strong></p>
<p>Wenn die Teststatistik und damit der Stichprobenmittelwert so extrem ist, dass er über den kritischen Wert hinausgeht und damit in den Verwerfungsbereich fällt, schließen wir, dass die Daten bei einem Signifikanzniveau von <span class="math notranslate nohighlight">\(5 \%\)</span> genügend Beweise liefern, um <span class="math notranslate nohighlight">\(H_0\)</span> zu verwerfen. Fällt die Teststatistik und damit der Stichprobenmittelwert dagegen in den Nicht-Verwerfungsbereich, so schließen wir, dass die Daten keine Beweise für die Ablehnung von <span class="math notranslate nohighlight">\(H_0\)</span> liefern.</p>
</section>
<section id="hypothesentests-in-python-der-p-wert-ansatz">
<h3>Hypothesentests in Python: Der <span class="math notranslate nohighlight">\(p\)</span>-Wert Ansatz<a class="headerlink" href="#hypothesentests-in-python-der-p-wert-ansatz" title="Permalink to this headline">#</a></h3>
<p>Der zweite Ansatz basiert auf der Zuweisung einer Wahrscheinlichkeit für den Wert der Teststatistik. Wenn die Teststatistik sehr extrem ist und die Nullhypothese wahr ist, wird der Teststatistik eine geringe Wahrscheinlichkeit zugewiesen. Ist die Teststatistik dagegen überhaupt nicht extrem, so wird ihr eine viel höhere Wahrscheinlichkeit zugewiesen. Diese Wahrscheinlichkeit wird als <span class="math notranslate nohighlight">\(p\)</span>-Wert bezeichnet.</p>
<p>Um den genauen <span class="math notranslate nohighlight">\(p\)</span>-Wert für einen gegebenen numerischen Wert zu berechnen, sind wir auf Software angewiesen, da die “In-Tabellen-nachschlagen-Methode” etwas mühsam ist, da nicht alle numerischen Werte der Teststatistik in einer solchen Tabelle angegeben sind. Dies führt zu Rundungsfehlern. Die Programmiersprache Python bietet jedoch einen sehr leistungsfähigen Mechanismus zur Durchführung von <span class="math notranslate nohighlight">\(t\)</span>-Tests. Die generische Funktion heißt <code class="docutils literal notranslate"><span class="pre">ttest_1samp</span></code>. Sie können mehr Details erfahren, indem Sie <code class="docutils literal notranslate"><span class="pre">help(ttest_1samp)</span></code> in Ihre Konsole eingeben. Obwohl die Funktion verschiedene Argumente liefert, ist der spezielle <span class="math notranslate nohighlight">\(t\)</span>-Test, für den wir uns jetzt interessieren, nämlich der Test eines Grundgesamtheitsmittelwertes, wenn <span class="math notranslate nohighlight">\(\sigma\)</span> unbekannt ist, ist recht einfach.</p>
<p>Wir wiederholen das gleiche Problem wie im vorherigen Abschnitt, wobei wir die bereits definierten Variablen verwenden. Zur Erinnerung: Die Stichprobe ist ein Vektor von Gewichten (<span class="math notranslate nohighlight">\(x\)</span>), <span class="math notranslate nohighlight">\(\mu_0=70,8\)</span>, angegeben als <code class="docutils literal notranslate"><span class="pre">mu0</span></code>, <span class="math notranslate nohighlight">\(n=9\)</span>, angegeben als <code class="docutils literal notranslate"><span class="pre">n</span></code>. Mit diesen Informationen wenden wir die Funktion <code class="docutils literal notranslate"><span class="pre">ttest_1samp</span></code> für einen zweiseitigen <span class="math notranslate nohighlight">\(t\)</span>-Test an, indem wir <code class="docutils literal notranslate"><span class="pre">ttest_1samp(x</span> <span class="pre">=</span> <span class="pre">x,</span> <span class="pre">mu</span> <span class="pre">=</span> <span class="pre">mu0,</span> <span class="pre">alternative</span> <span class="pre">=</span> <span class="pre">'two-sided')</span></code> in Python eingeben. Wir vergleichen zur Auswertung ob der <span class="math notranslate nohighlight">\(p\)</span>-Wert unter <span class="math notranslate nohighlight">\(\alpha=0,05\)</span> liegt und damit statistisch Signifikant ist.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ttest_1samp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu0</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;two-sided&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ttest_1sampResult(statistic=-1.2710092384447174, pvalue=0.23943518262349406)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mf">0.2394</span> <span class="o">&lt;</span> <span class="n">alpha</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<p>Wahnsinn! Python führt einen Hypothesentest in einer einzigen Codezeile durch und gibt zusätzliche Informationen kostenlos aus! Gehen wir die Ausgabe der Funktion <code class="docutils literal notranslate"><span class="pre">ttest_1samp()</span></code> durch.</p>
<p>Die erste Zeile listet die Ergebnisse der Berechnungen für die Teststatistik <span class="math notranslate nohighlight">\(t\)</span> und den <span class="math notranslate nohighlight">\(p\)</span>-Wert auf: <span class="math notranslate nohighlight">\(t = -1,271\)</span>, <span class="math notranslate nohighlight">\(p\)</span>-Wert <span class="math notranslate nohighlight">\(= 0,2394\)</span>.
Wir können die Alternativhypothese, die wir verwenden durch das Argument <code class="docutils literal notranslate"><span class="pre">alternative</span></code> = <code class="docutils literal notranslate"><span class="pre">less</span></code> , <code class="docutils literal notranslate"><span class="pre">greater</span></code> , <code class="docutils literal notranslate"><span class="pre">two-sided</span></code> ändern. In unserem Fall war sie zweiseitig. Versuchen Sie selbst, das Attribut in <code class="docutils literal notranslate"><span class="pre">less</span></code> oder <code class="docutils literal notranslate"><span class="pre">greater</span></code> zu ändern, um eine andere Alternativhypothese anzuwenden.</p>
<p>Es ist erwähnenswert, dass die Funktion <code class="docutils literal notranslate"><span class="pre">ttest_1samp()</span></code> die Ergebnisse des <span class="math notranslate nohighlight">\(t\)</span>-Tests ausgibt. Wir können also die Ergebnisse der Funktion <code class="docutils literal notranslate"><span class="pre">ttest_1samp()</span></code> in einer Variablen speichern.</p>
<p>Um den <span class="math notranslate nohighlight">\(p\)</span>-Wert abzurufen, geben wir ein</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">statistics</span><span class="p">,</span> <span class="n">pvalue</span> <span class="o">=</span> <span class="n">ttest_1samp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu0</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;two-sided&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pvalue</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.23943518262349406
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">statistics</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.2710092384447174
</pre></div>
</div>
</div>
</div>
</section>
</section>
<span id="document-Kapitel06/03_Hypothesentests_zwei_Grundgesamtheitsmittelwerte"></span><section id="hypothesentests-fur-zwei-grundgesamtheitsmittelwerte">
<h2>Hypothesentests für zwei Grundgesamtheitsmittelwerte<a class="headerlink" href="#hypothesentests-fur-zwei-grundgesamtheitsmittelwerte" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<p>Bisher haben wir uns auf Hypothesentests für den Mittelwert einer Grundgesamtheit konzentriert. In vielen Anwendungen wollen wir jedoch die Mittelwerte von zwei oder mehr Grundgesamtheiten vergleichen. In den folgenden Abschnitten werden Schlussfolgerungsverfahren für den Vergleich der Mittelwerte von zwei Grundgesamtheiten erörtert. Daher müssen wir zunächst zwischen Stichproben aus zwei <a href="https://de.wikipedia.org/wiki/Stochastisch_unabh%C3%A4ngige_Ereignisse">unabhängigen</a> Populationen und Stichproben aus nicht unabhängigen Populationen unterscheiden, die als <a href="https://de.wikipedia.org/wiki/Zufallsstichprobe#Abh%C3%A4ngige_und_unabh%C3%A4ngige_Stichproben">abhängige</a> Stichproben bezeichnet werden.</p>
<p>In den folgenden Abschnitten werden die Parameter und die Statistiken von Population <span class="math notranslate nohighlight">\(1\)</span> und Population <span class="math notranslate nohighlight">\(2\)</span> mit dem Index <span class="math notranslate nohighlight">\(1\)</span> bzw. <span class="math notranslate nohighlight">\(2\)</span> bezeichnet. Somit sind <span class="math notranslate nohighlight">\(\mu_1\)</span> und <span class="math notranslate nohighlight">\(\sigma_1\)</span> die Populationsparameter der Population <span class="math notranslate nohighlight">\(1\)</span> und <span class="math notranslate nohighlight">\(\mu_2\)</span> und <span class="math notranslate nohighlight">\(\sigma_2\)</span> die der Population <span class="math notranslate nohighlight">\(2\)</span>. Analog dazu sind <span class="math notranslate nohighlight">\(\bar{x}_1, s_1\)</span> und <span class="math notranslate nohighlight">\(n_1\)</span> der Stichprobenmittelwert, die Stichprobenstandardabweichung und der Stichprobenumfang der Grundgesamtheit <span class="math notranslate nohighlight">\(1\)</span>, während <span class="math notranslate nohighlight">\(\bar{x}_2, s_2\)</span> und <span class="math notranslate nohighlight">\(n_2\)</span> der aus der Grundgesamtheit <span class="math notranslate nohighlight">\(2\)</span> gezogenen Stichprobe entsprechen.</p>
<p>Für unabhängige Stichproben mit dem Umfang <span class="math notranslate nohighlight">\(n_1\)</span> und <span class="math notranslate nohighlight">\(n_2\)</span> der Grundgesamtheit <span class="math notranslate nohighlight">\(1\)</span> und der Grundgesamtheit <span class="math notranslate nohighlight">\(2\)</span> ist der Mittelwert aller möglichen Unterschiede zwischen den beiden Stichprobenmittelwerten gleich dem Unterschied zwischen den beiden Grundgesamtheitsmittelwerten.</p>
<div class="math notranslate nohighlight">
\[\mu_{\bar x_1 -\bar x_2} = \mu_1-\mu_2\]</div>
<p>Außerdem ist die Standardabweichung aller möglichen Unterschiede zwischen den beiden Stichprobenmittelwerten gleich der Quadratwurzel aus der Summe der Varianzen der Grundgesamtheit, jeweils dividiert durch den entsprechenden Stichprobenumfang.</p>
<div class="math notranslate nohighlight">
\[\sigma_{\bar x_1 -\bar x_2} = \sqrt{\frac{\sigma^2_1}{n_1} + \frac{\sigma^2_1}{n_2}}\]</div>
<p>Eine normalverteilte Variable oder ein ausreichend großer Stichprobenumfang (man denke an den <a href="https://de.wikipedia.org/wiki/Zentraler_Grenzwertsatz">zentralen Grenzwertsatz</a>) führt dazu, dass die Differenz der Stichprobenmittelwerte (<span class="math notranslate nohighlight">\(\bar{x}_1-\bar{x}_2\)</span>) ebenfalls normalverteilt ist.</p>
<p>Die Hypothesentestverfahren für zwei Grundgesamtheitsmittelwerte sind im Grunde dieselben wie für einen Grundgesamtheitsmittelwert. Bitte beachten Sie, dass wir uns in den folgenden Abschnitten auf den <span class="math notranslate nohighlight">\(p\)</span>-Wert-Ansatz konzentrieren und nicht mehr auf den kritischen Wert-Ansatz eingehen. Daher wird das Hypothesentestverfahren leicht überarbeitet. Das schrittweise Vorgehen bei Hypothesentests ist wie folgt zusammengefasst</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{l}
\hline
\ \text{Schritt 1}  &amp; \text{Geben Sie die Nullhypothese } H_0 \text{ und alternative Hypothese } H_A \text{ an.}\\
\ \text{Schritt 2}  &amp; \text{Legen Sie das Signifikanzniveau, } \alpha\text{ fest.} \\
\ \text{Schritt 3}  &amp; \text{Berechnen Sie den Wert der Teststatistik.} \\
\ \text{Schritt 4} &amp;\text{P-Wert-Ansatz: Bestimmen Sie den p-Wert.} \\
\ \text{Schritt 5b} &amp; \text{P-Wert-Ansatz: Wenn } p\le \alpha \text{, } H_0 \text{ ablehnen } \text{; ansonsten } H_0 \text{ nicht ablehnen} \text{.} \\
\ \text{Schritt 6} &amp;\text{Interpretieren Sie das Ergebnis des Hypothesentests.} \\
\hline
\end{array}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="c1"># Load the &quot;autoreload&quot; extension</span>
<span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="c1"># always reload modules</span>
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="c1"># black formatter for jupyter notebooks</span>
<span class="c1"># %load_ext nb_black</span>
<span class="c1"># black formatter for jupyter lab</span>
<span class="o">%</span><span class="k">load_ext</span> lab_black

<span class="o">%</span><span class="k">run</span> ../../src/notebook_env.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>---------------------------------
Working on the host: imarevic-pc

---------------------------------
Python version: 3.10.9 | packaged by conda-forge | (main, Feb  2 2023, 20:20:04) [GCC 11.3.0]

---------------------------------
Python interpreter: /home/imarevic/anaconda3/envs/srh/bin/python
</pre></div>
</div>
</div>
</div>
</section>
<section id="inferenz-fur-zwei-grundgesamtheitsmittelwerte-bei-unabhangigen-stichproben-s-1-approx-s-2">
<h2>Inferenz für zwei Grundgesamtheitsmittelwerte bei unabhängigen Stichproben; <span class="math notranslate nohighlight">\(s_1 \approx s_2\)</span><a class="headerlink" href="#inferenz-fur-zwei-grundgesamtheitsmittelwerte-bei-unabhangigen-stichproben-s-1-approx-s-2" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">sample</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">t</span><span class="p">,</span> <span class="n">ttest_ind</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">smi</span>
</pre></div>
</div>
</div>
</div>
<p>In diesem Abschnitt führen wir einen Hypothesentest für die Mittelwerte von zwei Grundgesamtheiten durch. Wir gehen davon aus, dass die Standardabweichungen (<span class="math notranslate nohighlight">\(s_1,s_2\)</span>) der beiden Grundgesamtheiten gleich, aber unbekannt sind. Wenn wir jedoch <span class="math notranslate nohighlight">\(\sigma\)</span> und die Differenz der Stichprobenmittelwerte (<span class="math notranslate nohighlight">\(\bar{x}_1-\bar{x}_2\)</span>) kennen würden, könnte die Teststatistik wie folgt geschrieben werden.</p>
<div class="math notranslate nohighlight">
\[z = \frac{(\bar x_1 - \bar x_2)-(\mu_1-\mu_2)}{\sigma \sqrt{\frac{1}{n_1} + \frac{1}{n_2}}}\]</div>
<p>In fast allen realen Anwendungen kennen wir <span class="math notranslate nohighlight">\(\sigma\)</span> jedoch nicht. Daher müssen wir es im Voraus schätzen. Das geht am besten, wenn man die Stichprobenvarianzen <span class="math notranslate nohighlight">\(s^2_1\)</span> und <span class="math notranslate nohighlight">\(s^2_2\)</span> als zwei Schätzungen für <span class="math notranslate nohighlight">\(\sigma^2\)</span> betrachtet. Durch Zusammenfassen der beiden Stichprobenabweichungen und Gewichtung nach dem Stichprobenumfang ergibt sich der Schätzwert für <span class="math notranslate nohighlight">\(\sigma^2\)</span> wie folgt</p>
<div class="math notranslate nohighlight">
\[s_g^2 = \frac{(n_1-1)s_1^2 + (n_2-1)s_2^2 }{n_1+n_2-2}\text{,}\]</div>
<p>und durch Ziehen der Quadratwurzel erhalten wir</p>
<div class="math notranslate nohighlight">
\[s_g = \sqrt{\frac{(n_1-1)s_1^2 + (n_2-1)s_2^2 }{n_1+n_2-2}}\text{,}\]</div>
<p>Die Größe <span class="math notranslate nohighlight">\(s_g\)</span> wird als <a href="https://de.wikipedia.org/wiki/Zweistichproben-t-Test#Zweistichproben-t-Test_f%C3%BCr_unabh%C3%A4ngige_Stichproben">gewichtete Stichprobenstandardabweichung</a> bezeichnet (engl. pooled), wobei der tiefgestellte Index <span class="math notranslate nohighlight">\(g\)</span> für <strong>gewichtet</strong> steht.</p>
<p>Die Ersetzung von <span class="math notranslate nohighlight">\(\sigma\)</span> in der obigen Gleichung durch seine Schätzung <span class="math notranslate nohighlight">\(s_g\)</span> ergibt</p>
<div class="math notranslate nohighlight">
\[t =  \frac{(\bar x_1 - \bar x_2)-(\mu_1-\mu_2)}{s_g \sqrt{\frac{1}{n_1} + \frac{1}{n_2}}}\]</div>
<p>Der Nenner der Gleichung <span class="math notranslate nohighlight">\(s_g \sqrt{\frac{1}{n_1} + \frac{1}{n_2}}\)</span> ist der Schätzer der Standardabweichung von <span class="math notranslate nohighlight">\(\bar{x}_1-\bar{x}_2\)</span>, der wie folgt geschrieben werden kann</p>
<div class="math notranslate nohighlight">
\[s_{\bar x_1 - \bar x_2} = s_g \sqrt{\frac{1}{n_1} + \frac{1}{n_2}}\]</div>
<p>Bitte beachten Sie, dass die Gleichung für die Teststatistik <span class="math notranslate nohighlight">\(t\)</span> einer <span class="math notranslate nohighlight">\(t\)</span>-Verteilung folgt. Die Freiheitsgrade (<span class="math notranslate nohighlight">\(df\)</span>) sind gegeben durch</p>
<div class="math notranslate nohighlight">
\[df = n_1+n_2-2\]</div>
<section id="intervall-schatzung-von-mu-1-mu-2">
<h3>Intervall-Schätzung von <span class="math notranslate nohighlight">\(\mu_1-\mu_2\)</span><a class="headerlink" href="#intervall-schatzung-von-mu-1-mu-2" title="Permalink to this headline">#</a></h3>
<p>Das <span class="math notranslate nohighlight">\(100(1-\alpha)\%\)</span>-Konfidenzintervall für <span class="math notranslate nohighlight">\(\mu_1-\mu_2\)</span> ist gegeben durch</p>
<div class="math notranslate nohighlight">
\[(\bar x_1 - \bar x_2) \pm t \times s_g \sqrt{\frac{1}{n_1}+\frac{1}{n_2}}\text{,}\]</div>
<p>wobei sich der Wert von <span class="math notranslate nohighlight">\(t\)</span> aus der <span class="math notranslate nohighlight">\(t\)</span>-Verteilung für das gegebene Konfidenzniveau und <span class="math notranslate nohighlight">\(n_1+n_2-2\)</span> Freiheitsgrade ergibt.</p>
</section>
<section id="der-zweistichproben-t-test-fur-unabhangige-stichproben-engl-pooled-t-test-ein-beispiel">
<h3>Der Zweistichproben-<span class="math notranslate nohighlight">\(t\)</span>-Test für unabhängige Stichproben (engl. pooled <span class="math notranslate nohighlight">\(t\)</span>-Test): Ein Beispiel<a class="headerlink" href="#der-zweistichproben-t-test-fur-unabhangige-stichproben-engl-pooled-t-test-ein-beispiel" title="Permalink to this headline">#</a></h3>
<p>Python ermöglicht es uns, einen <strong>Zweistichproben-<span class="math notranslate nohighlight">\(t\)</span>-Test für unabhängige Stichproben</strong> durchzuführen, indem wir die Funktion <code class="docutils literal notranslate"><span class="pre">ttest_ind()</span></code> um das Argument <code class="docutils literal notranslate"><span class="pre">equal_var</span> <span class="pre">=</span> <span class="pre">True</span></code> erweitern.</p>
<p>Um den Zweistichproben-<span class="math notranslate nohighlight">\(t\)</span>-Test zu üben, laden wir den <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz. Sie können die Datei <code class="docutils literal notranslate"><span class="pre">students.csv</span></code> <a href="https://userpage.fu-berlin.de/soga/200/2010_data_sets/students.csv">hier</a> herunterladen. Importieren Sie den Datensatz und weisen Sie ihm einen geeigneten Namen zu.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lese Datei students.csv als Dataframe ein; Indexspalte wird übersprungen</span>
<span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../data/students.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Der <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz besteht aus <span class="math notranslate nohighlight">\(8239\)</span> Zeilen, von denen jede einen bestimmten Studenten repräsentiert, und <span class="math notranslate nohighlight">\(16\)</span> Spalten, von denen jede einer Variable/einem Merkmal entspricht, das sich auf diesen bestimmten Studenten bezieht. Diese selbsterklärenden Variablen sind: <em>stud_id, Name, Geschlecht, Alter, Größe, Gewicht, Religion, nc_score, Semester, Hauptfach, Nebenfach, score1, score2, online_tutorial, graduated, salary</em>.</p>
<p>Um den Zweistichproben-<span class="math notranslate nohighlight">\(t\)</span>-Test für unabhängige Stichproben zu veranschaulichen, untersuchen wir das mittlere Jahresgehalt (in Euro) der Absolventen. Die erste Grundgesamtheit besteht aus männlichen Studenten und die zweite aus weiblichen Studenten. <strong>Die Frage ist, ob es einen Unterschied im mittleren Jahresgehalt der Absolventen in Bezug auf das Geschlecht gibt?</strong></p>
</section>
<section id="vorbereitung-der-daten">
<h3>Vorbereitung der Daten<a class="headerlink" href="#vorbereitung-der-daten" title="Permalink to this headline">#</a></h3>
<p>Wir beginnen mit der Datenaufbereitung.</p>
<ul class="simple">
<li><p>Wir unterteilen den Datensatz anhand der binären Variable <code class="docutils literal notranslate"><span class="pre">graduated</span></code>, die angibt, ob der Student seinen Abschluss bereits gemacht hat. Die ganze Zahl <span class="math notranslate nohighlight">\(1\)</span> steht für “abgeschlossen”, <span class="math notranslate nohighlight">\(0\)</span>
bedeutet, dass der Schüler seinen Abschluss noch nicht gemacht hat.</p></li>
<li><p>Dann teilen wir den Datensatz nach Geschlecht auf (männlich und weiblich).</p></li>
<li><p>Dann ziehen wir aus jeder Teilmenge <span class="math notranslate nohighlight">\(50\)</span> weibliche und <span class="math notranslate nohighlight">\(50\)</span> männliche Studenten und extrahieren die Variable von Interesse, das mittlere Jahresgehalt (in Euro), das in der Spalte Gehalt gespeichert ist. Diese beiden Vektoren ordnen wir den Variablen <code class="docutils literal notranslate"><span class="pre">male_sample</span></code> und <code class="docutils literal notranslate"><span class="pre">female_sample</span></code> zu.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">50</span>

<span class="n">male</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">students</span><span class="p">[</span><span class="s2">&quot;gender&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Male&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">students</span><span class="p">[</span><span class="s2">&quot;graduated&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)]</span>
<span class="n">female</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">students</span><span class="p">[</span><span class="s2">&quot;gender&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Female&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">students</span><span class="p">[</span><span class="s2">&quot;graduated&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)]</span>

<span class="n">male_sample</span> <span class="o">=</span> <span class="n">male</span><span class="p">[</span><span class="s2">&quot;salary&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">female_sample</span> <span class="o">=</span> <span class="n">female</span><span class="p">[</span><span class="s2">&quot;salary&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Außerdem prüfen wir ob die Daten normalverteilt sind, indem wir ein Normalwahrscheinlichkeitsdiagramm erstellen, das oft als <a href="https://de.wikipedia.org/wiki/Quantil-Quantil-Diagramm">Q-Q-Diagramm</a> bezeichnet wird. Wenn die Variable normalverteilt ist, sollte das Q-Q-Diagramm ungefähr linear sein.</p>
<p>In Python können wir die Funktion <code class="docutils literal notranslate"><span class="pre">qqplot()</span></code> verwenden, um Q-Q-Plots zu erstellen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Erzeuge Q-Q Plot</span>
<span class="n">qqp</span> <span class="o">=</span> <span class="n">smi</span><span class="o">.</span><span class="n">qqplot</span><span class="p">(</span><span class="n">male_sample</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">qqp</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Q-Q-Diagramm : Studenten(männlich)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Theoretische Quantillen&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Stichproben Quantillen&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Stichproben Quantillen&#39;)
</pre></div>
</div>
<img alt="_images/03_Hypothesentests_zwei_Grundgesamtheitsmittelwerte_35_1.png" src="_images/03_Hypothesentests_zwei_Grundgesamtheitsmittelwerte_35_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Erzeuge Q-Q Plot</span>
<span class="n">qqp</span> <span class="o">=</span> <span class="n">smi</span><span class="o">.</span><span class="n">qqplot</span><span class="p">(</span><span class="n">female_sample</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">qqp</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Q-Q-Diagramm : Studenten(weiblich)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Stichproben Quantillen&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Theoretische Quantillen&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Theoretische Quantillen&#39;)
</pre></div>
</div>
<img alt="_images/03_Hypothesentests_zwei_Grundgesamtheitsmittelwerte_36_1.png" src="_images/03_Hypothesentests_zwei_Grundgesamtheitsmittelwerte_36_1.png" />
</div>
</div>
<p>Wir sehen, dass die Stichprobendaten etwas Rauschen beinhalten sind, aber sie sind immer noch ungefähr normalverteilt. Die Abweichung von der Geraden im oberen und unteren Teil deutet darauf hin, dass die Wahrscheinlichkeitsverteilung leicht schief ist.</p>
<p>Außerdem prüfen wir, ob die Standardabweichungen der beiden Grundgesamtheiten ungefähr gleich sind. Als Faustregel gilt, dass die Bedingung gleicher Standardabweichungen der Grundgesamtheit erfüllt ist, wenn das Verhältnis der größeren zur kleineren Standardabweichung der Stichprobe kleiner als <span class="math notranslate nohighlight">\(2\)</span> ist. Gehen wir davon aus, dass die Daten des <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatzes eine gute Annäherung an die Grundgesamtheit darstellen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne Standardabweichung</span>
<span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">male</span><span class="p">[</span><span class="s2">&quot;salary&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9653.18969182546
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne Standardabweichung</span>
<span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">female</span><span class="p">[</span><span class="s2">&quot;salary&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7723.490231798204
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne Verhältnis</span>
<span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">male</span><span class="p">[</span><span class="s2">&quot;salary&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">female</span><span class="p">[</span><span class="s2">&quot;salary&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.2498481129790953
</pre></div>
</div>
</div>
</div>
<p>Das Verhältnis liegt bei etwa <span class="math notranslate nohighlight">\(1,249\)</span>, so dass wir zu dem Schluss kommen, dass das Kriterium der gleichen Standardabweichungen der Bevölkerung erfüllt ist. Eine einfache Visualisierungstechnik zur Bewertung der Streuung einer Variablen ist die Darstellung eines Boxplots.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig1</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Stichprobendaten&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">male</span><span class="p">[</span><span class="s2">&quot;salary&quot;</span><span class="p">],</span> <span class="n">vert</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">female</span><span class="p">[</span><span class="s2">&quot;salary&quot;</span><span class="p">],</span> <span class="n">vert</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Jährliches Einkommen in EUR&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;Jährliches Einkommen in EUR&#39;)
</pre></div>
</div>
<img alt="_images/03_Hypothesentests_zwei_Grundgesamtheitsmittelwerte_42_1.png" src="_images/03_Hypothesentests_zwei_Grundgesamtheitsmittelwerte_42_1.png" />
</div>
</div>
</section>
<section id="uberprufung-der-hypothesen">
<h3>Überprüfung der Hypothesen<a class="headerlink" href="#uberprufung-der-hypothesen" title="Permalink to this headline">#</a></h3>
<p>Wir führen den Zweistichproben-<span class="math notranslate nohighlight">\(t\)</span>-Test für unabhängige Stichproben durch, indem wir das schrittweise Durchführungsverfahren für Hypothesentests befolgen.</p>
<p><strong>Schritt 1 : Geben Sie die Nullhypothese <span class="math notranslate nohighlight">\(H_0\)</span> und alternative Hypothese <span class="math notranslate nohighlight">\(H_A\)</span> an</strong></p>
<p>Die Nullhypothese besagt, dass das durchschnittliche Jahresgehalt der männlichen Absolventen (<span class="math notranslate nohighlight">\(μ_1\)</span>) gleich dem durchschnittlichen Jahresgehalt der weiblichen Absolventen (<span class="math notranslate nohighlight">\(μ_2\)</span>) ist.</p>
<div class="math notranslate nohighlight">
\[H_0: \quad \mu_1 = \mu_2\]</div>
<p>Es sei daran erinnert, dass die Formulierung der Alternativhypothese vorgibt, ob wir einen zweiseitigen, einen links- oder einen rechtsseitigen Hypothesentest durchführen. Wir wollen prüfen, ob das Gehalt der männlichen Absolventen (<span class="math notranslate nohighlight">\(μ_1\)</span>) höher ist als das durchschnittliche Jahresgehalt der weiblichen Absolventen (<span class="math notranslate nohighlight">\(μ_2\)</span>), daher wird die Alternativhypothese wie folgt formuliert</p>
<p><strong>Alternative Hypothese</strong></p>
<div class="math notranslate nohighlight">
\[H_A: \quad \mu_1 &gt; \mu_2\]</div>
<p>Aus dieser Formulierung ergibt sich ein rechtsseitiger Hypothesentest.</p>
<p><strong>Schritt 2: Legen Sie das Signifikanzniveau,<span class="math notranslate nohighlight">\(\alpha\)</span> fest</strong></p>
<div class="math notranslate nohighlight">
\[\alpha = 0,01\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.01</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Schritt 3 und 4: Berechnen Sie den Wert der Teststatistik und den <span class="math notranslate nohighlight">\(p\)</span>-Wert</strong></p>
<p>Zur Veranschaulichung berechnen wir die Teststatistik manuell in Python. Erinnern Sie sich an die Gleichung für die Teststatistik von oben.</p>
<div class="math notranslate nohighlight">
\[t =  \frac{(\bar x_1 - \bar x_2)-(\mu_1-\mu_2)}{s_g \sqrt{\frac{1}{n_1} + \frac{1}{n_2}}}\]</div>
<p>Wenn <span class="math notranslate nohighlight">\(H_0\)</span> wahr ist, dann ist <span class="math notranslate nohighlight">\(\mu_1-\mu_2=0\)</span> und somit vereinfacht sich die Gleichung zu</p>
<div class="math notranslate nohighlight">
\[t =  \frac{(\bar x_1 - \bar x_2)}{s_g \sqrt{\frac{1}{n_1} + \frac{1}{n_2}}}\text{,}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(s_z\)</span> gleich</p>
<div class="math notranslate nohighlight">
\[s_g = \sqrt{\frac{(n_1-1)s_1^2 + (n_2-1)s_2^2 }{n_1+n_2-2}}\]</div>
<p>ist.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne Teststatistik</span>
<span class="n">n1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">male_sample</span><span class="p">)</span>
<span class="n">n2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">female_sample</span><span class="p">)</span>
<span class="n">s1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">male_sample</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">female_sample</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x1_bar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">male_sample</span><span class="p">)</span>
<span class="n">x2_bar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">female_sample</span><span class="p">)</span>

<span class="n">sg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="n">n1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">s1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">n2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">s2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">tw</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1_bar</span> <span class="o">-</span> <span class="n">x2_bar</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">sg</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">n1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">n2</span><span class="p">))</span>
<span class="n">tw</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.591470501655584
</pre></div>
</div>
</div>
</div>
<p>Der numerische Wert der Teststatistik ist <span class="math notranslate nohighlight">\(5,59147\)</span>.</p>
<p>Um den <span class="math notranslate nohighlight">\(p\)</span>-Wert zu berechnen, wenden wir die Funktion <code class="docutils literal notranslate"><span class="pre">t.cdf()</span></code> an. Erinnern Sie sich daran, wie man die Freiheitsgrade berechnet.</p>
<div class="math notranslate nohighlight">
\[df = n_1+n_2-2 = 50 + 50 - 2 = 98\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne den p-Wert</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span> <span class="o">-</span> <span class="mi">2</span>
<span class="n">p</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">t</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">tw</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0169262409931434e-07
</pre></div>
</div>
</div>
</div>
<p><strong>Schritt 5: Wenn <span class="math notranslate nohighlight">\(p \le \alpha , H_0\)</span> ablehnen; ansonsten <span class="math notranslate nohighlight">\(H_0\)</span> nicht ablehnen</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">&lt;=</span> <span class="n">alpha</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>Der <span class="math notranslate nohighlight">\(p\)</span>-Wert ist kleiner als das angegebene Signifikanzniveau von <span class="math notranslate nohighlight">\(0,01\)</span>; wir verwerfen <span class="math notranslate nohighlight">\(H_0\)</span>. Die Testergebnisse sind statistisch signifikant auf dem <span class="math notranslate nohighlight">\(1 \%\)</span>-Niveau und liefern einen sehr starken Beweis gegen die Nullhypothese.</p>
<p><strong>Schritt 6: Interpretieren Sie das Ergebnis des Hypothesentests</strong></p>
<p><span class="math notranslate nohighlight">\(p=1,0169 \cdot 10^{-7}\)</span>; Bei einem Signifikanzniveau von <span class="math notranslate nohighlight">\(1 \%\)</span> lassen die Daten den Schluss zu, dass das Durchschnittsgehalt männlicher Studenten höher ist als das Durchschnittsgehalt weiblicher Studenten.</p>
</section>
<section id="hypothesentests-in-python">
<h3>Hypothesentests in Python<a class="headerlink" href="#hypothesentests-in-python" title="Permalink to this headline">#</a></h3>
<p>Wir haben soeben manuell einen Zweistichproben-<span class="math notranslate nohighlight">\(t\)</span>-Test für unabhängige Stichproben in Python durchgeführt. Bitte beachten Sie jedoch, dass wir die volle Leistungsfähigkeit von Python nutzen können, um das gleiche Ergebnis wie oben in nur einer Zeile Code zu erhalten!</p>
<p>Um einen Zweistichproben-<span class="math notranslate nohighlight">\(t\)</span>-Test für unabhängige Stichproben in Python durchzuführen, verwenden wir die Funktion <code class="docutils literal notranslate"><span class="pre">ttest_ind()</span></code>. Wir geben zwei Vektoren als Dateneingabe an und setzen <code class="docutils literal notranslate"><span class="pre">equal_var=True</span></code>, um explizit anzugeben, dass wir die gepoolte Version des <span class="math notranslate nohighlight">\(t\)</span>-Tests anwenden, und wir setzen das Argument <code class="docutils literal notranslate"><span class="pre">alternative</span></code> auf <code class="docutils literal notranslate"><span class="pre">alternative=greater</span></code>, um <span class="math notranslate nohighlight">\(H_A\)</span> widerzuspiegeln: <span class="math notranslate nohighlight">\(\mu1 \gt \mu2\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">male_sample</span><span class="p">,</span> <span class="n">female_sample</span><span class="p">,</span> <span class="n">equal_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;greater&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ttest_indResult(statistic=5.591470501655584, pvalue=1.0169262412759705e-07)
</pre></div>
</div>
</div>
</div>
<p>Ein großer Erfolg! Vergleichen Sie die Ausgabe der Funktion <code class="docutils literal notranslate"><span class="pre">ttest_ind()</span></code> mit unserem Ergebnis von oben. Sie stimmen perfekt überein! Auch hier können wir schlussfolgern, dass bei einem Signifikanzniveau von <span class="math notranslate nohighlight">\(1 \%\)</span> die Daten einen sehr starken Hinweis darauf liefern, dass das Durchschnittsgehalt der männlichen Absolventen höher ist als das der weiblichen Absolventen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="c1"># Load the &quot;autoreload&quot; extension</span>
<span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="c1"># always reload modules</span>
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="c1"># black formatter for jupyter notebooks</span>
<span class="c1"># %load_ext nb_black</span>
<span class="c1"># black formatter for jupyter lab</span>
<span class="o">%</span><span class="k">load_ext</span> lab_black

<span class="o">%</span><span class="k">run</span> ../../src/notebook_env.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
The lab_black extension is already loaded. To reload it, use:
  %reload_ext lab_black

---------------------------------
Working on the host: imarevic-pc

---------------------------------
Python version: 3.10.9 | packaged by conda-forge | (main, Feb  2 2023, 20:20:04) [GCC 11.3.0]

---------------------------------
Python interpreter: /home/imarevic/anaconda3/envs/srh/bin/python
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 864x432 with 0 Axes&gt;
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="inferenz-fur-zwei-grundgesamtheitsmittelwerte-bei-unabhangigen-stichproben-s-1-ne-s-2">
<h2>Inferenz für zwei Grundgesamtheitsmittelwerte bei unabhängigen Stichproben; <span class="math notranslate nohighlight">\(s_1 \ne s_2\)</span><a class="headerlink" href="#inferenz-fur-zwei-grundgesamtheitsmittelwerte-bei-unabhangigen-stichproben-s-1-ne-s-2" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">sample</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">t</span><span class="p">,</span> <span class="n">ttest_ind</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">smi</span>
</pre></div>
</div>
</div>
</div>
<p>In den Fällen, in denen die Mittelwerte zweier Grundgesamtheiten getestet werden sollen und die Standardabweichungen zwischen den beiden Grundgesamtheiten unterschiedlich sind, wird der so genannte <strong>nicht gepoolte <span class="math notranslate nohighlight">\(t\)</span>-Test</strong> oder <a href="https://de.wikipedia.org/wiki/Zweistichproben-t-Test#Welch-Test"><strong>Welch’s <span class="math notranslate nohighlight">\(t\)</span>-Test</strong></a> angewendet.</p>
<p>Der <strong>Welch’s <span class="math notranslate nohighlight">\(t\)</span>-Test</strong> ist dem <strong><span class="math notranslate nohighlight">\(2\)</span>-Stichproben <span class="math notranslate nohighlight">\(t\)</span>-Test für unabhängige Stichproben</strong> sehr ähnlich, mit Ausnahme der Teststatistik <span class="math notranslate nohighlight">\(t\)</span>
und bei der Berechnung der Freiheitsgrade (<span class="math notranslate nohighlight">\(df\)</span>). Die Teststatistik nutzt nicht <span class="math notranslate nohighlight">\(s_g\)</span>, die gewichtete Standardabweichung, und wird geschrieben als</p>
<div class="math notranslate nohighlight">
\[t =  \frac{(\bar x_1 - \bar x_2)}{ \sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}}\text{.}\]</div>
<p>Der Nenner der obigen Gleichung ist der Schätzer der Standardabweichung von <span class="math notranslate nohighlight">\(\bar x_1 - \bar x_2\)</span> und gegeben durch</p>
<div class="math notranslate nohighlight">
\[s_{\bar x_1 - \bar x_2} = \sqrt{\frac{s^2_1}{n_1} + \frac{s^2_2}{n_2}}\text{.}\]</div>
<p>Die Teststatistik <span class="math notranslate nohighlight">\(t\)</span> folgt einer <span class="math notranslate nohighlight">\(t\)</span>-Verteilung und die Freiheitsgrade (<span class="math notranslate nohighlight">\(df\)</span>) sind gegeben durch</p>
<div class="math notranslate nohighlight">
\[df=\frac{\left(\frac{s_1^2}{n_1}+\frac{s_1^2}{n_2}\right)^2}{\frac{\left(\frac{s_1^2}{n_1}\right)^2}{n_1-1}+\frac{\left(\frac{s_2^2}{n_2}\right)^2}{n_2-1}}\text{.}\]</div>
<p>Runden Sie die Freiheitsgrade auf die nächste ganze Zahl ab, wenn Sie Wahrscheinlichkeitstabellen verwenden.</p>
<p>Der <strong>nicht gepoolte <span class="math notranslate nohighlight">\(t\)</span>-Test</strong> ist robust gegenüber mäßigen Verstößen gegen die Normalverteilungsannahme, aber er ist weniger robust gegenüber Ausreißern (<span id="id1">Fahrmeir <em>et al.</em> [<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">2016</a>]</span> s.403).</p>
<section id="id2">
<h3>Intervall-Schätzung von <span class="math notranslate nohighlight">\(\mu_1 - \mu_2\)</span><a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h3>
<p>Das <span class="math notranslate nohighlight">\(100(1-\alpha)\%\)</span>-Konfidenzintervall für <span class="math notranslate nohighlight">\(\mu_1-\mu_2\)</span> ist</p>
<div class="math notranslate nohighlight">
\[(\bar x_1 - \bar x_2) \pm t^* \times  \sqrt{\frac{s^2_1}{n_1} + \frac{s^2_2}{n_2}}\]</div>
<p>wobei der Wert von <span class="math notranslate nohighlight">\(t\)</span> aus der <span class="math notranslate nohighlight">\(t\)</span>-Verteilung für das gegebene Konfidenzniveau ermittelt wird. Die Freiheitsgrade (<span class="math notranslate nohighlight">\(df\)</span>) und die Standardabweichung (<span class="math notranslate nohighlight">\(s_{\bar x_1 - \bar x_2}\)</span>) ergeben sich aus der obigen Gleichung.</p>
</section>
<section id="der-welch-s-t-test-ein-beispiel">
<h3>Der Welch’s <span class="math notranslate nohighlight">\(t\)</span>-Test: Ein Beispiel<a class="headerlink" href="#der-welch-s-t-test-ein-beispiel" title="Permalink to this headline">#</a></h3>
<p>Um praktische Erfahrungen zu sammeln, wenden wir den Welch’s <span class="math notranslate nohighlight">\(t\)</span>-Test in einer Übung an. Dazu laden wir den <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz. Sie können die Datei <code class="docutils literal notranslate"><span class="pre">students.csv</span></code> <a href="https://userpage.fu-berlin.de/soga/200/2010_data_sets/students.csv">hier</a> herunterladen. Importieren Sie den Datensatz und geben Sie ihm einen passenden Namen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lese Datei students.csv als Dataframe ein; Indexspalte wird übersprungen</span>
<span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../data/students.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Der <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz besteht aus <span class="math notranslate nohighlight">\(8239\)</span> Zeilen, von denen jede einen bestimmten Studenten repräsentiert, und <span class="math notranslate nohighlight">\(16\)</span> Spalten, von denen jede einer Variable/einem Merkmal entspricht, das sich auf diesen bestimmten Studenten bezieht. Diese selbsterklärenden Variablen sind: <em>stud_id, Name, Geschlecht, Alter, Größe, Gewicht, Religion, nc_score, Semester, Hauptfach, Nebenfach, score1, score2, online_tutorial, graduated, salary</em>.</p>
<p>Zur Veranschaulichung des <strong>nicht gepoolten <span class="math notranslate nohighlight">\(t\)</span>-Tests</strong> untersuchen wir das mittlere Jahresgehalt (in Euro) von Absolventinnen in Abhängigkeit von ihrem Studienfach. Die erste Grundgesamtheit besteht aus Studentinnen mit dem Hauptfach Politikwissenschaft und die zweite Grundgesamtheit aus Studentinnen mit dem Hauptfach Sozialwissenschaften. Wir wollen testen, <strong>ob es einen Unterschied im mittleren Gehalt dieser beiden Gruppen gibt.</strong></p>
</section>
<section id="id3">
<h3>Vorbereitung der Daten<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h3>
<p>Wir beginnen mit der Datenaufbereitung.</p>
<ul class="simple">
<li><p>Wir unterteilen den Datensatz anhand der Variablen <code class="docutils literal notranslate"><span class="pre">gender</span></code> und <code class="docutils literal notranslate"><span class="pre">graduated</span></code>.</p></li>
<li><p>Dann unterteilen wir die Teilmenge in Absolventen der Politikwissenschaften und der Sozialwissenschaften (Variable <code class="docutils literal notranslate"><span class="pre">major</span></code>).</p></li>
<li><p>Dann ziehen wir aus jeder Gruppe <span class="math notranslate nohighlight">\(50\)</span> Studenten und extrahieren die Variable von Interesse, das mittlere Jahresgehalt (in Euro), das in der Spalte <code class="docutils literal notranslate"><span class="pre">salary</span></code> gespeichert ist. Wir ordnen diese beiden Vektoren den Variablen <code class="docutils literal notranslate"><span class="pre">PS</span></code> und <code class="docutils literal notranslate"><span class="pre">SS</span></code> zu.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">female_graduates</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="p">(</span><span class="n">students</span><span class="p">[</span><span class="s2">&quot;graduated&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">students</span><span class="p">[</span><span class="s2">&quot;gender&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Female&quot;</span><span class="p">)</span>
<span class="p">]</span>
<span class="n">subset_PS</span> <span class="o">=</span> <span class="n">female_graduates</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">female_graduates</span><span class="p">[</span><span class="s2">&quot;major&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Political Science&quot;</span><span class="p">]</span>
<span class="n">subset_SS</span> <span class="o">=</span> <span class="n">female_graduates</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">female_graduates</span><span class="p">[</span><span class="s2">&quot;major&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Social Sciences&quot;</span><span class="p">]</span>

<span class="n">PS</span> <span class="o">=</span> <span class="n">subset_PS</span><span class="p">[</span><span class="s2">&quot;salary&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">SS</span> <span class="o">=</span> <span class="n">subset_SS</span><span class="p">[</span><span class="s2">&quot;salary&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Außerdem überprüfen wir, ob die Daten normalverteilt sind, indem wir ein Q-Q-Diagramm erstellen. In Python können wir die Funktion <code class="docutils literal notranslate"><span class="pre">qqplot()</span></code> verwenden, um Q-Q-Plots zu erstellen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Erzeuge Q-Q Plot</span>
<span class="n">qqp</span> <span class="o">=</span> <span class="n">smi</span><span class="o">.</span><span class="n">qqplot</span><span class="p">(</span><span class="n">PS</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">qqp</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s2">&quot;Q-Q-Diagramm für Absolventinnen </span><span class="se">\n</span><span class="s2"> der Politikwissenschaft (Stichprobendaten)&quot;</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Theoretische Quantillen&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Stichproben Quantillen&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Stichproben Quantillen&#39;)
</pre></div>
</div>
<img alt="_images/03_Hypothesentests_zwei_Grundgesamtheitsmittelwerte_99_1.png" src="_images/03_Hypothesentests_zwei_Grundgesamtheitsmittelwerte_99_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Erzeuge Q-Q Plot</span>
<span class="n">qqp2</span> <span class="o">=</span> <span class="n">smi</span><span class="o">.</span><span class="n">qqplot</span><span class="p">(</span><span class="n">SS</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">qqp2</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s2">&quot;Q-Q-Diagramm für Absolventinnen </span><span class="se">\n</span><span class="s2"> der Sozialwissenschaft (Stichprobendaten)&quot;</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Theoretische Quantillen&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Stichproben Quantillen&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Stichproben Quantillen&#39;)
</pre></div>
</div>
<img alt="_images/03_Hypothesentests_zwei_Grundgesamtheitsmittelwerte_100_1.png" src="_images/03_Hypothesentests_zwei_Grundgesamtheitsmittelwerte_100_1.png" />
</div>
</div>
<p>Wir sehen, dass die Daten beider Stichproben ungefähr auf einer Geraden liegen.</p>
<p>Gehen wir davon aus, dass die Daten des <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatzes eine gute Annäherung an die Grundgesamtheit darstellen. Dann können wir visuell überprüfen, ob sich die Standardabweichungen der beiden Grundgesamtheiten tatsächlich voneinander unterscheiden, indem wir ein Boxplot aufzeichnen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig1</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Stichprobendaten&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Sozialwissenschaften&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Politikwissenschaften&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Jährliches Gehalt in EUR&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">subset_PS</span><span class="p">[</span><span class="s2">&quot;salary&quot;</span><span class="p">],</span> <span class="n">vert</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">subset_SS</span><span class="p">[</span><span class="s2">&quot;salary&quot;</span><span class="p">],</span> <span class="n">vert</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;whiskers&#39;: [&lt;matplotlib.lines.Line2D at 0x7fd6555297e0&gt;,
  &lt;matplotlib.lines.Line2D at 0x7fd6555284f0&gt;],
 &#39;caps&#39;: [&lt;matplotlib.lines.Line2D at 0x7fd6560a59c0&gt;,
  &lt;matplotlib.lines.Line2D at 0x7fd6560a63e0&gt;],
 &#39;boxes&#39;: [&lt;matplotlib.lines.Line2D at 0x7fd655529db0&gt;],
 &#39;medians&#39;: [&lt;matplotlib.lines.Line2D at 0x7fd6560a6680&gt;],
 &#39;fliers&#39;: [&lt;matplotlib.lines.Line2D at 0x7fd6560a6920&gt;],
 &#39;means&#39;: []}
</pre></div>
</div>
<img alt="_images/03_Hypothesentests_zwei_Grundgesamtheitsmittelwerte_102_1.png" src="_images/03_Hypothesentests_zwei_Grundgesamtheitsmittelwerte_102_1.png" />
</div>
</div>
<p>Auf der Grundlage des grafischen Auswertungsansatzes kommen wir zu dem Schluss, dass die Daten annähernd normalverteilt sind und dass die Standardabweichungen voneinander abweichen.</p>
</section>
<section id="id4">
<h3>Überprüfung der Hypothesen<a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h3>
<p>Erinnern Sie sich an die Forschungsfrage. <strong>Lassen die Daten den Schluss zu, dass sich das mittlere Jahresgehalt von Absolventinnen mit einem Hauptfach in Politikwissenschaft vom mittleren Jahresgehalt von Absolventinnen mit einem Hauptfach in Sozialwissenschaften unterscheidet?</strong></p>
<p>Um den nicht zusammengefassten <span class="math notranslate nohighlight">\(t\)</span>-Test durchzuführen, folgen wir dem schrittweisen Durchführungsverfahren für Hypothesentests.</p>
<p><strong>Schritt 1 : Geben Sie die Nullhypothese <span class="math notranslate nohighlight">\(H_0\)</span> und alternative Hypothese <span class="math notranslate nohighlight">\(H_A\)</span> an</strong></p>
<p>Die Nullhypothese besagt, dass das durchschnittliche Jahresgehalt von Absolventinnen mit dem Hauptfach Politikwissenschaft (<span class="math notranslate nohighlight">\(\mu_1\)</span>) gleich dem durchschnittlichen Jahresgehalt von Absolventinnen mit dem Hauptfach Sozialwissenschaften (<span class="math notranslate nohighlight">\(\mu_2\)</span>) ist.</p>
<div class="math notranslate nohighlight">
\[H_0: \quad \mu_1 = \mu_2\]</div>
<p><strong>Alternative Hypothese</strong></p>
<div class="math notranslate nohighlight">
\[H_A: \quad \mu_1 \ne \mu_2\]</div>
<p>Diese Formulierung führt zu einem zweiseitigen Hypothesentest.</p>
<p><strong>Schritt 2: Legen Sie das Signifikanzniveau,<span class="math notranslate nohighlight">\(\alpha\)</span> fest</strong></p>
<div class="math notranslate nohighlight">
\[\alpha = 0,05\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Schritt 3 und 4: Berechnen Sie den Wert der Teststatistik und den <span class="math notranslate nohighlight">\(p\)</span>-Wert</strong></p>
<p>Zur Veranschaulichung berechnen wir die Teststatistik manuell in Python. Wir erinnern uns an die Gleichungen für die Teststatistik von oben.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne die Teststatistik</span>
<span class="n">n1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">PS</span><span class="p">)</span>
<span class="n">n2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">SS</span><span class="p">)</span>
<span class="n">s1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">PS</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">SS</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x1_bar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">PS</span><span class="p">)</span>
<span class="n">x2_bar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">SS</span><span class="p">)</span>

<span class="n">tw</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1_bar</span> <span class="o">-</span> <span class="n">x2_bar</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">s1</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">s2</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">n2</span><span class="p">))</span>
<span class="n">tw</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.054456171492353
</pre></div>
</div>
</div>
</div>
<p>Der numerische Wert der Teststatistik ist <span class="math notranslate nohighlight">\(3,05446\)</span>.</p>
<p>Um den <span class="math notranslate nohighlight">\(p\)</span>-Wert zu berechnen, wenden wir die Funktion <code class="docutils literal notranslate"><span class="pre">t.cdf()</span></code> an. Erinnern Sie sich daran, wie man die Freiheitsgrade berechnet.</p>
<div class="math notranslate nohighlight">
\[df=\frac{\left(\frac{s_1^2}{n_1}+\frac{s_1^2}{n_2}\right)^2}{\frac{\left(\frac{s_1^2}{n_1}\right)^2}{n_1-1}+\frac{\left(\frac{s_2^2}{n_2}\right)^2}{n_2-1}}\text{,}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne df</span>
<span class="n">df_numerator</span> <span class="o">=</span> <span class="p">(</span><span class="n">s1</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">s2</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">n2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">df_denominator</span> <span class="o">=</span> <span class="p">(</span><span class="n">s1</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">n1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">n1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s2</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">n2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">n2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df_numerator</span> <span class="o">/</span> <span class="n">df_denominator</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>81.31178520706362
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne p-Wert</span>
<span class="c1"># wir verwenden einen zweiseitigen Test</span>
<span class="n">upper</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">t</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">tw</span><span class="p">),</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">lower</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">tw</span><span class="p">),</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">upper</span> <span class="o">+</span> <span class="n">lower</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0030479813074539763
</pre></div>
</div>
</div>
</div>
<p><strong>Schritt 5: Wenn <span class="math notranslate nohighlight">\(p \le \alpha , H_0\)</span> ablehnen; ansonsten <span class="math notranslate nohighlight">\(H_0\)</span> nicht ablehnen</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">&lt;=</span> <span class="n">alpha</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>Der <span class="math notranslate nohighlight">\(p\)</span>-Wert ist kleiner als das angegebene Signifikanzniveau von <span class="math notranslate nohighlight">\(0,05\)</span>; wir verwerfen <span class="math notranslate nohighlight">\(H_0\)</span>. Die Testergebnisse sind statistisch signifikant auf dem <span class="math notranslate nohighlight">\(5 \%\)</span>-Niveau und liefern einen sehr starken Beweis gegen die Nullhypothese.</p>
<p><strong>Schritt 6: Interpretieren Sie das Ergebnis des Hypothesentests</strong></p>
<p><span class="math notranslate nohighlight">\(p=0,003047987\)</span>. Bei einem Signifikanzniveau von <span class="math notranslate nohighlight">\(5 \%\)</span> lassen die Daten den Schluss zu, dass sich das durchschnittliche Jahresgehalt von Absolventinnen der Politikwissenschaft vom durchschnittlichen Jahresgehalt von Absolventinnen der Sozialwissenschaften unterscheidet.</p>
</section>
<section id="id5">
<h3>Hypothesentests in Python<a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h3>
<p>Wir haben gerade einen Welch’s <span class="math notranslate nohighlight">\(t\)</span>-Test in Python manuell durchgeführt. Jetzt nutzen wir die volle Leistung  von Python, um das gleiche Ergebnis wie oben mit nur einer Zeile Code zu erhalten!</p>
<p>Um einen Welch’s <span class="math notranslate nohighlight">\(t\)</span>-Test in Python durchzuführen, verwenden wir die Funktion <code class="docutils literal notranslate"><span class="pre">ttest_ind()</span></code>. Wir geben zwei Vektoren als Dateneingabe an und setzen <code class="docutils literal notranslate"><span class="pre">equal_var</span> <span class="pre">=</span> <span class="pre">False</span></code>, um explizit anzugeben, dass wir die nicht gepoolte Version des <span class="math notranslate nohighlight">\(t\)</span>-Tests anwenden. Das Argument <code class="docutils literal notranslate"><span class="pre">alternative</span></code> muss nicht gesetzt werden, da der Standardwert unserer Alternativhypothese entspricht <span class="math notranslate nohighlight">\(H_A: \; \mu_1 \ne \mu_2\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">PS</span><span class="p">,</span> <span class="n">SS</span><span class="p">,</span> <span class="n">equal_var</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ttest_indResult(statistic=3.0544561714923537, pvalue=0.0030479813074539563)
</pre></div>
</div>
</div>
</div>
<p>Stark! Vergleichen Sie die Ausgabe der Funktion <code class="docutils literal notranslate"><span class="pre">ttest_ind()</span></code> mit unserem Ergebnis von oben. Sie stimmen perfekt überein! Auch hier können wir schlussfolgern, dass die Daten bei einem Signifikanzniveau von <span class="math notranslate nohighlight">\(5 \%\)</span> einen sehr starken Hinweis darauf liefern, dass sich das durchschnittliche Jahresgehalt von Absolventinnen der Politikwissenschaft vom durchschnittlichen Jahresgehalt von Absolventinnen der Sozialwissenschaften unterscheidet.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="c1"># Load the &quot;autoreload&quot; extension</span>
<span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="c1"># always reload modules</span>
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="c1"># black formatter for jupyter notebooks</span>
<span class="c1"># %load_ext nb_black</span>
<span class="c1"># black formatter for jupyter lab</span>
<span class="o">%</span><span class="k">load_ext</span> lab_black

<span class="o">%</span><span class="k">run</span> ../../src/notebook_env.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
The lab_black extension is already loaded. To reload it, use:
  %reload_ext lab_black

---------------------------------
Working on the host: imarevic-pc

---------------------------------
Python version: 3.10.9 | packaged by conda-forge | (main, Feb  2 2023, 20:20:04) [GCC 11.3.0]

---------------------------------
Python interpreter: /home/imarevic/anaconda3/envs/srh/bin/python
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 864x432 with 0 Axes&gt;
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="inferenz-fur-zwei-grundgesamtheitsmittelwerte-bei-gepaarten-stichproben">
<h2>Inferenz für zwei Grundgesamtheitsmittelwerte bei gepaarten Stichproben<a class="headerlink" href="#inferenz-fur-zwei-grundgesamtheitsmittelwerte-bei-gepaarten-stichproben" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">sample</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">t</span><span class="p">,</span> <span class="n">ttest_rel</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">smi</span>
</pre></div>
</div>
</div>
</div>
<p>Wenden wir uns nun einem Hypothesentestverfahren für die Differenz zwischen zwei Grundgesamtheitsmittelwerte zu, wenn die Stichproben <strong>abhängig</strong> sind. Wenn beispielsweise zwei Datenwerte aus derselben Quelle (oder demselben Teilsystem) stammen, werden diese als <strong>gepaarte</strong> oder <strong>abhängige</strong> Stichproben bezeichnet.</p>
<p>Sehr häufig werden diese Verfahren für die <strong>Before-After-Control-Impact (BACI)</strong> eingesetzt. Stellen Sie sich einen Fall vor, in dem Sie die Wirksamkeit eines Filtersystems zur Entfernung von Luftschadstoffen, die von einer Fabrik freigesetzt werden, bewerten sollen. In diesem Fall besteht eine Grundgesamtheit aus Messungen der Luftqualität vor der Einführung oder Erneuerung des Filtersystems und die andere Grundgesamtheit aus Messungen der Luftqualität nach der Installation des neuen Filtersystems. In diesem Fall hat man es mit gepaarten Stichproben zu tun, da die beiden Datensätze von derselben Quelle, der Fabrik, erhoben werden.</p>
<p>Bei gepaarten Stichproben wird die Differenz zwischen den Datenwerten der beiden Stichproben mit <span class="math notranslate nohighlight">\(d\)</span> bezeichnet, oft auch als <strong>gepaarte Differenz</strong> bezeichnet. Beachten Sie, dass der Stichprobenumfang <span class="math notranslate nohighlight">\(n\)</span> für jede Stichprobe gleich ist. Der Mittelwert der gepaarten Differenzen für die Stichproben wird als <span class="math notranslate nohighlight">\(\bar d\)</span> bezeichnet.</p>
<div class="math notranslate nohighlight">
\[\bar d = \frac{\sum d}{n}\]</div>
<p>Die Standardabweichung der gepaarten Unterschiede für zwei Stichproben, <span class="math notranslate nohighlight">\(s_d\)</span>, wird wie folgt berechnet</p>
<div class="math notranslate nohighlight">
\[s_d = \sqrt{\frac{\sum d^2 - \frac{(\sum d)^2}{n}}{n-1}}\]</div>
<p>Angenommen, die gepaarte Differenzvariable <span class="math notranslate nohighlight">\(d\)</span> ist normalverteilt, dann wird die <a href="https://de.wikipedia.org/wiki/Zweistichproben-t-Test#Zweistichproben-t-Test_f%C3%BCr_abh%C3%A4ngige_Stichproben">gepaarte <span class="math notranslate nohighlight">\(t\)</span>-Statistik</a> wie folgt ausgedrückt</p>
<div class="math notranslate nohighlight">
\[t= \frac{\bar d - (\mu_1-\mu_2)}{\frac{s_d}{\sqrt{n}}}\text{,}\]</div>
<p>was sich vereinfacht zu</p>
<div class="math notranslate nohighlight">
\[t= \frac{\bar d}{\frac{s_d}{\sqrt{n}}}\text{,}\]</div>
<p>wenn <span class="math notranslate nohighlight">\(\mu_1-\mu_2 = 0\)</span>. Die Teststatistik <span class="math notranslate nohighlight">\(t\)</span> für gepaarte Stichproben folgt einer <span class="math notranslate nohighlight">\(t\)</span>-Verteilung mit <span class="math notranslate nohighlight">\(df=n-1\)</span>.</p>
<section id="intervall-schatzung-von-mu-d">
<h3>Intervall-Schätzung von <span class="math notranslate nohighlight">\(\mu_d\)</span><a class="headerlink" href="#intervall-schatzung-von-mu-d" title="Permalink to this headline">#</a></h3>
<p>Das <span class="math notranslate nohighlight">\(100(1-\alpha)\%\)</span>-Konfidenzintervall für <span class="math notranslate nohighlight">\(\mu_d\)</span> ist</p>
<div class="math notranslate nohighlight">
\[\bar d \pm t \times \frac{s_d}{\sqrt{n}}\]</div>
<p>wobei sich der Wert von <span class="math notranslate nohighlight">\(t\)</span> aus der <span class="math notranslate nohighlight">\(t\)</span>-Verteilung für das gegebene Konfidenzniveau und <span class="math notranslate nohighlight">\(n-1\)</span> Freiheitsgrade ergibt.</p>
</section>
<section id="der-2-stichproben-t-test-fur-gepaarte-abhangige-stichproben-ein-beispiel">
<h3>Der <span class="math notranslate nohighlight">\(2\)</span>-Stichproben <span class="math notranslate nohighlight">\(t\)</span>-Test für gepaarte (abhängige) Stichproben: Ein Beispiel<a class="headerlink" href="#der-2-stichproben-t-test-fur-gepaarte-abhangige-stichproben-ein-beispiel" title="Permalink to this headline">#</a></h3>
<p>Um praktische Erfahrungen zu sammeln, wenden wir den <strong>gepaarten <span class="math notranslate nohighlight">\(t\)</span>-Test</strong> in einer Übung an. Dazu laden wir den <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz. Sie können die Datei <code class="docutils literal notranslate"><span class="pre">students.csv</span></code> <a href="https://userpage.fu-berlin.de/soga/200/2010_data_sets/students.csv">hier</a> herunterladen. Importieren Sie den Datensatz und geben Sie ihm einen passenden Namen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lese Datei students.csv als Dataframe ein; Indexspalte wird übersprungen</span>
<span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../data/students.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Der <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz besteht aus <span class="math notranslate nohighlight">\(8239\)</span> Zeilen, von denen jede einen bestimmten Studenten repräsentiert, und <span class="math notranslate nohighlight">\(16\)</span> Spalten, von denen jede einer Variable/einem Merkmal entspricht, das sich auf diesen bestimmten Studenten bezieht. Diese selbsterklärenden Variablen sind: <em>stud_id, name, gender, age, height, weight, religion, nc_score, semester, major, minor, score1, score2, online_tutorial, graduated, salary.</em></p>
<p>Um den gepaarten <span class="math notranslate nohighlight">\(t\)</span>-Test für abhängige Stichproben zu veranschaulichen, <strong>interessieren wir uns für die Frage, ob ein Online-Tutorium zum Erlernen von Statistik den Studenten hilft, ihre Noten zu verbessern</strong>. Es gibt drei Variablen im Datensatz der Studenten, die von Interesse sind. Die Variable <code class="docutils literal notranslate"><span class="pre">online_tutorial</span></code> ist eine binäre Variable, die den Wert <span class="math notranslate nohighlight">\(1\)</span> annimmt, wenn der Student das Online-Tutorium zum Thema Statistik absolviert hat, und ansonsten den Wert <span class="math notranslate nohighlight">\(0\)</span>. Die Variablen <code class="docutils literal notranslate"><span class="pre">score1</span></code> und <code class="docutils literal notranslate"><span class="pre">score2</span></code> geben die Noten (<span class="math notranslate nohighlight">\(0-100\)</span>) für zwei Klausuren in Mathematik und Statistik an. Je höher der Wert ist, desto besser hat der jeweilige Studierende abgeschnitten. Bitte beachten Sie, dass die erste Prüfung stattfindet, bevor die Studierenden das Online-Tutorium zum Thema Statistik besucht haben. Die Teilnahme am Online-Tutorium zur Statistik ist nicht verpflichtend, die beiden Prüfungen sind jedoch für alle Studierenden obligatorisch. Die erste Prüfung (<code class="docutils literal notranslate"><span class="pre">score1</span></code>) findet zu Beginn des <span class="math notranslate nohighlight">\(3\)</span>. Semesters statt, die zweite Prüfung (<code class="docutils literal notranslate"><span class="pre">score2</span></code>) am Ende des <span class="math notranslate nohighlight">\(3\)</span>. Semesters.</p>
<p>Im Wesentlichen sind zwei Forschungsfragen von Interesse. <strong>Erstens wollen wir untersuchen, ob die Gruppe der Studierenden, die das Online-Tutorial zum Statistiklernen besucht hat, in der zweiten Prüfung besser abschneidet als in den ersten Prüfungen. Zweitens wird untersucht, wie die Gruppe der Studierenden, die nicht am Online-Tutorium für Statistik teilgenommen hat, bei beiden Prüfungen abgeschnitten hat.</strong></p>
</section>
<section id="id6">
<h3>Vorbereitung der Daten<a class="headerlink" href="#id6" title="Permalink to this headline">#</a></h3>
<p>Wir beginnen mit der ersten Forschungsfrage und konzentrieren uns auf die Studierenden, die das Online-Tutorial zum Thema Statistik besucht haben.</p>
<p>Für die Datenaufbereitung unterteilen wir den Datensatz anhand der Variable <code class="docutils literal notranslate"><span class="pre">online_tutorial</span></code>, die angibt, ob der Studierende das Tutorium besucht hat oder nicht (<span class="math notranslate nohighlight">\(1\)</span>=ja, <span class="math notranslate nohighlight">\(0\)</span>=nein). Dann ziehen wir eine Zufallsstichprobe von <span class="math notranslate nohighlight">\(65\)</span> Studenten aus dem Datensatz und extrahieren die beiden Variablen von Interesse, <code class="docutils literal notranslate"><span class="pre">score1</span></code> und <code class="docutils literal notranslate"><span class="pre">score2</span></code>. Wir speichern jede von ihnen in einem Vektor mit den Namen <code class="docutils literal notranslate"><span class="pre">score1_sample</span></code> und <code class="docutils literal notranslate"><span class="pre">score2_sample</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tutorial</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">students</span><span class="p">[</span><span class="s2">&quot;online_tutorial&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">65</span>
<span class="n">score1_sample</span> <span class="o">=</span> <span class="n">tutorial</span><span class="p">[</span><span class="s2">&quot;score1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">score2_sample</span> <span class="o">=</span> <span class="n">tutorial</span><span class="p">[</span><span class="s2">&quot;score2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Nun berechnen wir die gepaarten Differenzen, <span class="math notranslate nohighlight">\(d\)</span>, und stellen sie dar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">score1_sample</span> <span class="o">-</span> <span class="n">score2_sample</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;ID&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Unterschied der &#39;Scores&#39;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &quot;Unterschied der &#39;Scores&#39;&quot;)
</pre></div>
</div>
<img alt="_images/03_Hypothesentests_zwei_Grundgesamtheitsmittelwerte_156_1.png" src="_images/03_Hypothesentests_zwei_Grundgesamtheitsmittelwerte_156_1.png" />
</div>
</div>
<p>Das Diagramm sieht wie erwartet aus. Einige Studierende schneiden in der ersten Prüfung besser ab als in der zweiten Prüfung und umgekehrt.</p>
<p>Um die Normalverteilungsannahme zu überprüfen, stützen wir uns wiederum auf eine visuelle Inspektion eines <a href="https://de.wikipedia.org/wiki/Quantil-Quantil-Diagramm">Q-Q-Plots</a>. Wenn die Variable normalverteilt ist, sollte das Q-Q-Diagramm ungefähr linear sein. In Python können wir die Funktion <code class="docutils literal notranslate"><span class="pre">qqplot()</span></code> verwenden, um Q-Q-Plots zu erstellen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Erzeuge Q-Q Plot</span>
<span class="n">qqp</span> <span class="o">=</span> <span class="n">smi</span><span class="o">.</span><span class="n">qqplot</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">qqp</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Q-Q-Diagramm für Unterschiede </span><span class="se">\n</span><span class="s2"> in den Prüfungsergebnissen&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Theoretische Quantillen&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Stichproben Quantillen&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Stichproben Quantillen&#39;)
</pre></div>
</div>
<img alt="_images/03_Hypothesentests_zwei_Grundgesamtheitsmittelwerte_158_1.png" src="_images/03_Hypothesentests_zwei_Grundgesamtheitsmittelwerte_158_1.png" />
</div>
</div>
<p>Die Daten sind nicht sehr genau und etwas verrauscht, aber sie scheinen ungefähr normalverteilt zu sein.</p>
<p>Wir berechnen weiter <span class="math notranslate nohighlight">\(\bar d\)</span> den Mittelwert der gepaarten Differenzen</p>
<div class="math notranslate nohighlight">
\[\bar d = \frac{\sum d}{n}\text{,}\]</div>
<p>und <span class="math notranslate nohighlight">\(s_d\)</span>, die Standardabweichung der gepaarten Unterschiede für zwei Stichproben</p>
<div class="math notranslate nohighlight">
\[s_d = \sqrt{\frac{\sum d^2 - \frac{(\sum d)^2}{n}}{n-1}}\text{.}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># gepaarte Differenz</span>
<span class="n">d_bar</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">d_bar</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.7538461538461538
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Standardabweichung</span>
<span class="n">s_d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="nb">sum</span><span class="p">(</span><span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)))</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">s_d</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.836391139947831
</pre></div>
</div>
</div>
</div>
</section>
<section id="id7">
<h3>Überprüfung der Hypothesen<a class="headerlink" href="#id7" title="Permalink to this headline">#</a></h3>
<p>Jetzt sind wir bereit, den <strong>gepaarten <span class="math notranslate nohighlight">\(t\)</span>-Test</strong> anzuwenden. Erinnern Sie sich an unsere erste Forschungsfrage: <strong>Lassen die Daten den Schluss zu, dass sich die durchschnittlichen Prüfungsergebnisse verbessern, wenn die Studierenden ein Online-Tutorial zum Thema Statistik besuchen?</strong></p>
<p>Wir folgen dem schrittweisen Implementierungsverfahren für Hypothesentests.</p>
<p><strong>Schritt 1 : Geben Sie die Nullhypothese <span class="math notranslate nohighlight">\(H_0\)</span> und alternative Hypothese <span class="math notranslate nohighlight">\(H_A\)</span> an</strong></p>
<p>Die Nullhypothese besagt, dass es keinen Unterschied im Mittelwert der Prüfungsnoten der einen Prüfung im Vergleich zur anderen gibt.</p>
<div class="math notranslate nohighlight">
\[H_0: \quad \mu_1 = \mu_2\]</div>
<p>Erinnern Sie sich daran, dass die Formulierung der Alternativhypothese vorgibt, ob wir einen zweiseitigen, einen links- oder einen rechtsseitigen Hypothesentest durchführen.</p>
<p><strong>Alternative Hypothese</strong></p>
<div class="math notranslate nohighlight">
\[H_A: \quad \mu_1 &lt; \mu_2\]</div>
<p>Diese Formulierung führt zu einem linksseitigen Hypothesentest und besagt, dass die Studenten im Durchschnitt bei der zweiten Prüfung besser abschneiden.</p>
<p><strong>Schritt 2: Legen Sie das Signifikanzniveau,<span class="math notranslate nohighlight">\(\alpha\)</span> fest</strong></p>
<div class="math notranslate nohighlight">
\[\alpha = 0,05\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Schritt 3 und 4: Berechnen Sie den Wert der Teststatistik und den <span class="math notranslate nohighlight">\(p\)</span>-Wert</strong></p>
<p>Zur Veranschaulichung berechnen wir die Teststatistik manuell in Python. Erinnern Sie sich an die obige Gleichungsform:</p>
<div class="math notranslate nohighlight">
\[t= \frac{\bar d - (\mu_1-\mu_2)}{\frac{s_d}{\sqrt{n}}}\]</div>
<p>Wenn <span class="math notranslate nohighlight">\(H_0\)</span> wahr ist, dann ist <span class="math notranslate nohighlight">\(μ_1-μ_2=0\)</span> und somit vereinfacht sich die Gleichung zu</p>
<div class="math notranslate nohighlight">
\[t= \frac{\bar d}{\frac{s_d}{\sqrt{n}}}\text{.}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne Teststatistik</span>

<span class="c1"># gepaarte Differenz</span>
<span class="n">d_bar</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

<span class="c1"># Standardabweichung</span>
<span class="n">s_d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="nb">sum</span><span class="p">(</span><span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)))</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Teststatistik</span>
<span class="n">tw</span> <span class="o">=</span> <span class="n">d_bar</span> <span class="o">/</span> <span class="p">(</span><span class="n">s_d</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)))</span>
<span class="n">tw</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-2.4227231184673745
</pre></div>
</div>
</div>
</div>
<p>Der numerische Wert der Teststatistik ist <span class="math notranslate nohighlight">\(-2,422723\)</span>.</p>
<p>Um den <span class="math notranslate nohighlight">\(p\)</span>-Wert zu berechnen, wenden wir die Funktion <code class="docutils literal notranslate"><span class="pre">t.cdf()</span></code> an. Erinnern Sie sich daran, wie man die Freiheitsgrade berechnet.</p>
<div class="math notranslate nohighlight">
\[df = n - 1= 64\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne p-Wert</span>
<span class="n">df</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">tw</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.009122595661033035
</pre></div>
</div>
</div>
</div>
<p><strong>Schritt 5: Wenn <span class="math notranslate nohighlight">\(p \le \alpha , H_0\)</span> ablehnen; ansonsten <span class="math notranslate nohighlight">\(H_0\)</span> nicht ablehnen</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">&lt;=</span> <span class="n">alpha</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>Der <span class="math notranslate nohighlight">\(p\)</span>-Wert ist kleiner als das angegebene Signifikanzniveau von <span class="math notranslate nohighlight">\(0,05\)</span>; wir verwerfen <span class="math notranslate nohighlight">\(H_0\)</span>. Die Testergebnisse sind statistisch signifikant auf dem <span class="math notranslate nohighlight">\(5 \%\)</span>-Niveau und liefern einen sehr starken Beweis gegen die Nullhypothese.</p>
<p><strong>Schritt 6: Interpretieren Sie das Ergebnis des Hypothesentests</strong></p>
<p><span class="math notranslate nohighlight">\(p=0,009123\)</span>. Bei einem Signifikanzniveau von <span class="math notranslate nohighlight">\(5 \%\)</span> lassen die Daten den Schluss zu, dass sich die Prüfungsnoten der Studierenden nach der Teilnahme an einem Online-Tutorium für Statistik verbessern.</p>
</section>
<section id="id8">
<h3>Hypothesentests in Python<a class="headerlink" href="#id8" title="Permalink to this headline">#</a></h3>
<p>Wir haben soeben manuell einen gepaarten <span class="math notranslate nohighlight">\(t\)</span>-Test in Python durchgeführt. Das ist gut, aber jetzt nutzen wir die ganze Macht von Python, um das gleiche Ergebnis wie oben mit nur einer Zeile Code zu erhalten!</p>
<p>Um einen gepaarten <span class="math notranslate nohighlight">\(t\)</span>-Test in Python durchzuführen, verwenden wir die Funktion <code class="docutils literal notranslate"><span class="pre">ttest_rel()</span></code>. Wir geben zwei Vektoren als Dateneingabe an und wir setzen das Argument <code class="docutils literal notranslate"><span class="pre">alternative</span></code> auf <code class="docutils literal notranslate"><span class="pre">alternative</span> <span class="pre">=</span> <span class="pre">'less'</span></code>, um auf <span class="math notranslate nohighlight">\(HA:\mu_1 \lt \mu_2\)</span> zu testen</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ttest_rel</span><span class="p">(</span><span class="n">score1_sample</span><span class="p">,</span> <span class="n">score2_sample</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;less&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ttest_relResult(statistic=-2.4227231184673745, pvalue=0.009122595661033035)
</pre></div>
</div>
</div>
</div>
<p>Großartig! Vergleichen Sie die Ausgabe der Funktion <code class="docutils literal notranslate"><span class="pre">ttest_rel()</span></code> mit unserem Ergebnis von oben. Sie stimmen perfekt überein! Auch hier können wir schlussfolgern, dass die Daten bei einem Signifikanzniveau von <span class="math notranslate nohighlight">\(5 \%\)</span> einen sehr starken Hinweis darauf liefern, dass sich die Prüfungsnoten der Studenten nach der Teilnahme an einem Online-Tutorium für Statistik verbessern.</p>
<p>Bevor wir fortfahren, muss noch eine Forschungsfrage beantwortet werden. Was ist, wenn es andere Gründe für die besseren Noten in der zweiten Prüfung gibt? Was ist, wenn die zweite Prüfung viel einfacher war? Was wäre, wenn die Studenten einen tollen Dozenten hatten und sich dadurch im Laufe des Semesters verbessert haben? Wir testen diese Hypothese, indem wir einen gepaarten <span class="math notranslate nohighlight">\(t\)</span>-Test durchführen, und zwar explizit für die Studierenden, die nicht am Online-Tutorium für Statistik teilgenommen haben. Da wir mit der Python-Maschinerie bestens vertraut sind, führen wir einen gepaarten <span class="math notranslate nohighlight">\(t\)</span>-Test mit nur wenigen Zeilen Code durch.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">no_tutorial</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">students</span><span class="p">[</span><span class="s2">&quot;online_tutorial&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">65</span>


<span class="n">score1_no_tutorial</span> <span class="o">=</span> <span class="n">no_tutorial</span><span class="p">[</span><span class="s2">&quot;score1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">score2_no_tutorial</span> <span class="o">=</span> <span class="n">no_tutorial</span><span class="p">[</span><span class="s2">&quot;score2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># führe paired t-test durch</span>
<span class="n">statistics</span><span class="p">,</span> <span class="n">pvalue</span> <span class="o">=</span> <span class="n">ttest_rel</span><span class="p">(</span>
    <span class="n">score1_no_tutorial</span><span class="p">,</span> <span class="n">score2_no_tutorial</span><span class="p">,</span> <span class="n">nan_policy</span><span class="o">=</span><span class="s2">&quot;omit&quot;</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;less&quot;</span>
<span class="p">)</span>
<span class="n">ttest_rel</span><span class="p">(</span><span class="n">score1_no_tutorial</span><span class="p">,</span> <span class="n">score2_no_tutorial</span><span class="p">,</span> <span class="n">nan_policy</span><span class="o">=</span><span class="s2">&quot;omit&quot;</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;less&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ttest_relResult(statistic=2.1307181194375913, pvalue=0.9771439852770387)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pvalue</span> <span class="o">&lt;=</span> <span class="n">alpha</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<p>Der <span class="math notranslate nohighlight">\(p\)</span>-Wert ist größer als das angegebene Signifikanzniveau von <span class="math notranslate nohighlight">\(0,05\)</span>; wir verwerfen <span class="math notranslate nohighlight">\(H_0\)</span> nicht. Die Testergebnisse sind auf dem <span class="math notranslate nohighlight">\(5 \%\)</span>-Niveau statistisch signifikant und liefern keinen ausreichenden Beweis gegen die Nullhypothese.</p>
<p>Bei einem Signifikanzniveau von <span class="math notranslate nohighlight">\(5 \%\)</span> liefern die Daten keine ausreichende Evidenz für die Schlussfolgerung, dass sich die Prüfungsnoten der Studierenden, die nicht am Online-Tutorium teilgenommen haben, verbessert haben.</p>
</section>
</section>
<span id="document-Kapitel06/04_Standardabweichung_der_Grundgesamtheit"></span><section id="inferenz-fur-die-standardabweichung-der-grundgesamtheit">
<h2>Inferenz für die Standardabweichung der Grundgesamtheit<a class="headerlink" href="#inferenz-fur-die-standardabweichung-der-grundgesamtheit" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<p>Bisher haben wir Methoden der Inferenzstatistik erörtert, die sich auf Aussagen über einen oder mehrere Grundgesamtheitsmittelwerte konzentrieren. In den folgenden Abschnitten betrachten wir Methoden der Inferenzstatistik, die Aussagen über die Varianzen (oder Standardabweichungen) der Grundgesamtheit liefern. Wir erinnern daran, dass die Varianz (<span class="math notranslate nohighlight">\(\sigma^2\)</span>) und die Standardabweichung (<span class="math notranslate nohighlight">\(\sigma\)</span>) ein Maß für die Streuung und Variabilität einer Variablen sind.</p>
</section>
<section id="inferenz-fur-die-standardabweichung-einer-grundgesamtheit">
<h2>Inferenz für die Standardabweichung einer Grundgesamtheit<a class="headerlink" href="#inferenz-fur-die-standardabweichung-einer-grundgesamtheit" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">sample</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">smi</span>
</pre></div>
</div>
</div>
</div>
<p>Inferenz für eine Grundgesamtheitsstandardabweichung basiert auf der <a href="https://de.wikipedia.org/wiki/Chi-Quadrat-Verteilung">Chi-Quadrat (<span class="math notranslate nohighlight">\(\chi^2\)</span>)-Verteilung</a>. Eine <span class="math notranslate nohighlight">\(\chi^2\)</span>-Verteilung ist eine rechtsschiefe Wahrscheinlichkeitsdichtekurve. Die Form der <span class="math notranslate nohighlight">\(\chi^2\)</span>-Kurve wird durch ihre Freiheitsgrade (<span class="math notranslate nohighlight">\(df\)</span>) bestimmt.</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chi2</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">df</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="k">for</span> <span class="n">_df</span> <span class="ow">in</span> <span class="n">df</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">chi2</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">_df</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;df=</span><span class="si">{</span><span class="n">_df</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s2">&quot;$\chi^2$-Warscheinlichkeitsdichtefunktion mit unterschiedlichen Freiheitsgraden (df)&quot;</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.lines.Line2D at 0x7fb5b4c6a980&gt;
</pre></div>
</div>
<img alt="_images/04_Standardabweichung_der_Grundgesamtheit_6_1.png" src="_images/04_Standardabweichung_der_Grundgesamtheit_6_1.png" />
</div>
</div>
<p>Um einen Hypothesentest für eine Populationsstandardabweichung durchzuführen, wird ein <span class="math notranslate nohighlight">\(\chi^2\)</span>-Wert mit einer bestimmten Fläche unter einer <span class="math notranslate nohighlight">\(\chi^2\)</span>-Kurve in Beziehung gesetzt. Entweder wir ziehen eine <span class="math notranslate nohighlight">\(\chi^2\)</span>-Tabelle, um diesen Wert nachzuschlagen, oder wir machen von der Python-Maschinerie Gebrauch.</p>
<p>Bei gegebenen <span class="math notranslate nohighlight">\(\alpha\)</span>, wobei <span class="math notranslate nohighlight">\(\alpha\)</span> einer Wahrscheinlichkeit zwischen <span class="math notranslate nohighlight">\(0\)</span> und <span class="math notranslate nohighlight">\(1\)</span> entspricht, bezeichnet <span class="math notranslate nohighlight">\(\chi^2_\alpha\)</span> den <span class="math notranslate nohighlight">\(\chi^2\)</span> -Wert, der die Fläche <span class="math notranslate nohighlight">\(\alpha\)</span> zu seiner Rechten unter einer <span class="math notranslate nohighlight">\(\chi^2\)</span> -Kurve hat.</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chi2</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">df</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.9</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">chi2</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.02</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span>
    <span class="n">chi2</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">),</span>
    <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">ymax</span><span class="o">=</span><span class="n">chi2</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">chi2</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">),</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">),</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">chi2</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">chi2</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\chi^2$-Dichtefunktion, $df=5$, $\alpha=0.1$&quot;</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;$\chi^2$&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mf">0.075</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;Fläche = 0.1&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.018</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;$\chi^2_</span><span class="si">{0.1}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">chi2</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Fläche = $1 - \alpha$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.07</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(2.5, 0.07, &#39;Fläche = $1 - \\alpha$&#39;)
</pre></div>
</div>
<img alt="_images/04_Standardabweichung_der_Grundgesamtheit_8_1.png" src="_images/04_Standardabweichung_der_Grundgesamtheit_8_1.png" />
</div>
</div>
<section id="intervall-schatzung-von-sigma">
<h3>Intervall-Schätzung von <span class="math notranslate nohighlight">\(\sigma\)</span><a class="headerlink" href="#intervall-schatzung-von-sigma" title="Permalink to this headline">#</a></h3>
<p>Das <span class="math notranslate nohighlight">\(100(1-\alpha)\%\)</span>-Konfidenzintervall für <span class="math notranslate nohighlight">\(\sigma\)</span> beträgt</p>
<div class="math notranslate nohighlight">
\[\sqrt{\frac{n-1}{\chi^2_{\alpha/2}}} \le \sigma \le \sqrt{\frac{n-1}{\chi^2_{1-\alpha/2}} }\]</div>
</section>
<section id="chi-2-test-auf-standardabweichung">
<h3><span class="math notranslate nohighlight">\(\chi^2\)</span>-Test auf Standardabweichung<a class="headerlink" href="#chi-2-test-auf-standardabweichung" title="Permalink to this headline">#</a></h3>
<p>Das Hypothesentestverfahren für eine Standardabweichung wird als <strong><span class="math notranslate nohighlight">\(\chi^2\)</span>-Test auf Standardabweichung</strong> bezeichnet. Hypothesentests für Varianzen folgen demselben schrittweisen Verfahren wie Hypothesentests für den Mittelwert.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{l}
\hline
\ \text{Schritt 1}  &amp; \text{Geben Sie die Nullhypothese } H_0 \text{ und alternative Hypothese } H_A \text{ an.}\\
\ \text{Schritt 2}  &amp; \text{Legen Sie das Signifikanzniveau, } \alpha\text{ fest.} \\
\ \text{Schritt 3}  &amp; \text{Berechnen Sie den Wert der Teststatistik.} \\
\ \text{Schritt 4} &amp;\text{Bestimmen Sie den p-Wert.} \\
\ \text{Schritt 5} &amp; \text{Wenn }p \le \alpha \text{, } H_0 \text{ ablehnen } \text{; ansonsten } H_0 \text{ nicht ablehnen} \text{.} \\
\ \text{Schritt 6} &amp;\text{Interpretieren Sie das Ergebnis des Hypothesentests.} \\
\hline 
\end{array}
\end{split}\]</div>
<p>Die Teststatistik für einen Hypothesentest mit der Nullhypothese <span class="math notranslate nohighlight">\(H_0: \,\sigma = \sigma_0\)</span> für eine normalverteilte Variable ist gegeben durch</p>
<div class="math notranslate nohighlight">
\[\chi^2 = \frac{n-1}{\sigma^2_0}s^2\]</div>
<p>wobei <span class="math notranslate nohighlight">\(n\)</span> der Stichprobenumfang und <span class="math notranslate nohighlight">\(s\)</span> die Standardabweichung der Stichprobendaten ist.</p>
<p>Die Variable folgt einer <span class="math notranslate nohighlight">\(\chi^2\)</span>-Verteilung mit <span class="math notranslate nohighlight">\(n-1\)</span> Freiheitsgraden.</p>
<p>Beachten Sie, dass der Test auf eine Standardabweichung <span class="math notranslate nohighlight">\(\chi^2\)</span>-Test nicht robust gegenüber Abweichungen von der Normalverteilung ist (Weiss 2010).</p>
</section>
<section id="chi-2-test-auf-standardabweichung-ein-beispiel">
<h3><span class="math notranslate nohighlight">\(\chi^2\)</span> -Test auf Standardabweichung : Ein Beispiel<a class="headerlink" href="#chi-2-test-auf-standardabweichung-ein-beispiel" title="Permalink to this headline">#</a></h3>
<p>Um praktische Erfahrungen zu sammeln, wenden wir den <span class="math notranslate nohighlight">\(\chi^2\)</span>-Test mit einer Standardabweichung in einer Übung an. Dazu laden wir den <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz. Sie können die Datei <code class="docutils literal notranslate"><span class="pre">students.csv</span></code> <a href="https://userpage.fu-berlin.de/soga/200/2010_data_sets/students.csv">hier</a> herunterladen. Importieren Sie den Datensatz und geben Sie ihm einen passenden Namen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lese Datei students.csv als Dataframe ein; Indexspalte wird übersprungen</span>
<span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../data/students.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Der <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz besteht aus <span class="math notranslate nohighlight">\(8239\)</span> Zeilen, von denen jede einen bestimmten Studenten repräsentiert, und <span class="math notranslate nohighlight">\(16\)</span> Spalten, von denen jede einer Variable/einem Merkmal entspricht, das sich auf diesen bestimmten Studenten bezieht. Diese selbsterklärenden Variablen sind: <em>stud_id, name, gender, age, height, weight, religion, nc_score, semester, major, minor, score1, score2, online_tutorial, graduated, salary.</em></p>
<p>Um den <strong><span class="math notranslate nohighlight">\(\chi^2\)</span>-Test auf Standardabweichung</strong> zu demonstrieren, untersuchen wir die Streuung der Körpergröße in cm der Studentinnen und vergleichen sie mit der Streuung der Körpergröße aller Studenten (unserer Grundgesamtheit). <strong>Wir wollen testen, ob die Standardabweichung der Körpergröße der Studentinnen kleiner ist als die Standardabweichung der Körpergröße aller Studenten.</strong></p>
</section>
<section id="vorbereitung-der-daten">
<h3>Vorbereitung der Daten<a class="headerlink" href="#vorbereitung-der-daten" title="Permalink to this headline">#</a></h3>
<p>Wir beginnen mit der Datenaufbereitung.</p>
<ul class="simple">
<li><p>Zunächst definieren wir die Standardabweichung der Grundgesamtheit. In unserem Beispiel entspricht die Grundgesamtheit der Körpergröße aller <span class="math notranslate nohighlight">\(8239\)</span> Studenten im Datensatz. Wir berechnen die Standardabweichung für die Variable <code class="docutils literal notranslate"><span class="pre">height</span></code> und weisen ihr den Variablennamen <code class="docutils literal notranslate"><span class="pre">sigma0</span></code> zu.</p></li>
<li><p>Zweitens unterteilen wir den Datensatz anhand der Variable <code class="docutils literal notranslate"><span class="pre">gender</span></code>.</p></li>
<li><p>Drittens nehmen wir eine Stichprobe von <span class="math notranslate nohighlight">\(30\)</span> Studentinnen und extrahieren die interessierende Statistik, die Standardabweichung der Größe der Studentinnen in unserer Stichprobe.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sigma0</span> <span class="o">=</span> <span class="n">students</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">sigma0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11.077529134763823
</pre></div>
</div>
</div>
</div>
<p>Die Standardabweichung der interessierenden Grundgesamtheit (<span class="math notranslate nohighlight">\(\sigma_0\)</span>) beträgt <span class="math notranslate nohighlight">\(\approx\)</span> <span class="math notranslate nohighlight">\(11,08\)</span> cm.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">female</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">students</span><span class="p">[</span><span class="s2">&quot;gender&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Female&quot;</span><span class="p">]</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">female_sample</span> <span class="o">=</span> <span class="n">female</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sample_std</span> <span class="o">=</span> <span class="n">female_sample</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Außerdem überprüfen wir die Normalverteilungsannahme, indem wir ein <a href="https://de.wikipedia.org/wiki/Quantil-Quantil-Diagramm">Q-Q-Diagramm</a> erstellen. In Python können wir die Funktion <code class="docutils literal notranslate"><span class="pre">qqplot()</span></code> verwenden, um Q-Q-Plots zu erstellen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Erzeuge Q-Q Plot</span>
<span class="n">qqp</span> <span class="o">=</span> <span class="n">smi</span><span class="o">.</span><span class="n">qqplot</span><span class="p">(</span><span class="n">female_sample</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">qqp</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s2">&quot;Q-Q-Diagramm für die Körpergrösse der </span><span class="se">\n</span><span class="s2"> in der Stichprobe befindlichen Studentinnen&quot;</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Theoretische Quantillen&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Stichproben Quantillen&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Stichproben Quantillen&#39;)
</pre></div>
</div>
<img alt="_images/04_Standardabweichung_der_Grundgesamtheit_30_1.png" src="_images/04_Standardabweichung_der_Grundgesamtheit_30_1.png" />
</div>
</div>
<p>Wir sehen, dass die Daten ungefähr auf einer Geraden liegen. Auf der Grundlage des grafischen Auswertungsansatzes kommen wir zu dem Schluss, dass die interessierende Variable ungefähr normalverteilt ist.</p>
</section>
<section id="uberprufung-der-hypothesen">
<h3>Überprüfung der Hypothesen<a class="headerlink" href="#uberprufung-der-hypothesen" title="Permalink to this headline">#</a></h3>
<p>Zur Durchführung des <strong><span class="math notranslate nohighlight">\(\chi^2\)</span>-Tests auf Standardabweichung</strong> folgen wir dem Verfahren der schrittweisen Durchführung von Hypothesentests.</p>
<p><strong>Schritt 1 : Geben Sie die Nullhypothese <span class="math notranslate nohighlight">\(H_0\)</span> und alternative Hypothese <span class="math notranslate nohighlight">\(H_A\)</span> an</strong></p>
<p>Die Nullhypothese besagt, dass die Standardabweichung der Körpergröße der Studentinnen (<span class="math notranslate nohighlight">\(\sigma\)</span>) gleich der Standardabweichung der Grundgesamtheit (<span class="math notranslate nohighlight">\(\sigma_0 \approx 11,08\)</span> cm) ist.</p>
<div class="math notranslate nohighlight">
\[H_0: \quad \sigma = \sigma_0\]</div>
<p><strong>Alternative Hypothese</strong></p>
<div class="math notranslate nohighlight">
\[H_A: \quad \sigma &lt; \sigma_0\]</div>
<p>Diese Formulierung führt zu einem linksseitigen Hypothesentest.</p>
<p><strong>Schritt 2: Legen Sie das Signifikanzniveau,<span class="math notranslate nohighlight">\(\alpha\)</span> fest</strong></p>
<div class="math notranslate nohighlight">
\[\alpha = 0,05\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Schritt 3 und 4: Berechnen Sie den Wert der Teststatistik und den <span class="math notranslate nohighlight">\(p\)</span>-Wert</strong></p>
<p>Zur Veranschaulichung berechnen wir die Teststatistik manuell in Python. Erinnern Sie sich an die Gleichung für die Teststatistik von oben:</p>
<div class="math notranslate nohighlight">
\[\chi^2 = \frac{n-1}{\sigma^2_0}s^2\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne Teststatistik</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">female_sample</span><span class="p">)</span>
<span class="n">s_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">female_sample</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sigma0_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">students</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">],</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">sigma0_2</span><span class="p">)</span> <span class="o">*</span> <span class="n">s_2</span>
<span class="n">x2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>14.272211660048107
</pre></div>
</div>
</div>
</div>
<p>Der numerische Wert der Teststatistik ist <span class="math notranslate nohighlight">\(14,27221166\)</span>.</p>
<p>Um den <span class="math notranslate nohighlight">\(p\)</span>-Wert zu berechnen, wenden wir die Funktion <code class="docutils literal notranslate"><span class="pre">chi2.ppf()</span></code> an. Erinnern Sie sich daran, wie man die Freiheitsgrade berechnet:</p>
<div class="math notranslate nohighlight">
\[df=n-1\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne df</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span>

<span class="c1"># Berechne p-Wert</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">chi2</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.010089951471801363
</pre></div>
</div>
</div>
</div>
<p><strong>Schritt 5: Wenn <span class="math notranslate nohighlight">\(p \le \alpha , H_0\)</span> ablehnen; ansonsten <span class="math notranslate nohighlight">\(H_0\)</span> nicht ablehnen</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">&lt;=</span> <span class="n">alpha</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>Der <span class="math notranslate nohighlight">\(p\)</span>-Wert ist kleiner als das angegebene Signifikanzniveau von <span class="math notranslate nohighlight">\(0,05\)</span>; wir verwerfen <span class="math notranslate nohighlight">\(H_0\)</span>. Die Testergebnisse sind statistisch signifikant auf dem <span class="math notranslate nohighlight">\(5 \%\)</span>-Niveau und liefern starke Beweise gegen die Nullhypothese.</p>
<p><strong>Schritt 6: Interpretieren Sie das Ergebnis des Hypothesentests</strong></p>
<p><span class="math notranslate nohighlight">\(p=0,01008995\)</span>. Bei einem Signifikanzniveau von <span class="math notranslate nohighlight">\(5 \%\)</span> lassen die Daten den Schluss zu, dass die Standardabweichung der Körpergröße von Studentinnen weniger als <span class="math notranslate nohighlight">\(11\)</span> cm beträgt.</p>
</section>
<section id="hypothesentests-in-python">
<h3>Hypothesentests in Python<a class="headerlink" href="#hypothesentests-in-python" title="Permalink to this headline">#</a></h3>
<p>Wir haben gerade einen <span class="math notranslate nohighlight">\(\chi^2\)</span>-Test mit einer Standardabweichung in Python manuell durchgeführt. Meines Wissens bietet Python keine eingebaute Funktion zur Berechnung eines Standardabweichung <span class="math notranslate nohighlight">\(\chi^2\)</span>-Test. Wir können jedoch eine solche Funktion selbst implementieren. Unsere Funktion <code class="docutils literal notranslate"><span class="pre">simple_chi2_test()</span></code> nimmt als Eingabe einen Stichprobenvektor <code class="docutils literal notranslate"><span class="pre">x</span></code>, die Standardabweichung der Grundgesamtheit <code class="docutils literal notranslate"><span class="pre">sigma0</span></code>, das Signifikanzniveau <code class="docutils literal notranslate"><span class="pre">alpha</span></code> und die angegebene Methode, <code class="docutils literal notranslate"><span class="pre">right</span></code>, <code class="docutils literal notranslate"><span class="pre">left</span></code> und <code class="docutils literal notranslate"><span class="pre">two-sided</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">simple_chi2_test</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sigma0</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;two-sided&quot;</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Berechne Teststatistik</span>
    <span class="n">testchi</span> <span class="o">=</span> <span class="n">df</span> <span class="o">/</span> <span class="p">(</span><span class="n">sigma0</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">v</span>

    <span class="c1"># linksseitiger Test</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">chi2</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">testchi</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
    <span class="c1"># rechtsseitiger Test</span>
    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">chi2</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">testchi</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>

    <span class="c1"># beidseitiger Test (default)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">p_upper</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">chi2</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">testchi</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
        <span class="n">p_lower</span> <span class="o">=</span> <span class="n">chi2</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">testchi</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">p_upper</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">p_lower</span> <span class="o">*</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">p_upper</span> <span class="o">*</span> <span class="mi">2</span>
    <span class="c1"># evaluiere p &lt; alpha</span>
    <span class="k">if</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
        <span class="n">reject</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">reject</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># Ausgabe</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Significance level:&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Degrees of freedom:&quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test statistic:&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">testchi</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p-value:&quot;</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Reject H0:&quot;</span><span class="p">,</span> <span class="n">reject</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Wenden wir nun unsere selbst erstellte Funktion <code class="docutils literal notranslate"><span class="pre">simple_x2_test()</span></code> auf die obigen Beispieldaten an.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simple_chi2_test</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">female_sample</span><span class="p">,</span> <span class="n">sigma0</span><span class="o">=</span><span class="n">sigma0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Significance level: 0.05
Degrees of freedom: 29
Test statistic: 14.2722
p-value: 0.010089951471801363
Reject H0: True
</pre></div>
</div>
</div>
</div>
<p>Perfekt! Vergleichen Sie die Ausgabe der Funktion <code class="docutils literal notranslate"><span class="pre">simple_chi2_test()</span></code> mit unserem Ergebnis von oben. Auch hier können wir zu dem Schluss kommen, dass die Daten bei einem Signifikanzniveau von <span class="math notranslate nohighlight">\(5 \%\)</span> starke Anhaltspunkte dafür liefern, dass die Standardabweichung der Körpergröße von Studentinnen weniger als <span class="math notranslate nohighlight">\(11\)</span> cm beträgt.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="c1"># Load the &quot;autoreload&quot; extension</span>
<span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="c1"># always reload modules</span>
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="c1"># black formatter for jupyter notebooks</span>
<span class="c1"># %load_ext nb_black</span>
<span class="c1"># black formatter for jupyter lab</span>
<span class="o">%</span><span class="k">load_ext</span> lab_black

<span class="o">%</span><span class="k">run</span> ../../src/notebook_env.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
The lab_black extension is already loaded. To reload it, use:
  %reload_ext lab_black

---------------------------------
Working on the host: imarevic-pc

---------------------------------
Python version: 3.10.9 | packaged by conda-forge | (main, Feb  2 2023, 20:20:04) [GCC 11.3.0]

---------------------------------
Python interpreter: /home/imarevic/anaconda3/envs/srh/bin/python
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 864x432 with 0 Axes&gt;
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="inferenz-fur-standardabweichungen-zweier-grundgesamtheiten">
<h2>Inferenz für Standardabweichungen zweier Grundgesamtheiten<a class="headerlink" href="#inferenz-fur-standardabweichungen-zweier-grundgesamtheiten" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">sample</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">f</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">smi</span>
</pre></div>
</div>
</div>
</div>
<p>In diesem Abschnitt werden Hypothesentests für die Standardabweichungen zweier Grundgesamtheiten behandelt. Oder anders ausgedrückt, wir erörtern Methoden der Inferenz für die Standardabweichungen einer Variablen aus zwei verschiedenen Grundgesamtheiten. Diese Methoden beruhen auf der <a href="https://de.wikipedia.org/wiki/F-Verteilung"><span class="math notranslate nohighlight">\(F\)</span>-Verteilung</a>, benannt zu Ehren von <a href="https://de.wikipedia.org/wiki/Ronald_Aylmer_Fisher">Sir Ronald Aylmer Fisher</a>.</p>
<p>Die <span class="math notranslate nohighlight">\(F\)</span>-Verteilung ist eine rechtsschiefe Wahrscheinlichkeitsdichteverteilung mit zwei Formparametern, <span class="math notranslate nohighlight">\(v_1\)</span> und <span class="math notranslate nohighlight">\(v_2\)</span>, den Freiheitsgraden für den Zähler (<span class="math notranslate nohighlight">\(v_1\)</span>) und den Freiheitsgraden für den Nenner (<span class="math notranslate nohighlight">\(v_2\)</span>).</p>
<div class="math notranslate nohighlight">
\[df = (v_1,v_2)\]</div>
<p>Wie bei jeder anderen Dichtekurve entspricht die Fläche unter der Kurve der <span class="math notranslate nohighlight">\(F\)</span>-Verteilung den Wahrscheinlichkeiten. Die Fläche unter der Kurve und damit die Wahrscheinlichkeit für ein gegebenes Intervall und einen gegebenen <span class="math notranslate nohighlight">\(df\)</span>-Wert wird mittels Software berechnet. Alternativ kann man sie auch in einer <a href="https://www.itl.nist.gov/div898/handbook/eda/section3/eda3673.htm">Tabelle</a> nachschlagen. In diesen Tabellen werden im Allgemeinen die Freiheitsgrade für den Zähler (<span class="math notranslate nohighlight">\(v_1\)</span>) am oberen Rand angezeigt, während die Freiheitsgrade für den Nenner (<span class="math notranslate nohighlight">\(v_2\)</span>) in den äußeren Spalten auf der linken Seite angezeigt werden.</p>
<p>Um einen Hypothesentest für zwei Grundgesamtheitsstandardabweichungen durchzuführen, wird der Wert berechnet, der einer bestimmten Fläche unter einer <span class="math notranslate nohighlight">\(F\)</span>-Kurve entspricht, berechnet.</p>
<p>Für gegebenes <span class="math notranslate nohighlight">\(\alpha\)</span>,wobei <span class="math notranslate nohighlight">\(\alpha\)</span> einer Wahrscheinlichkeit zwischen <span class="math notranslate nohighlight">\(0\)</span> und <span class="math notranslate nohighlight">\(1\)</span> entspricht, bezeichnet <span class="math notranslate nohighlight">\(F_\alpha\)</span> den Wert, der eine Fläche <span class="math notranslate nohighlight">\(\alpha\)</span> zu seiner Rechten unter einer <span class="math notranslate nohighlight">\(F\)</span>-Kurve hat.</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chi2</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">v1</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">v2</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span>
    <span class="n">f</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">),</span>
    <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">ymax</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">),</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">),</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">f</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$F$-Dichtefunktion, $df(v1=9, v2=14)$, $\alpha=0.05$&quot;</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;F-Kurve&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;Fläche = 0.05&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">2.9</span><span class="p">,</span> <span class="mf">0.015</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;$F_</span><span class="si">{0.05}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.08</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Fläche = $1 - \alpha$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="n">ticks</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.axis.XTick at 0x7fb5b026ff40&gt;,
 &lt;matplotlib.axis.XTick at 0x7fb5b026ff70&gt;,
 &lt;matplotlib.axis.XTick at 0x7fb5b026d300&gt;,
 &lt;matplotlib.axis.XTick at 0x7fb5b02ab0a0&gt;,
 &lt;matplotlib.axis.XTick at 0x7fb5b01fd120&gt;,
 &lt;matplotlib.axis.XTick at 0x7fb5b026df90&gt;]
</pre></div>
</div>
<img alt="_images/04_Standardabweichung_der_Grundgesamtheit_67_1.png" src="_images/04_Standardabweichung_der_Grundgesamtheit_67_1.png" />
</div>
</div>
<p>In der obigen Abbildung ergibt <span class="math notranslate nohighlight">\(F_{0,05}\)</span> für <span class="math notranslate nohighlight">\(df=(9,14)\)</span> den Wert <span class="math notranslate nohighlight">\(\approx 2,6458\)</span>.</p>
<p>Eine interessante Eigenschaft von <span class="math notranslate nohighlight">\(F\)</span>-Kurven ist die <strong>reziproke Charakteristik</strong>. Sie besagt, dass für eine <span class="math notranslate nohighlight">\(F\)</span>-Kurve mit <span class="math notranslate nohighlight">\(df=(v_1,v_2)\)</span> der <span class="math notranslate nohighlight">\(F\)</span>-Wert mit der Fläche <span class="math notranslate nohighlight">\(\alpha\)</span> auf der linken Seite gleich dem Kehrwert des <span class="math notranslate nohighlight">\(F\)</span>-Wertes mit der Fläche <span class="math notranslate nohighlight">\(\alpha\)</span> auf der rechten Seite für eine <span class="math notranslate nohighlight">\(F\)</span>-Kurve mit <span class="math notranslate nohighlight">\(df=(v_2,v_1)\)</span> ist (<span id="id1">Fahrmeir <em>et al.</em> [<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">2016</a>]</span> s.282). Übertragen auf das obige Beispiel, bei dem <span class="math notranslate nohighlight">\(F_{0,05}\)</span> für <span class="math notranslate nohighlight">\(df=(9,14) \approx 2,6458\)</span> beträgt, bedeutet dies, dass <span class="math notranslate nohighlight">\(F_{0,95}\)</span> für <span class="math notranslate nohighlight">\(df=(14,9) \ ; \  \frac{1}{2,6458}=0,378\)</span> beträgt.</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chi2</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">v1</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">v2</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span>
    <span class="n">f</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">),</span>
    <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">ymax</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">),</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">),</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">f</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$F$-Dichtefunktion, $df(v1=14, v2=9)$, $\alpha=0.95$&quot;</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;F-Kurve&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;Fläche = 0.05&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.27</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">),</span>
    <span class="c1"># textcoords=&quot;data&quot;,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;$F_</span><span class="si">{0.05}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.08</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Fläche = $1 - \alpha$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="n">ticks</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.axis.XTick at 0x7fb5b0e23760&gt;,
 &lt;matplotlib.axis.XTick at 0x7fb5b0e235b0&gt;,
 &lt;matplotlib.axis.XTick at 0x7fb5b0e23490&gt;,
 &lt;matplotlib.axis.XTick at 0x7fb5b0e21a50&gt;,
 &lt;matplotlib.axis.XTick at 0x7fb5b0e20790&gt;,
 &lt;matplotlib.axis.XTick at 0x7fb5b0e20490&gt;]
</pre></div>
</div>
<img alt="_images/04_Standardabweichung_der_Grundgesamtheit_69_1.png" src="_images/04_Standardabweichung_der_Grundgesamtheit_69_1.png" />
</div>
</div>
<section id="intervall-schatzung-von-sigma-1-sigma-2">
<h3>Intervall-Schätzung von <span class="math notranslate nohighlight">\(\sigma_1-\sigma_2\)</span><a class="headerlink" href="#intervall-schatzung-von-sigma-1-sigma-2" title="Permalink to this headline">#</a></h3>
<p>Das <span class="math notranslate nohighlight">\(100(1-\alpha)\%\)</span>-Konfidenzintervall für <span class="math notranslate nohighlight">\(\sigma\)</span> beträgt</p>
<div class="math notranslate nohighlight">
\[\frac{1}{\sqrt{F_{\alpha /2}}} \times \frac{s_1}{s_2} \le \sigma \le \frac{1}{\sqrt{F_{1-\alpha /2}}} \times \frac{s_1}{s_2}\text{,}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(s_1\)</span> und <span class="math notranslate nohighlight">\(s_2\)</span> die Standardabweichungen der Stichprobe sind.</p>
</section>
<section id="f-test-fur-zwei-standardabweichungen">
<h3><span class="math notranslate nohighlight">\(F\)</span>-Test für zwei Standardabweichungen<a class="headerlink" href="#f-test-fur-zwei-standardabweichungen" title="Permalink to this headline">#</a></h3>
<p>Das Hypothesentestverfahren für die Standardabweichung wird als F-Test für zwei Standardabweichungen bezeichnet. Der Hypothesentest für zwei Standardabweichungen der Grundgesamtheit folgt demselben schrittweisen Verfahren wie andere Hypothesentests.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{l}
\hline
\ \text{Schritt 1}  &amp; \text{Geben Sie die Nullhypothese } H_0 \text{ und alternative Hypothese } H_A \text{ an.}\\
\ \text{Schritt 2}  &amp; \text{Legen Sie das Signifikanzniveau, } \alpha\text{ fest.} \\
\ \text{Schritt 3}  &amp; \text{Berechnen Sie den Wert der Teststatistik.} \\
\ \text{Schritt 4} &amp;\text{Bestimmen Sie den p-Wert.} \\
\ \text{Schritt 5} &amp; \text{Wenn }p \le \alpha \text{, } H_0 \text{ ablehnen } \text{; ansonsten } H_0 \text{ nicht ablehnen} \text{.} \\
\ \text{Schritt 6} &amp;\text{Interpretieren Sie das Ergebnis des Hypothesentests.} \\
\hline 
\end{array}
\end{split}\]</div>
<p>Die Teststatistik für einen Hypothesentest für eine normalverteilte Variable und für unabhängige Stichproben der Größen <span class="math notranslate nohighlight">\(n_1\)</span> und <span class="math notranslate nohighlight">\(n_2\)</span> ist gegeben durch</p>
<div class="math notranslate nohighlight">
\[F = \frac{s_1^2/\sigma_1^2}{s_2^2/\sigma_2^2}\text{,}\]</div>
<p>mit <span class="math notranslate nohighlight">\(df=(n_1-1,n_2-1)\)</span>.</p>
<p>Wenn <span class="math notranslate nohighlight">\(H_0: \sigma_1 = \sigma_2\)</span> wahr ist, dann vereinfacht sich die Gleichung zu</p>
<div class="math notranslate nohighlight">
\[F = \frac{s_1^2}{s_2^2}\]</div>
</section>
<section id="f-test-fur-zwei-standardabweichungen-ein-beispiel">
<h3><span class="math notranslate nohighlight">\(F\)</span>-Test für zwei Standardabweichungen : Ein Beispiel<a class="headerlink" href="#f-test-fur-zwei-standardabweichungen-ein-beispiel" title="Permalink to this headline">#</a></h3>
<p>Um einige praktische Erfahrungen zu sammeln, wenden wir den <strong><span class="math notranslate nohighlight">\(F\)</span>-Test für zwei Standardabweichungen</strong> in einer Übung an. Dazu laden wir den <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz. Sie können die Datei <code class="docutils literal notranslate"><span class="pre">students.csv</span></code> <a href="https://userpage.fu-berlin.de/soga/200/2010_data_sets/students.csv">hier</a> herunterladen. Importieren Sie den Datensatz und geben Sie ihm einen passenden Namen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lese Datei students.csv als Dataframe ein; Indexspalte wird übersprungen</span>
<span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../data/students.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Der <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz besteht aus <span class="math notranslate nohighlight">\(8239\)</span> Zeilen, von denen jede einen bestimmten Studenten repräsentiert, und <span class="math notranslate nohighlight">\(16\)</span> Spalten, von denen jede einer Variable/einem Merkmal entspricht, das sich auf diesen bestimmten Studenten bezieht. Diese selbsterklärenden Variablen sind: <em>stud_id, name, gender, age, height, weight, religion, nc_score, semester, major, minor, score1, score2, online_tutorial, graduated, salary.</em></p>
<p>Um den <strong><span class="math notranslate nohighlight">\(F\)</span>-Test für zwei Standardabweichungen</strong> zu zeigen, untersuchen wir die Streuung der Körpergröße in cm der Studentinnen und vergleichen sie mit der Streuung der Körpergröße aller Studenten (unserer Grundgesamtheit). <strong>Wir wollen testen, ob sich die Standardabweichung der Körpergröße der weiblichen Studenten (<span class="math notranslate nohighlight">\(\sigma_1\)</span>) von der Standardabweichung der Körpergröße der männlichen Studenten (<span class="math notranslate nohighlight">\(\sigma_2\)</span>) unterscheidet</strong>.</p>
</section>
<section id="id2">
<h3>Vorbereitung der Daten<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Wir unterteilen den Datensatz anhand der Variable <code class="docutils literal notranslate"><span class="pre">gender</span></code>.</p></li>
<li><p>Dann nehmen wir <span class="math notranslate nohighlight">\(25\)</span> weibliche und <span class="math notranslate nohighlight">\(25\)</span> männliche Studenten in die Stichprobe auf.</p></li>
<li><p>Dann berechnen wir die Standardabweichungen der interessierenden Variable (Körpergröße in cm) für beide Stichproben und weisen ihnen die Variablen <code class="docutils literal notranslate"><span class="pre">std_female</span></code> und <code class="docutils literal notranslate"><span class="pre">std_male</span></code> zu.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Unterteile Datensatz nach Variable `gender`</span>
<span class="n">male</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">students</span><span class="p">[</span><span class="s2">&quot;gender&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Male&quot;</span><span class="p">]</span>
<span class="n">female</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">students</span><span class="p">[</span><span class="s2">&quot;gender&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Female&quot;</span><span class="p">]</span>

<span class="c1"># Entnehme Probe von jeweils 25 Studenten</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">male_sample</span> <span class="o">=</span> <span class="n">male</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">female_sample</span> <span class="o">=</span> <span class="n">female</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">std_female</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">female_sample</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">std_female</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7.009041779492163
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">std_male</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">male_sample</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">std_male</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8.203251387915241
</pre></div>
</div>
</div>
</div>
<p>Außerdem überprüfen wir die Normalverteilungsannahme, indem wir ein <a href="https://de.wikipedia.org/wiki/Quantil-Quantil-Diagramm">Q-Q-Diagramm</a> erstellen. In Python können wir die Funktion <code class="docutils literal notranslate"><span class="pre">qqplot()</span></code> verwenden, um Q-Q-Plots zu erstellen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Erzeuge Q-Q Plot</span>
<span class="n">qqp</span> <span class="o">=</span> <span class="n">smi</span><span class="o">.</span><span class="n">qqplot</span><span class="p">(</span><span class="n">female_sample</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">qqp</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s2">&quot;Q-Q-Diagramm für die Körpergrösse der </span><span class="se">\n</span><span class="s2"> in der weiblichen Studentinnen (Stichprobe)&quot;</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Theoretische Quantillen&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Stichproben Quantillen&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Stichproben Quantillen&#39;)
</pre></div>
</div>
<img alt="_images/04_Standardabweichung_der_Grundgesamtheit_92_1.png" src="_images/04_Standardabweichung_der_Grundgesamtheit_92_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Erzeuge Q-Q Plot</span>
<span class="n">qqp</span> <span class="o">=</span> <span class="n">smi</span><span class="o">.</span><span class="n">qqplot</span><span class="p">(</span><span class="n">male_sample</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">qqp</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s2">&quot;Q-Q-Diagramm für die Körpergrösse der </span><span class="se">\n</span><span class="s2"> in der männlichen Studenten (Stichprobe)&quot;</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Theoretische Quantillen&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Stichproben Quantillen&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Stichproben Quantillen&#39;)
</pre></div>
</div>
<img alt="_images/04_Standardabweichung_der_Grundgesamtheit_93_1.png" src="_images/04_Standardabweichung_der_Grundgesamtheit_93_1.png" />
</div>
</div>
<p>Wir sehen, dass die Daten ungefähr auf einer Geraden liegen. Auf der Grundlage des grafischen Auswertungsansatzes kommen wir zu dem Schluss, dass die interessierende Variable ungefähr normalverteilt ist.</p>
</section>
<section id="id3">
<h3>Überprüfung der Hypothesen<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h3>
<p>Zur Durchführung des <strong><span class="math notranslate nohighlight">\(F\)</span>-Tests für zwei Standardabweichungen</strong> folgen wir dem Verfahren der schrittweisen Durchführung von Hypothesentests.</p>
<p><strong>Schritt 1 : Geben Sie die Nullhypothese <span class="math notranslate nohighlight">\(H_0\)</span> und alternative Hypothese <span class="math notranslate nohighlight">\(H_A\)</span> an</strong></p>
<p>Die Nullhypothese besagt, dass die Standardabweichung der Körpergröße der weiblichen Studenten (<span class="math notranslate nohighlight">\(\sigma_1\)</span>) gleich der Standardabweichung der Körpergröße der männlichen Studenten (<span class="math notranslate nohighlight">\(\sigma_2\)</span>) ist.</p>
<div class="math notranslate nohighlight">
\[H_0: \quad \sigma_1 = \sigma_2\]</div>
<p><strong>Alternative Hypothese</strong></p>
<div class="math notranslate nohighlight">
\[H_A: \quad \sigma_1 \ne \sigma_2\]</div>
<p>Diese Formulierung führt zu einem zweiseitigen Hypothesentest.</p>
<p><strong>Schritt 2: Legen Sie das Signifikanzniveau,<span class="math notranslate nohighlight">\(\alpha\)</span> fest</strong></p>
<div class="math notranslate nohighlight">
\[\alpha = 0,05\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Schritt 3 und 4: Berechnen Sie den Wert der Teststatistik und den <span class="math notranslate nohighlight">\(p\)</span>-Wert</strong></p>
<p>Zur Veranschaulichung berechnen wir die Teststatistik manuell in Python. Erinnern Sie sich an die Gleichung für die Teststatistik von oben:</p>
<div class="math notranslate nohighlight">
\[F = \frac{s_1^2}{s_2^2}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne die Teststatistik</span>
<span class="n">Ftest</span> <span class="o">=</span> <span class="n">std_female</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">std_male</span><span class="o">**</span><span class="mi">2</span>
<span class="n">Ftest</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7300376461264116
</pre></div>
</div>
</div>
</div>
<p>Der numerische Wert der Teststatistik beträgt <span class="math notranslate nohighlight">\(\approx 0,73\)</span>.</p>
<p>Um den <span class="math notranslate nohighlight">\(p\)</span>-Wert zu berechnen, wenden wir die Funktion <code class="docutils literal notranslate"><span class="pre">f.cdf()</span></code> an. Erinnern Sie sich daran, wie man die Freiheitsgrade berechnet.</p>
<div class="math notranslate nohighlight">
\[df = (n_1 - 1, n_2 - 1)\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne df</span>
<span class="n">df1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">female_sample</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">df2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">male_sample</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

<span class="c1"># Berechne p-Wert</span>
<span class="n">p_upper</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">f</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">Ftest</span><span class="p">,</span> <span class="n">dfn</span><span class="o">=</span><span class="n">df1</span><span class="p">,</span> <span class="n">dfd</span><span class="o">=</span><span class="n">df2</span><span class="p">)</span>
<span class="n">p_lower</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">Ftest</span><span class="p">,</span> <span class="n">dfn</span><span class="o">=</span><span class="n">df1</span><span class="p">,</span> <span class="n">dfd</span><span class="o">=</span><span class="n">df2</span><span class="p">)</span>

<span class="k">if</span> <span class="n">p_upper</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">p_lower</span> <span class="o">*</span> <span class="mi">2</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">p_upper</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.4465246946119613
</pre></div>
</div>
</div>
</div>
<p><strong>Schritt 5: Wenn <span class="math notranslate nohighlight">\(p \le \alpha , H_0\)</span> ablehnen; ansonsten <span class="math notranslate nohighlight">\(H_0\)</span> nicht ablehnen</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">&lt;=</span> <span class="n">alpha</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<p>Der <span class="math notranslate nohighlight">\(p\)</span>-Wert ist größer als das angegebene Signifikanzniveau von <span class="math notranslate nohighlight">\(0,05\)</span>; wir verwerfen <span class="math notranslate nohighlight">\(H_0\)</span> nicht. Die Testergebnisse sind auf dem <span class="math notranslate nohighlight">\(5 \%\)</span>-Niveau statistisch signifikant und liefern keinen ausreichenden Beweis gegen die Nullhypothese.</p>
<p><strong>Schritt 6: Interpretieren Sie das Ergebnis des Hypothesentests</strong></p>
<p><span class="math notranslate nohighlight">\(p=0,44652469\)</span>. Bei einem Signifikanzniveau von <span class="math notranslate nohighlight">\(5 \%\)</span> liefern die Daten keine ausreichenden Beweise für die Schlussfolgerung, dass die Standardabweichungen der Körpergröße von weiblichen und männlichen Studenten unterschiedlich sind.</p>
</section>
<section id="id4">
<h3>Hypothesentests in Python<a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h3>
<p>Wir haben gerade einen <span class="math notranslate nohighlight">\(F\)</span>-Test für zwei Standardabweichungen in Python manuell durchgeführt. OK, wir haben eine Menge gelernt, aber jetzt nutzen wir die Mittel von Python, um das gleiche Ergebnis wie oben mit nur einer Zeile Code zu erhalten!</p>
<p>Um einen <span class="math notranslate nohighlight">\(F\)</span>-Test für zwei Standardabweichungen  in Python durchzuführen, verwenden wir unsere Funktion <code class="docutils literal notranslate"><span class="pre">simple_x2_test()</span></code> und verändern sie geringfügig. Wir geben zwei Vektoren als Dateneingabe an: <code class="docutils literal notranslate"><span class="pre">female_sample</span></code> und <code class="docutils literal notranslate"><span class="pre">male_sample</span></code>. Das Argument <code class="docutils literal notranslate"><span class="pre">alternative</span></code> muss nicht angegeben werden, da <code class="docutils literal notranslate"><span class="pre">alternative</span> <span class="pre">=</span> <span class="pre">'two-sided'</span></code> die Vorgabe ist.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">simple_f_test</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">dfn</span><span class="p">,</span> <span class="n">dfd</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;two-sided&quot;</span><span class="p">):</span>
    <span class="n">df1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">female_sample</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">df2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">male_sample</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">std_male</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">male_sample</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">std_female</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">female_sample</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Berechne Teststatistik</span>
    <span class="n">Ftest</span> <span class="o">=</span> <span class="n">std_female</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">std_male</span><span class="o">**</span><span class="mi">2</span>

    <span class="c1"># linksseitiger Test</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Ftest</span><span class="p">,</span> <span class="n">dfn</span><span class="o">=</span><span class="n">df1</span><span class="p">,</span> <span class="n">dfd</span><span class="o">=</span><span class="n">df2</span><span class="p">)</span>
    <span class="c1"># rechtsseitiger Test</span>
    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Ftest</span><span class="p">,</span> <span class="n">dfn</span><span class="o">=</span><span class="n">df1</span><span class="p">,</span> <span class="n">dfd</span><span class="o">=</span><span class="n">df2</span><span class="p">)</span>

    <span class="c1"># beidseitiger Test (default)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">p_upper</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">f</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">Ftest</span><span class="p">,</span> <span class="n">dfn</span><span class="o">=</span><span class="n">df1</span><span class="p">,</span> <span class="n">dfd</span><span class="o">=</span><span class="n">df2</span><span class="p">)</span>
        <span class="n">p_lower</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">Ftest</span><span class="p">,</span> <span class="n">dfn</span><span class="o">=</span><span class="n">df1</span><span class="p">,</span> <span class="n">dfd</span><span class="o">=</span><span class="n">df2</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">p_upper</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">p_lower</span> <span class="o">*</span> <span class="mi">2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">p_upper</span> <span class="o">*</span> <span class="mi">2</span>
    <span class="c1"># evaluiere p &lt; alpha</span>
    <span class="k">if</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
        <span class="n">reject</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">reject</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># Ausgabe</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Significance level:&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Degrees of freedom:&quot;</span><span class="p">,</span> <span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test statistic:&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">Ftest</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p-value:&quot;</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Reject H0:&quot;</span><span class="p">,</span> <span class="n">reject</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simple_f_test</span><span class="p">(</span><span class="n">female_sample</span><span class="p">,</span> <span class="n">male_sample</span><span class="p">,</span> <span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Significance level: 0.05
Degrees of freedom: 24 24
Test statistic: 0.73
p-value: 0.4465246946119613
Reject H0: False
</pre></div>
</div>
</div>
</div>
<p>Es hat gut funktioniert! Vergleichen Sie die Ausgabe der Funktion <code class="docutils literal notranslate"><span class="pre">simple_f_test()</span></code> mit unserem Ergebnis von oben. Auch hier können wir zu dem Schluss kommen, dass die Daten bei einem Signifikanzniveau von <span class="math notranslate nohighlight">\(5 \%\)</span> keine ausreichenden Beweise dafür liefern, dass die Standardabweichungen der Körpergröße von weiblichen und männlichen Studenten unterschiedlich sind.</p>
</section>
</section>
<span id="document-Kapitel06/05_Chi_Quadrat_Tests"></span><section class="tex2jax_ignore mathjax_ignore" id="chi-quadrat-tests">
<h2>Chi-Quadrat-Tests<a class="headerlink" href="#chi-quadrat-tests" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">sample</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chi2</span><span class="p">,</span> <span class="n">chisquare</span>
</pre></div>
</div>
</div>
</div>
<p>Neben Inferenzverfahren für Hypothesentests für Grundgesamtheitsparameter wie den Mittelwert <span class="math notranslate nohighlight">\(\mu\)</span> und die Standardabweichung <span class="math notranslate nohighlight">\(\sigma\)</span> gibt es statistische Verfahren, um Rückschlüsse auf die Verteilung einer Variablen zu ziehen. Diese Schlussfolgerungsmethoden beruhen auf der Chi-Quadrat-Verteilung (<span class="math notranslate nohighlight">\(\chi^2\)</span>) und werden daher als <span class="math notranslate nohighlight">\(\chi^2\)</span>-Tests bezeichnet.</p>
<p>Im folgenden Abschnitt werden der <strong>Chi-Quadrat-Anpassungstest</strong>, ein Hypothesentest, der angewandt wird, um Rückschlüsse auf die Verteilung einer Variablen zu ziehen, und der <strong>Chi-Quadrat-Unabhängigkeitstest</strong>, ein Hypothesentest, der angewandt wird, um zu entscheiden, ob ein Zusammenhang zwischen zwei Variablen einer Grundgesamtheit besteht, erörtert.</p>
<section id="chi-2-verteilung">
<h3><span class="math notranslate nohighlight">\(\chi^2\)</span>-Verteilung<a class="headerlink" href="#chi-2-verteilung" title="Permalink to this headline">#</a></h3>
<p><strong>Grundlegende Eigenschaften von <span class="math notranslate nohighlight">\(\chi^2\)</span>-Kurven (<span id="id1">Fahrmeir <em>et al.</em> [<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">2016</a>]</span> s.279)</strong></p>
<ul class="simple">
<li><p>Die Gesamtfläche unter einer <span class="math notranslate nohighlight">\(\chi^2\)</span>-Kurve ist gleich <span class="math notranslate nohighlight">\(1\)</span>.</p></li>
<li><p>Eine <span class="math notranslate nohighlight">\(\chi^2\)</span>-Kurve beginnt bei <span class="math notranslate nohighlight">\(0\)</span> auf der horizontalen Achse und erstreckt sich unendlich weit nach rechts, wobei sie sich der horizontalen Achse nähert, diese aber nie berührt.</p></li>
<li><p>Eine <span class="math notranslate nohighlight">\(\chi^2\)</span>-Kurve ist rechtsschief.</p></li>
<li><p>Mit zunehmender Anzahl von Freiheitsgraden sehen <span class="math notranslate nohighlight">\(\chi^2\)</span>- Kurven zunehmend wie normale Kurven aus.</p></li>
</ul>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chi2</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">df</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="k">for</span> <span class="n">_df</span> <span class="ow">in</span> <span class="n">df</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">chi2</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">_df</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;df=</span><span class="si">{</span><span class="n">_df</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s2">&quot;$\chi^2$-Warscheinlichkeitsdichtefunktion mit unterschiedlichen Freiheitsgraden (df)&quot;</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.lines.Line2D at 0x7fe7b4c89060&gt;
</pre></div>
</div>
<img alt="_images/05_Chi_Quadrat_Tests_7_1.png" src="_images/05_Chi_Quadrat_Tests_7_1.png" />
</div>
</div>
</section>
<section id="chi-quadrat-test-auf-anpassungsgute">
<h3>Chi-Quadrat-Test auf Anpassungsgüte<a class="headerlink" href="#chi-quadrat-test-auf-anpassungsgute" title="Permalink to this headline">#</a></h3>
<p>Der <strong><span class="math notranslate nohighlight">\(\chi^2\)</span>-Anpassungstest</strong> wird angewandt, um Hypothesentests über die Verteilung einer qualitativen (kategorialen) Variable oder einer diskreten quantitativen Variable, die nur endlich viele mögliche Werte hat, durchzuführen.</p>
<p>Die grundlegende Logik des <span class="math notranslate nohighlight">\(\chi^2\)</span>-Anpassungstest besteht darin, die Häufigkeiten von zwei Variablen zu vergleichen. Wir vergleichen die <strong>beobachteten Häufigkeiten</strong> einer Stichprobe mit den <strong>erwarteten Häufigkeiten</strong>.</p>
<p>Betrachten wir ein einfaches Beispiel:</p>
<p>Am <span class="math notranslate nohighlight">\(22\)</span>. September <span class="math notranslate nohighlight">\(2013\)</span> fand in Deutschland die <a href="https://de.wikipedia.org/wiki/Bundestagswahl_2013">Bundestagswahl <span class="math notranslate nohighlight">\(2013\)</span></a> statt. Mehr als <span class="math notranslate nohighlight">\(44\)</span> Millionen Menschen gingen zur Wahl. <span class="math notranslate nohighlight">\(41,5 \%\)</span> der deutschen Wähler entschieden sich für die Christlich Demokratische Union (CDU) und <span class="math notranslate nohighlight">\(25,7 \%\)</span> für die Sozialdemokratische Partei (SPD). Der Einfachheit halber fassen wir den verbleibenden Prozentsatz der Stimmen (<span class="math notranslate nohighlight">\(32,8 \%\)</span>) als Sonstige zusammen.</p>
<p>Auf der Grundlage dieser Daten können wir eine Häufigkeitstabelle erstellen.</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Partei</p></th>
<th class="text-align:center head"><p>Prozent</p></th>
<th class="text-align:center head"><p>Relative Häufigkeit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CDU</p></td>
<td class="text-align:center"><p>41,5</p></td>
<td class="text-align:center"><p>0,415</p></td>
</tr>
<tr class="row-odd"><td><p>SPD</p></td>
<td class="text-align:center"><p>25,7</p></td>
<td class="text-align:center"><p>0,257</p></td>
</tr>
<tr class="row-even"><td><p>Sonstige</p></td>
<td class="text-align:center"><p>32,8</p></td>
<td class="text-align:center"><p>0,328</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td class="text-align:center"><p>100</p></td>
<td class="text-align:center"><p>1</p></td>
</tr>
</tbody>
</table>
<p>Die dritte Spalte der obigen Tabelle entspricht den <strong>relativen Häufigkeiten</strong> in der deutschen Bevölkerung/Wählerschaft. Für diese Übung nehmen wir eine Zufallsstichprobe. Wir befragen <span class="math notranslate nohighlight">\(123\)</span> Studierende der FU Berlin nach ihrer Parteizugehörigkeit und halten die folgenden Antworten fest.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;SPD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SPD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SPD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SPD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SPD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SPD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SPD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SPD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SPD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SPD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SPD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SPD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SPD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SPD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SPD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SPD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SPD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SPD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SPD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SPD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SPD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SPD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SPD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SPD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SPD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sonstige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SPD&quot;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Im nächsten Schritt zählen wir das Auftreten der einzelnen Kategorien (Parteien) in unserer Stichprobe. Diese Größen sind die <strong>beobachteten Häufigkeiten</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">l</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">sample</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">sample</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;SPD: 26&#39;, &#39;CDU: 57&#39;, &#39;Sonstige: 40&#39;]
</pre></div>
</div>
</div>
</div>
<p>Im nächsten Schritt berechnen wir die <strong>erwartete Häufigkeit</strong> (<span class="math notranslate nohighlight">\(E\)</span>) für jede Kategorie.</p>
<div class="math notranslate nohighlight">
\[E = n \times p\text{,}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(n\)</span> der Stichprobenumfang und <span class="math notranslate nohighlight">\(p\)</span> die entsprechende relative Häufigkeit aus der obigen Tabelle ist.</p>
<div class="math notranslate nohighlight">
\[E_{CDU} = n\times p = 123 \times 0,415 = 51,045\]</div>
<div class="math notranslate nohighlight">
\[E_{SPD} = n\times p = 123 \times 0,257 = 31,611\]</div>
<div class="math notranslate nohighlight">
\[E_{Sonstige} = n\times p = 123 \times 0,382 = 46,986\]</div>
<p>Beachten Sie, dass es sich zwar um einzelne Zählungen handelt, die durch ganzzahlige Werte dargestellt werden, die <strong>erwartete Häufigkeit</strong>, <span class="math notranslate nohighlight">\(E\)</span> eine Fließkommazahl ist. Das ist in Ordnung.</p>
<p>Nun werden die <strong>beobachteten Häufigkeiten</strong> und die <strong>erwarteten Häufigkeiten</strong> in einer Tabelle zusammengeführt.</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Partei</p></th>
<th class="text-align:center head"><p>Beobachtete Häufigkeit</p></th>
<th class="text-align:center head"><p>Erwartete Häufigkeit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CDU</p></td>
<td class="text-align:center"><p>57</p></td>
<td class="text-align:center"><p>51,045</p></td>
</tr>
<tr class="row-odd"><td><p>SPD</p></td>
<td class="text-align:center"><p>26</p></td>
<td class="text-align:center"><p>31,611</p></td>
</tr>
<tr class="row-even"><td><p>Sonstige</p></td>
<td class="text-align:center"><p>40</p></td>
<td class="text-align:center"><p>46,986</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td class="text-align:center"><p>123</p></td>
<td class="text-align:center"><p>129,642</p></td>
</tr>
</tbody>
</table>
<p>Großartig! Sobald wir die erwarteten Häufigkeiten kennen, müssen wir auf zwei Annahmen prüfen. Erstens müssen wir sicherstellen, dass alle erwarteten Häufigkeiten <span class="math notranslate nohighlight">\(1\)</span> oder größer sind, und zweitens, dass höchstens <span class="math notranslate nohighlight">\(20 \%\)</span> der erwarteten Häufigkeiten kleiner als <span class="math notranslate nohighlight">\(5\)</span> sind. Durch einen Blick auf die Tabelle können wir bestätigen, dass beide Annahmen erfüllt sind.</p>
<p>Jetzt haben wir alle Zutaten, die wir brauchen, außer der Teststatistik, um einen <span class="math notranslate nohighlight">\(\chi^2\)</span>-Anpassungstest durchzuführen.</p>
<p>Die <span class="math notranslate nohighlight">\(\chi^2\)</span> Teststatistik für die Anpassungsgüte ist gegeben durch</p>
<div class="math notranslate nohighlight">
\[\chi^2=\sum \frac{(O-E)^2}{E}\text{,}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(O\)</span> den beobachteten Häufigkeiten und <span class="math notranslate nohighlight">\(E\)</span> den erwarteten Häufigkeiten entspricht. Die Teststatistik <span class="math notranslate nohighlight">\(\chi^2\)</span> approximiert eine <em>Chi-Quadrat</em>-Verteilung, wenn die Nullhypothese wahr ist. Die Zahl der Freiheitsgrade ist um <span class="math notranslate nohighlight">\(1\)</span> kleiner als die Zahl der möglichen Werte (Kategorien) für die betrachtete Variable.</p>
<div class="math notranslate nohighlight">
\[df = c-1\]</div>
<p>Ausgehend von den in der obigen Tabelle angegebenen beobachteten und erwarteten Häufigkeiten lässt sich der <span class="math notranslate nohighlight">\(\chi^2\)</span>-Wert relativ einfach berechnen. Um das Berechnungsverfahren jedoch übersichtlicher zu gestalten, haben wir alle erforderlichen Berechnungsschritte in einer Tabelle zusammengefasst.</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Partei</p></th>
<th class="text-align:center head"><p>Beobachtete Häufigkeit</p></th>
<th class="text-align:center head"><p>Erwartete Häufigkeit</p></th>
<th class="text-align:center head"><p>Differenz <span class="math notranslate nohighlight">\(O-E\)</span></p></th>
<th class="text-align:center head"><p>Quadrat der Differenz <span class="math notranslate nohighlight">\((O-E)^2\)</span></p></th>
<th class="text-align:center head"><p><span class="math notranslate nohighlight">\(\chi^2\)</span> Zwischensumme <span class="math notranslate nohighlight">\((O-E)^2 / E\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CDU</p></td>
<td class="text-align:center"><p>57</p></td>
<td class="text-align:center"><p>51,045</p></td>
<td class="text-align:center"><p>5,955</p></td>
<td class="text-align:center"><p>35,462025</p></td>
<td class="text-align:center"><p>0,6947208</p></td>
</tr>
<tr class="row-odd"><td><p>SPD</p></td>
<td class="text-align:center"><p>26</p></td>
<td class="text-align:center"><p>31,611</p></td>
<td class="text-align:center"><p>-5,611</p></td>
<td class="text-align:center"><p>31,483321</p></td>
<td class="text-align:center"><p>0,9959609</p></td>
</tr>
<tr class="row-even"><td><p>Sonstige</p></td>
<td class="text-align:center"><p>40</p></td>
<td class="text-align:center"><p>46,986</p></td>
<td class="text-align:center"><p>-6,986</p></td>
<td class="text-align:center"><p>48,804196</p></td>
<td class="text-align:center"><p>1,0386965</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td class="text-align:center"><p>123</p></td>
<td class="text-align:center"><p>129,642</p></td>
<td class="text-align:center"><p>-6,642</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
</tr>
</tbody>
</table>
<p>In unserem Beispiel ergibt die <span class="math notranslate nohighlight">\(\chi^2\)</span>-Teststatistik für die Anpassungsgüte den Wert</p>
<div class="math notranslate nohighlight">
\[\chi^2=\sum \frac{(O-E)^2}{E} \approx2,729\]</div>
<p>Wenn die Nullhypothese wahr ist, sind die beobachtete und die erwartete Häufigkeit ungefähr gleich. Dies führt zu einem kleinen Wert der <span class="math notranslate nohighlight">\(\chi^2\)</span>-Teststatistik und unterstützt somit <span class="math notranslate nohighlight">\(H_0\)</span>. Ist der Wert der <span class="math notranslate nohighlight">\(\chi^2\)</span>-Teststatistik jedoch groß, liefern die Daten Beweise gegen <span class="math notranslate nohighlight">\(H_0\)</span>.</p>
<section id="chi-2-anpassungstest-ein-beispiel">
<h4><span class="math notranslate nohighlight">\(\chi^2\)</span>-Anpassungstest: Ein Beispiel<a class="headerlink" href="#chi-2-anpassungstest-ein-beispiel" title="Permalink to this headline">#</a></h4>
<p>Um praktische Erfahrungen zu sammeln, wenden wir den <span class="math notranslate nohighlight">\(\chi^2\)</span> Anpassungstest in einer Übung an. Dazu laden wir den <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz. Sie können die Datei <code class="docutils literal notranslate"><span class="pre">students.csv</span></code> <a href="https://userpage.fu-berlin.de/soga/200/2010_data_sets/students.csv">hier</a> herunterladen. Importieren Sie den Datensatz und geben Sie ihm einen passenden Namen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lese Datei students.csv als Dataframe ein; Indexspalte wird übersprungen</span>
<span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../data/students.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Der <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz besteht aus <span class="math notranslate nohighlight">\(8239\)</span> Zeilen, von denen jede einen bestimmten Studenten repräsentiert, und <span class="math notranslate nohighlight">\(16\)</span> Spalten, von denen jede einer Variable/einem Merkmal entspricht, das sich auf diesen bestimmten Studenten bezieht. Diese selbsterklärenden Variablen sind: <em>stud_id, name, gender, age, height, weight, religion, nc_score, semester, major, minor, score1, score2, online_tutorial, graduated, salary.</em></p>
<p>Es sei daran erinnert, dass <span class="math notranslate nohighlight">\(\chi^2\)</span>-Anpassungstests für qualitative (kategoriale) Variablen oder diskrete quantitative Variablen angewendet werden. Der <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz enthält mehrere kategoriale Variablen, wie z. B. <code class="docutils literal notranslate"><span class="pre">gender</span></code>, <code class="docutils literal notranslate"><span class="pre">religion</span></code>, <code class="docutils literal notranslate"><span class="pre">major</span></code>, <code class="docutils literal notranslate"><span class="pre">minor</span></code> und <code class="docutils literal notranslate"><span class="pre">graduated</span></code>.</p>
<p>Um den <span class="math notranslate nohighlight">\(\chi^2\)</span>-Anpassungstest zu veranschaulichen, untersuchen wir, ob die Religion unter den Studierenden gleichmäßig verteilt ist, verglichen mit der Verteilung der Religion in der Bevölkerung der Europäischen Union. Die Daten auf kontinentaler Ebene stammen aus dem Bericht “Discrimination in the EU in <span class="math notranslate nohighlight">\(2012\)</span>” (<a href="https://europa.eu/eurobarometer/api/archives/ebs/ebs_393_en.pdf">European Union: European Commission, Special Eurobarometer, <span class="math notranslate nohighlight">\(393\)</span>, p. <span class="math notranslate nohighlight">\(233\)</span></a>). Der Bericht enthält Daten für <span class="math notranslate nohighlight">\(8\)</span> Kategorien: <span class="math notranslate nohighlight">\(48 \%\)</span> der Menschen werden als Katholiken, <span class="math notranslate nohighlight">\(16 \%\)</span> als Nichtgläubige/Agnostiker, <span class="math notranslate nohighlight">\(12 \%\)</span> als Protestanten, <span class="math notranslate nohighlight">\(8 \%\)</span> als Orthodoxe, <span class="math notranslate nohighlight">\(7 \%\)</span> als Atheisten, <span class="math notranslate nohighlight">\(4 \%\)</span> als sonstige Christen, <span class="math notranslate nohighlight">\(3 \%\)</span> als sonstige Religion/keine Angabe und <span class="math notranslate nohighlight">\(2 \%\)</span> als Muslime eingestuft. Zum besseren Verständnis stellen wir die Daten in Form eines Tortendiagramms dar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Erzeuge Pie chart</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">48</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">mylabels</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Katholiken&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Nichtgläubige/Agnostiker&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Protestanten&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Orthodoxe&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Atheisten&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sonstige Christen&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sonstige Religion/keine Angabe&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Muslime&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">mylabels</span><span class="p">,</span> <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">labeldistance</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">rotatelabels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/05_Chi_Quadrat_Tests_38_0.png" src="_images/05_Chi_Quadrat_Tests_38_0.png" />
</div>
</div>
</section>
<section id="vorbereitung-der-daten">
<h4>Vorbereitung der Daten<a class="headerlink" href="#vorbereitung-der-daten" title="Permalink to this headline">#</a></h4>
<p>Wir beginnen mit der Datenexploration und der Datenaufbereitung.</p>
<p>Zunächst wollen wir wissen, welche Kategorien im Datensatz vorhanden sind. Dazu wenden wir die Funktion <code class="docutils literal notranslate"><span class="pre">unique()</span></code> an, die die einzelnen Spaltennamen (Kategorien) ausgibt.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">students</span><span class="p">[</span><span class="s2">&quot;religion&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Muslim&#39;, &#39;Other&#39;, &#39;Protestant&#39;, &#39;Catholic&#39;, &#39;Orthodox&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<p>Offensichtlich gibt es in den <em>Studenten</em>daten <span class="math notranslate nohighlight">\(5\)</span> weniger Kategorien, im Vergleich zu den <span class="math notranslate nohighlight">\(8\)</span> Kategorien, die im EU-Bericht angegeben sind. Um Vergleiche anstellen zu können, kodieren wir die Kategorien der Religionsvariable um, um schließlich <span class="math notranslate nohighlight">\(5\)</span> Kategorien zu erhalten: “Katholisch”, “Muslimisch”, “Orthodox”, “Protestantisch” und “Sonstige”. Achten Sie bei diesem Schritt darauf, dass Sie die Kategorien nicht verwechseln!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lege Kategorien zusammen</span>
<span class="n">raw_data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s2">&quot;Other&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">16</span> <span class="o">+</span> <span class="mi">7</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)),</span>
    <span class="p">(</span><span class="s2">&quot;Catholic&quot;</span><span class="p">,</span> <span class="mi">48</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Protestant&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Orthodox&quot;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Muslim&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="p">]</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">raw_data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Religion&quot;</span><span class="p">,</span> <span class="s2">&quot;absoulte Häufigkeit&quot;</span><span class="p">])</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;relative Häufigkeit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;absoulte Häufigkeit&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;Religion&quot;</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>absoulte Häufigkeit</th>
      <th>relative Häufigkeit</th>
    </tr>
    <tr>
      <th>Religion</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Other</th>
      <td>30</td>
      <td>0.30</td>
    </tr>
    <tr>
      <th>Catholic</th>
      <td>48</td>
      <td>0.48</td>
    </tr>
    <tr>
      <th>Protestant</th>
      <td>12</td>
      <td>0.12</td>
    </tr>
    <tr>
      <th>Orthodox</th>
      <td>8</td>
      <td>0.08</td>
    </tr>
    <tr>
      <th>Muslim</th>
      <td>2</td>
      <td>0.02</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Nun nehmen wir eine Zufallsstichprobe. Wir wählen <span class="math notranslate nohighlight">\(256\)</span> Studenten nach dem Zufallsprinzip aus und zählen mit der Funktion <code class="docutils literal notranslate"><span class="pre">value_counts()</span></code> die Anzahl der Studenten in jeder bestimmten Kategorie der Variablen <code class="docutils literal notranslate"><span class="pre">religion</span></code>. Wir erinnern uns, dass diese Menge den <strong>beobachteten Häufigkeiten</strong> entspricht.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">students_sample</span> <span class="o">=</span> <span class="n">students</span><span class="p">[</span><span class="s2">&quot;religion&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sample_frequencies</span> <span class="o">=</span> <span class="n">students_sample</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">sample_frequencies</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Other         85
Catholic      77
Protestant    60
Orthodox      27
Muslim         7
Name: religion, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Mit einer einzigen Code-Zeile fügen wir die beobachteten Häufigkeiten in <code class="docutils literal notranslate"><span class="pre">data</span></code> ein, den <code class="docutils literal notranslate"><span class="pre">dataframe</span></code>, den wir oben konstruiert haben.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;beobachtete Häufigkeit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sample_frequencies</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>absoulte Häufigkeit</th>
      <th>relative Häufigkeit</th>
      <th>beobachtete Häufigkeit</th>
    </tr>
    <tr>
      <th>Religion</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Other</th>
      <td>30</td>
      <td>0.30</td>
      <td>85</td>
    </tr>
    <tr>
      <th>Catholic</th>
      <td>48</td>
      <td>0.48</td>
      <td>77</td>
    </tr>
    <tr>
      <th>Protestant</th>
      <td>12</td>
      <td>0.12</td>
      <td>60</td>
    </tr>
    <tr>
      <th>Orthodox</th>
      <td>8</td>
      <td>0.08</td>
      <td>27</td>
    </tr>
    <tr>
      <th>Muslim</th>
      <td>2</td>
      <td>0.02</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Im nächsten Schritt berechnen wir die erwarteten Häufigkeiten. Erinnern Sie sich an die Gleichung:</p>
<div class="math notranslate nohighlight">
\[E = n \times p\]</div>
<p>Wir fügen die erwarteten Häufigkeiten als neue Spalte in <code class="docutils literal notranslate"><span class="pre">data</span></code> ein.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;erwartete Häufigkeit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;relative Häufigkeit&quot;</span><span class="p">]</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>absoulte Häufigkeit</th>
      <th>relative Häufigkeit</th>
      <th>beobachtete Häufigkeit</th>
      <th>erwartete Häufigkeit</th>
    </tr>
    <tr>
      <th>Religion</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Other</th>
      <td>30</td>
      <td>0.30</td>
      <td>85</td>
      <td>76.80</td>
    </tr>
    <tr>
      <th>Catholic</th>
      <td>48</td>
      <td>0.48</td>
      <td>77</td>
      <td>122.88</td>
    </tr>
    <tr>
      <th>Protestant</th>
      <td>12</td>
      <td>0.12</td>
      <td>60</td>
      <td>30.72</td>
    </tr>
    <tr>
      <th>Orthodox</th>
      <td>8</td>
      <td>0.08</td>
      <td>27</td>
      <td>20.48</td>
    </tr>
    <tr>
      <th>Muslim</th>
      <td>2</td>
      <td>0.02</td>
      <td>7</td>
      <td>5.12</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Sobald wir die erwarteten Häufigkeiten kennen, müssen wir zwei Annahmen überprüfen. Erstens müssen wir sicherstellen, dass alle erwarteten Häufigkeiten <span class="math notranslate nohighlight">\(1\)</span> oder größer sind, und zweitens, dass höchstens <span class="math notranslate nohighlight">\(20 \%\)</span> der erwarteten Häufigkeiten kleiner als <span class="math notranslate nohighlight">\(5\)</span> sind. Durch einen Blick auf die Tabelle können wir bestätigen, dass beide Annahmen erfüllt sind.</p>
<p>Perfekt, jetzt sind wir fertig! Der Datensatz ist bereit für die Analyse mit dem <span class="math notranslate nohighlight">\(\chi^2\)</span> Anpassungstest zu analysieren. Erinnern Sie sich an die Frage, an der wir interessiert sind: <strong>Ist die Religion unter den Studierenden gleichmäßig verteilt, verglichen mit der Verteilung der Religion in der Bevölkerung der Europäischen Union?</strong></p>
</section>
<section id="uberprufung-der-hypothesen">
<h4>Überprüfung der Hypothesen<a class="headerlink" href="#uberprufung-der-hypothesen" title="Permalink to this headline">#</a></h4>
<p>Zur Durchführung des <span class="math notranslate nohighlight">\(\chi^2\)</span> Anpassungstests folgen wir dem schrittweisen Durchführungsverfahren für Hypothesentests. Der <span class="math notranslate nohighlight">\(\chi^2\)</span> Anpassungstest folgt demselben schrittweisen Verfahren wie Hypothesentests für den Grundgesamtheitsmittelwert.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{l}
\hline
\ \text{Schritt 1}  &amp; \text{Geben Sie die Nullhypothese } H_0 \text{ und alternative Hypothese } H_A \text{ an.}\\
\ \text{Schritt 2}  &amp; \text{Legen Sie das Signifikanzniveau, } \alpha\text{ fest.} \\
\ \text{Schritt 3}  &amp; \text{Berechnen Sie den Wert der Teststatistik.} \\
\ \text{Schritt 4} &amp;\text{Bestimmen Sie den p-Wert.} \\
\ \text{Schritt 5} &amp; \text{Wenn} \ p \le \alpha \text{, } H_0 \text{ ablehnen } \text{; ansonsten } H_0 \text{ nicht ablehnen} \text{.} \\
\ \text{Schritt 6} &amp;\text{Interpretieren Sie das Ergebnis des Hypothesentests.} \\
\hline 
\end{array}
\end{split}\]</div>
<p><strong>Schritt 1 : Geben Sie die Nullhypothese <span class="math notranslate nohighlight">\(H_0\)</span> und alternative Hypothese <span class="math notranslate nohighlight">\(H_A\)</span> an</strong></p>
<p>Die Nullhypothese besagt, dass die Religion unter den Studenten gleich verteilt ist, verglichen mit der Verteilung der Religion in der Bevölkerung der Europäischen Union.</p>
<p><span class="math notranslate nohighlight">\(H_0:\text{Die Variable hat die angegebene Verteilung}\)</span></p>
<p><strong>Alternative Hypothese</strong></p>
<p><span class="math notranslate nohighlight">\(H_A:\text{Die Variable hat nicht die angegebene Verteilung}\)</span></p>
<p><strong>Schritt 2: Legen Sie das Signifikanzniveau,<span class="math notranslate nohighlight">\(\alpha\)</span> fest</strong></p>
<div class="math notranslate nohighlight">
\[\alpha = 0,01\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.01</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Schritt 3 und 4: Berechnen Sie den Wert der Teststatistik und den <span class="math notranslate nohighlight">\(p\)</span>-Wert</strong></p>
<p>Zur Veranschaulichung berechnen wir die Teststatistik manuell in Python. Erinnern Sie sich an die Gleichung für die Teststatistik von oben:</p>
<div class="math notranslate nohighlight">
\[\chi^2=\sum \frac{(O-E)^2}{E}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne Teststatistik</span>
<span class="n">x2</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
    <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;beobachtete Häufigkeit&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;erwartete Häufigkeit&quot;</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;erwartete Häufigkeit&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">x2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>48.679361979166664
</pre></div>
</div>
</div>
</div>
<p>Der numerische Wert der Teststatistik beträgt <span class="math notranslate nohighlight">\(\approx 48,67936\)</span>.</p>
<p>Um den <span class="math notranslate nohighlight">\(p\)</span>-Wert zu berechnen, verwenden wir die Funktion <code class="docutils literal notranslate"><span class="pre">chi2.cdf()</span></code>. Erinnern Sie sich daran, wie man die Freiheitsgrade berechnet:</p>
<div class="math notranslate nohighlight">
\[df = (c - 1)\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne df</span>
<span class="n">df</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

<span class="c1"># Berechne p-Wert</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">chi2</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6.811017529549072e-10
</pre></div>
</div>
</div>
</div>
<p><strong>Schritt 5: Wenn <span class="math notranslate nohighlight">\(p \le \alpha , H_0\)</span> ablehnen; ansonsten <span class="math notranslate nohighlight">\(H_0\)</span> nicht ablehnen</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">&lt;=</span> <span class="n">alpha</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>Der <span class="math notranslate nohighlight">\(p\)</span>-Wert ist kleiner als das angegebene Signifikanzniveau von <span class="math notranslate nohighlight">\(0,01\)</span>; wir verwerfen <span class="math notranslate nohighlight">\(H_0\)</span>. Die Testergebnisse sind statistisch signifikant auf dem <span class="math notranslate nohighlight">\(1 \%\)</span>-Niveau und liefern einen sehr starken Beweis gegen die Nullhypothese.</p>
<p><strong>Schritt 6: Interpretieren Sie das Ergebnis des Hypothesentests</strong></p>
<p><span class="math notranslate nohighlight">\(p=6,8110175 \cdot 10^{-10}\)</span>. Bei einem Signifikanzniveau von <span class="math notranslate nohighlight">\(1 \%\)</span> lassen die Daten den Schluss zu, dass die Religionsverteilung unter den Studenten von der Religionsverteilung der Bevölkerung der Europäischen Union abweicht.</p>
</section>
<section id="hypothesentests-in-python">
<h4>Hypothesentests in Python<a class="headerlink" href="#hypothesentests-in-python" title="Permalink to this headline">#</a></h4>
<p>Wir haben gerade einen <span class="math notranslate nohighlight">\(\chi^2\)</span> Anpassungstest in Python manuell durchgeführt. Sehr cool, aber jetzt wiederholen wir dieses Beispiel und nutzen die Python-Maschinerie, um das gleiche Ergebnis wie oben mit nur einer Zeile Code zu erhalten!</p>
<p>Für die Durchführung eines <span class="math notranslate nohighlight">\(\chi^2\)</span> Anpassungsgüte-Test in Python durchzuführen, verwenden wir die Funktion <code class="docutils literal notranslate"><span class="pre">chisquare()</span></code>. Wir geben zwei Vektoren als Daten ein: <code class="docutils literal notranslate"><span class="pre">data['beobachtete</span> <span class="pre">Häufigkeit']</span></code> und <code class="docutils literal notranslate"><span class="pre">data['erwartete</span> <span class="pre">Häufigkeit']</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Führe Chi-Square Goodness of Fit Test durch</span>
<span class="n">chisquare</span><span class="p">(</span><span class="n">f_obs</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;beobachtete Häufigkeit&quot;</span><span class="p">],</span> <span class="n">f_exp</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;erwartete Häufigkeit&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Power_divergenceResult(statistic=48.679361979166664, pvalue=6.811017529549072e-10)
</pre></div>
</div>
</div>
</div>
<p>Es hat gut funktioniert! Vergleichen Sie die Ausgabe der Funktion <code class="docutils literal notranslate"><span class="pre">chisquare()</span></code> mit unserem Ergebnis von oben. Auch hier können wir feststellen, dass die Daten bei einem Signifikanzniveau von <span class="math notranslate nohighlight">\(1 \%\)</span> sehr starke Hinweise darauf liefern, dass sich die Religionsverteilung unter den Schülern von der Religionsverteilung der Bevölkerung der Europäischen Union unterscheidet.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="c1"># Load the &quot;autoreload&quot; extension</span>
<span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="c1"># always reload modules</span>
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="c1"># black formatter for jupyter notebooks</span>
<span class="c1"># %load_ext nb_black</span>
<span class="c1"># black formatter for jupyter lab</span>
<span class="o">%</span><span class="k">load_ext</span> lab_black

<span class="o">%</span><span class="k">run</span> ../../src/notebook_env.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
The lab_black extension is already loaded. To reload it, use:
  %reload_ext lab_black

---------------------------------
Working on the host: imarevic-pc

---------------------------------
Python version: 3.10.9 | packaged by conda-forge | (main, Feb  2 2023, 20:20:04) [GCC 11.3.0]

---------------------------------
Python interpreter: /home/imarevic/anaconda3/envs/srh/bin/python
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 864x432 with 0 Axes&gt;
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="der-chi-quadrat-unabhangigkeitstest">
<h3>Der Chi-Quadrat-Unabhängigkeitstest<a class="headerlink" href="#der-chi-quadrat-unabhangigkeitstest" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">sample</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chi2</span><span class="p">,</span> <span class="n">chi2_contingency</span>
</pre></div>
</div>
</div>
</div>
<p>Der <strong><span class="math notranslate nohighlight">\(\chi^2\)</span> Unabhängigkeitstest</strong> ist eine inferentielle Methode, um zu entscheiden, ob ein Zusammenhang zwischen zwei Variablen besteht. Ähnlich wie bei anderen Hypothesentests besagt die Nullhypothese, dass die beiden Variablen nicht miteinander verbunden sind. Im Gegensatz dazu besagt die Alternativhypothese, dass die beiden Variablen miteinander verbunden sind.</p>
<p>Es sei daran erinnert, dass statistisch <strong>abhängige Variablen</strong> als <strong>assoziierte Variablen</strong> bezeichnet werden. Im Gegensatz dazu werden nicht-assoziierte Variablen als statistisch unabhängige Variablen bezeichnet. Erinnern Sie sich auch an das Konzept der <a href="https://de.wikipedia.org/wiki/Kontingenztafel">Kontingenztabellen</a> (auch als Zwei-Wege-Tabellen oder Kreuztabellen bezeichnet), in denen die Häufigkeitsverteilungen von bivariaten Daten dargestellt werden.</p>
<section id="chi-2-unabhangigkeitstest">
<h4><span class="math notranslate nohighlight">\(\chi^2\)</span>-Unabhängigkeitstest<a class="headerlink" href="#chi-2-unabhangigkeitstest" title="Permalink to this headline">#</a></h4>
<p>Die Grundidee des <strong><span class="math notranslate nohighlight">\(\chi^2\)</span>-Unabhängigkeitstests</strong> besteht darin, die <strong>beobachteten Häufigkeiten</strong> in einer Kontingenztabelle mit den <strong>erwarteten Häufigkeiten</strong> zu vergleichen, unter der Annahme das die Nullhypothese der Nicht-Assoziation wahr ist. Die erwartete Häufigkeit für jede Zelle einer Kontingenztabelle ist gegeben durch</p>
<div class="math notranslate nohighlight">
\[E = \frac{R\times C}{n} \text{,}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(R\)</span> die Zeilensumme ist, <span class="math notranslate nohighlight">\(C\)</span> die Spaltensumme und <span class="math notranslate nohighlight">\(n\)</span> der Stichprobenumfang ist.</p>
<p>Lassen Sie uns zum besseren Verständnis ein Beispiel konstruieren. Wir betrachten eine Exit Poll in Form einer Kontingenztabelle, die das Alter von <span class="math notranslate nohighlight">\(n=1189\)</span> Personen in den Kategorien <span class="math notranslate nohighlight">\(18-29\)</span>, <span class="math notranslate nohighlight">\(30-44\)</span>, <span class="math notranslate nohighlight">\(45-64\)</span> und <span class="math notranslate nohighlight">\(\gt 65\)</span> Jahre und ihre politische Zugehörigkeit, d. h. “Konservativ”, “Sozialistisch” und “Andere” aufgliedert. Diese Tabelle entspricht den beobachteten Häufigkeiten.</p>
<p><strong>Beobachtete Häufigkeiten:</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{|l|c|}
\hline
\ &amp; \text{Konservativ} &amp; \text{Sozialistisch} &amp; \text{Andere} &amp; \text{Insgesamt} \\
\hline
\ \text{18-29}  &amp; 141 &amp; 68 &amp; 4 &amp; 213\\
\ \text{30-44}  &amp; 179 &amp; 159 &amp; 7 &amp; 345\\
\ \text{45-64} &amp; 220 &amp; 216 &amp; 4 &amp; 440\\
\ \text{65 &amp; älter} &amp; 86 &amp; 101 &amp; 4 &amp; 191\\
\hline 
\  \text{Insgesamt} &amp; 626 &amp; 544 &amp; 19 &amp; 1189\\
\hline 
\end{array}
\end{split}\]</div>
<p>Auf der Grundlage der oben genannten Gleichung berechnen wir die erwartete Häufigkeit für jede Zelle.</p>
<p><strong>Erwartete Häufigkeiten:</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{|l|c|}
\hline
\ &amp; \text{Konservativ} &amp; \text{Sozialistisch} &amp; \text{Andere} &amp; \text{Insgesamt} \\
\hline
\ \text{18-29}  &amp; \frac{213 \times 626 }{1189} \approx 112,14 &amp; \frac{213 \times 544 }{1189} \approx97,45 &amp; \frac{213 \times 19 }{1189} \approx3,4 &amp; 213\\
\ \text{30-44}  &amp; \frac{345 \times 626 }{1189} \approx181,64 &amp;\frac{345 \times 544 }{1189} \approx 157,85 &amp; \frac{345 \times 19 }{1189} \approx5,51 &amp; 345\\
\ \text{45-64} &amp; \frac{440 \times 626 }{1189} \approx231,66 &amp; \frac{440 \times 544 }{1189} \approx201,31 &amp;\frac{440 \times 19 }{1189} \approx 7,03 &amp; 440\\
\ \text{65 &amp; älter} &amp;\frac{191 \times 626 }{1189} \approx 100,56 &amp;\frac{191 \times 544 }{1189} \approx 87,39 &amp; \frac{191 \times 19 }{1189} \approx3,05 &amp; 191\\
\hline 
\ \text{Insgesamt} &amp; 626 &amp; 544 &amp; 19 &amp; 1189\\
\hline 
\end{array}
\end{split}\]</div>
<p>Sobald wir die erwarteten Häufigkeiten kennen, müssen wir zwei Annahmen überprüfen. Erstens müssen wir sicherstellen, dass alle erwarteten Häufigkeiten <span class="math notranslate nohighlight">\(1\)</span> oder größer sind, und zweitens, dass höchstens <span class="math notranslate nohighlight">\(20 \%\)</span> der erwarteten Häufigkeiten kleiner als <span class="math notranslate nohighlight">\(5\)</span> sind. Ein Blick auf die Tabelle bestätigt, dass beide Annahmen erfüllt sind.</p>
<p>Der eigentliche Vergleich erfolgt auf der Grundlage der <span class="math notranslate nohighlight">\(\chi^2\)</span> Teststatistik für die beobachtete Häufigkeit und die erwartete Häufigkeit. Die -Teststatistik folgt der <span class="math notranslate nohighlight">\(\chi^2\)</span>-Verteilung und ist gegeben durch</p>
<div class="math notranslate nohighlight">
\[\chi^2= \sum{\frac{(O-E)^2}{E}}\text{,}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(O\)</span> für die beobachtete Häufigkeit und <span class="math notranslate nohighlight">\(E\)</span> für die erwartete Häufigkeit steht. Bitte beachten Sie, dass <span class="math notranslate nohighlight">\(\frac{(O-E)^2}{E}\)</span> für jede Zelle ausgewertet und dann aufsummiert wird.</p>
<p>Die Anzahl der Freiheitsgrade ist gegeben durch</p>
<div class="math notranslate nohighlight">
\[df = (r-1) \times (c-1)\text{,}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(r\)</span> und <span class="math notranslate nohighlight">\(c\)</span> die Anzahl der möglichen Werte für die beiden betrachteten Variablen sind.</p>
<p>Übertragen auf das obige Beispiel führt dies zu einem etwas langen Ausdruck, der der Kürze halber nur für die erste und die letzte Zeile der interessierenden Kontingenztafeln angegeben wird.</p>
<div class="math notranslate nohighlight">
\[\chi^2 = \frac{(141 - 112,14)^2}{112,14} + \frac{(68 - 97,45)^2}{97,45} + \frac{(4 - 3,4)^2}{3,4}  + \cdots + \frac{(86 - 100,56)^2}{100,56} + \frac{(101 - 87,39)^2}{87,39} + \frac{(4 - 3,05)^2}{3,05}\]</div>
<p>Wenn die Nullhypothese wahr ist, sind die beobachtete und die erwartete Häufigkeit ungefähr gleich, was zu einem kleinen Wert der <span class="math notranslate nohighlight">\(\chi^2\)</span>-Teststatistik führt und somit <span class="math notranslate nohighlight">\(H_0\)</span> unterstützt. Ist der Wert der <span class="math notranslate nohighlight">\(\chi^2\)</span>-Teststatistik jedoch groß, liefern die Daten Beweise gegen <span class="math notranslate nohighlight">\(H_0\)</span>. In den nächsten Abschnitten wird weiter erörtert, wie der Wert der <span class="math notranslate nohighlight">\(\chi^2\)</span>-Teststatistik im Rahmen der Hypothesentests zu bewerten ist.</p>
</section>
<section id="chi-2-unabhangigkeitstest-ein-beispiel">
<h4><span class="math notranslate nohighlight">\(\chi^2\)</span> Unabhängigkeitstest: Ein Beispiel<a class="headerlink" href="#chi-2-unabhangigkeitstest-ein-beispiel" title="Permalink to this headline">#</a></h4>
<p>Um praktische Erfahrungen zu sammeln, wenden wir den <span class="math notranslate nohighlight">\(\chi^2\)</span> Unabhängigkeitstest in einer Übung an. Dazu laden wir den <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz. Sie können die Datei <code class="docutils literal notranslate"><span class="pre">students.csv</span></code> <a href="https://userpage.fu-berlin.de/soga/200/2010_data_sets/students.csv">hier</a> herunterladen. Importieren Sie den Datensatz und geben Sie ihm einen passenden Namen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lese Datei students.csv als Dataframe ein; Indexspalte wird übersprungen</span>
<span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../data/students.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Der <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz besteht aus <span class="math notranslate nohighlight">\(8239\)</span> Zeilen, von denen jede einen bestimmten Studenten repräsentiert, und <span class="math notranslate nohighlight">\(16\)</span> Spalten, von denen jede einer Variable/einem Merkmal entspricht, das sich auf diesen bestimmten Studenten bezieht. Diese selbsterklärenden Variablen sind: <em>stud_id, name, gender, age, height, weight, religion, nc_score, semester, major, minor, score1, score2, online_tutorial, graduated, salary.</em></p>
<p>In dieser Übung wollen wir untersuchen, <strong>ob es einen Zusammenhang zwischen den Variablen <code class="docutils literal notranslate"><span class="pre">gender</span></code> und <code class="docutils literal notranslate"><span class="pre">major</span></code> gibt, oder mit anderen Worten, wir wollen wissen, ob männliche Studenten andere Studienfächer bevorzugen als weibliche Studenten.</strong></p>
</section>
<section id="id2">
<h4>Vorbereitung der Daten<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h4>
<p>Wir beginnen mit der Datenaufbereitung. Da wir nicht den gesamten Datensatz von <span class="math notranslate nohighlight">\(8239\)</span> Einträgen bearbeiten wollen, wählen wir zufällig <span class="math notranslate nohighlight">\(865\)</span> Studenten aus dem Datensatz aus. Der erste Schritt der Datenvorbereitung besteht darin, die interessierenden Daten in Form einer Kontingenztabelle darzustellen. Pandas bietet die Funktion <code class="docutils literal notranslate"><span class="pre">crosstab()</span></code>, die diese Aufgabe übernehmen wird.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">865</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;major&quot;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;gender&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>gender</th>
      <th>Female</th>
      <th>Male</th>
    </tr>
    <tr>
      <th>major</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Biology</th>
      <td>89</td>
      <td>65</td>
    </tr>
    <tr>
      <th>Economics and Finance</th>
      <td>55</td>
      <td>79</td>
    </tr>
    <tr>
      <th>Environmental Sciences</th>
      <td>99</td>
      <td>96</td>
    </tr>
    <tr>
      <th>Mathematics and Statistics</th>
      <td>39</td>
      <td>92</td>
    </tr>
    <tr>
      <th>Political Science</th>
      <td>112</td>
      <td>40</td>
    </tr>
    <tr>
      <th>Social Sciences</th>
      <td>70</td>
      <td>29</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Außerdem bestimmen wir die Spaltensummen und die Zeilensummen. Python bietet das Argument <code class="docutils literal notranslate"><span class="pre">margins</span> <span class="pre">=</span> <span class="pre">True</span></code>, das die Zeilensummen und die Spaltensummen für uns hinzufügt.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">observed_frequencies</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span>
    <span class="n">index</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;major&quot;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;gender&quot;</span><span class="p">],</span> <span class="n">margins</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">observed_frequencies</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>gender</th>
      <th>Female</th>
      <th>Male</th>
      <th>All</th>
    </tr>
    <tr>
      <th>major</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Biology</th>
      <td>89</td>
      <td>65</td>
      <td>154</td>
    </tr>
    <tr>
      <th>Economics and Finance</th>
      <td>55</td>
      <td>79</td>
      <td>134</td>
    </tr>
    <tr>
      <th>Environmental Sciences</th>
      <td>99</td>
      <td>96</td>
      <td>195</td>
    </tr>
    <tr>
      <th>Mathematics and Statistics</th>
      <td>39</td>
      <td>92</td>
      <td>131</td>
    </tr>
    <tr>
      <th>Political Science</th>
      <td>112</td>
      <td>40</td>
      <td>152</td>
    </tr>
    <tr>
      <th>Social Sciences</th>
      <td>70</td>
      <td>29</td>
      <td>99</td>
    </tr>
    <tr>
      <th>All</th>
      <td>464</td>
      <td>401</td>
      <td>865</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Im nächsten Schritt konstruieren wir die <strong>erwarteten Häufigkeiten</strong>. Erinnern Sie sich an die Gleichung von oben:</p>
<div class="math notranslate nohighlight">
\[E = \frac{R\times C}{n} \text{,}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(R\)</span> die Zeilensumme ist, <span class="math notranslate nohighlight">\(C\)</span> die Spaltensumme und <span class="math notranslate nohighlight">\(n\)</span> der Stichprobenumfang ist.</p>
<p>Wir berechnen die erwarteten Häufigkeiten mit der Numpy-Funktion <code class="docutils literal notranslate"><span class="pre">outer</span></code>. Das Ergebnis wandeln wir dann in eine Pandas <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> um.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rows</span> <span class="o">=</span> <span class="n">observed_frequencies</span><span class="p">[</span><span class="s2">&quot;All&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">cols</span> <span class="o">=</span> <span class="n">observed_frequencies</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;All&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">observed_frequencies</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;All&quot;</span><span class="p">,</span> <span class="s2">&quot;All&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">expected_frequencies</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span><span class="p">,</span>
    <span class="n">index</span><span class="o">=</span><span class="n">observed_frequencies</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
    <span class="n">columns</span><span class="o">=</span><span class="n">observed_frequencies</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">expected_frequencies</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>gender</th>
      <th>Female</th>
      <th>Male</th>
      <th>All</th>
    </tr>
    <tr>
      <th>major</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Biology</th>
      <td>82.608092</td>
      <td>71.391908</td>
      <td>154.0</td>
    </tr>
    <tr>
      <th>Economics and Finance</th>
      <td>71.879769</td>
      <td>62.120231</td>
      <td>134.0</td>
    </tr>
    <tr>
      <th>Environmental Sciences</th>
      <td>104.601156</td>
      <td>90.398844</td>
      <td>195.0</td>
    </tr>
    <tr>
      <th>Mathematics and Statistics</th>
      <td>70.270520</td>
      <td>60.729480</td>
      <td>131.0</td>
    </tr>
    <tr>
      <th>Political Science</th>
      <td>81.535260</td>
      <td>70.464740</td>
      <td>152.0</td>
    </tr>
    <tr>
      <th>Social Sciences</th>
      <td>53.105202</td>
      <td>45.894798</td>
      <td>99.0</td>
    </tr>
    <tr>
      <th>All</th>
      <td>464.000000</td>
      <td>401.000000</td>
      <td>865.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Sobald wir die erwarteten Häufigkeiten kennen, müssen wir zwei Annahmen überprüfen. Erstens müssen wir sicherstellen, dass alle erwarteten Häufigkeiten <span class="math notranslate nohighlight">\(1\)</span> oder größer sind, und zweitens, dass höchstens <span class="math notranslate nohighlight">\(20 \%\)</span> der erwarteten Häufigkeiten kleiner als <span class="math notranslate nohighlight">\(5\)</span> sind. Durch einen Blick auf die Tabelle können wir bestätigen, dass beide Annahmen erfüllt sind.</p>
<p>Jetzt haben wir alle Daten, die wir für einen <span class="math notranslate nohighlight">\(\chi^2\)</span> Unabhängigkeitstest durchzuführen.</p>
</section>
<section id="id3">
<h4>Überprüfung der Hypothesen<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h4>
<p>Zur Durchführung des <strong><span class="math notranslate nohighlight">\(\chi^2\)</span>-Unabhängigkeitstests</strong> folgen wir dem Verfahren der schrittweisen Durchführung von Hypothesentests. Der <strong><span class="math notranslate nohighlight">\(\chi^2\)</span>-Unabhängigkeitstest</strong> folgt demselben schrittweisen Verfahren wie in den vorangegangenen Abschnitten beschrieben.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{l}
\hline
\ \text{Schritt 1}  &amp; \text{Geben Sie die Nullhypothese } H_0 \text{ und alternative Hypothese } H_A \text{ an.}\\
\ \text{Schritt 2}  &amp; \text{Legen Sie das Signifikanzniveau, } \alpha\text{ fest.} \\
\ \text{Schritt 3}  &amp; \text{Berechnen Sie den Wert der Teststatistik.} \\
\ \text{Schritt 4} &amp;\text{Bestimmen Sie den p-Wert.} \\
\ \text{Schritt 5} &amp; \text{Wenn} \ p \le \alpha \text{, } H_0 \text{ ablehnen } \text{; ansonsten } H_0 \text{ nicht ablehnen} \text{.} \\
\ \text{Schritt 6} &amp;\text{Interpretieren Sie das Ergebnis des Hypothesentests.} \\
\hline 
\end{array}
\end{split}\]</div>
<p><strong>Schritt 1 : Geben Sie die Nullhypothese <span class="math notranslate nohighlight">\(H_0\)</span> und alternative Hypothese <span class="math notranslate nohighlight">\(H_A\)</span> an</strong></p>
<p>Die Nullhypothese besagt, dass es keinen Zusammenhang zwischen dem Geschlecht und dem Hauptstudienfach der Studierenden gibt.</p>
<div class="math notranslate nohighlight">
\[H_0:\text{Kein Zusammenhang zwischen Geschlecht und Studienschwerpunkt}\]</div>
<p><strong>Alternative Hypothese</strong></p>
<div class="math notranslate nohighlight">
\[H_A:\text{Es gibt einen Zusammenhang zwischen dem Geschlecht und dem Hauptstudienfach}\]</div>
<p><strong>Schritt 2: Legen Sie das Signifikanzniveau,<span class="math notranslate nohighlight">\(\alpha\)</span> fest</strong></p>
<div class="math notranslate nohighlight">
\[\alpha = 0,05\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Schritt 3 und 4: Berechnen Sie den Wert der Teststatistik und den <span class="math notranslate nohighlight">\(p\)</span>-Wert</strong></p>
<p>Zur Veranschaulichung berechnen wir die Teststatistik manuell in Python. Erinnern Sie sich an die Gleichung für die Teststatistik von oben:</p>
<div class="math notranslate nohighlight">
\[\chi^2= \sum{\frac{(O-E)^2}{E}}\text{,}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(O\)</span> für die beobachtete Häufigkeit und <span class="math notranslate nohighlight">\(E\)</span> für die erwartete Häufigkeit steht.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chi_2</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">((</span><span class="n">observed_frequencies</span> <span class="o">-</span> <span class="n">expected_frequencies</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">expected_frequencies</span><span class="p">)</span>
    <span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">chi_2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>76.42971653913816
</pre></div>
</div>
</div>
</div>
<p>Der numerische Wert der Teststatistik beträgt <span class="math notranslate nohighlight">\(\approx 76,43\)</span>.</p>
<p>Um den <span class="math notranslate nohighlight">\(p\)</span>-Wert zu berechnen, verwenden wir die Funktion <code class="docutils literal notranslate"><span class="pre">chi2.cdf()</span></code>. Erinnern Sie sich daran, wie man die Freiheitsgrade berechnet:</p>
<div class="math notranslate nohighlight">
\[df = (r-1) \times (c-1)\text{,}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(r\)</span> und <span class="math notranslate nohighlight">\(c\)</span> die Anzahl der möglichen Werte für die beiden betrachteten Variablen sind.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="p">(</span><span class="n">observed_frequencies</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;All&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
    <span class="n">observed_frequencies</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;All&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>
<span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">chi2</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">chi_2</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.678888864647207e-15
</pre></div>
</div>
</div>
</div>
<p><strong>Schritt 5: Wenn <span class="math notranslate nohighlight">\(p \le \alpha , H_0\)</span> ablehnen; ansonsten <span class="math notranslate nohighlight">\(H_0\)</span> nicht ablehnen</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">&lt;=</span> <span class="n">alpha</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>Der <span class="math notranslate nohighlight">\(p\)</span>-Wert ist kleiner als das angegebene Signifikanzniveau von <span class="math notranslate nohighlight">\(0,05\)</span>; wir verwerfen <span class="math notranslate nohighlight">\(H_0\)</span>. Die Testergebnisse sind statistisch signifikant auf dem <span class="math notranslate nohighlight">\(5 \%\)</span>-Niveau und liefern einen sehr starken Beweis gegen die Nullhypothese.</p>
<p><strong>Schritt 6: Interpretieren Sie das Ergebnis des Hypothesentests</strong></p>
<p><span class="math notranslate nohighlight">\(p=4,67888886 \cdot 10^{-15}\)</span>. Bei einem Signifikanzniveau von <span class="math notranslate nohighlight">\(5 \%\)</span> lassen die Daten den Schluss zu, dass es einen Zusammenhang zwischen dem Geschlecht und dem Hauptstudienfach gibt</p>
</section>
<section id="id4">
<h4>Hypothesentests in Python<a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h4>
<p>Wir haben gerade einen <span class="math notranslate nohighlight">\(\chi^2\)</span> Unabhängigkeitstest manuell durchgeführt. Wir können dasselbe in Python mit nur einer Zeile Code tun!</p>
<p>Dazu wenden wir die Funktion <code class="docutils literal notranslate"><span class="pre">chi2_contingency()</span></code> an. Wir achten darauf die Spalte und die Reihe <code class="docutils literal notranslate"><span class="pre">All</span></code> zu exkludieren.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stat</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">dof</span><span class="p">,</span> <span class="n">expected</span> <span class="o">=</span> <span class="n">chi2_contingency</span><span class="p">(</span>
    <span class="n">observed_frequencies</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;All&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;All&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p- Wert :&quot;</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Freiheitsgrade :&quot;</span><span class="p">,</span> <span class="n">dof</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;chi^2 :&quot;</span><span class="p">,</span> <span class="n">stat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>p- Wert : 4.6788888646472395e-15
Freiheitsgrade : 5
chi^2 : 76.42971653913814
</pre></div>
</div>
</div>
</div>
<p>Perfekt! Vergleichen Sie die Ausgabe der Funktion <code class="docutils literal notranslate"><span class="pre">chi2_contingency()</span></code> mit unserem Ergebnis von oben. Auch hier können wir zu dem Schluss kommen, dass die Daten bei einem Signifikanzniveau von <span class="math notranslate nohighlight">\(5 \%\)</span> sehr starke Anhaltspunkte dafür liefern, dass es einen Zusammenhang zwischen dem Geschlecht und dem Hauptstudienfach gibt.</p>
</section>
</section>
</section>
<span id="document-Kapitel06/06_Inferenz_Regression_und_Korrelation"></span><section class="tex2jax_ignore mathjax_ignore" id="inferenzmethoden-in-regression-und-korrelation">
<h2>Inferenzmethoden in Regression und Korrelation<a class="headerlink" href="#inferenzmethoden-in-regression-und-korrelation" title="Permalink to this headline">#</a></h2>
<p>Das lineare Modell ergibt sich aus der Gleichung</p>
<div class="math notranslate nohighlight">
\[y = \beta_0 + \beta_1x+e\text{,}\]</div>
<p>Wobei <span class="math notranslate nohighlight">\(\beta_0\)</span> der Achsenabschnitt, <span class="math notranslate nohighlight">\(\beta_1\)</span> der Regressionskoeffizient und <span class="math notranslate nohighlight">\(e\)</span> der Fehlerterm ist. Die beste Regressionsgerade wird durch Anwendung der <a href="https://de.wikipedia.org/wiki/Methode_der_kleinsten_Quadrate">Methode der kleinsten Quadrate</a> gefunden, um die <strong>Summe der quadratischen Fehler (SSE)</strong> zu minimieren, d. h. die quadratische Differenz zwischen der gemessenen Reaktionsvariablen <span class="math notranslate nohighlight">\(y\)</span> und der Modellvorhersage <span class="math notranslate nohighlight">\(\hat y\)</span> zu minimieren, die wie folgt lautet</p>
<div class="math notranslate nohighlight">
\[SSE = \sum_{i=1}^n e_i^2=\sum_{i=1}^n (y - \hat y)^2\text{.}\]</div>
<p>Im Abschnitt über die <em>lineare Regression</em> finden Sie weitere Einzelheiten zum linearen Modell.</p>
<p>Wie auch immer, wir müssen anerkennen, dass wir unsere Modelle, in diesem Fall unser lineares Regressionsmodell, auf Beobachtungsdaten aufbauen. Die Daten stammen also aus einer Grundgesamtheit und deren entsprechenden statistischen Eigenschaften, die uns im Allgemeinen unbekannt sind. Jede Beobachtung stellt also eine Ausprägung der Population dar, die mit dem Begriff Zufallsvariable bezeichnet wird.</p>
<p>Betrachten wir ein Beispiel, wie es in der folgenden Abbildung dargestellt ist. In diesem Beispiel sind die Parameter der Grundgesamtheit bekannt, so dass wir ein lineares Regressionsmodell der Form <span class="math notranslate nohighlight">\(y=β_0+β_1x=1+0,25x\)</span> erstellen können</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">linregress</span>


<span class="k">def</span> <span class="nf">generate_dataset_simple</span><span class="p">(</span><span class="n">intercept</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">std_dev</span><span class="p">,</span> <span class="n">min_max_x</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">min_max_x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">min_max_x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="n">std_dev</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">beta</span> <span class="o">+</span> <span class="n">e</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>


<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">generate_dataset_simple</span><span class="p">(</span><span class="n">intercept</span><span class="o">=</span><span class="mf">1.01</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">linregress</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$y=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">intercept</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> + </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">x$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">28</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Grundgesamtheit&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Grundgesamtheit&#39;)
</pre></div>
</div>
<img alt="_images/06_Inferenz_Regression_und_Korrelation_7_1.png" src="_images/06_Inferenz_Regression_und_Korrelation_7_1.png" />
</div>
</div>
<p>Wenn wir jedoch eine Zufallsstichprobe aus der Grundgesamtheit nehmen und ein lineares Modell auf der Grundlage der Stichprobendaten erstellen, wird die Regressionslinie der Stichprobe nicht mit der Regressionslinie der Grundgesamtheit übereinstimmen. In der folgenden Abbildung haben wir vier Stichproben mit dem Stichprobenumfang <span class="math notranslate nohighlight">\(10\)</span> (blaue Punkte) gezogen. Wir sehen sofort, dass die Regressionslinie der Stichprobe (blaue gestrichelte Linie) nicht mit der Regressionslinie der Grundgesamtheit (graue Linie) übereinstimmt. Um dieser Variabilität Rechnung zu tragen, die auf den Zufallsstichprobenprozess zurückzuführen ist, wird eine Statistik berechnet, indem die folgende Gleichung angewendet wird</p>
<div class="math notranslate nohighlight">
\[s_e = \sqrt{\frac{SSE}{n-2}}\text{,}\]</div>
<p>Wobei SSE für die <strong>Summe der quadratischen Fehler</strong> und <span class="math notranslate nohighlight">\(n\)</span> für den Stichprobenumfang steht. Die Statistik <span class="math notranslate nohighlight">\(s_e\)</span> wird als <strong>Standardfehler der Schätzung</strong> (<span class="math notranslate nohighlight">\(s_e\)</span>) oder als <strong>Reststandardfehler</strong> bezeichnet.</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">_x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
    <span class="n">_y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">_y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
    <span class="p">(</span><span class="n">_slope</span><span class="p">,</span> <span class="n">_intercept</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">stderr</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">linregress</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">_x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">_y</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">_intercept</span> <span class="o">+</span> <span class="n">_slope</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$s_e=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/06_Inferenz_Regression_und_Korrelation_11_0.png" src="_images/06_Inferenz_Regression_und_Korrelation_11_0.png" />
</div>
</div>
<p>Wie oben dargestellt, variiert die Regressionsgerade der Stichprobe von einer Stichprobe zur anderen und ist daher eine Zufallsvariable. Ihre Verteilung wird als <strong>Stichprobenverteilung der Steigung der Regressionsgeraden</strong> bezeichnet.</p>
<section id="inferenz-uber-die-steigung-der-t-test-des-regressionskoeffizienten">
<h3>Inferenz über die Steigung - Der <span class="math notranslate nohighlight">\(t\)</span>-Test des Regressionskoeffizienten<a class="headerlink" href="#inferenz-uber-die-steigung-der-t-test-des-regressionskoeffizienten" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">sample</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">t</span><span class="p">,</span> <span class="n">linregress</span>
</pre></div>
</div>
</div>
</div>
<p>Der <strong><span class="math notranslate nohighlight">\(t\)</span>-Test des Regressionskoeffizienten</strong> wird angewendet, um zu prüfen, ob die Steigung <span class="math notranslate nohighlight">\(\beta_1\)</span> der Regressionslinie der Grundgesamtheit gleich <span class="math notranslate nohighlight">\(0\)</span> ist. Auf der Grundlage dieses Tests können wir entscheiden, ob <span class="math notranslate nohighlight">\(x\)</span> ein nützlicher (linearer) Vorhersagewert für <span class="math notranslate nohighlight">\(y\)</span> ist.</p>
<p>Die Teststatistik folgt einer <span class="math notranslate nohighlight">\(t\)</span>-Verteilung mit <span class="math notranslate nohighlight">\(df=n-2\)</span> und kann geschrieben werden als</p>
<div class="math notranslate nohighlight">
\[t =\frac{\beta_1}{s_b}= \frac{\beta_1}{s_e/\sqrt{\sum(x- \bar x)^2}}\text{,}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(\beta_1\)</span> dem Stichprobenregressionskoeffizienten und <span class="math notranslate nohighlight">\(s_e\)</span> dem <strong>Reststandardfehler</strong> entspricht <span class="math notranslate nohighlight">\((s_e=\sqrt{\frac{SSE}{n-2}}\)</span> und <span class="math notranslate nohighlight">\(SSE = \sum_{i=1}^n e_i^2)\)</span></p>
<section id="intervall-schatzung-von-beta-1">
<h4>Intervall-Schätzung von <span class="math notranslate nohighlight">\(\beta_1\)</span><a class="headerlink" href="#intervall-schatzung-von-beta-1" title="Permalink to this headline">#</a></h4>
<p>Das <span class="math notranslate nohighlight">\(100(1-\alpha)\%\)</span>-Konfidenzintervall für <span class="math notranslate nohighlight">\(\beta_1\)</span> ist gegeben durch</p>
<div class="math notranslate nohighlight">
\[\beta_1 \pm t_{\alpha/2} \times  \frac{s_e}{\sqrt{\sum(x- \bar x)^2}}\text{,}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(s_e\)</span> dem <strong>Reststandardfehler</strong> (auch als <strong>Standardfehler der Schätzung</strong> bezeichnet) entspricht.</p>
<p>Der Wert von <span class="math notranslate nohighlight">\(t\)</span> ergibt sich aus der <span class="math notranslate nohighlight">\(t\)</span>-Verteilung für das gegebene Konfidenzniveau und <span class="math notranslate nohighlight">\(n-2\)</span> Freiheitsgrade.</p>
</section>
<section id="der-t-test-des-regressionskoeffizienten-ein-beispiel">
<h4>Der <span class="math notranslate nohighlight">\(t\)</span>-Test des Regressionskoeffizienten: Ein Beispiel<a class="headerlink" href="#der-t-test-des-regressionskoeffizienten-ein-beispiel" title="Permalink to this headline">#</a></h4>
<p>Um praktische Erfahrungen zu sammeln, wenden wir den <strong>Regressions-<span class="math notranslate nohighlight">\(t\)</span>-Test</strong> in einer Übung an. Dazu laden wir den <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz. Sie können die Datei <code class="docutils literal notranslate"><span class="pre">students.csv</span></code> <a href="https://userpage.fu-berlin.de/soga/200/2010_data_sets/students.csv">hier</a> herunterladen. Importieren Sie den Datensatz und geben Sie ihm einen passenden Namen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lese Datei students.csv als Dataframe ein; Indexspalte wird übersprungen</span>
<span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../data/students.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Der <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz besteht aus 8239 Zeilen, von denen jede einen bestimmten Studenten repräsentiert, und 16 Spalten, von denen jede einer Variable/einem Merkmal entspricht, das sich auf diesen bestimmten Studenten bezieht. Diese selbsterklärenden Variablen sind: stud_id, name, gender, age, height, weight, religion, nc_score, semester, major, minor, score1, score2, online_tutorial, graduated, salary.</p>
<p>Um den <span class="math notranslate nohighlight">\(t\)</span>-Test des Regressionskoeffizienten zu veranschaulichen, untersuchen wir die Beziehung zwischen zwei Variablen, der Körpergröße der Studenten als Vorhersagevariable und dem Gewicht der Studenten als Antwortvariable. <strong>Die Frage ist, ob die Vorhersagevariable <code class="docutils literal notranslate"><span class="pre">height</span></code> nützlich ist, um Vorhersagen über das Gewicht der Studierenden zu treffen.</strong></p>
</section>
<section id="vorbereitung-der-daten">
<h4>Vorbereitung der Daten<a class="headerlink" href="#vorbereitung-der-daten" title="Permalink to this headline">#</a></h4>
<p>Zur Datenaufbereitung ziehen wir eine Zufallsstichprobe von <span class="math notranslate nohighlight">\(12\)</span> Studenten aus dem Datensatz und erstellen einen <code class="docutils literal notranslate"><span class="pre">dataframe</span></code> mit den zwei Variablen von Interesse (<code class="docutils literal notranslate"><span class="pre">height</span></code> und <code class="docutils literal notranslate"><span class="pre">weight</span></code>). Außerdem stellen wir die Daten in Form eines Streudiagramms dar, um die zugrunde liegende lineare Beziehung zwischen den beiden Variablen zu visualisieren.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Nehme Stichprobe</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">students</span><span class="p">[[</span><span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>height</th>
      <th>weight</th>
    </tr>
    <tr>
      <th>stud_id</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>769350</th>
      <td>169</td>
      <td>71.7</td>
    </tr>
    <tr>
      <th>886785</th>
      <td>181</td>
      <td>81.0</td>
    </tr>
    <tr>
      <th>648615</th>
      <td>148</td>
      <td>57.8</td>
    </tr>
    <tr>
      <th>501070</th>
      <td>173</td>
      <td>72.1</td>
    </tr>
    <tr>
      <th>649588</th>
      <td>168</td>
      <td>70.7</td>
    </tr>
    <tr>
      <th>822135</th>
      <td>159</td>
      <td>66.1</td>
    </tr>
    <tr>
      <th>261234</th>
      <td>169</td>
      <td>69.5</td>
    </tr>
    <tr>
      <th>249763</th>
      <td>159</td>
      <td>62.5</td>
    </tr>
    <tr>
      <th>211480</th>
      <td>173</td>
      <td>70.7</td>
    </tr>
    <tr>
      <th>934141</th>
      <td>164</td>
      <td>68.5</td>
    </tr>
    <tr>
      <th>399893</th>
      <td>171</td>
      <td>70.8</td>
    </tr>
    <tr>
      <th>413775</th>
      <td>160</td>
      <td>62.9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Erzeuge Streudiagramm</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Größe&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Gewicht&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Gewicht&#39;)
</pre></div>
</div>
<img alt="_images/06_Inferenz_Regression_und_Korrelation_30_1.png" src="_images/06_Inferenz_Regression_und_Korrelation_30_1.png" />
</div>
</div>
<p>Die visuelle Inspektion bestätigt unsere Vermutung, dass die Beziehung zwischen der Größe und der Gewichtsvariable ungefähr linear ist. Mit anderen Worten: Mit zunehmender Größe neigt der einzelne Student dazu, ein höheres Gewicht zu haben.</p>
</section>
<section id="uberprufung-der-hypothesen">
<h4>Überprüfung der Hypothesen<a class="headerlink" href="#uberprufung-der-hypothesen" title="Permalink to this headline">#</a></h4>
<p>Zur Durchführung des <strong><span class="math notranslate nohighlight">\(t\)</span>-Test des Regressionskoeffizienten</strong> folgen wir dem schrittweisen Durchführungsverfahren für Hypothesentests. Der <strong><span class="math notranslate nohighlight">\(t\)</span>-Test des Regressionskoeffizienten</strong> folgt demselben schrittweisen Verfahren wie in den vorangegangenen Abschnitten beschrieben.</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Schritt 1</p></td>
<td><p>Geben Sie die Nullhypothese <span class="math notranslate nohighlight">\(H_0\)</span> und alternative Hypothese <span class="math notranslate nohighlight">\(H_A\)</span> an</p></td>
</tr>
<tr class="row-odd"><td><p>Schritt 2</p></td>
<td><p>Legen Sie das Signifikanzniveau,<span class="math notranslate nohighlight">\(\alpha\)</span> fest</p></td>
</tr>
<tr class="row-even"><td><p>Schritt 3</p></td>
<td><p>Berechnen Sie den Wert der Teststatistik</p></td>
</tr>
<tr class="row-odd"><td><p>Schritt 4</p></td>
<td><p>Bestimmen Sie den p-Wert</p></td>
</tr>
<tr class="row-even"><td><p>Schritt 5</p></td>
<td><p>Wenn <span class="math notranslate nohighlight">\(p \le \alpha\)</span>, <span class="math notranslate nohighlight">\(H_0\)</span> ablehnen; ansonsten <span class="math notranslate nohighlight">\(H_0\)</span> nicht ablehnen</p></td>
</tr>
<tr class="row-odd"><td><p>Schritt 6</p></td>
<td><p>Interpretieren Sie das Ergebnis des Hypothesentests</p></td>
</tr>
</tbody>
</table>
<p><strong>Schritt 1 : Geben Sie die Nullhypothese <span class="math notranslate nohighlight">\(H_0\)</span> und alternative Hypothese <span class="math notranslate nohighlight">\(H_A\)</span> an</strong></p>
<p>Die Nullhypothese besagt, dass es keinen linearen Zusammenhang zwischen der Größe und dem Gewicht der Personen im Datensatz der Studierenden gibt.</p>
<div class="math notranslate nohighlight">
\[H_0: \beta_1=0\text{ (die Vorhersagevariable ist für die Erstellung von Vorhersagen nicht geeignet)}\]</div>
<p><strong>Alternative Hypothese</strong></p>
<div class="math notranslate nohighlight">
\[H_A: \beta_1\ne0\text{ (die Vorhersagevariable ist für die Erstellung von Vorhersagen geeignet)}\]</div>
<p><strong>Schritt 2: Legen Sie das Signifikanzniveau,<span class="math notranslate nohighlight">\(\alpha\)</span> fest</strong></p>
<div class="math notranslate nohighlight">
\[\alpha = 0,01\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.01</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Schritt 3 und 4: Berechnen Sie den Wert der Teststatistik und den <span class="math notranslate nohighlight">\(p\)</span>-Wert</strong></p>
<p>Zur Veranschaulichung berechnen wir die Teststatistik manuell in Python. Erinnern Sie sich an die obige Gleichung.</p>
<div class="math notranslate nohighlight">
\[t =\frac{\beta_1}{s_b}= \frac{\beta_1}{s_e/\sqrt{\sum(x- \bar x)^2}}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(\beta_1 = \frac{cov(x,y)}{var(x)}\)</span>, und</p>
<div class="math notranslate nohighlight">
\[s_e = \sqrt{\frac{SSE}{n-2}}\text{,}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(SSE = \sum_{i=1}^n e_i^2 = \sum_{i=1}^n (y - \hat y)^2\)</span>. Die Teststatistik folgt einer <span class="math notranslate nohighlight">\(t\)</span>-Verteilung mit <span class="math notranslate nohighlight">\(df=n-2\)</span>. Um <span class="math notranslate nohighlight">\(\hat y = \beta_0+\beta_1x\)</span> zu berechnen, müssen wir <span class="math notranslate nohighlight">\(\beta_0\)</span> kennen, das als <span class="math notranslate nohighlight">\(\beta_0 = \bar y -\beta_1 \bar x\)</span> berechnet wird.</p>
<p>Um nicht durch die verschiedenen Berechnungsschritte verwirrt zu werden, führen wir einen Schritt nach dem anderen durch.</p>
<ul class="simple">
<li><p>Erstellen Sie das lineare Modell durch Berechnung des Achsenabschnitts (<span class="math notranslate nohighlight">\(β_0\)</span>) und des Regressionskoeffizienten (<span class="math notranslate nohighlight">\(β_1\)</span>).</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_bar</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">x_bar</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Lineares Modell</span>
<span class="n">beta1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
<span class="n">beta1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6507615230460922
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">beta0</span> <span class="o">=</span> <span class="n">y_bar</span> <span class="o">-</span> <span class="n">beta1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">x_bar</span>
<span class="n">beta0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-39.44320641282566
</pre></div>
</div>
</div>
</div>
<p>Berechnen Sie die Summe der quadrierten Fehler (<span class="math notranslate nohighlight">\(SSE\)</span>) und den Reststandardfehler (<span class="math notranslate nohighlight">\(s_e\)</span>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne SSE</span>
<span class="n">y_hat</span> <span class="o">=</span> <span class="n">beta0</span> <span class="o">+</span> <span class="n">beta1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span>
<span class="n">SSE</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_hat</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">SSE</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>30.38618436873755
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne Reststandardfehler</span>
<span class="n">se</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">SSE</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">se</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.743163341994592
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Berechnen Sie den Wert der Teststatistik.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne Teststatistik</span>
<span class="n">tw</span> <span class="o">=</span> <span class="n">beta1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">se</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_bar</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)))</span>
<span class="n">tw</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10.766100516207496
</pre></div>
</div>
</div>
</div>
<p>Der numerische Wert der Teststatistik ist <span class="math notranslate nohighlight">\(\approx 10,7661\)</span>.</p>
<p>Um den <span class="math notranslate nohighlight">\(p\)</span>-Wert zu berechnen, wenden wir die Funktion <code class="docutils literal notranslate"><span class="pre">t.cdf()</span></code> an. Erinnern Sie sich daran, wie man die Freiheitsgrade berechnet.</p>
<div class="math notranslate nohighlight">
\[df = n - 2= 10\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne p-Wert</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span>

<span class="c1"># zweiseitiger Test</span>
<span class="n">p_upper</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">tw</span><span class="p">),</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">p_lower</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">tw</span><span class="p">),</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">p_upper</span> <span class="o">+</span> <span class="n">p_lower</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8.048424329265031e-07
</pre></div>
</div>
</div>
</div>
<p><strong>Schritt 5: Wenn <span class="math notranslate nohighlight">\(p \le \alpha , H_0\)</span> ablehnen; ansonsten <span class="math notranslate nohighlight">\(H_0\)</span> nicht ablehnen</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">&lt;=</span> <span class="n">alpha</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>Der <span class="math notranslate nohighlight">\(p\)</span>-Wert ist kleiner als das angegebene Signifikanzniveau von <span class="math notranslate nohighlight">\(0,01\)</span>; wir verwerfen <span class="math notranslate nohighlight">\(H_0\)</span>. Die Testergebnisse sind statistisch signifikant auf dem <span class="math notranslate nohighlight">\(1 \%\)</span>-Niveau und liefern einen sehr starken Beweis gegen die Nullhypothese.</p>
<p><strong>Schritt 6: Interpretieren Sie das Ergebnis des Hypothesentests</strong></p>
<p><span class="math notranslate nohighlight">\(p=8,0484243 \cdot 10^{-7}\)</span>. Bei einem Signifikanzniveau von <span class="math notranslate nohighlight">\(1 \%\)</span> lassen die Daten den Schluss zu, dass die Variable Größe ein guter Schätzer für das Gewicht der Studenten ist.</p>
</section>
<section id="hypothesentests-in-python">
<h4>Hypothesentests in Python<a class="headerlink" href="#hypothesentests-in-python" title="Permalink to this headline">#</a></h4>
<p>Wir haben gerade einen <strong><span class="math notranslate nohighlight">\(t\)</span>-Test des Regressionskoeffizienten</strong> in Python manuell berechnet. Das ist in Ordnung, aber wir können dasselbe in Python mit nur ein paar Zeilen Code tun!</p>
<p>Daher müssen wir die Funktion <code class="docutils literal notranslate"><span class="pre">linregress()</span></code> auf unsere Antwortvariable <code class="docutils literal notranslate"><span class="pre">weight</span></code> und unsere Vorhersagevariable <code class="docutils literal notranslate"><span class="pre">height</span></code> anwenden.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gradient</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">stderr</span> <span class="o">=</span> <span class="n">linregress</span><span class="p">(</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p-value&quot;</span><span class="p">,</span> <span class="n">p_value</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>p-value 8.048424329265105e-07
</pre></div>
</div>
</div>
</div>
<p>Für den Vergleich mit den manuell berechneten Werten extrahieren wir den Achsenabschnitt <span class="math notranslate nohighlight">\(\beta_0\)</span> und die Steigung <span class="math notranslate nohighlight">\(\beta_1\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Achsenabschnitt: </span><span class="si">{</span><span class="n">intercept</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Steigung:        </span><span class="si">{</span><span class="n">gradient</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Achsenabschnitt: -39.44320641282562
Steigung:        0.650761523046092
</pre></div>
</div>
</div>
</div>
<p>Vergleichen Sie die Ausgabe mit unseren Ergebnissen von oben. Sie passen perfekt!</p>
</section>
</section>
<section id="inferenzstatistik-der-lineare-korrelationskoeffizienten">
<h3>Inferenzstatistik - Der lineare Korrelationskoeffizienten<a class="headerlink" href="#inferenzstatistik-der-lineare-korrelationskoeffizienten" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">sample</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">t</span><span class="p">,</span> <span class="n">pearsonr</span>
</pre></div>
</div>
</div>
</div>
<p>Um zu prüfen, ob zwei Variablen linear korreliert sind, d. h. ob eine lineare Beziehung zwischen den beiden Variablen besteht, können wir den so genannten <strong><span class="math notranslate nohighlight">\(t\)</span>-Test zur Prüfung des Korrelationskoeffizienten</strong> anwenden. Der <strong>lineare Korrelationskoeffizient der Grundgesamtheit</strong>, <span class="math notranslate nohighlight">\(\rho\)</span>, misst die lineare Korrelation zweier Variablen auf die gleiche Weise wie der <strong>lineare Korrelationskoeffizient der Stichprobe</strong>, <span class="math notranslate nohighlight">\(r\)</span>, die lineare Korrelation zweier Variablen einer Stichprobe von Paaren misst. Sowohl <span class="math notranslate nohighlight">\(\rho\)</span> als auch <span class="math notranslate nohighlight">\(r\)</span> beschreiben die Stärke der linearen Beziehung zwischen zwei Variablen; <span class="math notranslate nohighlight">\(r\)</span> ist jedoch eine Schätzung von <span class="math notranslate nohighlight">\(\rho\)</span> der aus Stichprobendaten gewonnen wird.</p>
<p>Der lineare Korrelationskoeffizient von zwei Variablen liegt zwischen <span class="math notranslate nohighlight">\(-1\)</span> und <span class="math notranslate nohighlight">\(1\)</span>. Bei <span class="math notranslate nohighlight">\(\rho=0\)</span> sind die Variablen linear unkorreliert, es besteht also keine lineare Beziehung zwischen den Variablen. Bei <span class="math notranslate nohighlight">\(\rho \ne 0\)</span> sind die Variablen linear korreliert. Wenn <span class="math notranslate nohighlight">\(\rho \gt 0\)</span>, sind die Variablen positiv linear korreliert, und wenn <span class="math notranslate nohighlight">\(\rho \lt 0\)</span> sind die Variablen negativ linear korreliert.</p>
<p>Eine häufig verwendete Statistik zur Berechnung der linearen Beziehung zwischen quantitativen Variablen ist der <a href="https://de.wikipedia.org/wiki/Korrelationskoeffizient">Pearson-Produkt-Moment-Korrelationskoeffizient</a>. Er ist gegeben durch</p>
<div class="math notranslate nohighlight">
\[r = \frac{\sum_{i=1}^n(x_i- \bar x)(y_i - \bar y)}{\sqrt{\sum_{i=1}^n(x_i- \bar x)^2}\sqrt{\sum_{i=1}^n(y_i- \bar y)^2}}=\frac{s_{xy}}{s_x s_y}\text{,}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(s_{xy}\)</span> die Kovarianz von <span class="math notranslate nohighlight">\(x\)</span> und <span class="math notranslate nohighlight">\(y\)</span> ist und <span class="math notranslate nohighlight">\(s_x\)</span> und <span class="math notranslate nohighlight">\(s_y\)</span> die Standardabweichungen von <span class="math notranslate nohighlight">\(x\)</span> bzw. <span class="math notranslate nohighlight">\(y\)</span> sind.</p>
<p>Da der lineare Korrelationskoeffizient der Stichprobe, <span class="math notranslate nohighlight">\(r\)</span> eine Schätzung des linearen Korrelationskoeffizienten der Grundgesamtheit, <span class="math notranslate nohighlight">\(\rho\)</span>, ist, können wir <span class="math notranslate nohighlight">\(r\)</span> für einen Hypothesentest für <span class="math notranslate nohighlight">\(\rho\)</span> verwenden. Die Teststatistik für einen Korrelationstest hat eine <span class="math notranslate nohighlight">\(t\)</span>-Verteilung mit <span class="math notranslate nohighlight">\(n-2\)</span> Freiheitsgraden und kann wie folgt geschrieben werden</p>
<div class="math notranslate nohighlight">
\[t= \frac{r}{\sqrt{\frac{1-r^2}{n-2}}}\text{.}\]</div>
<section id="der-t-test-zur-prufung-des-korrelationskoeffizienten-ein-beispiel">
<h4>Der <span class="math notranslate nohighlight">\(t\)</span>-test zur Prüfung des Korrelationskoeffizienten: Ein Beispiel<a class="headerlink" href="#der-t-test-zur-prufung-des-korrelationskoeffizienten-ein-beispiel" title="Permalink to this headline">#</a></h4>
<p>Um den <span class="math notranslate nohighlight">\(t\)</span>-Test für den Korrelationskoeffizienten zu üben, laden wir den <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz. Sie können die Datei <code class="docutils literal notranslate"><span class="pre">students.csv</span></code> <a href="https://userpage.fu-berlin.de/soga/200/2010_data_sets/students.csv">hier</a> herunterladen. Importieren Sie den Datensatz und geben Sie ihm einen passenden Namen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lese Datei students.csv als Dataframe ein; Indexspalte wird übersprungen</span>
<span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../data/students.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Der <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz besteht aus <span class="math notranslate nohighlight">\(8239\)</span> Zeilen, von denen jede einen bestimmten Studenten repräsentiert, und <span class="math notranslate nohighlight">\(16\)</span> Spalten, von denen jede einer Variable/einem Merkmal entspricht, das sich auf diesen bestimmten Studenten bezieht. Diese selbsterklärenden Variablen sind: <em>stud_id, name, gender, age, height, weight, religion, nc_score, semester, major, minor, score1, score2, online_tutorial, graduated, salary.</em></p>
<p>Um den <span class="math notranslate nohighlight">\(t\)</span>-Test für die Korrelation zu veranschaulichen, untersuchen wir die Beziehung zwischen den Variablen <code class="docutils literal notranslate"><span class="pre">score1</span></code> und <code class="docutils literal notranslate"><span class="pre">score2</span></code>, die das Ergebnis von zwei obligatorischen statistischen Prüfungen darstellen. <strong>Die Frage ist, ob es eine lineare Beziehung zwischen den Noten von zwei aufeinanderfolgenden statistischen Prüfungen gibt?</strong></p>
</section>
<section id="id1">
<h4>Vorbereitung der Daten<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h4>
<p>Wir beginnen mit der Datenvorbereitung.</p>
<ul class="simple">
<li><p>Wir unterteilen den Datensatz anhand der Variablen <code class="docutils literal notranslate"><span class="pre">score1</span></code> und <code class="docutils literal notranslate"><span class="pre">score2</span></code>. Durch Anwendung der Funktion <code class="docutils literal notranslate"><span class="pre">dropna()</span></code> lassen wir alle <code class="docutils literal notranslate"><span class="pre">nan</span></code>-Werte im Datensatz aus.</p></li>
<li><p>Dann ziehen wir aus jeder Teilmenge 50 Studierende und extrahieren die Variablen von Interesse.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">dropna</span><span class="p">()[[</span><span class="s2">&quot;score1&quot;</span><span class="p">,</span> <span class="s2">&quot;score2&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">score1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;score1&quot;</span><span class="p">]</span>
<span class="n">score2</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;score2&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Zum Zweck der visuellen Kontrolle stellen wir die Stichprobe in Form eines Streudiagramms dar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Erzeuge Streudiagramm</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">score1</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">score2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;score1&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;score2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;score2&#39;)
</pre></div>
</div>
<img alt="_images/06_Inferenz_Regression_und_Korrelation_86_1.png" src="_images/06_Inferenz_Regression_und_Korrelation_86_1.png" />
</div>
</div>
<p>Die visuelle Inspektion zeigt, dass eine positive lineare Beziehung zwischen den Variablen <code class="docutils literal notranslate"><span class="pre">score1</span></code> und <code class="docutils literal notranslate"><span class="pre">score2</span></code> besteht.</p>
</section>
<section id="id2">
<h4>Überprüfung der Hypothesen<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h4>
<p>Zur Durchführung des <span class="math notranslate nohighlight">\(t\)</span>-Tests für die Korrelation folgen wir dem schrittweisen Durchführungsverfahren für Hypothesentests. Der <span class="math notranslate nohighlight">\(t\)</span>-Test für die Korrelation folgt demselben schrittweisen Verfahren wie in den vorangegangenen Abschnitten beschrieben.</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Schritt 1</p></td>
<td><p>Geben Sie die Nullhypothese <span class="math notranslate nohighlight">\(H_0\)</span> und alternative Hypothese <span class="math notranslate nohighlight">\(H_A\)</span> an</p></td>
</tr>
<tr class="row-odd"><td><p>Schritt 2</p></td>
<td><p>Legen Sie das Signifikanzniveau,<span class="math notranslate nohighlight">\(\alpha\)</span> fest</p></td>
</tr>
<tr class="row-even"><td><p>Schritt 3</p></td>
<td><p>Berechnen Sie den Wert der Teststatistik</p></td>
</tr>
<tr class="row-odd"><td><p>Schritt 4</p></td>
<td><p>Bestimmen Sie den p-Wert</p></td>
</tr>
<tr class="row-even"><td><p>Schritt 5</p></td>
<td><p>Wenn <span class="math notranslate nohighlight">\(p \le \alpha\)</span>, <span class="math notranslate nohighlight">\(H_0\)</span> ablehnen; ansonsten <span class="math notranslate nohighlight">\(H_0\)</span> nicht ablehnen</p></td>
</tr>
<tr class="row-odd"><td><p>Schritt 6</p></td>
<td><p>Interpretieren Sie das Ergebnis des Hypothesentests</p></td>
</tr>
</tbody>
</table>
<p><strong>Schritt 1 : Geben Sie die Nullhypothese <span class="math notranslate nohighlight">\(H_0\)</span> und alternative Hypothese <span class="math notranslate nohighlight">\(H_A\)</span> an</strong></p>
<p>Die Nullhypothese besagt, dass es keinen linearen Zusammenhang zwischen den Noten von zwei aufeinanderfolgenden Statistikprüfungen gibt.</p>
<div class="math notranslate nohighlight">
\[H_0: r  = 0\]</div>
<p>Erinnern Sie sich daran, dass die Formulierung der Alternativhypothese vorgibt, ob wir einen zweiseitigen, einen links- oder einen rechtsseitigen Hypothesentest durchführen.</p>
<p><strong>Alternative Hypothese</strong></p>
<div class="math notranslate nohighlight">
\[H_A: r \ne 0\]</div>
<p>Diese Formulierung führt zu einem zweiseitigen Hypothesentest.</p>
<p><strong>Schritt 2: Legen Sie das Signifikanzniveau,<span class="math notranslate nohighlight">\(\alpha\)</span> fest</strong></p>
<div class="math notranslate nohighlight">
\[\alpha = 0,01\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.01</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Schritt 3 und 4: Berechnen Sie den Wert der Teststatistik und den <span class="math notranslate nohighlight">\(p\)</span>-Wert</strong></p>
<p>Zur Veranschaulichung berechnen wir die Teststatistik manuell in Python. Erinnern Sie sich an die obige Gleichungsform:</p>
<div class="math notranslate nohighlight">
\[t= \frac{r}{\sqrt{\frac{1-r^2}{n-2}}}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">score1</span><span class="p">)</span>

<span class="c1"># Berechne Teststatistik</span>
<span class="c1"># Berechne PearsonKorrelationskoefficient r</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">score1</span><span class="p">,</span> <span class="n">score2</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Teststatistik</span>
<span class="n">tw</span> <span class="o">=</span> <span class="n">r</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">tw</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>14.846357121994247
</pre></div>
</div>
</div>
</div>
<p>Der numerische Wert der Teststatistik ist <span class="math notranslate nohighlight">\(14,846357\)</span>.</p>
<p>Um den <span class="math notranslate nohighlight">\(p\)</span>-Wert zu berechnen, wenden wir die Funktion <code class="docutils literal notranslate"><span class="pre">t.cdf()</span></code> an. Erinnern Sie sich daran, wie man die Freiheitsgrade berechnet:</p>
<div class="math notranslate nohighlight">
\[df = n - 2= 48\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne den p-Wert</span>
<span class="n">df</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">score1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span>

<span class="c1"># zweiseitiger Test</span>
<span class="n">p_upper</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">tw</span><span class="p">),</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">p_lower</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">tw</span><span class="p">),</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">p_upper</span> <span class="o">+</span> <span class="n">p_lower</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.4401962006630608e-19
</pre></div>
</div>
</div>
</div>
<p><strong>Schritt 5: Wenn <span class="math notranslate nohighlight">\(p \le \alpha , H_0\)</span> ablehnen; ansonsten <span class="math notranslate nohighlight">\(H_0\)</span> nicht ablehnen</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">&lt;=</span> <span class="n">alpha</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>Der <span class="math notranslate nohighlight">\(p\)</span>-Wert ist kleiner als das angegebene Signifikanzniveau von <span class="math notranslate nohighlight">\(0,01\)</span>; wir verwerfen <span class="math notranslate nohighlight">\(H_0\)</span>. Die Testergebnisse sind statistisch signifikant auf dem <span class="math notranslate nohighlight">\(1 \%\)</span>-Niveau und liefern einen sehr starken Beweis gegen die Nullhypothese.</p>
<p><strong>Schritt 6: Interpretieren Sie das Ergebnis des Hypothesentests</strong></p>
<p><span class="math notranslate nohighlight">\(p=1,4401962 \cdot 10^{-19}\)</span>. Bei einem Signifikanzniveau von <span class="math notranslate nohighlight">\(1 \%\)</span> lassen die Daten den Schluss zu, dass die Prüfungsnoten der Studenten linear korreliert sind.</p>
</section>
<section id="id3">
<h4>Hypothesentests in Python<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h4>
<p>Wir haben soeben einen <span class="math notranslate nohighlight">\(t\)</span>-test zur Prüfung des Korrelationskoeffizienten in Python manuell durchgeführt. Wir können dasselbe in Python mit nur einer Zeile Code tun!</p>
<p>Dazu wenden wir die Funktion <code class="docutils literal notranslate"><span class="pre">pearsonr()</span></code> an. Für die Funktion verwenden wir die zwei Vektoren, <code class="docutils literal notranslate"><span class="pre">score1</span></code> und <code class="docutils literal notranslate"><span class="pre">score2</span></code>, als Dateneingabe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">pearsonr</span><span class="p">(</span><span class="n">score1</span><span class="p">,</span> <span class="n">score2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Korrelationskoeffizient: </span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p - Wert:                </span><span class="si">{</span><span class="n">p_value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Korrelationskoeffizient: 0.906185403227985
p - Wert:                1.440196200663062e-19
</pre></div>
</div>
</div>
</div>
<p>Perfekt! Vergleichen Sie die Ausgabe der Funktion <code class="docutils literal notranslate"><span class="pre">pearsonr()</span></code> mit unserem Ergebnis von oben. Darüber hinaus gibt die Funktion den Pearson-Korrelationskoeffizienten für die Beispieldaten aus. Aus der Ausgabe der Funktion <code class="docutils literal notranslate"><span class="pre">pearsonr()</span></code> können wir schließen, dass die Daten bei einem Signifikanzniveau von <span class="math notranslate nohighlight">\(1 \%\)</span> sehr starke Hinweise darauf liefern, dass die Prüfungsnoten der Studenten linear korreliert sind.</p>
</section>
</section>
</section>
<span id="document-Kapitel06/07_Wahrscheinlichkeitstabellen"></span><section id="wahrscheinlichkeits-tabellen">
<h2>Wahrscheinlichkeits-Tabellen<a class="headerlink" href="#wahrscheinlichkeits-tabellen" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<p>Die folgenden Wahrscheinlichkeitsverteilungen werden behandelt:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(z\)</span>-Verteilung</p></li>
<li><p><span class="math notranslate nohighlight">\(t\)</span>-Verteilung</p></li>
<li><p><span class="math notranslate nohighlight">\(\chi^2\)</span>-Verteilung</p></li>
<li><p><span class="math notranslate nohighlight">\(F\)</span>-Verteilung (<span class="math notranslate nohighlight">\(\alpha=1\)</span> und <span class="math notranslate nohighlight">\(\alpha=5\)</span>)</p></li>
</ul>
</section>
<section id="die-z-verteilung">
<h2>Die <span class="math notranslate nohighlight">\(z\)</span>-Verteilung<a class="headerlink" href="#die-z-verteilung" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<section id="quantilen-der-standard-normal-z-verteilung">
<h3>Quantilen der Standard-Normal-(<span class="math notranslate nohighlight">\(z\)</span>)-Verteilung<a class="headerlink" href="#quantilen-der-standard-normal-z-verteilung" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\phi(-z) \rightarrow\)</span> unter Mittelwert</p></li>
<li><p><span class="math notranslate nohighlight">\(\phi(z) \rightarrow\)</span> über Mittelwert</p></li>
<li><p><span class="math notranslate nohighlight">\(D(z) \rightarrow\)</span> symmetrisches Intervall</p></li>
</ul>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(z\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\phi(-z)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\phi(z)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(D(z)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>0,01</p></td>
<td><p>0,496</p></td>
<td><p>0,504</p></td>
<td><p>0,007979</p></td>
</tr>
<tr class="row-even"><td><p>0,02</p></td>
<td><p>0,492</p></td>
<td><p>0,508</p></td>
<td><p>0,01596</p></td>
</tr>
<tr class="row-odd"><td><p>0,03</p></td>
<td><p>0,488</p></td>
<td><p>0,512</p></td>
<td><p>0,02393</p></td>
</tr>
<tr class="row-even"><td><p>0,04</p></td>
<td><p>0,484</p></td>
<td><p>0,516</p></td>
<td><p>0,03191</p></td>
</tr>
<tr class="row-odd"><td><p>0,05</p></td>
<td><p>0,4801</p></td>
<td><p>0,5199</p></td>
<td><p>0,03988</p></td>
</tr>
<tr class="row-even"><td><p>0,06</p></td>
<td><p>0,4761</p></td>
<td><p>0,5239</p></td>
<td><p>0,04784</p></td>
</tr>
<tr class="row-odd"><td><p>0,07</p></td>
<td><p>0,4721</p></td>
<td><p>0,5279</p></td>
<td><p>0,05581</p></td>
</tr>
<tr class="row-even"><td><p>0,08</p></td>
<td><p>0,4681</p></td>
<td><p>0,5319</p></td>
<td><p>0,06376</p></td>
</tr>
<tr class="row-odd"><td><p>0,09</p></td>
<td><p>0,4641</p></td>
<td><p>0,5359</p></td>
<td><p>0,07171</p></td>
</tr>
<tr class="row-even"><td><p>0,1</p></td>
<td><p>0,4602</p></td>
<td><p>0,5398</p></td>
<td><p>0,07966</p></td>
</tr>
<tr class="row-odd"><td><p>0,11</p></td>
<td><p>0,4562</p></td>
<td><p>0,5438</p></td>
<td><p>0,08759</p></td>
</tr>
<tr class="row-even"><td><p>0,12</p></td>
<td><p>0,4522</p></td>
<td><p>0,5478</p></td>
<td><p>0,09552</p></td>
</tr>
<tr class="row-odd"><td><p>0,13</p></td>
<td><p>0,4483</p></td>
<td><p>0,5517</p></td>
<td><p>0,1034</p></td>
</tr>
<tr class="row-even"><td><p>0,14</p></td>
<td><p>0,4443</p></td>
<td><p>0,5557</p></td>
<td><p>0,1113</p></td>
</tr>
<tr class="row-odd"><td><p>0,15</p></td>
<td><p>0,4404</p></td>
<td><p>0,5596</p></td>
<td><p>0,1192</p></td>
</tr>
<tr class="row-even"><td><p>0,16</p></td>
<td><p>0,4364</p></td>
<td><p>0,5636</p></td>
<td><p>0,1271</p></td>
</tr>
<tr class="row-odd"><td><p>0,17</p></td>
<td><p>0,4325</p></td>
<td><p>0,5675</p></td>
<td><p>0,135</p></td>
</tr>
<tr class="row-even"><td><p>0,18</p></td>
<td><p>0,4286</p></td>
<td><p>0,5714</p></td>
<td><p>0,1428</p></td>
</tr>
<tr class="row-odd"><td><p>0,19</p></td>
<td><p>0,4247</p></td>
<td><p>0,5753</p></td>
<td><p>0,1507</p></td>
</tr>
<tr class="row-even"><td><p>0,2</p></td>
<td><p>0,4207</p></td>
<td><p>0,5793</p></td>
<td><p>0,1585</p></td>
</tr>
<tr class="row-odd"><td><p>0,21</p></td>
<td><p>0,4168</p></td>
<td><p>0,5832</p></td>
<td><p>0,1663</p></td>
</tr>
<tr class="row-even"><td><p>0,22</p></td>
<td><p>0,4129</p></td>
<td><p>0,5871</p></td>
<td><p>0,1741</p></td>
</tr>
<tr class="row-odd"><td><p>0,23</p></td>
<td><p>0,409</p></td>
<td><p>0,591</p></td>
<td><p>0,1819</p></td>
</tr>
<tr class="row-even"><td><p>0,24</p></td>
<td><p>0,4052</p></td>
<td><p>0,5948</p></td>
<td><p>0,1897</p></td>
</tr>
<tr class="row-odd"><td><p>0,25</p></td>
<td><p>0,4013</p></td>
<td><p>0,5987</p></td>
<td><p>0,1974</p></td>
</tr>
<tr class="row-even"><td><p>0,26</p></td>
<td><p>0,3974</p></td>
<td><p>0,6026</p></td>
<td><p>0,2051</p></td>
</tr>
<tr class="row-odd"><td><p>0,27</p></td>
<td><p>0,3936</p></td>
<td><p>0,6064</p></td>
<td><p>0,2128</p></td>
</tr>
<tr class="row-even"><td><p>0,28</p></td>
<td><p>0,3897</p></td>
<td><p>0,6103</p></td>
<td><p>0,2205</p></td>
</tr>
<tr class="row-odd"><td><p>0,29</p></td>
<td><p>0,3859</p></td>
<td><p>0,6141</p></td>
<td><p>0,2282</p></td>
</tr>
<tr class="row-even"><td><p>0,3</p></td>
<td><p>0,3821</p></td>
<td><p>0,6179</p></td>
<td><p>0,2358</p></td>
</tr>
<tr class="row-odd"><td><p>0,31</p></td>
<td><p>0,3783</p></td>
<td><p>0,6217</p></td>
<td><p>0,2434</p></td>
</tr>
<tr class="row-even"><td><p>0,32</p></td>
<td><p>0,3745</p></td>
<td><p>0,6255</p></td>
<td><p>0,251</p></td>
</tr>
<tr class="row-odd"><td><p>0,33</p></td>
<td><p>0,3707</p></td>
<td><p>0,6293</p></td>
<td><p>0,2586</p></td>
</tr>
<tr class="row-even"><td><p>0,34</p></td>
<td><p>0,3669</p></td>
<td><p>0,6331</p></td>
<td><p>0,2661</p></td>
</tr>
<tr class="row-odd"><td><p>0,35</p></td>
<td><p>0,3632</p></td>
<td><p>0,6368</p></td>
<td><p>0,2737</p></td>
</tr>
<tr class="row-even"><td><p>0,36</p></td>
<td><p>0,3594</p></td>
<td><p>0,6406</p></td>
<td><p>0,2812</p></td>
</tr>
<tr class="row-odd"><td><p>0,37</p></td>
<td><p>0,3557</p></td>
<td><p>0,6443</p></td>
<td><p>0,2886</p></td>
</tr>
<tr class="row-even"><td><p>0,38</p></td>
<td><p>0,352</p></td>
<td><p>0,648</p></td>
<td><p>0,2961</p></td>
</tr>
<tr class="row-odd"><td><p>0,39</p></td>
<td><p>0,3483</p></td>
<td><p>0,6517</p></td>
<td><p>0,3035</p></td>
</tr>
<tr class="row-even"><td><p>0,4</p></td>
<td><p>0,3446</p></td>
<td><p>0,6554</p></td>
<td><p>0,3108</p></td>
</tr>
<tr class="row-odd"><td><p>0,41</p></td>
<td><p>0,3409</p></td>
<td><p>0,6591</p></td>
<td><p>0,3182</p></td>
</tr>
<tr class="row-even"><td><p>0,42</p></td>
<td><p>0,3372</p></td>
<td><p>0,6628</p></td>
<td><p>0,3255</p></td>
</tr>
<tr class="row-odd"><td><p>0,43</p></td>
<td><p>0,3336</p></td>
<td><p>0,6664</p></td>
<td><p>0,3328</p></td>
</tr>
<tr class="row-even"><td><p>0,44</p></td>
<td><p>0,33</p></td>
<td><p>0,67</p></td>
<td><p>0,3401</p></td>
</tr>
<tr class="row-odd"><td><p>0,45</p></td>
<td><p>0,3264</p></td>
<td><p>0,6736</p></td>
<td><p>0,3473</p></td>
</tr>
<tr class="row-even"><td><p>0,46</p></td>
<td><p>0,3228</p></td>
<td><p>0,6772</p></td>
<td><p>0,3545</p></td>
</tr>
<tr class="row-odd"><td><p>0,47</p></td>
<td><p>0,3192</p></td>
<td><p>0,6808</p></td>
<td><p>0,3616</p></td>
</tr>
<tr class="row-even"><td><p>0,48</p></td>
<td><p>0,3156</p></td>
<td><p>0,6844</p></td>
<td><p>0,3688</p></td>
</tr>
<tr class="row-odd"><td><p>0,49</p></td>
<td><p>0,3121</p></td>
<td><p>0,6879</p></td>
<td><p>0,3759</p></td>
</tr>
<tr class="row-even"><td><p>0,5</p></td>
<td><p>0,3085</p></td>
<td><p>0,6915</p></td>
<td><p>0,3829</p></td>
</tr>
<tr class="row-odd"><td><p>0,51</p></td>
<td><p>0,305</p></td>
<td><p>0,695</p></td>
<td><p>0,3899</p></td>
</tr>
<tr class="row-even"><td><p>0,52</p></td>
<td><p>0,3015</p></td>
<td><p>0,6985</p></td>
<td><p>0,3969</p></td>
</tr>
<tr class="row-odd"><td><p>0,53</p></td>
<td><p>0,2981</p></td>
<td><p>0,7019</p></td>
<td><p>0,4039</p></td>
</tr>
<tr class="row-even"><td><p>0,54</p></td>
<td><p>0,2946</p></td>
<td><p>0,7054</p></td>
<td><p>0,4108</p></td>
</tr>
<tr class="row-odd"><td><p>0,55</p></td>
<td><p>0,2912</p></td>
<td><p>0,7088</p></td>
<td><p>0,4177</p></td>
</tr>
<tr class="row-even"><td><p>0,56</p></td>
<td><p>0,2877</p></td>
<td><p>0,7123</p></td>
<td><p>0,4245</p></td>
</tr>
<tr class="row-odd"><td><p>0,57</p></td>
<td><p>0,2843</p></td>
<td><p>0,7157</p></td>
<td><p>0,4313</p></td>
</tr>
<tr class="row-even"><td><p>0,58</p></td>
<td><p>0,281</p></td>
<td><p>0,719</p></td>
<td><p>0,4381</p></td>
</tr>
<tr class="row-odd"><td><p>0,59</p></td>
<td><p>0,2776</p></td>
<td><p>0,7224</p></td>
<td><p>0,4448</p></td>
</tr>
<tr class="row-even"><td><p>0,6</p></td>
<td><p>0,2743</p></td>
<td><p>0,7257</p></td>
<td><p>0,4515</p></td>
</tr>
<tr class="row-odd"><td><p>0,61</p></td>
<td><p>0,2709</p></td>
<td><p>0,7291</p></td>
<td><p>0,4581</p></td>
</tr>
<tr class="row-even"><td><p>0,62</p></td>
<td><p>0,2676</p></td>
<td><p>0,7324</p></td>
<td><p>0,4647</p></td>
</tr>
<tr class="row-odd"><td><p>0,63</p></td>
<td><p>0,2643</p></td>
<td><p>0,7357</p></td>
<td><p>0,4713</p></td>
</tr>
<tr class="row-even"><td><p>0,64</p></td>
<td><p>0,2611</p></td>
<td><p>0,7389</p></td>
<td><p>0,4778</p></td>
</tr>
<tr class="row-odd"><td><p>0,65</p></td>
<td><p>0,2578</p></td>
<td><p>0,7422</p></td>
<td><p>0,4843</p></td>
</tr>
<tr class="row-even"><td><p>0,66</p></td>
<td><p>0,2546</p></td>
<td><p>0,7454</p></td>
<td><p>0,4907</p></td>
</tr>
<tr class="row-odd"><td><p>0,67</p></td>
<td><p>0,2514</p></td>
<td><p>0,7486</p></td>
<td><p>0,4971</p></td>
</tr>
<tr class="row-even"><td><p>0,68</p></td>
<td><p>0,2483</p></td>
<td><p>0,7517</p></td>
<td><p>0,5035</p></td>
</tr>
<tr class="row-odd"><td><p>0,69</p></td>
<td><p>0,2451</p></td>
<td><p>0,7549</p></td>
<td><p>0,5098</p></td>
</tr>
<tr class="row-even"><td><p>0,7</p></td>
<td><p>0,242</p></td>
<td><p>0,758</p></td>
<td><p>0,5161</p></td>
</tr>
<tr class="row-odd"><td><p>0,71</p></td>
<td><p>0,2389</p></td>
<td><p>0,7611</p></td>
<td><p>0,5223</p></td>
</tr>
<tr class="row-even"><td><p>0,72</p></td>
<td><p>0,2358</p></td>
<td><p>0,7642</p></td>
<td><p>0,5285</p></td>
</tr>
<tr class="row-odd"><td><p>0,73</p></td>
<td><p>0,2327</p></td>
<td><p>0,7673</p></td>
<td><p>0,5346</p></td>
</tr>
<tr class="row-even"><td><p>0,74</p></td>
<td><p>0,2296</p></td>
<td><p>0,7704</p></td>
<td><p>0,5407</p></td>
</tr>
<tr class="row-odd"><td><p>0,75</p></td>
<td><p>0,2266</p></td>
<td><p>0,7734</p></td>
<td><p>0,5467</p></td>
</tr>
<tr class="row-even"><td><p>0,76</p></td>
<td><p>0,2236</p></td>
<td><p>0,7764</p></td>
<td><p>0,5527</p></td>
</tr>
<tr class="row-odd"><td><p>0,77</p></td>
<td><p>0,2206</p></td>
<td><p>0,7794</p></td>
<td><p>0,5587</p></td>
</tr>
<tr class="row-even"><td><p>0,78</p></td>
<td><p>0,2177</p></td>
<td><p>0,7823</p></td>
<td><p>0,5646</p></td>
</tr>
<tr class="row-odd"><td><p>0,79</p></td>
<td><p>0,2148</p></td>
<td><p>0,7852</p></td>
<td><p>0,5705</p></td>
</tr>
<tr class="row-even"><td><p>0,8</p></td>
<td><p>0,2119</p></td>
<td><p>0,7881</p></td>
<td><p>0,5763</p></td>
</tr>
<tr class="row-odd"><td><p>0,81</p></td>
<td><p>0,209</p></td>
<td><p>0,791</p></td>
<td><p>0,5821</p></td>
</tr>
<tr class="row-even"><td><p>0,82</p></td>
<td><p>0,2061</p></td>
<td><p>0,7939</p></td>
<td><p>0,5878</p></td>
</tr>
<tr class="row-odd"><td><p>0,83</p></td>
<td><p>0,2033</p></td>
<td><p>0,7967</p></td>
<td><p>0,5935</p></td>
</tr>
<tr class="row-even"><td><p>0,84</p></td>
<td><p>0,2005</p></td>
<td><p>0,7995</p></td>
<td><p>0,5991</p></td>
</tr>
<tr class="row-odd"><td><p>0,85</p></td>
<td><p>0,1977</p></td>
<td><p>0,8023</p></td>
<td><p>0,6047</p></td>
</tr>
<tr class="row-even"><td><p>0,86</p></td>
<td><p>0,1949</p></td>
<td><p>0,8051</p></td>
<td><p>0,6102</p></td>
</tr>
<tr class="row-odd"><td><p>0,87</p></td>
<td><p>0,1922</p></td>
<td><p>0,8078</p></td>
<td><p>0,6157</p></td>
</tr>
<tr class="row-even"><td><p>0,88</p></td>
<td><p>0,1894</p></td>
<td><p>0,8106</p></td>
<td><p>0,6211</p></td>
</tr>
<tr class="row-odd"><td><p>0,89</p></td>
<td><p>0,1867</p></td>
<td><p>0,8133</p></td>
<td><p>0,6265</p></td>
</tr>
<tr class="row-even"><td><p>0,9</p></td>
<td><p>0,1841</p></td>
<td><p>0,8159</p></td>
<td><p>0,6319</p></td>
</tr>
<tr class="row-odd"><td><p>0,91</p></td>
<td><p>0,1814</p></td>
<td><p>0,8186</p></td>
<td><p>0,6372</p></td>
</tr>
<tr class="row-even"><td><p>0,92</p></td>
<td><p>0,1788</p></td>
<td><p>0,8212</p></td>
<td><p>0,6424</p></td>
</tr>
<tr class="row-odd"><td><p>0,93</p></td>
<td><p>0,1762</p></td>
<td><p>0,8238</p></td>
<td><p>0,6476</p></td>
</tr>
<tr class="row-even"><td><p>0,94</p></td>
<td><p>0,1736</p></td>
<td><p>0,8264</p></td>
<td><p>0,6528</p></td>
</tr>
<tr class="row-odd"><td><p>0,95</p></td>
<td><p>0,1711</p></td>
<td><p>0,8289</p></td>
<td><p>0,6579</p></td>
</tr>
<tr class="row-even"><td><p>0,96</p></td>
<td><p>0,1685</p></td>
<td><p>0,8315</p></td>
<td><p>0,6629</p></td>
</tr>
<tr class="row-odd"><td><p>0,97</p></td>
<td><p>0,166</p></td>
<td><p>0,834</p></td>
<td><p>0,668</p></td>
</tr>
<tr class="row-even"><td><p>0,98</p></td>
<td><p>0,1635</p></td>
<td><p>0,8365</p></td>
<td><p>0,6729</p></td>
</tr>
<tr class="row-odd"><td><p>0,99</p></td>
<td><p>0,1611</p></td>
<td><p>0,8389</p></td>
<td><p>0,6778</p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p>0,1587</p></td>
<td><p>0,8413</p></td>
<td><p>0,6827</p></td>
</tr>
<tr class="row-odd"><td><p>1,01</p></td>
<td><p>0,1562</p></td>
<td><p>0,8438</p></td>
<td><p>0,6875</p></td>
</tr>
<tr class="row-even"><td><p>1,02</p></td>
<td><p>0,1539</p></td>
<td><p>0,8461</p></td>
<td><p>0,6923</p></td>
</tr>
<tr class="row-odd"><td><p>1,03</p></td>
<td><p>0,1515</p></td>
<td><p>0,8485</p></td>
<td><p>0,697</p></td>
</tr>
<tr class="row-even"><td><p>1,04</p></td>
<td><p>0,1492</p></td>
<td><p>0,8508</p></td>
<td><p>0,7017</p></td>
</tr>
<tr class="row-odd"><td><p>1,05</p></td>
<td><p>0,1469</p></td>
<td><p>0,8531</p></td>
<td><p>0,7063</p></td>
</tr>
<tr class="row-even"><td><p>1,06</p></td>
<td><p>0,1446</p></td>
<td><p>0,8554</p></td>
<td><p>0,7109</p></td>
</tr>
<tr class="row-odd"><td><p>1,07</p></td>
<td><p>0,1423</p></td>
<td><p>0,8577</p></td>
<td><p>0,7154</p></td>
</tr>
<tr class="row-even"><td><p>1,08</p></td>
<td><p>0,1401</p></td>
<td><p>0,8599</p></td>
<td><p>0,7199</p></td>
</tr>
<tr class="row-odd"><td><p>1,09</p></td>
<td><p>0,1379</p></td>
<td><p>0,8621</p></td>
<td><p>0,7243</p></td>
</tr>
<tr class="row-even"><td><p>1,1</p></td>
<td><p>0,1357</p></td>
<td><p>0,8643</p></td>
<td><p>0,7287</p></td>
</tr>
<tr class="row-odd"><td><p>1,11</p></td>
<td><p>0,1335</p></td>
<td><p>0,8665</p></td>
<td><p>0,733</p></td>
</tr>
<tr class="row-even"><td><p>1,12</p></td>
<td><p>0,1314</p></td>
<td><p>0,8686</p></td>
<td><p>0,7373</p></td>
</tr>
<tr class="row-odd"><td><p>1,13</p></td>
<td><p>0,1292</p></td>
<td><p>0,8708</p></td>
<td><p>0,7415</p></td>
</tr>
<tr class="row-even"><td><p>1,14</p></td>
<td><p>0,1271</p></td>
<td><p>0,8729</p></td>
<td><p>0,7457</p></td>
</tr>
<tr class="row-odd"><td><p>1,15</p></td>
<td><p>0,1251</p></td>
<td><p>0,8749</p></td>
<td><p>0,7499</p></td>
</tr>
<tr class="row-even"><td><p>1,16</p></td>
<td><p>0,123</p></td>
<td><p>0,877</p></td>
<td><p>0,754</p></td>
</tr>
<tr class="row-odd"><td><p>1,17</p></td>
<td><p>0,121</p></td>
<td><p>0,879</p></td>
<td><p>0,758</p></td>
</tr>
<tr class="row-even"><td><p>1,18</p></td>
<td><p>0,119</p></td>
<td><p>0,881</p></td>
<td><p>0,762</p></td>
</tr>
<tr class="row-odd"><td><p>1,19</p></td>
<td><p>0,117</p></td>
<td><p>0,883</p></td>
<td><p>0,766</p></td>
</tr>
<tr class="row-even"><td><p>1,2</p></td>
<td><p>0,1151</p></td>
<td><p>0,8849</p></td>
<td><p>0,7699</p></td>
</tr>
<tr class="row-odd"><td><p>1,21</p></td>
<td><p>0,1131</p></td>
<td><p>0,8869</p></td>
<td><p>0,7737</p></td>
</tr>
<tr class="row-even"><td><p>1,22</p></td>
<td><p>0,1112</p></td>
<td><p>0,8888</p></td>
<td><p>0,7775</p></td>
</tr>
<tr class="row-odd"><td><p>1,23</p></td>
<td><p>0,1093</p></td>
<td><p>0,8907</p></td>
<td><p>0,7813</p></td>
</tr>
<tr class="row-even"><td><p>1,24</p></td>
<td><p>0,1075</p></td>
<td><p>0,8925</p></td>
<td><p>0,785</p></td>
</tr>
<tr class="row-odd"><td><p>1,25</p></td>
<td><p>0,1056</p></td>
<td><p>0,8944</p></td>
<td><p>0,7887</p></td>
</tr>
<tr class="row-even"><td><p>1,26</p></td>
<td><p>0,1038</p></td>
<td><p>0,8962</p></td>
<td><p>0,7923</p></td>
</tr>
<tr class="row-odd"><td><p>1,27</p></td>
<td><p>0,102</p></td>
<td><p>0,898</p></td>
<td><p>0,7959</p></td>
</tr>
<tr class="row-even"><td><p>1,28</p></td>
<td><p>0,1003</p></td>
<td><p>0,8997</p></td>
<td><p>0,7995</p></td>
</tr>
<tr class="row-odd"><td><p>1,29</p></td>
<td><p>0,09853</p></td>
<td><p>0,9015</p></td>
<td><p>0,8029</p></td>
</tr>
<tr class="row-even"><td><p>1,3</p></td>
<td><p>0,0968</p></td>
<td><p>0,9032</p></td>
<td><p>0,8064</p></td>
</tr>
<tr class="row-odd"><td><p>1,31</p></td>
<td><p>0,0951</p></td>
<td><p>0,9049</p></td>
<td><p>0,8098</p></td>
</tr>
<tr class="row-even"><td><p>1,32</p></td>
<td><p>0,09342</p></td>
<td><p>0,9066</p></td>
<td><p>0,8132</p></td>
</tr>
<tr class="row-odd"><td><p>1,33</p></td>
<td><p>0,09176</p></td>
<td><p>0,9082</p></td>
<td><p>0,8165</p></td>
</tr>
<tr class="row-even"><td><p>1,34</p></td>
<td><p>0,09012</p></td>
<td><p>0,9099</p></td>
<td><p>0,8198</p></td>
</tr>
<tr class="row-odd"><td><p>1,35</p></td>
<td><p>0,08851</p></td>
<td><p>0,9115</p></td>
<td><p>0,823</p></td>
</tr>
<tr class="row-even"><td><p>1,36</p></td>
<td><p>0,08691</p></td>
<td><p>0,9131</p></td>
<td><p>0,8262</p></td>
</tr>
<tr class="row-odd"><td><p>1,37</p></td>
<td><p>0,08534</p></td>
<td><p>0,9147</p></td>
<td><p>0,8293</p></td>
</tr>
<tr class="row-even"><td><p>1,38</p></td>
<td><p>0,08379</p></td>
<td><p>0,9162</p></td>
<td><p>0,8324</p></td>
</tr>
<tr class="row-odd"><td><p>1,39</p></td>
<td><p>0,08226</p></td>
<td><p>0,9177</p></td>
<td><p>0,8355</p></td>
</tr>
<tr class="row-even"><td><p>1,4</p></td>
<td><p>0,08076</p></td>
<td><p>0,9192</p></td>
<td><p>0,8385</p></td>
</tr>
<tr class="row-odd"><td><p>1,41</p></td>
<td><p>0,07927</p></td>
<td><p>0,9207</p></td>
<td><p>0,8415</p></td>
</tr>
<tr class="row-even"><td><p>1,42</p></td>
<td><p>0,0778</p></td>
<td><p>0,9222</p></td>
<td><p>0,8444</p></td>
</tr>
<tr class="row-odd"><td><p>1,43</p></td>
<td><p>0,07636</p></td>
<td><p>0,9236</p></td>
<td><p>0,8473</p></td>
</tr>
<tr class="row-even"><td><p>1,44</p></td>
<td><p>0,07493</p></td>
<td><p>0,9251</p></td>
<td><p>0,8501</p></td>
</tr>
<tr class="row-odd"><td><p>1,45</p></td>
<td><p>0,07353</p></td>
<td><p>0,9265</p></td>
<td><p>0,8529</p></td>
</tr>
<tr class="row-even"><td><p>1,46</p></td>
<td><p>0,07215</p></td>
<td><p>0,9279</p></td>
<td><p>0,8557</p></td>
</tr>
<tr class="row-odd"><td><p>1,47</p></td>
<td><p>0,07078</p></td>
<td><p>0,9292</p></td>
<td><p>0,8584</p></td>
</tr>
<tr class="row-even"><td><p>1,48</p></td>
<td><p>0,06944</p></td>
<td><p>0,9306</p></td>
<td><p>0,8611</p></td>
</tr>
<tr class="row-odd"><td><p>1,49</p></td>
<td><p>0,06811</p></td>
<td><p>0,9319</p></td>
<td><p>0,8638</p></td>
</tr>
<tr class="row-even"><td><p>1,5</p></td>
<td><p>0,06681</p></td>
<td><p>0,9332</p></td>
<td><p>0,8664</p></td>
</tr>
<tr class="row-odd"><td><p>1,51</p></td>
<td><p>0,06552</p></td>
<td><p>0,9345</p></td>
<td><p>0,869</p></td>
</tr>
<tr class="row-even"><td><p>1,52</p></td>
<td><p>0,06426</p></td>
<td><p>0,9357</p></td>
<td><p>0,8715</p></td>
</tr>
<tr class="row-odd"><td><p>1,53</p></td>
<td><p>0,06301</p></td>
<td><p>0,937</p></td>
<td><p>0,874</p></td>
</tr>
<tr class="row-even"><td><p>1,54</p></td>
<td><p>0,06178</p></td>
<td><p>0,9382</p></td>
<td><p>0,8764</p></td>
</tr>
<tr class="row-odd"><td><p>1,55</p></td>
<td><p>0,06057</p></td>
<td><p>0,9394</p></td>
<td><p>0,8789</p></td>
</tr>
<tr class="row-even"><td><p>1,56</p></td>
<td><p>0,05938</p></td>
<td><p>0,9406</p></td>
<td><p>0,8812</p></td>
</tr>
<tr class="row-odd"><td><p>1,57</p></td>
<td><p>0,05821</p></td>
<td><p>0,9418</p></td>
<td><p>0,8836</p></td>
</tr>
<tr class="row-even"><td><p>1,58</p></td>
<td><p>0,05705</p></td>
<td><p>0,9429</p></td>
<td><p>0,8859</p></td>
</tr>
<tr class="row-odd"><td><p>1,59</p></td>
<td><p>0,05592</p></td>
<td><p>0,9441</p></td>
<td><p>0,8882</p></td>
</tr>
<tr class="row-even"><td><p>1,6</p></td>
<td><p>0,0548</p></td>
<td><p>0,9452</p></td>
<td><p>0,8904</p></td>
</tr>
<tr class="row-odd"><td><p>1,61</p></td>
<td><p>0,0537</p></td>
<td><p>0,9463</p></td>
<td><p>0,8926</p></td>
</tr>
<tr class="row-even"><td><p>1,62</p></td>
<td><p>0,05262</p></td>
<td><p>0,9474</p></td>
<td><p>0,8948</p></td>
</tr>
<tr class="row-odd"><td><p>1,63</p></td>
<td><p>0,05155</p></td>
<td><p>0,9484</p></td>
<td><p>0,8969</p></td>
</tr>
<tr class="row-even"><td><p>1,64</p></td>
<td><p>0,0505</p></td>
<td><p>0,9495</p></td>
<td><p>0,899</p></td>
</tr>
<tr class="row-odd"><td><p>1,65</p></td>
<td><p>0,04947</p></td>
<td><p>0,9505</p></td>
<td><p>0,9011</p></td>
</tr>
<tr class="row-even"><td><p>1,66</p></td>
<td><p>0,04846</p></td>
<td><p>0,9515</p></td>
<td><p>0,9031</p></td>
</tr>
<tr class="row-odd"><td><p>1,67</p></td>
<td><p>0,04746</p></td>
<td><p>0,9525</p></td>
<td><p>0,9051</p></td>
</tr>
<tr class="row-even"><td><p>1,68</p></td>
<td><p>0,04648</p></td>
<td><p>0,9535</p></td>
<td><p>0,907</p></td>
</tr>
<tr class="row-odd"><td><p>1,69</p></td>
<td><p>0,04551</p></td>
<td><p>0,9545</p></td>
<td><p>0,909</p></td>
</tr>
<tr class="row-even"><td><p>1,7</p></td>
<td><p>0,04457</p></td>
<td><p>0,9554</p></td>
<td><p>0,9109</p></td>
</tr>
<tr class="row-odd"><td><p>1,71</p></td>
<td><p>0,04363</p></td>
<td><p>0,9564</p></td>
<td><p>0,9127</p></td>
</tr>
<tr class="row-even"><td><p>1,72</p></td>
<td><p>0,04272</p></td>
<td><p>0,9573</p></td>
<td><p>0,9146</p></td>
</tr>
<tr class="row-odd"><td><p>1,73</p></td>
<td><p>0,04182</p></td>
<td><p>0,9582</p></td>
<td><p>0,9164</p></td>
</tr>
<tr class="row-even"><td><p>1,74</p></td>
<td><p>0,04093</p></td>
<td><p>0,9591</p></td>
<td><p>0,9181</p></td>
</tr>
<tr class="row-odd"><td><p>1,75</p></td>
<td><p>0,04006</p></td>
<td><p>0,9599</p></td>
<td><p>0,9199</p></td>
</tr>
<tr class="row-even"><td><p>1,76</p></td>
<td><p>0,0392</p></td>
<td><p>0,9608</p></td>
<td><p>0,9216</p></td>
</tr>
<tr class="row-odd"><td><p>1,77</p></td>
<td><p>0,03836</p></td>
<td><p>0,9616</p></td>
<td><p>0,9233</p></td>
</tr>
<tr class="row-even"><td><p>1,78</p></td>
<td><p>0,03754</p></td>
<td><p>0,9625</p></td>
<td><p>0,9249</p></td>
</tr>
<tr class="row-odd"><td><p>1,79</p></td>
<td><p>0,03673</p></td>
<td><p>0,9633</p></td>
<td><p>0,9265</p></td>
</tr>
<tr class="row-even"><td><p>1,8</p></td>
<td><p>0,03593</p></td>
<td><p>0,9641</p></td>
<td><p>0,9281</p></td>
</tr>
<tr class="row-odd"><td><p>1,81</p></td>
<td><p>0,03515</p></td>
<td><p>0,9649</p></td>
<td><p>0,9297</p></td>
</tr>
<tr class="row-even"><td><p>1,82</p></td>
<td><p>0,03438</p></td>
<td><p>0,9656</p></td>
<td><p>0,9312</p></td>
</tr>
<tr class="row-odd"><td><p>1,83</p></td>
<td><p>0,03362</p></td>
<td><p>0,9664</p></td>
<td><p>0,9328</p></td>
</tr>
<tr class="row-even"><td><p>1,84</p></td>
<td><p>0,03288</p></td>
<td><p>0,9671</p></td>
<td><p>0,9342</p></td>
</tr>
<tr class="row-odd"><td><p>1,85</p></td>
<td><p>0,03216</p></td>
<td><p>0,9678</p></td>
<td><p>0,9357</p></td>
</tr>
<tr class="row-even"><td><p>1,86</p></td>
<td><p>0,03144</p></td>
<td><p>0,9686</p></td>
<td><p>0,9371</p></td>
</tr>
<tr class="row-odd"><td><p>1,87</p></td>
<td><p>0,03074</p></td>
<td><p>0,9693</p></td>
<td><p>0,9385</p></td>
</tr>
<tr class="row-even"><td><p>1,88</p></td>
<td><p>0,03005</p></td>
<td><p>0,9699</p></td>
<td><p>0,9399</p></td>
</tr>
<tr class="row-odd"><td><p>1,89</p></td>
<td><p>0,02938</p></td>
<td><p>0,9706</p></td>
<td><p>0,9412</p></td>
</tr>
<tr class="row-even"><td><p>1,9</p></td>
<td><p>0,02872</p></td>
<td><p>0,9713</p></td>
<td><p>0,9426</p></td>
</tr>
<tr class="row-odd"><td><p>1,91</p></td>
<td><p>0,02807</p></td>
<td><p>0,9719</p></td>
<td><p>0,9439</p></td>
</tr>
<tr class="row-even"><td><p>1,92</p></td>
<td><p>0,02743</p></td>
<td><p>0,9726</p></td>
<td><p>0,9451</p></td>
</tr>
<tr class="row-odd"><td><p>1,93</p></td>
<td><p>0,0268</p></td>
<td><p>0,9732</p></td>
<td><p>0,9464</p></td>
</tr>
<tr class="row-even"><td><p>1,94</p></td>
<td><p>0,02619</p></td>
<td><p>0,9738</p></td>
<td><p>0,9476</p></td>
</tr>
<tr class="row-odd"><td><p>1,95</p></td>
<td><p>0,02559</p></td>
<td><p>0,9744</p></td>
<td><p>0,9488</p></td>
</tr>
<tr class="row-even"><td><p>1,96</p></td>
<td><p>0,025</p></td>
<td><p>0,975</p></td>
<td><p>0,95</p></td>
</tr>
<tr class="row-odd"><td><p>1,97</p></td>
<td><p>0,02442</p></td>
<td><p>0,9756</p></td>
<td><p>0,9512</p></td>
</tr>
<tr class="row-even"><td><p>1,98</p></td>
<td><p>0,02385</p></td>
<td><p>0,9761</p></td>
<td><p>0,9523</p></td>
</tr>
<tr class="row-odd"><td><p>1,99</p></td>
<td><p>0,0233</p></td>
<td><p>0,9767</p></td>
<td><p>0,9534</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>0,02275</p></td>
<td><p>0,9772</p></td>
<td><p>0,9545</p></td>
</tr>
<tr class="row-odd"><td><p>2,01</p></td>
<td><p>0,02222</p></td>
<td><p>0,9778</p></td>
<td><p>0,9556</p></td>
</tr>
<tr class="row-even"><td><p>2,02</p></td>
<td><p>0,02169</p></td>
<td><p>0,9783</p></td>
<td><p>0,9566</p></td>
</tr>
<tr class="row-odd"><td><p>2,03</p></td>
<td><p>0,02118</p></td>
<td><p>0,9788</p></td>
<td><p>0,9576</p></td>
</tr>
<tr class="row-even"><td><p>2,04</p></td>
<td><p>0,02068</p></td>
<td><p>0,9793</p></td>
<td><p>0,9586</p></td>
</tr>
<tr class="row-odd"><td><p>2,05</p></td>
<td><p>0,02018</p></td>
<td><p>0,9798</p></td>
<td><p>0,9596</p></td>
</tr>
<tr class="row-even"><td><p>2,06</p></td>
<td><p>0,0197</p></td>
<td><p>0,9803</p></td>
<td><p>0,9606</p></td>
</tr>
<tr class="row-odd"><td><p>2,07</p></td>
<td><p>0,01923</p></td>
<td><p>0,9808</p></td>
<td><p>0,9615</p></td>
</tr>
<tr class="row-even"><td><p>2,08</p></td>
<td><p>0,01876</p></td>
<td><p>0,9812</p></td>
<td><p>0,9625</p></td>
</tr>
<tr class="row-odd"><td><p>2,09</p></td>
<td><p>0,01831</p></td>
<td><p>0,9817</p></td>
<td><p>0,9634</p></td>
</tr>
<tr class="row-even"><td><p>2,1</p></td>
<td><p>0,01786</p></td>
<td><p>0,9821</p></td>
<td><p>0,9643</p></td>
</tr>
<tr class="row-odd"><td><p>2,11</p></td>
<td><p>0,01743</p></td>
<td><p>0,9826</p></td>
<td><p>0,9651</p></td>
</tr>
<tr class="row-even"><td><p>2,12</p></td>
<td><p>0,017</p></td>
<td><p>0,983</p></td>
<td><p>0,966</p></td>
</tr>
<tr class="row-odd"><td><p>2,13</p></td>
<td><p>0,01659</p></td>
<td><p>0,9834</p></td>
<td><p>0,9668</p></td>
</tr>
<tr class="row-even"><td><p>2,14</p></td>
<td><p>0,01618</p></td>
<td><p>0,9838</p></td>
<td><p>0,9676</p></td>
</tr>
<tr class="row-odd"><td><p>2,15</p></td>
<td><p>0,01578</p></td>
<td><p>0,9842</p></td>
<td><p>0,9684</p></td>
</tr>
<tr class="row-even"><td><p>2,16</p></td>
<td><p>0,01539</p></td>
<td><p>0,9846</p></td>
<td><p>0,9692</p></td>
</tr>
<tr class="row-odd"><td><p>2,17</p></td>
<td><p>0,015</p></td>
<td><p>0,985</p></td>
<td><p>0,97</p></td>
</tr>
<tr class="row-even"><td><p>2,18</p></td>
<td><p>0,01463</p></td>
<td><p>0,9854</p></td>
<td><p>0,9707</p></td>
</tr>
<tr class="row-odd"><td><p>2,19</p></td>
<td><p>0,01426</p></td>
<td><p>0,9857</p></td>
<td><p>0,9715</p></td>
</tr>
<tr class="row-even"><td><p>2,2</p></td>
<td><p>0,0139</p></td>
<td><p>0,9861</p></td>
<td><p>0,9722</p></td>
</tr>
<tr class="row-odd"><td><p>2,21</p></td>
<td><p>0,01355</p></td>
<td><p>0,9864</p></td>
<td><p>0,9729</p></td>
</tr>
<tr class="row-even"><td><p>2,22</p></td>
<td><p>0,01321</p></td>
<td><p>0,9868</p></td>
<td><p>0,9736</p></td>
</tr>
<tr class="row-odd"><td><p>2,23</p></td>
<td><p>0,01287</p></td>
<td><p>0,9871</p></td>
<td><p>0,9743</p></td>
</tr>
<tr class="row-even"><td><p>2,24</p></td>
<td><p>0,01255</p></td>
<td><p>0,9875</p></td>
<td><p>0,9749</p></td>
</tr>
<tr class="row-odd"><td><p>2,25</p></td>
<td><p>0,01222</p></td>
<td><p>0,9878</p></td>
<td><p>0,9756</p></td>
</tr>
<tr class="row-even"><td><p>2,26</p></td>
<td><p>0,01191</p></td>
<td><p>0,9881</p></td>
<td><p>0,9762</p></td>
</tr>
<tr class="row-odd"><td><p>2,27</p></td>
<td><p>0,0116</p></td>
<td><p>0,9884</p></td>
<td><p>0,9768</p></td>
</tr>
<tr class="row-even"><td><p>2,28</p></td>
<td><p>0,0113</p></td>
<td><p>0,9887</p></td>
<td><p>0,9774</p></td>
</tr>
<tr class="row-odd"><td><p>2,29</p></td>
<td><p>0,01101</p></td>
<td><p>0,989</p></td>
<td><p>0,978</p></td>
</tr>
<tr class="row-even"><td><p>2,3</p></td>
<td><p>0,01072</p></td>
<td><p>0,9893</p></td>
<td><p>0,9786</p></td>
</tr>
<tr class="row-odd"><td><p>2,31</p></td>
<td><p>0,01044</p></td>
<td><p>0,9896</p></td>
<td><p>0,9791</p></td>
</tr>
<tr class="row-even"><td><p>2,32</p></td>
<td><p>0,01017</p></td>
<td><p>0,9898</p></td>
<td><p>0,9797</p></td>
</tr>
<tr class="row-odd"><td><p>2,33</p></td>
<td><p>0,009903</p></td>
<td><p>0,9901</p></td>
<td><p>0,9802</p></td>
</tr>
<tr class="row-even"><td><p>2,34</p></td>
<td><p>0,009642</p></td>
<td><p>0,9904</p></td>
<td><p>0,9807</p></td>
</tr>
<tr class="row-odd"><td><p>2,35</p></td>
<td><p>0,009387</p></td>
<td><p>0,9906</p></td>
<td><p>0,9812</p></td>
</tr>
<tr class="row-even"><td><p>2,36</p></td>
<td><p>0,009137</p></td>
<td><p>0,9909</p></td>
<td><p>0,9817</p></td>
</tr>
<tr class="row-odd"><td><p>2,37</p></td>
<td><p>0,008894</p></td>
<td><p>0,9911</p></td>
<td><p>0,9822</p></td>
</tr>
<tr class="row-even"><td><p>2,38</p></td>
<td><p>0,008656</p></td>
<td><p>0,9913</p></td>
<td><p>0,9827</p></td>
</tr>
<tr class="row-odd"><td><p>2,39</p></td>
<td><p>0,008424</p></td>
<td><p>0,9916</p></td>
<td><p>0,9832</p></td>
</tr>
<tr class="row-even"><td><p>2,4</p></td>
<td><p>0,008198</p></td>
<td><p>0,9918</p></td>
<td><p>0,9836</p></td>
</tr>
<tr class="row-odd"><td><p>2,41</p></td>
<td><p>0,007976</p></td>
<td><p>0,992</p></td>
<td><p>0,984</p></td>
</tr>
<tr class="row-even"><td><p>2,42</p></td>
<td><p>0,00776</p></td>
<td><p>0,9922</p></td>
<td><p>0,9845</p></td>
</tr>
<tr class="row-odd"><td><p>2,43</p></td>
<td><p>0,007549</p></td>
<td><p>0,9925</p></td>
<td><p>0,9849</p></td>
</tr>
<tr class="row-even"><td><p>2,44</p></td>
<td><p>0,007344</p></td>
<td><p>0,9927</p></td>
<td><p>0,9853</p></td>
</tr>
<tr class="row-odd"><td><p>2,45</p></td>
<td><p>0,007143</p></td>
<td><p>0,9929</p></td>
<td><p>0,9857</p></td>
</tr>
<tr class="row-even"><td><p>2,46</p></td>
<td><p>0,006947</p></td>
<td><p>0,9931</p></td>
<td><p>0,9861</p></td>
</tr>
<tr class="row-odd"><td><p>2,47</p></td>
<td><p>0,006756</p></td>
<td><p>0,9932</p></td>
<td><p>0,9865</p></td>
</tr>
<tr class="row-even"><td><p>2,48</p></td>
<td><p>0,006569</p></td>
<td><p>0,9934</p></td>
<td><p>0,9869</p></td>
</tr>
<tr class="row-odd"><td><p>2,49</p></td>
<td><p>0,006387</p></td>
<td><p>0,9936</p></td>
<td><p>0,9872</p></td>
</tr>
<tr class="row-even"><td><p>2,5</p></td>
<td><p>0,00621</p></td>
<td><p>0,9938</p></td>
<td><p>0,9876</p></td>
</tr>
<tr class="row-odd"><td><p>2,51</p></td>
<td><p>0,006037</p></td>
<td><p>0,994</p></td>
<td><p>0,9879</p></td>
</tr>
<tr class="row-even"><td><p>2,52</p></td>
<td><p>0,005868</p></td>
<td><p>0,9941</p></td>
<td><p>0,9883</p></td>
</tr>
<tr class="row-odd"><td><p>2,53</p></td>
<td><p>0,005703</p></td>
<td><p>0,9943</p></td>
<td><p>0,9886</p></td>
</tr>
<tr class="row-even"><td><p>2,54</p></td>
<td><p>0,005543</p></td>
<td><p>0,9945</p></td>
<td><p>0,9889</p></td>
</tr>
<tr class="row-odd"><td><p>2,55</p></td>
<td><p>0,005386</p></td>
<td><p>0,9946</p></td>
<td><p>0,9892</p></td>
</tr>
<tr class="row-even"><td><p>2,56</p></td>
<td><p>0,005234</p></td>
<td><p>0,9948</p></td>
<td><p>0,9895</p></td>
</tr>
<tr class="row-odd"><td><p>2,57</p></td>
<td><p>0,005085</p></td>
<td><p>0,9949</p></td>
<td><p>0,9898</p></td>
</tr>
<tr class="row-even"><td><p>2,58</p></td>
<td><p>0,00494</p></td>
<td><p>0,9951</p></td>
<td><p>0,9901</p></td>
</tr>
<tr class="row-odd"><td><p>2,59</p></td>
<td><p>0,004799</p></td>
<td><p>0,9952</p></td>
<td><p>0,9904</p></td>
</tr>
<tr class="row-even"><td><p>2,6</p></td>
<td><p>0,004661</p></td>
<td><p>0,9953</p></td>
<td><p>0,9907</p></td>
</tr>
<tr class="row-odd"><td><p>2,61</p></td>
<td><p>0,004527</p></td>
<td><p>0,9955</p></td>
<td><p>0,9909</p></td>
</tr>
<tr class="row-even"><td><p>2,62</p></td>
<td><p>0,004396</p></td>
<td><p>0,9956</p></td>
<td><p>0,9912</p></td>
</tr>
<tr class="row-odd"><td><p>2,63</p></td>
<td><p>0,004269</p></td>
<td><p>0,9957</p></td>
<td><p>0,9915</p></td>
</tr>
<tr class="row-even"><td><p>2,64</p></td>
<td><p>0,004145</p></td>
<td><p>0,9959</p></td>
<td><p>0,9917</p></td>
</tr>
<tr class="row-odd"><td><p>2,65</p></td>
<td><p>0,004025</p></td>
<td><p>0,996</p></td>
<td><p>0,992</p></td>
</tr>
<tr class="row-even"><td><p>2,66</p></td>
<td><p>0,003907</p></td>
<td><p>0,9961</p></td>
<td><p>0,9922</p></td>
</tr>
<tr class="row-odd"><td><p>2,67</p></td>
<td><p>0,003793</p></td>
<td><p>0,9962</p></td>
<td><p>0,9924</p></td>
</tr>
<tr class="row-even"><td><p>2,68</p></td>
<td><p>0,003681</p></td>
<td><p>0,9963</p></td>
<td><p>0,9926</p></td>
</tr>
<tr class="row-odd"><td><p>2,69</p></td>
<td><p>0,003573</p></td>
<td><p>0,9964</p></td>
<td><p>0,9929</p></td>
</tr>
<tr class="row-even"><td><p>2,7</p></td>
<td><p>0,003467</p></td>
<td><p>0,9965</p></td>
<td><p>0,9931</p></td>
</tr>
<tr class="row-odd"><td><p>2,71</p></td>
<td><p>0,003364</p></td>
<td><p>0,9966</p></td>
<td><p>0,9933</p></td>
</tr>
<tr class="row-even"><td><p>2,72</p></td>
<td><p>0,003264</p></td>
<td><p>0,9967</p></td>
<td><p>0,9935</p></td>
</tr>
<tr class="row-odd"><td><p>2,73</p></td>
<td><p>0,003167</p></td>
<td><p>0,9968</p></td>
<td><p>0,9937</p></td>
</tr>
<tr class="row-even"><td><p>2,74</p></td>
<td><p>0,003072</p></td>
<td><p>0,9969</p></td>
<td><p>0,9939</p></td>
</tr>
<tr class="row-odd"><td><p>2,75</p></td>
<td><p>0,00298</p></td>
<td><p>0,997</p></td>
<td><p>0,994</p></td>
</tr>
<tr class="row-even"><td><p>2,76</p></td>
<td><p>0,00289</p></td>
<td><p>0,9971</p></td>
<td><p>0,9942</p></td>
</tr>
<tr class="row-odd"><td><p>2,77</p></td>
<td><p>0,002803</p></td>
<td><p>0,9972</p></td>
<td><p>0,9944</p></td>
</tr>
<tr class="row-even"><td><p>2,78</p></td>
<td><p>0,002718</p></td>
<td><p>0,9973</p></td>
<td><p>0,9946</p></td>
</tr>
<tr class="row-odd"><td><p>2,79</p></td>
<td><p>0,002635</p></td>
<td><p>0,9974</p></td>
<td><p>0,9947</p></td>
</tr>
<tr class="row-even"><td><p>2,8</p></td>
<td><p>0,002555</p></td>
<td><p>0,9974</p></td>
<td><p>0,9949</p></td>
</tr>
<tr class="row-odd"><td><p>2,81</p></td>
<td><p>0,002477</p></td>
<td><p>0,9975</p></td>
<td><p>0,995</p></td>
</tr>
<tr class="row-even"><td><p>2,82</p></td>
<td><p>0,002401</p></td>
<td><p>0,9976</p></td>
<td><p>0,9952</p></td>
</tr>
<tr class="row-odd"><td><p>2,83</p></td>
<td><p>0,002327</p></td>
<td><p>0,9977</p></td>
<td><p>0,9953</p></td>
</tr>
<tr class="row-even"><td><p>2,84</p></td>
<td><p>0,002256</p></td>
<td><p>0,9977</p></td>
<td><p>0,9955</p></td>
</tr>
<tr class="row-odd"><td><p>2,85</p></td>
<td><p>0,002186</p></td>
<td><p>0,9978</p></td>
<td><p>0,9956</p></td>
</tr>
<tr class="row-even"><td><p>2,86</p></td>
<td><p>0,002118</p></td>
<td><p>0,9979</p></td>
<td><p>0,9958</p></td>
</tr>
<tr class="row-odd"><td><p>2,87</p></td>
<td><p>0,002052</p></td>
<td><p>0,9979</p></td>
<td><p>0,9959</p></td>
</tr>
<tr class="row-even"><td><p>2,88</p></td>
<td><p>0,001988</p></td>
<td><p>0,998</p></td>
<td><p>0,996</p></td>
</tr>
<tr class="row-odd"><td><p>2,89</p></td>
<td><p>0,001926</p></td>
<td><p>0,9981</p></td>
<td><p>0,9961</p></td>
</tr>
<tr class="row-even"><td><p>2,9</p></td>
<td><p>0,001866</p></td>
<td><p>0,9981</p></td>
<td><p>0,9963</p></td>
</tr>
<tr class="row-odd"><td><p>2,91</p></td>
<td><p>0,001807</p></td>
<td><p>0,9982</p></td>
<td><p>0,9964</p></td>
</tr>
<tr class="row-even"><td><p>2,92</p></td>
<td><p>0,00175</p></td>
<td><p>0,9982</p></td>
<td><p>0,9965</p></td>
</tr>
<tr class="row-odd"><td><p>2,93</p></td>
<td><p>0,001695</p></td>
<td><p>0,9983</p></td>
<td><p>0,9966</p></td>
</tr>
<tr class="row-even"><td><p>2,94</p></td>
<td><p>0,001641</p></td>
<td><p>0,9984</p></td>
<td><p>0,9967</p></td>
</tr>
<tr class="row-odd"><td><p>2,95</p></td>
<td><p>0,001589</p></td>
<td><p>0,9984</p></td>
<td><p>0,9968</p></td>
</tr>
<tr class="row-even"><td><p>2,96</p></td>
<td><p>0,001538</p></td>
<td><p>0,9985</p></td>
<td><p>0,9969</p></td>
</tr>
<tr class="row-odd"><td><p>2,97</p></td>
<td><p>0,001489</p></td>
<td><p>0,9985</p></td>
<td><p>0,997</p></td>
</tr>
<tr class="row-even"><td><p>2,98</p></td>
<td><p>0,001441</p></td>
<td><p>0,9986</p></td>
<td><p>0,9971</p></td>
</tr>
<tr class="row-odd"><td><p>2,99</p></td>
<td><p>0,001395</p></td>
<td><p>0,9986</p></td>
<td><p>0,9972</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>0,00135</p></td>
<td><p>0,9987</p></td>
<td><p>0,9973</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="die-t-verteilung">
<h2>Die <span class="math notranslate nohighlight">\(t\)</span>-Verteilung<a class="headerlink" href="#die-t-verteilung" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<section id="quantilen-der-studentschen-t-verteilung">
<h3>Quantilen der Studentschen t-Verteilung<a class="headerlink" href="#quantilen-der-studentschen-t-verteilung" title="Permalink to this headline">#</a></h3>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Si</p></th>
<th class="head"><p>0,75</p></th>
<th class="head"><p>0,9</p></th>
<th class="head"><p>0,95</p></th>
<th class="head"><p>0,975</p></th>
<th class="head"><p>0,99</p></th>
<th class="head"><p>0,995</p></th>
<th class="head"><p>0,999</p></th>
<th class="head"><p>0,9995</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>df/Alpha</p></td>
<td><p>0,25</p></td>
<td><p>0,1</p></td>
<td><p>0,05</p></td>
<td><p>0,025</p></td>
<td><p>0,01</p></td>
<td><p>0,005</p></td>
<td><p>0,001</p></td>
<td><p>5e-04</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>1</p></td>
<td><p>3,08</p></td>
<td><p>6,31</p></td>
<td><p>12,71</p></td>
<td><p>31,82</p></td>
<td><p>63,66</p></td>
<td><p>318,3</p></td>
<td><p>636,6</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>0,82</p></td>
<td><p>1,89</p></td>
<td><p>2,92</p></td>
<td><p>4,3</p></td>
<td><p>6,96</p></td>
<td><p>9,92</p></td>
<td><p>22,33</p></td>
<td><p>31,6</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>0,76</p></td>
<td><p>1,64</p></td>
<td><p>2,35</p></td>
<td><p>3,18</p></td>
<td><p>4,54</p></td>
<td><p>5,84</p></td>
<td><p>10,21</p></td>
<td><p>12,92</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>0,74</p></td>
<td><p>1,53</p></td>
<td><p>2,13</p></td>
<td><p>2,78</p></td>
<td><p>3,75</p></td>
<td><p>4,6</p></td>
<td><p>7,17</p></td>
<td><p>8,61</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>0,73</p></td>
<td><p>1,48</p></td>
<td><p>2,02</p></td>
<td><p>2,57</p></td>
<td><p>3,36</p></td>
<td><p>4,03</p></td>
<td><p>5,89</p></td>
<td><p>6,87</p></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>0,72</p></td>
<td><p>1,44</p></td>
<td><p>1,94</p></td>
<td><p>2,45</p></td>
<td><p>3,14</p></td>
<td><p>3,71</p></td>
<td><p>5,21</p></td>
<td><p>5,96</p></td>
</tr>
<tr class="row-odd"><td><p>7</p></td>
<td><p>0,71</p></td>
<td><p>1,41</p></td>
<td><p>1,89</p></td>
<td><p>2,36</p></td>
<td><p>3</p></td>
<td><p>3,5</p></td>
<td><p>4,79</p></td>
<td><p>5,41</p></td>
</tr>
<tr class="row-even"><td><p>8</p></td>
<td><p>0,71</p></td>
<td><p>1,4</p></td>
<td><p>1,86</p></td>
<td><p>2,31</p></td>
<td><p>2,9</p></td>
<td><p>3,36</p></td>
<td><p>4,5</p></td>
<td><p>5,04</p></td>
</tr>
<tr class="row-odd"><td><p>9</p></td>
<td><p>0,7</p></td>
<td><p>1,38</p></td>
<td><p>1,83</p></td>
<td><p>2,26</p></td>
<td><p>2,82</p></td>
<td><p>3,25</p></td>
<td><p>4,3</p></td>
<td><p>4,78</p></td>
</tr>
<tr class="row-even"><td><p>10</p></td>
<td><p>0,7</p></td>
<td><p>1,37</p></td>
<td><p>1,81</p></td>
<td><p>2,23</p></td>
<td><p>2,76</p></td>
<td><p>3,17</p></td>
<td><p>4,14</p></td>
<td><p>4,59</p></td>
</tr>
<tr class="row-odd"><td><p>11</p></td>
<td><p>0,7</p></td>
<td><p>1,36</p></td>
<td><p>1,8</p></td>
<td><p>2,2</p></td>
<td><p>2,72</p></td>
<td><p>3,11</p></td>
<td><p>4,02</p></td>
<td><p>4,44</p></td>
</tr>
<tr class="row-even"><td><p>12</p></td>
<td><p>0,7</p></td>
<td><p>1,36</p></td>
<td><p>1,78</p></td>
<td><p>2,18</p></td>
<td><p>2,68</p></td>
<td><p>3,05</p></td>
<td><p>3,93</p></td>
<td><p>4,32</p></td>
</tr>
<tr class="row-odd"><td><p>13</p></td>
<td><p>0,69</p></td>
<td><p>1,35</p></td>
<td><p>1,77</p></td>
<td><p>2,16</p></td>
<td><p>2,65</p></td>
<td><p>3,01</p></td>
<td><p>3,85</p></td>
<td><p>4,22</p></td>
</tr>
<tr class="row-even"><td><p>14</p></td>
<td><p>0,69</p></td>
<td><p>1,35</p></td>
<td><p>1,76</p></td>
<td><p>2,14</p></td>
<td><p>2,62</p></td>
<td><p>2,98</p></td>
<td><p>3,79</p></td>
<td><p>4,14</p></td>
</tr>
<tr class="row-odd"><td><p>15</p></td>
<td><p>0,69</p></td>
<td><p>1,34</p></td>
<td><p>1,75</p></td>
<td><p>2,13</p></td>
<td><p>2,6</p></td>
<td><p>2,95</p></td>
<td><p>3,73</p></td>
<td><p>4,07</p></td>
</tr>
<tr class="row-even"><td><p>16</p></td>
<td><p>0,69</p></td>
<td><p>1,34</p></td>
<td><p>1,75</p></td>
<td><p>2,12</p></td>
<td><p>2,58</p></td>
<td><p>2,92</p></td>
<td><p>3,69</p></td>
<td><p>4,01</p></td>
</tr>
<tr class="row-odd"><td><p>17</p></td>
<td><p>0,69</p></td>
<td><p>1,33</p></td>
<td><p>1,74</p></td>
<td><p>2,11</p></td>
<td><p>2,57</p></td>
<td><p>2,9</p></td>
<td><p>3,65</p></td>
<td><p>3,97</p></td>
</tr>
<tr class="row-even"><td><p>18</p></td>
<td><p>0,69</p></td>
<td><p>1,33</p></td>
<td><p>1,73</p></td>
<td><p>2,1</p></td>
<td><p>2,55</p></td>
<td><p>2,88</p></td>
<td><p>3,61</p></td>
<td><p>3,92</p></td>
</tr>
<tr class="row-odd"><td><p>19</p></td>
<td><p>0,69</p></td>
<td><p>1,33</p></td>
<td><p>1,73</p></td>
<td><p>2,09</p></td>
<td><p>2,54</p></td>
<td><p>2,86</p></td>
<td><p>3,58</p></td>
<td><p>3,88</p></td>
</tr>
<tr class="row-even"><td><p>20</p></td>
<td><p>0,69</p></td>
<td><p>1,33</p></td>
<td><p>1,72</p></td>
<td><p>2,09</p></td>
<td><p>2,53</p></td>
<td><p>2,85</p></td>
<td><p>3,55</p></td>
<td><p>3,85</p></td>
</tr>
<tr class="row-odd"><td><p>21</p></td>
<td><p>0,69</p></td>
<td><p>1,32</p></td>
<td><p>1,72</p></td>
<td><p>2,08</p></td>
<td><p>2,52</p></td>
<td><p>2,83</p></td>
<td><p>3,53</p></td>
<td><p>3,82</p></td>
</tr>
<tr class="row-even"><td><p>22</p></td>
<td><p>0,69</p></td>
<td><p>1,32</p></td>
<td><p>1,72</p></td>
<td><p>2,07</p></td>
<td><p>2,51</p></td>
<td><p>2,82</p></td>
<td><p>3,5</p></td>
<td><p>3,79</p></td>
</tr>
<tr class="row-odd"><td><p>23</p></td>
<td><p>0,69</p></td>
<td><p>1,32</p></td>
<td><p>1,71</p></td>
<td><p>2,07</p></td>
<td><p>2,5</p></td>
<td><p>2,81</p></td>
<td><p>3,48</p></td>
<td><p>3,77</p></td>
</tr>
<tr class="row-even"><td><p>24</p></td>
<td><p>0,68</p></td>
<td><p>1,32</p></td>
<td><p>1,71</p></td>
<td><p>2,06</p></td>
<td><p>2,49</p></td>
<td><p>2,8</p></td>
<td><p>3,47</p></td>
<td><p>3,75</p></td>
</tr>
<tr class="row-odd"><td><p>25</p></td>
<td><p>0,68</p></td>
<td><p>1,32</p></td>
<td><p>1,71</p></td>
<td><p>2,06</p></td>
<td><p>2,49</p></td>
<td><p>2,79</p></td>
<td><p>3,45</p></td>
<td><p>3,73</p></td>
</tr>
<tr class="row-even"><td><p>26</p></td>
<td><p>0,68</p></td>
<td><p>1,31</p></td>
<td><p>1,71</p></td>
<td><p>2,06</p></td>
<td><p>2,48</p></td>
<td><p>2,78</p></td>
<td><p>3,43</p></td>
<td><p>3,71</p></td>
</tr>
<tr class="row-odd"><td><p>27</p></td>
<td><p>0,68</p></td>
<td><p>1,31</p></td>
<td><p>1,7</p></td>
<td><p>2,05</p></td>
<td><p>2,47</p></td>
<td><p>2,77</p></td>
<td><p>3,42</p></td>
<td><p>3,69</p></td>
</tr>
<tr class="row-even"><td><p>28</p></td>
<td><p>0,68</p></td>
<td><p>1,31</p></td>
<td><p>1,7</p></td>
<td><p>2,05</p></td>
<td><p>2,47</p></td>
<td><p>2,76</p></td>
<td><p>3,41</p></td>
<td><p>3,67</p></td>
</tr>
<tr class="row-odd"><td><p>29</p></td>
<td><p>0,68</p></td>
<td><p>1,31</p></td>
<td><p>1,7</p></td>
<td><p>2,05</p></td>
<td><p>2,46</p></td>
<td><p>2,76</p></td>
<td><p>3,4</p></td>
<td><p>3,66</p></td>
</tr>
<tr class="row-even"><td><p>30</p></td>
<td><p>0,68</p></td>
<td><p>1,31</p></td>
<td><p>1,7</p></td>
<td><p>2,04</p></td>
<td><p>2,46</p></td>
<td><p>2,75</p></td>
<td><p>3,39</p></td>
<td><p>3,65</p></td>
</tr>
<tr class="row-odd"><td><p>35</p></td>
<td><p>0,68</p></td>
<td><p>1,31</p></td>
<td><p>1,69</p></td>
<td><p>2,03</p></td>
<td><p>2,44</p></td>
<td><p>2,72</p></td>
<td><p>3,34</p></td>
<td><p>3,59</p></td>
</tr>
<tr class="row-even"><td><p>40</p></td>
<td><p>0,68</p></td>
<td><p>1,3</p></td>
<td><p>1,68</p></td>
<td><p>2,02</p></td>
<td><p>2,42</p></td>
<td><p>2,7</p></td>
<td><p>3,31</p></td>
<td><p>3,55</p></td>
</tr>
<tr class="row-odd"><td><p>45</p></td>
<td><p>0,68</p></td>
<td><p>1,3</p></td>
<td><p>1,68</p></td>
<td><p>2,01</p></td>
<td><p>2,41</p></td>
<td><p>2,69</p></td>
<td><p>3,28</p></td>
<td><p>3,52</p></td>
</tr>
<tr class="row-even"><td><p>50</p></td>
<td><p>0,68</p></td>
<td><p>1,3</p></td>
<td><p>1,68</p></td>
<td><p>2,01</p></td>
<td><p>2,4</p></td>
<td><p>2,68</p></td>
<td><p>3,26</p></td>
<td><p>3,5</p></td>
</tr>
<tr class="row-odd"><td><p>60</p></td>
<td><p>0,68</p></td>
<td><p>1,3</p></td>
<td><p>1,67</p></td>
<td><p>2</p></td>
<td><p>2,39</p></td>
<td><p>2,66</p></td>
<td><p>3,23</p></td>
<td><p>3,46</p></td>
</tr>
<tr class="row-even"><td><p>70</p></td>
<td><p>0,68</p></td>
<td><p>1,29</p></td>
<td><p>1,67</p></td>
<td><p>1,99</p></td>
<td><p>2,38</p></td>
<td><p>2,65</p></td>
<td><p>3,21</p></td>
<td><p>3,44</p></td>
</tr>
<tr class="row-odd"><td><p>80</p></td>
<td><p>0,68</p></td>
<td><p>1,29</p></td>
<td><p>1,66</p></td>
<td><p>1,99</p></td>
<td><p>2,37</p></td>
<td><p>2,64</p></td>
<td><p>3,2</p></td>
<td><p>3,42</p></td>
</tr>
<tr class="row-even"><td><p>90</p></td>
<td><p>0,68</p></td>
<td><p>1,29</p></td>
<td><p>1,66</p></td>
<td><p>1,99</p></td>
<td><p>2,37</p></td>
<td><p>2,63</p></td>
<td><p>3,18</p></td>
<td><p>3,4</p></td>
</tr>
<tr class="row-odd"><td><p>100</p></td>
<td><p>0,68</p></td>
<td><p>1,29</p></td>
<td><p>1,66</p></td>
<td><p>1,98</p></td>
<td><p>2,36</p></td>
<td><p>2,63</p></td>
<td><p>3,17</p></td>
<td><p>3,39</p></td>
</tr>
<tr class="row-even"><td><p>150</p></td>
<td><p>0,68</p></td>
<td><p>1,29</p></td>
<td><p>1,66</p></td>
<td><p>1,98</p></td>
<td><p>2,35</p></td>
<td><p>2,61</p></td>
<td><p>3,15</p></td>
<td><p>3,36</p></td>
</tr>
<tr class="row-odd"><td><p>200</p></td>
<td><p>0,68</p></td>
<td><p>1,29</p></td>
<td><p>1,65</p></td>
<td><p>1,97</p></td>
<td><p>2,35</p></td>
<td><p>2,6</p></td>
<td><p>3,13</p></td>
<td><p>3,34</p></td>
</tr>
<tr class="row-even"><td><p>300</p></td>
<td><p>0,68</p></td>
<td><p>1,28</p></td>
<td><p>1,65</p></td>
<td><p>1,97</p></td>
<td><p>2,34</p></td>
<td><p>2,59</p></td>
<td><p>3,12</p></td>
<td><p>3,32</p></td>
</tr>
<tr class="row-odd"><td><p>500</p></td>
<td><p>0,67</p></td>
<td><p>1,28</p></td>
<td><p>1,65</p></td>
<td><p>1,96</p></td>
<td><p>2,33</p></td>
<td><p>2,59</p></td>
<td><p>3,11</p></td>
<td><p>3,31</p></td>
</tr>
<tr class="row-even"><td><p>1000</p></td>
<td><p>0,67</p></td>
<td><p>1,28</p></td>
<td><p>1,65</p></td>
<td><p>1,96</p></td>
<td><p>2,33</p></td>
<td><p>2,58</p></td>
<td><p>3,1</p></td>
<td><p>3,3</p></td>
</tr>
<tr class="row-odd"><td><p>1e+09</p></td>
<td><p>0,67</p></td>
<td><p>1,28</p></td>
<td><p>1,64</p></td>
<td><p>1,96</p></td>
<td><p>2,33</p></td>
<td><p>2,58</p></td>
<td><p>3,09</p></td>
<td><p>3,29</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="die-chi-quadrat-verteilung">
<h2>Die Chi-Quadrat-Verteilung<a class="headerlink" href="#die-chi-quadrat-verteilung" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<section id="chi-2-quantilen">
<h3><span class="math notranslate nohighlight">\(\chi^2\)</span>-Quantilen<a class="headerlink" href="#chi-2-quantilen" title="Permalink to this headline">#</a></h3>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Si</p></th>
<th class="head"><p>0,01</p></th>
<th class="head"><p>0,025</p></th>
<th class="head"><p>0,05</p></th>
<th class="head"><p>0,1</p></th>
<th class="head"><p>0,25</p></th>
<th class="head"><p>0,5</p></th>
<th class="head"><p>0,75</p></th>
<th class="head"><p>0,9</p></th>
<th class="head"><p>0,95</p></th>
<th class="head"><p>0,975</p></th>
<th class="head"><p>0,99</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>df/Alpha</p></td>
<td><p>0,99</p></td>
<td><p>0,975</p></td>
<td><p>0,95</p></td>
<td><p>0,9</p></td>
<td><p>0,75</p></td>
<td><p>0,5</p></td>
<td><p>0,25</p></td>
<td><p>0,1</p></td>
<td><p>0,05</p></td>
<td><p>0,025</p></td>
<td><p>0,01</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0,02</p></td>
<td><p>0,1</p></td>
<td><p>0,45</p></td>
<td><p>1,32</p></td>
<td><p>2,71</p></td>
<td><p>3,84</p></td>
<td><p>5,02</p></td>
<td><p>6,63</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>0,02</p></td>
<td><p>0,05</p></td>
<td><p>0,1</p></td>
<td><p>0,21</p></td>
<td><p>0,58</p></td>
<td><p>1,39</p></td>
<td><p>2,77</p></td>
<td><p>4,61</p></td>
<td><p>5,99</p></td>
<td><p>7,38</p></td>
<td><p>9,21</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>0,11</p></td>
<td><p>0,22</p></td>
<td><p>0,35</p></td>
<td><p>0,58</p></td>
<td><p>1,21</p></td>
<td><p>2,37</p></td>
<td><p>4,11</p></td>
<td><p>6,25</p></td>
<td><p>7,81</p></td>
<td><p>9,35</p></td>
<td><p>11,34</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>0,3</p></td>
<td><p>0,48</p></td>
<td><p>0,71</p></td>
<td><p>1,06</p></td>
<td><p>1,92</p></td>
<td><p>3,36</p></td>
<td><p>5,39</p></td>
<td><p>7,78</p></td>
<td><p>9,49</p></td>
<td><p>11,14</p></td>
<td><p>13,28</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>0,55</p></td>
<td><p>0,83</p></td>
<td><p>1,15</p></td>
<td><p>1,61</p></td>
<td><p>2,67</p></td>
<td><p>4,35</p></td>
<td><p>6,63</p></td>
<td><p>9,24</p></td>
<td><p>11,07</p></td>
<td><p>12,83</p></td>
<td><p>15,09</p></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>0,87</p></td>
<td><p>1,24</p></td>
<td><p>1,64</p></td>
<td><p>2,2</p></td>
<td><p>3,45</p></td>
<td><p>5,35</p></td>
<td><p>7,84</p></td>
<td><p>10,64</p></td>
<td><p>12,59</p></td>
<td><p>14,45</p></td>
<td><p>16,81</p></td>
</tr>
<tr class="row-odd"><td><p>7</p></td>
<td><p>1,24</p></td>
<td><p>1,69</p></td>
<td><p>2,17</p></td>
<td><p>2,83</p></td>
<td><p>4,25</p></td>
<td><p>6,35</p></td>
<td><p>9,04</p></td>
<td><p>12,02</p></td>
<td><p>14,07</p></td>
<td><p>16,01</p></td>
<td><p>18,48</p></td>
</tr>
<tr class="row-even"><td><p>8</p></td>
<td><p>1,65</p></td>
<td><p>2,18</p></td>
<td><p>2,73</p></td>
<td><p>3,49</p></td>
<td><p>5,07</p></td>
<td><p>7,34</p></td>
<td><p>10,22</p></td>
<td><p>13,36</p></td>
<td><p>15,51</p></td>
<td><p>17,53</p></td>
<td><p>20,09</p></td>
</tr>
<tr class="row-odd"><td><p>9</p></td>
<td><p>2,09</p></td>
<td><p>2,7</p></td>
<td><p>3,33</p></td>
<td><p>4,17</p></td>
<td><p>5,9</p></td>
<td><p>8,34</p></td>
<td><p>11,39</p></td>
<td><p>14,68</p></td>
<td><p>16,92</p></td>
<td><p>19,02</p></td>
<td><p>21,67</p></td>
</tr>
<tr class="row-even"><td><p>10</p></td>
<td><p>2,56</p></td>
<td><p>3,25</p></td>
<td><p>3,94</p></td>
<td><p>4,87</p></td>
<td><p>6,74</p></td>
<td><p>9,34</p></td>
<td><p>12,55</p></td>
<td><p>15,99</p></td>
<td><p>18,31</p></td>
<td><p>20,48</p></td>
<td><p>23,21</p></td>
</tr>
<tr class="row-odd"><td><p>11</p></td>
<td><p>3,05</p></td>
<td><p>3,82</p></td>
<td><p>4,57</p></td>
<td><p>5,58</p></td>
<td><p>7,58</p></td>
<td><p>10,34</p></td>
<td><p>13,7</p></td>
<td><p>17,28</p></td>
<td><p>19,68</p></td>
<td><p>21,92</p></td>
<td><p>24,72</p></td>
</tr>
<tr class="row-even"><td><p>12</p></td>
<td><p>3,57</p></td>
<td><p>4,4</p></td>
<td><p>5,23</p></td>
<td><p>6,3</p></td>
<td><p>8,44</p></td>
<td><p>11,34</p></td>
<td><p>14,85</p></td>
<td><p>18,55</p></td>
<td><p>21,03</p></td>
<td><p>23,34</p></td>
<td><p>26,22</p></td>
</tr>
<tr class="row-odd"><td><p>13</p></td>
<td><p>4,11</p></td>
<td><p>5,01</p></td>
<td><p>5,89</p></td>
<td><p>7,04</p></td>
<td><p>9,3</p></td>
<td><p>12,34</p></td>
<td><p>15,98</p></td>
<td><p>19,81</p></td>
<td><p>22,36</p></td>
<td><p>24,74</p></td>
<td><p>27,69</p></td>
</tr>
<tr class="row-even"><td><p>14</p></td>
<td><p>4,66</p></td>
<td><p>5,63</p></td>
<td><p>6,57</p></td>
<td><p>7,79</p></td>
<td><p>10,17</p></td>
<td><p>13,34</p></td>
<td><p>17,12</p></td>
<td><p>21,06</p></td>
<td><p>23,68</p></td>
<td><p>26,12</p></td>
<td><p>29,14</p></td>
</tr>
<tr class="row-odd"><td><p>15</p></td>
<td><p>5,23</p></td>
<td><p>6,26</p></td>
<td><p>7,26</p></td>
<td><p>8,55</p></td>
<td><p>11,04</p></td>
<td><p>14,34</p></td>
<td><p>18,25</p></td>
<td><p>22,31</p></td>
<td><p>25</p></td>
<td><p>27,49</p></td>
<td><p>30,58</p></td>
</tr>
<tr class="row-even"><td><p>16</p></td>
<td><p>5,81</p></td>
<td><p>6,91</p></td>
<td><p>7,96</p></td>
<td><p>9,31</p></td>
<td><p>11,91</p></td>
<td><p>15,34</p></td>
<td><p>19,37</p></td>
<td><p>23,54</p></td>
<td><p>26,3</p></td>
<td><p>28,85</p></td>
<td><p>32</p></td>
</tr>
<tr class="row-odd"><td><p>17</p></td>
<td><p>6,41</p></td>
<td><p>7,56</p></td>
<td><p>8,67</p></td>
<td><p>10,09</p></td>
<td><p>12,79</p></td>
<td><p>16,34</p></td>
<td><p>20,49</p></td>
<td><p>24,77</p></td>
<td><p>27,59</p></td>
<td><p>30,19</p></td>
<td><p>33,41</p></td>
</tr>
<tr class="row-even"><td><p>18</p></td>
<td><p>7,01</p></td>
<td><p>8,23</p></td>
<td><p>9,39</p></td>
<td><p>10,86</p></td>
<td><p>13,68</p></td>
<td><p>17,34</p></td>
<td><p>21,6</p></td>
<td><p>25,99</p></td>
<td><p>28,87</p></td>
<td><p>31,53</p></td>
<td><p>34,81</p></td>
</tr>
<tr class="row-odd"><td><p>19</p></td>
<td><p>7,63</p></td>
<td><p>8,91</p></td>
<td><p>10,12</p></td>
<td><p>11,65</p></td>
<td><p>14,56</p></td>
<td><p>18,34</p></td>
<td><p>22,72</p></td>
<td><p>27,2</p></td>
<td><p>30,14</p></td>
<td><p>32,85</p></td>
<td><p>36,19</p></td>
</tr>
<tr class="row-even"><td><p>20</p></td>
<td><p>8,26</p></td>
<td><p>9,59</p></td>
<td><p>10,85</p></td>
<td><p>12,44</p></td>
<td><p>15,45</p></td>
<td><p>19,34</p></td>
<td><p>23,83</p></td>
<td><p>28,41</p></td>
<td><p>31,41</p></td>
<td><p>34,17</p></td>
<td><p>37,57</p></td>
</tr>
<tr class="row-odd"><td><p>21</p></td>
<td><p>8,9</p></td>
<td><p>10,28</p></td>
<td><p>11,59</p></td>
<td><p>13,24</p></td>
<td><p>16,34</p></td>
<td><p>20,34</p></td>
<td><p>24,93</p></td>
<td><p>29,62</p></td>
<td><p>32,67</p></td>
<td><p>35,48</p></td>
<td><p>38,93</p></td>
</tr>
<tr class="row-even"><td><p>22</p></td>
<td><p>9,54</p></td>
<td><p>10,98</p></td>
<td><p>12,34</p></td>
<td><p>14,04</p></td>
<td><p>17,24</p></td>
<td><p>21,34</p></td>
<td><p>26,04</p></td>
<td><p>30,81</p></td>
<td><p>33,92</p></td>
<td><p>36,78</p></td>
<td><p>40,29</p></td>
</tr>
<tr class="row-odd"><td><p>23</p></td>
<td><p>10,2</p></td>
<td><p>11,69</p></td>
<td><p>13,09</p></td>
<td><p>14,85</p></td>
<td><p>18,14</p></td>
<td><p>22,34</p></td>
<td><p>27,14</p></td>
<td><p>32,01</p></td>
<td><p>35,17</p></td>
<td><p>38,08</p></td>
<td><p>41,64</p></td>
</tr>
<tr class="row-even"><td><p>24</p></td>
<td><p>10,86</p></td>
<td><p>12,4</p></td>
<td><p>13,85</p></td>
<td><p>15,66</p></td>
<td><p>19,04</p></td>
<td><p>23,34</p></td>
<td><p>28,24</p></td>
<td><p>33,2</p></td>
<td><p>36,42</p></td>
<td><p>39,36</p></td>
<td><p>42,98</p></td>
</tr>
<tr class="row-odd"><td><p>25</p></td>
<td><p>11,52</p></td>
<td><p>13,12</p></td>
<td><p>14,61</p></td>
<td><p>16,47</p></td>
<td><p>19,94</p></td>
<td><p>24,34</p></td>
<td><p>29,34</p></td>
<td><p>34,38</p></td>
<td><p>37,65</p></td>
<td><p>40,65</p></td>
<td><p>44,31</p></td>
</tr>
<tr class="row-even"><td><p>26</p></td>
<td><p>12,2</p></td>
<td><p>13,84</p></td>
<td><p>15,38</p></td>
<td><p>17,29</p></td>
<td><p>20,84</p></td>
<td><p>25,34</p></td>
<td><p>30,43</p></td>
<td><p>35,56</p></td>
<td><p>38,89</p></td>
<td><p>41,92</p></td>
<td><p>45,64</p></td>
</tr>
<tr class="row-odd"><td><p>27</p></td>
<td><p>12,88</p></td>
<td><p>14,57</p></td>
<td><p>16,15</p></td>
<td><p>18,11</p></td>
<td><p>21,75</p></td>
<td><p>26,34</p></td>
<td><p>31,53</p></td>
<td><p>36,74</p></td>
<td><p>40,11</p></td>
<td><p>43,19</p></td>
<td><p>46,96</p></td>
</tr>
<tr class="row-even"><td><p>28</p></td>
<td><p>13,56</p></td>
<td><p>15,31</p></td>
<td><p>16,93</p></td>
<td><p>18,94</p></td>
<td><p>22,66</p></td>
<td><p>27,34</p></td>
<td><p>32,62</p></td>
<td><p>37,92</p></td>
<td><p>41,34</p></td>
<td><p>44,46</p></td>
<td><p>48,28</p></td>
</tr>
<tr class="row-odd"><td><p>29</p></td>
<td><p>14,26</p></td>
<td><p>16,05</p></td>
<td><p>17,71</p></td>
<td><p>19,77</p></td>
<td><p>23,57</p></td>
<td><p>28,34</p></td>
<td><p>33,71</p></td>
<td><p>39,09</p></td>
<td><p>42,56</p></td>
<td><p>45,72</p></td>
<td><p>49,59</p></td>
</tr>
<tr class="row-even"><td><p>30</p></td>
<td><p>14,95</p></td>
<td><p>16,79</p></td>
<td><p>18,49</p></td>
<td><p>20,6</p></td>
<td><p>24,48</p></td>
<td><p>29,34</p></td>
<td><p>34,8</p></td>
<td><p>40,26</p></td>
<td><p>43,77</p></td>
<td><p>46,98</p></td>
<td><p>50,89</p></td>
</tr>
<tr class="row-odd"><td><p>35</p></td>
<td><p>18,51</p></td>
<td><p>20,57</p></td>
<td><p>22,47</p></td>
<td><p>24,8</p></td>
<td><p>29,05</p></td>
<td><p>34,34</p></td>
<td><p>40,22</p></td>
<td><p>46,06</p></td>
<td><p>49,8</p></td>
<td><p>53,2</p></td>
<td><p>57,34</p></td>
</tr>
<tr class="row-even"><td><p>40</p></td>
<td><p>22,16</p></td>
<td><p>24,43</p></td>
<td><p>26,51</p></td>
<td><p>29,05</p></td>
<td><p>33,66</p></td>
<td><p>39,34</p></td>
<td><p>45,62</p></td>
<td><p>51,81</p></td>
<td><p>55,76</p></td>
<td><p>59,34</p></td>
<td><p>63,69</p></td>
</tr>
<tr class="row-odd"><td><p>45</p></td>
<td><p>25,9</p></td>
<td><p>28,37</p></td>
<td><p>30,61</p></td>
<td><p>33,35</p></td>
<td><p>38,29</p></td>
<td><p>44,34</p></td>
<td><p>50,98</p></td>
<td><p>57,51</p></td>
<td><p>61,66</p></td>
<td><p>65,41</p></td>
<td><p>69,96</p></td>
</tr>
<tr class="row-even"><td><p>50</p></td>
<td><p>29,71</p></td>
<td><p>32,36</p></td>
<td><p>34,76</p></td>
<td><p>37,69</p></td>
<td><p>42,94</p></td>
<td><p>49,33</p></td>
<td><p>56,33</p></td>
<td><p>63,17</p></td>
<td><p>67,5</p></td>
<td><p>71,42</p></td>
<td><p>76,15</p></td>
</tr>
<tr class="row-odd"><td><p>60</p></td>
<td><p>37,48</p></td>
<td><p>40,48</p></td>
<td><p>43,19</p></td>
<td><p>46,46</p></td>
<td><p>52,29</p></td>
<td><p>59,33</p></td>
<td><p>66,98</p></td>
<td><p>74,4</p></td>
<td><p>79,08</p></td>
<td><p>83,3</p></td>
<td><p>88,38</p></td>
</tr>
<tr class="row-even"><td><p>70</p></td>
<td><p>45,44</p></td>
<td><p>48,76</p></td>
<td><p>51,74</p></td>
<td><p>55,33</p></td>
<td><p>61,7</p></td>
<td><p>69,33</p></td>
<td><p>77,58</p></td>
<td><p>85,53</p></td>
<td><p>90,53</p></td>
<td><p>95,02</p></td>
<td><p>100,4</p></td>
</tr>
<tr class="row-odd"><td><p>80</p></td>
<td><p>53,54</p></td>
<td><p>57,15</p></td>
<td><p>60,39</p></td>
<td><p>64,28</p></td>
<td><p>71,14</p></td>
<td><p>79,33</p></td>
<td><p>88,13</p></td>
<td><p>96,58</p></td>
<td><p>101,9</p></td>
<td><p>106,6</p></td>
<td><p>112,3</p></td>
</tr>
<tr class="row-even"><td><p>90</p></td>
<td><p>61,75</p></td>
<td><p>65,65</p></td>
<td><p>69,13</p></td>
<td><p>73,29</p></td>
<td><p>80,62</p></td>
<td><p>89,33</p></td>
<td><p>98,65</p></td>
<td><p>107,6</p></td>
<td><p>113,2</p></td>
<td><p>118,1</p></td>
<td><p>124,1</p></td>
</tr>
<tr class="row-odd"><td><p>100</p></td>
<td><p>70,06</p></td>
<td><p>74,22</p></td>
<td><p>77,93</p></td>
<td><p>82,36</p></td>
<td><p>90,13</p></td>
<td><p>99,33</p></td>
<td><p>109,1</p></td>
<td><p>118,5</p></td>
<td><p>124,3</p></td>
<td><p>129,6</p></td>
<td><p>135,8</p></td>
</tr>
<tr class="row-even"><td><p>150</p></td>
<td><p>112,7</p></td>
<td><p>118</p></td>
<td><p>122,7</p></td>
<td><p>128,3</p></td>
<td><p>138</p></td>
<td><p>149,3</p></td>
<td><p>161,3</p></td>
<td><p>172,6</p></td>
<td><p>179,6</p></td>
<td><p>185,8</p></td>
<td><p>193,2</p></td>
</tr>
<tr class="row-odd"><td><p>200</p></td>
<td><p>156,4</p></td>
<td><p>162,7</p></td>
<td><p>168,3</p></td>
<td><p>174,8</p></td>
<td><p>186,2</p></td>
<td><p>199,3</p></td>
<td><p>213,1</p></td>
<td><p>226</p></td>
<td><p>234</p></td>
<td><p>241,1</p></td>
<td><p>249,4</p></td>
</tr>
<tr class="row-even"><td><p>300</p></td>
<td><p>246</p></td>
<td><p>253,9</p></td>
<td><p>260,9</p></td>
<td><p>269,1</p></td>
<td><p>283,1</p></td>
<td><p>299,3</p></td>
<td><p>316,1</p></td>
<td><p>331,8</p></td>
<td><p>341,4</p></td>
<td><p>349,9</p></td>
<td><p>359,9</p></td>
</tr>
<tr class="row-odd"><td><p>500</p></td>
<td><p>429,4</p></td>
<td><p>439,9</p></td>
<td><p>449,1</p></td>
<td><p>459,9</p></td>
<td><p>478,3</p></td>
<td><p>499,3</p></td>
<td><p>521</p></td>
<td><p>540,9</p></td>
<td><p>553,1</p></td>
<td><p>563,9</p></td>
<td><p>576,5</p></td>
</tr>
<tr class="row-even"><td><p>1000</p></td>
<td><p>898,9</p></td>
<td><p>914,3</p></td>
<td><p>927,6</p></td>
<td><p>943,1</p></td>
<td><p>969,5</p></td>
<td><p>999,3</p></td>
<td><p>1030</p></td>
<td><p>1058</p></td>
<td><p>1075</p></td>
<td><p>1090</p></td>
<td><p>1107</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="die-f-verteilung">
<h2>Die <span class="math notranslate nohighlight">\(F\)</span>-Verteilung<a class="headerlink" href="#die-f-verteilung" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<section id="quantilen-der-f-verteilung-alpha-5">
<h3>Quantilen der <span class="math notranslate nohighlight">\(F\)</span>-Verteilung (<span class="math notranslate nohighlight">\(\alpha=5 \%\)</span>)<a class="headerlink" href="#quantilen-der-f-verteilung-alpha-5" title="Permalink to this headline">#</a></h3>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>1</p></th>
<th class="head"><p>2</p></th>
<th class="head"><p>3</p></th>
<th class="head"><p>4</p></th>
<th class="head"><p>5</p></th>
<th class="head"><p>6</p></th>
<th class="head"><p>7</p></th>
<th class="head"><p>8</p></th>
<th class="head"><p>9</p></th>
<th class="head"><p>10</p></th>
<th class="head"><p>15</p></th>
<th class="head"><p>20</p></th>
<th class="head"><p>30</p></th>
<th class="head"><p>40</p></th>
<th class="head"><p>50</p></th>
<th class="head"><p>100</p></th>
<th class="head"><p>200</p></th>
<th class="head"><p>1e+09</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>161,4</p></td>
<td><p>199,5</p></td>
<td><p>215,7</p></td>
<td><p>224,6</p></td>
<td><p>230,2</p></td>
<td><p>234</p></td>
<td><p>236,8</p></td>
<td><p>238,9</p></td>
<td><p>240,5</p></td>
<td><p>241,9</p></td>
<td><p>245,9</p></td>
<td><p>248</p></td>
<td><p>250,1</p></td>
<td><p>251,1</p></td>
<td><p>251,8</p></td>
<td><p>253</p></td>
<td><p>253,7</p></td>
<td><p>254,3</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>18,51</p></td>
<td><p>19</p></td>
<td><p>19,16</p></td>
<td><p>19,25</p></td>
<td><p>19,3</p></td>
<td><p>19,33</p></td>
<td><p>19,35</p></td>
<td><p>19,37</p></td>
<td><p>19,38</p></td>
<td><p>19,4</p></td>
<td><p>19,43</p></td>
<td><p>19,45</p></td>
<td><p>19,46</p></td>
<td><p>19,47</p></td>
<td><p>19,48</p></td>
<td><p>19,49</p></td>
<td><p>19,49</p></td>
<td><p>19,5</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>10,13</p></td>
<td><p>9,55</p></td>
<td><p>9,28</p></td>
<td><p>9,12</p></td>
<td><p>9,01</p></td>
<td><p>8,94</p></td>
<td><p>8,89</p></td>
<td><p>8,85</p></td>
<td><p>8,81</p></td>
<td><p>8,79</p></td>
<td><p>8,7</p></td>
<td><p>8,66</p></td>
<td><p>8,62</p></td>
<td><p>8,59</p></td>
<td><p>8,58</p></td>
<td><p>8,55</p></td>
<td><p>8,54</p></td>
<td><p>8,53</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>7,71</p></td>
<td><p>6,94</p></td>
<td><p>6,59</p></td>
<td><p>6,39</p></td>
<td><p>6,26</p></td>
<td><p>6,16</p></td>
<td><p>6,09</p></td>
<td><p>6,04</p></td>
<td><p>6</p></td>
<td><p>5,96</p></td>
<td><p>5,86</p></td>
<td><p>5,8</p></td>
<td><p>5,75</p></td>
<td><p>5,72</p></td>
<td><p>5,7</p></td>
<td><p>5,66</p></td>
<td><p>5,65</p></td>
<td><p>5,63</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>6,61</p></td>
<td><p>5,79</p></td>
<td><p>5,41</p></td>
<td><p>5,19</p></td>
<td><p>5,05</p></td>
<td><p>4,95</p></td>
<td><p>4,88</p></td>
<td><p>4,82</p></td>
<td><p>4,77</p></td>
<td><p>4,74</p></td>
<td><p>4,62</p></td>
<td><p>4,56</p></td>
<td><p>4,5</p></td>
<td><p>4,46</p></td>
<td><p>4,44</p></td>
<td><p>4,41</p></td>
<td><p>4,39</p></td>
<td><p>4,36</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>5,99</p></td>
<td><p>5,14</p></td>
<td><p>4,76</p></td>
<td><p>4,53</p></td>
<td><p>4,39</p></td>
<td><p>4,28</p></td>
<td><p>4,21</p></td>
<td><p>4,15</p></td>
<td><p>4,1</p></td>
<td><p>4,06</p></td>
<td><p>3,94</p></td>
<td><p>3,87</p></td>
<td><p>3,81</p></td>
<td><p>3,77</p></td>
<td><p>3,75</p></td>
<td><p>3,71</p></td>
<td><p>3,69</p></td>
<td><p>3,67</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>5,59</p></td>
<td><p>4,74</p></td>
<td><p>4,35</p></td>
<td><p>4,12</p></td>
<td><p>3,97</p></td>
<td><p>3,87</p></td>
<td><p>3,79</p></td>
<td><p>3,73</p></td>
<td><p>3,68</p></td>
<td><p>3,64</p></td>
<td><p>3,51</p></td>
<td><p>3,44</p></td>
<td><p>3,38</p></td>
<td><p>3,34</p></td>
<td><p>3,32</p></td>
<td><p>3,27</p></td>
<td><p>3,25</p></td>
<td><p>3,23</p></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p>5,32</p></td>
<td><p>4,46</p></td>
<td><p>4,07</p></td>
<td><p>3,84</p></td>
<td><p>3,69</p></td>
<td><p>3,58</p></td>
<td><p>3,5</p></td>
<td><p>3,44</p></td>
<td><p>3,39</p></td>
<td><p>3,35</p></td>
<td><p>3,22</p></td>
<td><p>3,15</p></td>
<td><p>3,08</p></td>
<td><p>3,04</p></td>
<td><p>3,02</p></td>
<td><p>2,97</p></td>
<td><p>2,95</p></td>
<td><p>2,93</p></td>
</tr>
<tr class="row-even"><td><p>9</p></td>
<td><p>5,12</p></td>
<td><p>4,26</p></td>
<td><p>3,86</p></td>
<td><p>3,63</p></td>
<td><p>3,48</p></td>
<td><p>3,37</p></td>
<td><p>3,29</p></td>
<td><p>3,23</p></td>
<td><p>3,18</p></td>
<td><p>3,14</p></td>
<td><p>3,01</p></td>
<td><p>2,94</p></td>
<td><p>2,86</p></td>
<td><p>2,83</p></td>
<td><p>2,8</p></td>
<td><p>2,76</p></td>
<td><p>2,73</p></td>
<td><p>2,71</p></td>
</tr>
<tr class="row-odd"><td><p>10</p></td>
<td><p>4,96</p></td>
<td><p>4,1</p></td>
<td><p>3,71</p></td>
<td><p>3,48</p></td>
<td><p>3,33</p></td>
<td><p>3,22</p></td>
<td><p>3,14</p></td>
<td><p>3,07</p></td>
<td><p>3,02</p></td>
<td><p>2,98</p></td>
<td><p>2,85</p></td>
<td><p>2,77</p></td>
<td><p>2,7</p></td>
<td><p>2,66</p></td>
<td><p>2,64</p></td>
<td><p>2,59</p></td>
<td><p>2,56</p></td>
<td><p>2,54</p></td>
</tr>
<tr class="row-even"><td><p>11</p></td>
<td><p>4,84</p></td>
<td><p>3,98</p></td>
<td><p>3,59</p></td>
<td><p>3,36</p></td>
<td><p>3,2</p></td>
<td><p>3,09</p></td>
<td><p>3,01</p></td>
<td><p>2,95</p></td>
<td><p>2,9</p></td>
<td><p>2,85</p></td>
<td><p>2,72</p></td>
<td><p>2,65</p></td>
<td><p>2,57</p></td>
<td><p>2,53</p></td>
<td><p>2,51</p></td>
<td><p>2,46</p></td>
<td><p>2,43</p></td>
<td><p>2,4</p></td>
</tr>
<tr class="row-odd"><td><p>12</p></td>
<td><p>4,75</p></td>
<td><p>3,89</p></td>
<td><p>3,49</p></td>
<td><p>3,26</p></td>
<td><p>3,11</p></td>
<td><p>3</p></td>
<td><p>2,91</p></td>
<td><p>2,85</p></td>
<td><p>2,8</p></td>
<td><p>2,75</p></td>
<td><p>2,62</p></td>
<td><p>2,54</p></td>
<td><p>2,47</p></td>
<td><p>2,43</p></td>
<td><p>2,4</p></td>
<td><p>2,35</p></td>
<td><p>2,32</p></td>
<td><p>2,3</p></td>
</tr>
<tr class="row-even"><td><p>13</p></td>
<td><p>4,67</p></td>
<td><p>3,81</p></td>
<td><p>3,41</p></td>
<td><p>3,18</p></td>
<td><p>3,03</p></td>
<td><p>2,92</p></td>
<td><p>2,83</p></td>
<td><p>2,77</p></td>
<td><p>2,71</p></td>
<td><p>2,67</p></td>
<td><p>2,53</p></td>
<td><p>2,46</p></td>
<td><p>2,38</p></td>
<td><p>2,34</p></td>
<td><p>2,31</p></td>
<td><p>2,26</p></td>
<td><p>2,23</p></td>
<td><p>2,21</p></td>
</tr>
<tr class="row-odd"><td><p>14</p></td>
<td><p>4,6</p></td>
<td><p>3,74</p></td>
<td><p>3,34</p></td>
<td><p>3,11</p></td>
<td><p>2,96</p></td>
<td><p>2,85</p></td>
<td><p>2,76</p></td>
<td><p>2,7</p></td>
<td><p>2,65</p></td>
<td><p>2,6</p></td>
<td><p>2,46</p></td>
<td><p>2,39</p></td>
<td><p>2,31</p></td>
<td><p>2,27</p></td>
<td><p>2,24</p></td>
<td><p>2,19</p></td>
<td><p>2,16</p></td>
<td><p>2,13</p></td>
</tr>
<tr class="row-even"><td><p>15</p></td>
<td><p>4,54</p></td>
<td><p>3,68</p></td>
<td><p>3,29</p></td>
<td><p>3,06</p></td>
<td><p>2,9</p></td>
<td><p>2,79</p></td>
<td><p>2,71</p></td>
<td><p>2,64</p></td>
<td><p>2,59</p></td>
<td><p>2,54</p></td>
<td><p>2,4</p></td>
<td><p>2,33</p></td>
<td><p>2,25</p></td>
<td><p>2,2</p></td>
<td><p>2,18</p></td>
<td><p>2,12</p></td>
<td><p>2,1</p></td>
<td><p>2,07</p></td>
</tr>
<tr class="row-odd"><td><p>16</p></td>
<td><p>4,49</p></td>
<td><p>3,63</p></td>
<td><p>3,24</p></td>
<td><p>3,01</p></td>
<td><p>2,85</p></td>
<td><p>2,74</p></td>
<td><p>2,66</p></td>
<td><p>2,59</p></td>
<td><p>2,54</p></td>
<td><p>2,49</p></td>
<td><p>2,35</p></td>
<td><p>2,28</p></td>
<td><p>2,19</p></td>
<td><p>2,15</p></td>
<td><p>2,12</p></td>
<td><p>2,07</p></td>
<td><p>2,04</p></td>
<td><p>2,01</p></td>
</tr>
<tr class="row-even"><td><p>17</p></td>
<td><p>4,45</p></td>
<td><p>3,59</p></td>
<td><p>3,2</p></td>
<td><p>2,96</p></td>
<td><p>2,81</p></td>
<td><p>2,7</p></td>
<td><p>2,61</p></td>
<td><p>2,55</p></td>
<td><p>2,49</p></td>
<td><p>2,45</p></td>
<td><p>2,31</p></td>
<td><p>2,23</p></td>
<td><p>2,15</p></td>
<td><p>2,1</p></td>
<td><p>2,08</p></td>
<td><p>2,02</p></td>
<td><p>1,99</p></td>
<td><p>1,96</p></td>
</tr>
<tr class="row-odd"><td><p>18</p></td>
<td><p>4,41</p></td>
<td><p>3,55</p></td>
<td><p>3,16</p></td>
<td><p>2,93</p></td>
<td><p>2,77</p></td>
<td><p>2,66</p></td>
<td><p>2,58</p></td>
<td><p>2,51</p></td>
<td><p>2,46</p></td>
<td><p>2,41</p></td>
<td><p>2,27</p></td>
<td><p>2,19</p></td>
<td><p>2,11</p></td>
<td><p>2,06</p></td>
<td><p>2,04</p></td>
<td><p>1,98</p></td>
<td><p>1,95</p></td>
<td><p>1,92</p></td>
</tr>
<tr class="row-even"><td><p>19</p></td>
<td><p>4,38</p></td>
<td><p>3,52</p></td>
<td><p>3,13</p></td>
<td><p>2,9</p></td>
<td><p>2,74</p></td>
<td><p>2,63</p></td>
<td><p>2,54</p></td>
<td><p>2,48</p></td>
<td><p>2,42</p></td>
<td><p>2,38</p></td>
<td><p>2,23</p></td>
<td><p>2,16</p></td>
<td><p>2,07</p></td>
<td><p>2,03</p></td>
<td><p>2</p></td>
<td><p>1,94</p></td>
<td><p>1,91</p></td>
<td><p>1,88</p></td>
</tr>
<tr class="row-odd"><td><p>20</p></td>
<td><p>4,35</p></td>
<td><p>3,49</p></td>
<td><p>3,1</p></td>
<td><p>2,87</p></td>
<td><p>2,71</p></td>
<td><p>2,6</p></td>
<td><p>2,51</p></td>
<td><p>2,45</p></td>
<td><p>2,39</p></td>
<td><p>2,35</p></td>
<td><p>2,2</p></td>
<td><p>2,12</p></td>
<td><p>2,04</p></td>
<td><p>1,99</p></td>
<td><p>1,97</p></td>
<td><p>1,91</p></td>
<td><p>1,88</p></td>
<td><p>1,84</p></td>
</tr>
<tr class="row-even"><td><p>22</p></td>
<td><p>4,3</p></td>
<td><p>3,44</p></td>
<td><p>3,05</p></td>
<td><p>2,82</p></td>
<td><p>2,66</p></td>
<td><p>2,55</p></td>
<td><p>2,46</p></td>
<td><p>2,4</p></td>
<td><p>2,34</p></td>
<td><p>2,3</p></td>
<td><p>2,15</p></td>
<td><p>2,07</p></td>
<td><p>1,98</p></td>
<td><p>1,94</p></td>
<td><p>1,91</p></td>
<td><p>1,85</p></td>
<td><p>1,82</p></td>
<td><p>1,78</p></td>
</tr>
<tr class="row-odd"><td><p>24</p></td>
<td><p>4,26</p></td>
<td><p>3,4</p></td>
<td><p>3,01</p></td>
<td><p>2,78</p></td>
<td><p>2,62</p></td>
<td><p>2,51</p></td>
<td><p>2,42</p></td>
<td><p>2,36</p></td>
<td><p>2,3</p></td>
<td><p>2,25</p></td>
<td><p>2,11</p></td>
<td><p>2,03</p></td>
<td><p>1,94</p></td>
<td><p>1,89</p></td>
<td><p>1,86</p></td>
<td><p>1,8</p></td>
<td><p>1,77</p></td>
<td><p>1,73</p></td>
</tr>
<tr class="row-even"><td><p>26</p></td>
<td><p>4,23</p></td>
<td><p>3,37</p></td>
<td><p>2,98</p></td>
<td><p>2,74</p></td>
<td><p>2,59</p></td>
<td><p>2,47</p></td>
<td><p>2,39</p></td>
<td><p>2,32</p></td>
<td><p>2,27</p></td>
<td><p>2,22</p></td>
<td><p>2,07</p></td>
<td><p>1,99</p></td>
<td><p>1,9</p></td>
<td><p>1,85</p></td>
<td><p>1,82</p></td>
<td><p>1,76</p></td>
<td><p>1,73</p></td>
<td><p>1,69</p></td>
</tr>
<tr class="row-odd"><td><p>28</p></td>
<td><p>4,2</p></td>
<td><p>3,34</p></td>
<td><p>2,95</p></td>
<td><p>2,71</p></td>
<td><p>2,56</p></td>
<td><p>2,45</p></td>
<td><p>2,36</p></td>
<td><p>2,29</p></td>
<td><p>2,24</p></td>
<td><p>2,19</p></td>
<td><p>2,04</p></td>
<td><p>1,96</p></td>
<td><p>1,87</p></td>
<td><p>1,82</p></td>
<td><p>1,79</p></td>
<td><p>1,73</p></td>
<td><p>1,69</p></td>
<td><p>1,65</p></td>
</tr>
<tr class="row-even"><td><p>30</p></td>
<td><p>4,17</p></td>
<td><p>3,32</p></td>
<td><p>2,92</p></td>
<td><p>2,69</p></td>
<td><p>2,53</p></td>
<td><p>2,42</p></td>
<td><p>2,33</p></td>
<td><p>2,27</p></td>
<td><p>2,21</p></td>
<td><p>2,16</p></td>
<td><p>2,01</p></td>
<td><p>1,93</p></td>
<td><p>1,84</p></td>
<td><p>1,79</p></td>
<td><p>1,76</p></td>
<td><p>1,7</p></td>
<td><p>1,66</p></td>
<td><p>1,62</p></td>
</tr>
<tr class="row-odd"><td><p>35</p></td>
<td><p>4,12</p></td>
<td><p>3,27</p></td>
<td><p>2,87</p></td>
<td><p>2,64</p></td>
<td><p>2,49</p></td>
<td><p>2,37</p></td>
<td><p>2,29</p></td>
<td><p>2,22</p></td>
<td><p>2,16</p></td>
<td><p>2,11</p></td>
<td><p>1,96</p></td>
<td><p>1,88</p></td>
<td><p>1,79</p></td>
<td><p>1,74</p></td>
<td><p>1,7</p></td>
<td><p>1,63</p></td>
<td><p>1,6</p></td>
<td><p>1,56</p></td>
</tr>
<tr class="row-even"><td><p>40</p></td>
<td><p>4,08</p></td>
<td><p>3,23</p></td>
<td><p>2,84</p></td>
<td><p>2,61</p></td>
<td><p>2,45</p></td>
<td><p>2,34</p></td>
<td><p>2,25</p></td>
<td><p>2,18</p></td>
<td><p>2,12</p></td>
<td><p>2,08</p></td>
<td><p>1,92</p></td>
<td><p>1,84</p></td>
<td><p>1,74</p></td>
<td><p>1,69</p></td>
<td><p>1,66</p></td>
<td><p>1,59</p></td>
<td><p>1,55</p></td>
<td><p>1,51</p></td>
</tr>
<tr class="row-odd"><td><p>50</p></td>
<td><p>4,03</p></td>
<td><p>3,18</p></td>
<td><p>2,79</p></td>
<td><p>2,56</p></td>
<td><p>2,4</p></td>
<td><p>2,29</p></td>
<td><p>2,2</p></td>
<td><p>2,13</p></td>
<td><p>2,07</p></td>
<td><p>2,03</p></td>
<td><p>1,87</p></td>
<td><p>1,78</p></td>
<td><p>1,69</p></td>
<td><p>1,63</p></td>
<td><p>1,6</p></td>
<td><p>1,52</p></td>
<td><p>1,48</p></td>
<td><p>1,44</p></td>
</tr>
<tr class="row-even"><td><p>70</p></td>
<td><p>3,98</p></td>
<td><p>3,13</p></td>
<td><p>2,74</p></td>
<td><p>2,5</p></td>
<td><p>2,35</p></td>
<td><p>2,23</p></td>
<td><p>2,14</p></td>
<td><p>2,07</p></td>
<td><p>2,02</p></td>
<td><p>1,97</p></td>
<td><p>1,81</p></td>
<td><p>1,72</p></td>
<td><p>1,62</p></td>
<td><p>1,57</p></td>
<td><p>1,53</p></td>
<td><p>1,45</p></td>
<td><p>1,4</p></td>
<td><p>1,35</p></td>
</tr>
<tr class="row-odd"><td><p>100</p></td>
<td><p>3,94</p></td>
<td><p>3,09</p></td>
<td><p>2,7</p></td>
<td><p>2,46</p></td>
<td><p>2,31</p></td>
<td><p>2,19</p></td>
<td><p>2,1</p></td>
<td><p>2,03</p></td>
<td><p>1,97</p></td>
<td><p>1,93</p></td>
<td><p>1,77</p></td>
<td><p>1,68</p></td>
<td><p>1,57</p></td>
<td><p>1,52</p></td>
<td><p>1,48</p></td>
<td><p>1,39</p></td>
<td><p>1,34</p></td>
<td><p>1,28</p></td>
</tr>
<tr class="row-even"><td><p>200</p></td>
<td><p>3,89</p></td>
<td><p>3,04</p></td>
<td><p>2,65</p></td>
<td><p>2,42</p></td>
<td><p>2,26</p></td>
<td><p>2,14</p></td>
<td><p>2,06</p></td>
<td><p>1,98</p></td>
<td><p>1,93</p></td>
<td><p>1,88</p></td>
<td><p>1,72</p></td>
<td><p>1,62</p></td>
<td><p>1,52</p></td>
<td><p>1,46</p></td>
<td><p>1,41</p></td>
<td><p>1,32</p></td>
<td><p>1,26</p></td>
<td><p>1,19</p></td>
</tr>
<tr class="row-odd"><td><p>1000</p></td>
<td><p>3,85</p></td>
<td><p>3</p></td>
<td><p>2,61</p></td>
<td><p>2,38</p></td>
<td><p>2,22</p></td>
<td><p>2,11</p></td>
<td><p>2,02</p></td>
<td><p>1,95</p></td>
<td><p>1,89</p></td>
<td><p>1,84</p></td>
<td><p>1,68</p></td>
<td><p>1,58</p></td>
<td><p>1,47</p></td>
<td><p>1,41</p></td>
<td><p>1,36</p></td>
<td><p>1,26</p></td>
<td><p>1,19</p></td>
<td><p>1,08</p></td>
</tr>
<tr class="row-even"><td><p>1e+09</p></td>
<td><p>3,84</p></td>
<td><p>3</p></td>
<td><p>2,6</p></td>
<td><p>2,37</p></td>
<td><p>2,21</p></td>
<td><p>2,1</p></td>
<td><p>2,01</p></td>
<td><p>1,94</p></td>
<td><p>1,88</p></td>
<td><p>1,83</p></td>
<td><p>1,67</p></td>
<td><p>1,57</p></td>
<td><p>1,46</p></td>
<td><p>1,39</p></td>
<td><p>1,35</p></td>
<td><p>1,24</p></td>
<td><p>1,17</p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
</section>
<section id="quantilen-der-f-verteilung-alpha-1">
<h3>Quantilen der <span class="math notranslate nohighlight">\(F\)</span>-Verteilung (<span class="math notranslate nohighlight">\(\alpha=1\%\)</span>)<a class="headerlink" href="#quantilen-der-f-verteilung-alpha-1" title="Permalink to this headline">#</a></h3>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>1</p></th>
<th class="head"><p>2</p></th>
<th class="head"><p>3</p></th>
<th class="head"><p>4</p></th>
<th class="head"><p>5</p></th>
<th class="head"><p>6</p></th>
<th class="head"><p>7</p></th>
<th class="head"><p>8</p></th>
<th class="head"><p>9</p></th>
<th class="head"><p>10</p></th>
<th class="head"><p>15</p></th>
<th class="head"><p>20</p></th>
<th class="head"><p>30</p></th>
<th class="head"><p>40</p></th>
<th class="head"><p>50</p></th>
<th class="head"><p>100</p></th>
<th class="head"><p>200</p></th>
<th class="head"><p>1e+09</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>4052</p></td>
<td><p>5000</p></td>
<td><p>5403</p></td>
<td><p>5625</p></td>
<td><p>5764</p></td>
<td><p>5859</p></td>
<td><p>5928</p></td>
<td><p>5981</p></td>
<td><p>6022</p></td>
<td><p>6056</p></td>
<td><p>6157</p></td>
<td><p>6209</p></td>
<td><p>6261</p></td>
<td><p>6287</p></td>
<td><p>6303</p></td>
<td><p>6334</p></td>
<td><p>6350</p></td>
<td><p>6366</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>98,5</p></td>
<td><p>99</p></td>
<td><p>99,17</p></td>
<td><p>99,25</p></td>
<td><p>99,3</p></td>
<td><p>99,33</p></td>
<td><p>99,36</p></td>
<td><p>99,37</p></td>
<td><p>99,39</p></td>
<td><p>99,4</p></td>
<td><p>99,43</p></td>
<td><p>99,45</p></td>
<td><p>99,47</p></td>
<td><p>99,47</p></td>
<td><p>99,48</p></td>
<td><p>99,49</p></td>
<td><p>99,49</p></td>
<td><p>99,5</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>34,12</p></td>
<td><p>30,82</p></td>
<td><p>29,46</p></td>
<td><p>28,71</p></td>
<td><p>28,24</p></td>
<td><p>27,91</p></td>
<td><p>27,67</p></td>
<td><p>27,49</p></td>
<td><p>27,35</p></td>
<td><p>27,23</p></td>
<td><p>26,87</p></td>
<td><p>26,69</p></td>
<td><p>26,5</p></td>
<td><p>26,41</p></td>
<td><p>26,35</p></td>
<td><p>26,24</p></td>
<td><p>26,18</p></td>
<td><p>26,13</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>21,2</p></td>
<td><p>18</p></td>
<td><p>16,69</p></td>
<td><p>15,98</p></td>
<td><p>15,52</p></td>
<td><p>15,21</p></td>
<td><p>14,98</p></td>
<td><p>14,8</p></td>
<td><p>14,66</p></td>
<td><p>14,55</p></td>
<td><p>14,2</p></td>
<td><p>14,02</p></td>
<td><p>13,84</p></td>
<td><p>13,75</p></td>
<td><p>13,69</p></td>
<td><p>13,58</p></td>
<td><p>13,52</p></td>
<td><p>13,46</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>16,26</p></td>
<td><p>13,27</p></td>
<td><p>12,06</p></td>
<td><p>11,39</p></td>
<td><p>10,97</p></td>
<td><p>10,67</p></td>
<td><p>10,46</p></td>
<td><p>10,29</p></td>
<td><p>10,16</p></td>
<td><p>10,05</p></td>
<td><p>9,72</p></td>
<td><p>9,55</p></td>
<td><p>9,38</p></td>
<td><p>9,29</p></td>
<td><p>9,24</p></td>
<td><p>9,13</p></td>
<td><p>9,08</p></td>
<td><p>9,02</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>13,75</p></td>
<td><p>10,92</p></td>
<td><p>9,78</p></td>
<td><p>9,15</p></td>
<td><p>8,75</p></td>
<td><p>8,47</p></td>
<td><p>8,26</p></td>
<td><p>8,1</p></td>
<td><p>7,98</p></td>
<td><p>7,87</p></td>
<td><p>7,56</p></td>
<td><p>7,4</p></td>
<td><p>7,23</p></td>
<td><p>7,14</p></td>
<td><p>7,09</p></td>
<td><p>6,99</p></td>
<td><p>6,93</p></td>
<td><p>6,88</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>12,25</p></td>
<td><p>9,55</p></td>
<td><p>8,45</p></td>
<td><p>7,85</p></td>
<td><p>7,46</p></td>
<td><p>7,19</p></td>
<td><p>6,99</p></td>
<td><p>6,84</p></td>
<td><p>6,72</p></td>
<td><p>6,62</p></td>
<td><p>6,31</p></td>
<td><p>6,16</p></td>
<td><p>5,99</p></td>
<td><p>5,91</p></td>
<td><p>5,86</p></td>
<td><p>5,75</p></td>
<td><p>5,7</p></td>
<td><p>5,65</p></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p>11,26</p></td>
<td><p>8,65</p></td>
<td><p>7,59</p></td>
<td><p>7,01</p></td>
<td><p>6,63</p></td>
<td><p>6,37</p></td>
<td><p>6,18</p></td>
<td><p>6,03</p></td>
<td><p>5,91</p></td>
<td><p>5,81</p></td>
<td><p>5,52</p></td>
<td><p>5,36</p></td>
<td><p>5,2</p></td>
<td><p>5,12</p></td>
<td><p>5,07</p></td>
<td><p>4,96</p></td>
<td><p>4,91</p></td>
<td><p>4,86</p></td>
</tr>
<tr class="row-even"><td><p>9</p></td>
<td><p>10,56</p></td>
<td><p>8,02</p></td>
<td><p>6,99</p></td>
<td><p>6,42</p></td>
<td><p>6,06</p></td>
<td><p>5,8</p></td>
<td><p>5,61</p></td>
<td><p>5,47</p></td>
<td><p>5,35</p></td>
<td><p>5,26</p></td>
<td><p>4,96</p></td>
<td><p>4,81</p></td>
<td><p>4,65</p></td>
<td><p>4,57</p></td>
<td><p>4,52</p></td>
<td><p>4,41</p></td>
<td><p>4,36</p></td>
<td><p>4,31</p></td>
</tr>
<tr class="row-odd"><td><p>10</p></td>
<td><p>10,04</p></td>
<td><p>7,56</p></td>
<td><p>6,55</p></td>
<td><p>5,99</p></td>
<td><p>5,64</p></td>
<td><p>5,39</p></td>
<td><p>5,2</p></td>
<td><p>5,06</p></td>
<td><p>4,94</p></td>
<td><p>4,85</p></td>
<td><p>4,56</p></td>
<td><p>4,41</p></td>
<td><p>4,25</p></td>
<td><p>4,17</p></td>
<td><p>4,12</p></td>
<td><p>4,01</p></td>
<td><p>3,96</p></td>
<td><p>3,91</p></td>
</tr>
<tr class="row-even"><td><p>11</p></td>
<td><p>9,65</p></td>
<td><p>7,21</p></td>
<td><p>6,22</p></td>
<td><p>5,67</p></td>
<td><p>5,32</p></td>
<td><p>5,07</p></td>
<td><p>4,89</p></td>
<td><p>4,74</p></td>
<td><p>4,63</p></td>
<td><p>4,54</p></td>
<td><p>4,25</p></td>
<td><p>4,1</p></td>
<td><p>3,94</p></td>
<td><p>3,86</p></td>
<td><p>3,81</p></td>
<td><p>3,71</p></td>
<td><p>3,66</p></td>
<td><p>3,6</p></td>
</tr>
<tr class="row-odd"><td><p>12</p></td>
<td><p>9,33</p></td>
<td><p>6,93</p></td>
<td><p>5,95</p></td>
<td><p>5,41</p></td>
<td><p>5,06</p></td>
<td><p>4,82</p></td>
<td><p>4,64</p></td>
<td><p>4,5</p></td>
<td><p>4,39</p></td>
<td><p>4,3</p></td>
<td><p>4,01</p></td>
<td><p>3,86</p></td>
<td><p>3,7</p></td>
<td><p>3,62</p></td>
<td><p>3,57</p></td>
<td><p>3,47</p></td>
<td><p>3,41</p></td>
<td><p>3,36</p></td>
</tr>
<tr class="row-even"><td><p>13</p></td>
<td><p>9,07</p></td>
<td><p>6,7</p></td>
<td><p>5,74</p></td>
<td><p>5,21</p></td>
<td><p>4,86</p></td>
<td><p>4,62</p></td>
<td><p>4,44</p></td>
<td><p>4,3</p></td>
<td><p>4,19</p></td>
<td><p>4,1</p></td>
<td><p>3,82</p></td>
<td><p>3,66</p></td>
<td><p>3,51</p></td>
<td><p>3,43</p></td>
<td><p>3,38</p></td>
<td><p>3,27</p></td>
<td><p>3,22</p></td>
<td><p>3,17</p></td>
</tr>
<tr class="row-odd"><td><p>14</p></td>
<td><p>8,86</p></td>
<td><p>6,51</p></td>
<td><p>5,56</p></td>
<td><p>5,04</p></td>
<td><p>4,69</p></td>
<td><p>4,46</p></td>
<td><p>4,28</p></td>
<td><p>4,14</p></td>
<td><p>4,03</p></td>
<td><p>3,94</p></td>
<td><p>3,66</p></td>
<td><p>3,51</p></td>
<td><p>3,35</p></td>
<td><p>3,27</p></td>
<td><p>3,22</p></td>
<td><p>3,11</p></td>
<td><p>3,06</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-even"><td><p>15</p></td>
<td><p>8,68</p></td>
<td><p>6,36</p></td>
<td><p>5,42</p></td>
<td><p>4,89</p></td>
<td><p>4,56</p></td>
<td><p>4,32</p></td>
<td><p>4,14</p></td>
<td><p>4</p></td>
<td><p>3,89</p></td>
<td><p>3,8</p></td>
<td><p>3,52</p></td>
<td><p>3,37</p></td>
<td><p>3,21</p></td>
<td><p>3,13</p></td>
<td><p>3,08</p></td>
<td><p>2,98</p></td>
<td><p>2,92</p></td>
<td><p>2,87</p></td>
</tr>
<tr class="row-odd"><td><p>16</p></td>
<td><p>8,53</p></td>
<td><p>6,23</p></td>
<td><p>5,29</p></td>
<td><p>4,77</p></td>
<td><p>4,44</p></td>
<td><p>4,2</p></td>
<td><p>4,03</p></td>
<td><p>3,89</p></td>
<td><p>3,78</p></td>
<td><p>3,69</p></td>
<td><p>3,41</p></td>
<td><p>3,26</p></td>
<td><p>3,1</p></td>
<td><p>3,02</p></td>
<td><p>2,97</p></td>
<td><p>2,86</p></td>
<td><p>2,81</p></td>
<td><p>2,75</p></td>
</tr>
<tr class="row-even"><td><p>17</p></td>
<td><p>8,4</p></td>
<td><p>6,11</p></td>
<td><p>5,18</p></td>
<td><p>4,67</p></td>
<td><p>4,34</p></td>
<td><p>4,1</p></td>
<td><p>3,93</p></td>
<td><p>3,79</p></td>
<td><p>3,68</p></td>
<td><p>3,59</p></td>
<td><p>3,31</p></td>
<td><p>3,16</p></td>
<td><p>3</p></td>
<td><p>2,92</p></td>
<td><p>2,87</p></td>
<td><p>2,76</p></td>
<td><p>2,71</p></td>
<td><p>2,65</p></td>
</tr>
<tr class="row-odd"><td><p>18</p></td>
<td><p>8,29</p></td>
<td><p>6,01</p></td>
<td><p>5,09</p></td>
<td><p>4,58</p></td>
<td><p>4,25</p></td>
<td><p>4,01</p></td>
<td><p>3,84</p></td>
<td><p>3,71</p></td>
<td><p>3,6</p></td>
<td><p>3,51</p></td>
<td><p>3,23</p></td>
<td><p>3,08</p></td>
<td><p>2,92</p></td>
<td><p>2,84</p></td>
<td><p>2,78</p></td>
<td><p>2,68</p></td>
<td><p>2,62</p></td>
<td><p>2,57</p></td>
</tr>
<tr class="row-even"><td><p>19</p></td>
<td><p>8,18</p></td>
<td><p>5,93</p></td>
<td><p>5,01</p></td>
<td><p>4,5</p></td>
<td><p>4,17</p></td>
<td><p>3,94</p></td>
<td><p>3,77</p></td>
<td><p>3,63</p></td>
<td><p>3,52</p></td>
<td><p>3,43</p></td>
<td><p>3,15</p></td>
<td><p>3</p></td>
<td><p>2,84</p></td>
<td><p>2,76</p></td>
<td><p>2,71</p></td>
<td><p>2,6</p></td>
<td><p>2,55</p></td>
<td><p>2,49</p></td>
</tr>
<tr class="row-odd"><td><p>20</p></td>
<td><p>8,1</p></td>
<td><p>5,85</p></td>
<td><p>4,94</p></td>
<td><p>4,43</p></td>
<td><p>4,1</p></td>
<td><p>3,87</p></td>
<td><p>3,7</p></td>
<td><p>3,56</p></td>
<td><p>3,46</p></td>
<td><p>3,37</p></td>
<td><p>3,09</p></td>
<td><p>2,94</p></td>
<td><p>2,78</p></td>
<td><p>2,69</p></td>
<td><p>2,64</p></td>
<td><p>2,54</p></td>
<td><p>2,48</p></td>
<td><p>2,42</p></td>
</tr>
<tr class="row-even"><td><p>22</p></td>
<td><p>7,95</p></td>
<td><p>5,72</p></td>
<td><p>4,82</p></td>
<td><p>4,31</p></td>
<td><p>3,99</p></td>
<td><p>3,76</p></td>
<td><p>3,59</p></td>
<td><p>3,45</p></td>
<td><p>3,35</p></td>
<td><p>3,26</p></td>
<td><p>2,98</p></td>
<td><p>2,83</p></td>
<td><p>2,67</p></td>
<td><p>2,58</p></td>
<td><p>2,53</p></td>
<td><p>2,42</p></td>
<td><p>2,36</p></td>
<td><p>2,31</p></td>
</tr>
<tr class="row-odd"><td><p>24</p></td>
<td><p>7,82</p></td>
<td><p>5,61</p></td>
<td><p>4,72</p></td>
<td><p>4,22</p></td>
<td><p>3,9</p></td>
<td><p>3,67</p></td>
<td><p>3,5</p></td>
<td><p>3,36</p></td>
<td><p>3,26</p></td>
<td><p>3,17</p></td>
<td><p>2,89</p></td>
<td><p>2,74</p></td>
<td><p>2,58</p></td>
<td><p>2,49</p></td>
<td><p>2,44</p></td>
<td><p>2,33</p></td>
<td><p>2,27</p></td>
<td><p>2,21</p></td>
</tr>
<tr class="row-even"><td><p>26</p></td>
<td><p>7,72</p></td>
<td><p>5,53</p></td>
<td><p>4,64</p></td>
<td><p>4,14</p></td>
<td><p>3,82</p></td>
<td><p>3,59</p></td>
<td><p>3,42</p></td>
<td><p>3,29</p></td>
<td><p>3,18</p></td>
<td><p>3,09</p></td>
<td><p>2,81</p></td>
<td><p>2,66</p></td>
<td><p>2,5</p></td>
<td><p>2,42</p></td>
<td><p>2,36</p></td>
<td><p>2,25</p></td>
<td><p>2,19</p></td>
<td><p>2,13</p></td>
</tr>
<tr class="row-odd"><td><p>28</p></td>
<td><p>7,64</p></td>
<td><p>5,45</p></td>
<td><p>4,57</p></td>
<td><p>4,07</p></td>
<td><p>3,75</p></td>
<td><p>3,53</p></td>
<td><p>3,36</p></td>
<td><p>3,23</p></td>
<td><p>3,12</p></td>
<td><p>3,03</p></td>
<td><p>2,75</p></td>
<td><p>2,6</p></td>
<td><p>2,44</p></td>
<td><p>2,35</p></td>
<td><p>2,3</p></td>
<td><p>2,19</p></td>
<td><p>2,13</p></td>
<td><p>2,06</p></td>
</tr>
<tr class="row-even"><td><p>30</p></td>
<td><p>7,56</p></td>
<td><p>5,39</p></td>
<td><p>4,51</p></td>
<td><p>4,02</p></td>
<td><p>3,7</p></td>
<td><p>3,47</p></td>
<td><p>3,3</p></td>
<td><p>3,17</p></td>
<td><p>3,07</p></td>
<td><p>2,98</p></td>
<td><p>2,7</p></td>
<td><p>2,55</p></td>
<td><p>2,39</p></td>
<td><p>2,3</p></td>
<td><p>2,25</p></td>
<td><p>2,13</p></td>
<td><p>2,07</p></td>
<td><p>2,01</p></td>
</tr>
<tr class="row-odd"><td><p>35</p></td>
<td><p>7,42</p></td>
<td><p>5,27</p></td>
<td><p>4,4</p></td>
<td><p>3,91</p></td>
<td><p>3,59</p></td>
<td><p>3,37</p></td>
<td><p>3,2</p></td>
<td><p>3,07</p></td>
<td><p>2,96</p></td>
<td><p>2,88</p></td>
<td><p>2,6</p></td>
<td><p>2,44</p></td>
<td><p>2,28</p></td>
<td><p>2,19</p></td>
<td><p>2,14</p></td>
<td><p>2,02</p></td>
<td><p>1,96</p></td>
<td><p>1,89</p></td>
</tr>
<tr class="row-even"><td><p>40</p></td>
<td><p>7,31</p></td>
<td><p>5,18</p></td>
<td><p>4,31</p></td>
<td><p>3,83</p></td>
<td><p>3,51</p></td>
<td><p>3,29</p></td>
<td><p>3,12</p></td>
<td><p>2,99</p></td>
<td><p>2,89</p></td>
<td><p>2,8</p></td>
<td><p>2,52</p></td>
<td><p>2,37</p></td>
<td><p>2,2</p></td>
<td><p>2,11</p></td>
<td><p>2,06</p></td>
<td><p>1,94</p></td>
<td><p>1,87</p></td>
<td><p>1,8</p></td>
</tr>
<tr class="row-odd"><td><p>50</p></td>
<td><p>7,17</p></td>
<td><p>5,06</p></td>
<td><p>4,2</p></td>
<td><p>3,72</p></td>
<td><p>3,41</p></td>
<td><p>3,19</p></td>
<td><p>3,02</p></td>
<td><p>2,89</p></td>
<td><p>2,78</p></td>
<td><p>2,7</p></td>
<td><p>2,42</p></td>
<td><p>2,27</p></td>
<td><p>2,1</p></td>
<td><p>2,01</p></td>
<td><p>1,95</p></td>
<td><p>1,82</p></td>
<td><p>1,76</p></td>
<td><p>1,68</p></td>
</tr>
<tr class="row-even"><td><p>70</p></td>
<td><p>7,01</p></td>
<td><p>4,92</p></td>
<td><p>4,07</p></td>
<td><p>3,6</p></td>
<td><p>3,29</p></td>
<td><p>3,07</p></td>
<td><p>2,91</p></td>
<td><p>2,78</p></td>
<td><p>2,67</p></td>
<td><p>2,59</p></td>
<td><p>2,31</p></td>
<td><p>2,15</p></td>
<td><p>1,98</p></td>
<td><p>1,89</p></td>
<td><p>1,83</p></td>
<td><p>1,7</p></td>
<td><p>1,62</p></td>
<td><p>1,54</p></td>
</tr>
<tr class="row-odd"><td><p>100</p></td>
<td><p>6,9</p></td>
<td><p>4,82</p></td>
<td><p>3,98</p></td>
<td><p>3,51</p></td>
<td><p>3,21</p></td>
<td><p>2,99</p></td>
<td><p>2,82</p></td>
<td><p>2,69</p></td>
<td><p>2,59</p></td>
<td><p>2,5</p></td>
<td><p>2,22</p></td>
<td><p>2,07</p></td>
<td><p>1,89</p></td>
<td><p>1,8</p></td>
<td><p>1,74</p></td>
<td><p>1,6</p></td>
<td><p>1,52</p></td>
<td><p>1,43</p></td>
</tr>
<tr class="row-even"><td><p>200</p></td>
<td><p>6,76</p></td>
<td><p>4,71</p></td>
<td><p>3,88</p></td>
<td><p>3,41</p></td>
<td><p>3,11</p></td>
<td><p>2,89</p></td>
<td><p>2,73</p></td>
<td><p>2,6</p></td>
<td><p>2,5</p></td>
<td><p>2,41</p></td>
<td><p>2,13</p></td>
<td><p>1,97</p></td>
<td><p>1,79</p></td>
<td><p>1,69</p></td>
<td><p>1,63</p></td>
<td><p>1,48</p></td>
<td><p>1,39</p></td>
<td><p>1,28</p></td>
</tr>
<tr class="row-odd"><td><p>1000</p></td>
<td><p>6,66</p></td>
<td><p>4,63</p></td>
<td><p>3,8</p></td>
<td><p>3,34</p></td>
<td><p>3,04</p></td>
<td><p>2,82</p></td>
<td><p>2,66</p></td>
<td><p>2,53</p></td>
<td><p>2,43</p></td>
<td><p>2,34</p></td>
<td><p>2,06</p></td>
<td><p>1,9</p></td>
<td><p>1,72</p></td>
<td><p>1,61</p></td>
<td><p>1,54</p></td>
<td><p>1,38</p></td>
<td><p>1,28</p></td>
<td><p>1,11</p></td>
</tr>
<tr class="row-even"><td><p>1e+09</p></td>
<td><p>6,63</p></td>
<td><p>4,61</p></td>
<td><p>3,78</p></td>
<td><p>3,32</p></td>
<td><p>3,02</p></td>
<td><p>2,8</p></td>
<td><p>2,64</p></td>
<td><p>2,51</p></td>
<td><p>2,41</p></td>
<td><p>2,32</p></td>
<td><p>2,04</p></td>
<td><p>1,88</p></td>
<td><p>1,7</p></td>
<td><p>1,59</p></td>
<td><p>1,52</p></td>
<td><p>1,36</p></td>
<td><p>1,25</p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<span id="document-Aufgaben/Kapitel06/Aufgaben"></span><section class="tex2jax_ignore mathjax_ignore" id="ubungsaufgaben">
<h2>Übungsaufgaben<a class="headerlink" href="#ubungsaufgaben" title="Permalink to this headline">#</a></h2>
<div class="toctree-wrapper compound">
<span id="document-Aufgaben/Kapitel06/Fehler_1ter_2ter_Art"></span><section class="tex2jax_ignore mathjax_ignore" id="fehler-1-ter-und-2-ter-art">
<h3>Fehler <span class="math notranslate nohighlight">\(1\)</span>-ter und <span class="math notranslate nohighlight">\(2\)</span>-ter Art<a class="headerlink" href="#fehler-1-ter-und-2-ter-art" title="Permalink to this headline">#</a></h3>
<ol class="simple">
<li><p>Erklären Sie was man unter Fehler <span class="math notranslate nohighlight">\(1\)</span>-ter und <span class="math notranslate nohighlight">\(2\)</span>-ter Art versteht.</p></li>
<li><p>Warum kann man <span class="math notranslate nohighlight">\(\alpha\)</span> nicht beliebig genau wählen?</p></li>
<li><p>Eine Maschine produziert im Schnitt <span class="math notranslate nohighlight">\(2 \%\)</span> Ausschuss. Unter <span class="math notranslate nohighlight">\(100\)</span> Stück finden sich <span class="math notranslate nohighlight">\(5\)</span> Defekte. Die Nullhypothese ist das die Maschine <span class="math notranslate nohighlight">\(2 \%\)</span> Ausschuss hat. Berechnen Sie Wahrscheinlichkeit des <span class="math notranslate nohighlight">\(\alpha\)</span>-Fehlers (also bei <span class="math notranslate nohighlight">\(5\)</span> Stück oder mehr Ausfällen fälschlicherweise die Nullhypothese abzulehnen) unter Annahme von binomialverteilten Abweichungen.</p></li>
</ol>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 3 ...</span>
</pre></div>
</div>
</div>
</div>
<section id="losungen">
<h4>Lösungen<a class="headerlink" href="#losungen" title="Permalink to this headline">#</a></h4>
<div class="toggle docutils container">
<p>Der Fehler <span class="math notranslate nohighlight">\(1\)</span>-ter Art, der auch <span class="math notranslate nohighlight">\(\alpha\)</span>-Fehler oder <span class="math notranslate nohighlight">\(\alpha\)</span> Signifikanzniveau genannt wird, kann als Wahrscheinlichkeit interpretiert werden die Nullhypothese <span class="math notranslate nohighlight">\(H_0\)</span> fälschlicherweise abzulehnen. Meist wird bei Hypothesentests ein Signifikanzniveau von <span class="math notranslate nohighlight">\(\alpha = 0,05\)</span> oder <span class="math notranslate nohighlight">\(\alpha = 0,01\)</span> gewählt.</p>
<p>Der Fehler <span class="math notranslate nohighlight">\(2\)</span>-ter Art oder <span class="math notranslate nohighlight">\(\beta\)</span>-Fehler wird begangen, wenn die Alternativhypothese <span class="math notranslate nohighlight">\(H_0\)</span> fälschlicherweise abgelehnt wird.</p>
</div>
<div class="toggle docutils container">
<p>Der <span class="math notranslate nohighlight">\(\alpha\)</span>-Fehler kann nicht beliebig genau gewählt werden, weil die Wahrscheinlichkeit einen Fehler <span class="math notranslate nohighlight">\(2\)</span>-ter Art zu begehen damit zunimmt. Für die meisten Experimente ist <span class="math notranslate nohighlight">\(\alpha = 0,05\)</span> ein geeigneter Wert um Fehler der <span class="math notranslate nohighlight">\(1\)</span>-ten und <span class="math notranslate nohighlight">\(2\)</span>-ten Art zu minimieren.</p>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">binom</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.98</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">95</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Die Wahrscheinlichkeit einen Fehler 1ter Art zu begehen ist </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Die Wahrscheinlichkeit einen Fehler 1ter Art zu begehen ist 0.05083044536950054
</pre></div>
</div>
</div>
</div>
</section>
</section>
<span id="document-Aufgaben/Kapitel06/hypo_unabhSt"></span><section class="tex2jax_ignore mathjax_ignore" id="hypothesentest-unabhangige-stichproben-sigma-1-approx-sigma-2">
<h3>Hypothesentest - unabhängige Stichproben, <span class="math notranslate nohighlight">\(\sigma_1 \approx \sigma_2\)</span><a class="headerlink" href="#hypothesentest-unabhangige-stichproben-sigma-1-approx-sigma-2" title="Permalink to this headline">#</a></h3>
<p>Bei <span class="math notranslate nohighlight">\(2\)</span> Stichproben aus <span class="math notranslate nohighlight">\(2\)</span> Grundgesamtheiten erhalten Sie folgende Mittelwerte und Standardabweichungen: <span class="math notranslate nohighlight">\(\mu_1=61\)</span>, <span class="math notranslate nohighlight">\(\sigma_1=15,5\)</span>, <span class="math notranslate nohighlight">\(n_1=15\)</span>, <span class="math notranslate nohighlight">\(\mu_2=48,4\)</span> <span class="math notranslate nohighlight">\(\sigma_2=18,1\)</span>, <span class="math notranslate nohighlight">\(n_2 =12\)</span> . Welchen Hypothesentest müssen Sie anwenden um zu prüfen ob <span class="math notranslate nohighlight">\(\mu_1 \gt \mu_2\)</span> gilt?</p>
<ol class="simple">
<li><p>Formulieren Sie die geeignete Null- und Alternativhypothese.</p></li>
<li><p>Berechnen Sie die Teststatistik.</p></li>
<li><p>Berechnen Sie den kritischen Wert (entweder mit Python oder Wahrscheinlichkeitstabelle) bei einem Signifikanzniveau <span class="math notranslate nohighlight">\(\alpha = 0,01\)</span>. Wird <span class="math notranslate nohighlight">\(H_0\)</span> abgelehnt? Hierbei ergint sich der kritische Wert bei <span class="math notranslate nohighlight">\(\alpha = 0,01\)</span> für einen rechtseitigen Test <span class="math notranslate nohighlight">\(\mu_1 \gt \mu_2\)</span> mit der <span class="math notranslate nohighlight">\(t\)</span>-Verteilung (<span class="math notranslate nohighlight">\(1- \alpha, t_{df}\)</span>).</p></li>
<li><p>Interpretieren Sie das Ergebnis</p></li>
</ol>
<p>Die gewichtete Standardabweichung ergibt sich zu:</p>
<div class="math notranslate nohighlight">
\[s_g = \sqrt{\frac{(n_1-1)s_1^2 + (n_2-1)s_2^2 }{n_1+n_2-2}}\text{,}\]</div>
<p>Die Teststatistik ist <span class="math notranslate nohighlight">\(t\)</span>-verteilt und ergibt sich für <span class="math notranslate nohighlight">\((\mu_1-\mu_2)=0\)</span> zu:</p>
<div class="math notranslate nohighlight">
\[t =  \frac{(\bar x_1 - \bar x_2)}{s_g \sqrt{\frac{1}{n_1} + \frac{1}{n_2}}}\]</div>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 3 ...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 4 ...</span>
</pre></div>
</div>
</div>
</div>
<section id="losung">
<h4>Lösung<a class="headerlink" href="#losung" title="Permalink to this headline">#</a></h4>
<div class="toggle docutils container">
<div class="math notranslate nohighlight">
\[H_0 : \mu_1 = \mu_2\]</div>
<div class="math notranslate nohighlight">
\[H_A : \mu_1 \gt \mu_2\]</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">n_1</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">n_2</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">mu_1</span> <span class="o">=</span> <span class="mi">61</span>
<span class="n">mu_2</span> <span class="o">=</span> <span class="mf">48.4</span>
<span class="n">s_1</span> <span class="o">=</span> <span class="mf">15.5</span>
<span class="n">s_2</span> <span class="o">=</span> <span class="mf">18.1</span>

<span class="n">s_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="n">n_1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">s_1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">n_2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">s_2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_1</span> <span class="o">+</span> <span class="n">n_2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">t_stat</span> <span class="o">=</span> <span class="p">(</span><span class="n">mu_1</span> <span class="o">-</span> <span class="n">mu_2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">s_g</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">n_1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">n_2</span><span class="p">))</span>
<span class="n">t_stat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.9487919163239615
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">t</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">df</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">critical</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kritischer Wert: </span><span class="si">{</span><span class="n">critical</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">t_stat</span> <span class="o">&gt;=</span> <span class="n">critical</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Kritischer Wert: 2.4851071754106413
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<div class="toggle docutils container">
<p>Die Teststatistik liegt nicht im Ablehnungsbereich daher ist für <span class="math notranslate nohighlight">\(\alpha = 0,01\)</span> keine signifikante Abweichung der Mittelwerte feststellbar. Die Nullhypothese wird daher beibehalten.</p>
</div>
</section>
</section>
<span id="document-Aufgaben/Kapitel06/pooled_t"></span><section class="tex2jax_ignore mathjax_ignore" id="stichproben-t-test">
<h3><span class="math notranslate nohighlight">\(2\)</span>-Stichproben <span class="math notranslate nohighlight">\(t\)</span>-Test<a class="headerlink" href="#stichproben-t-test" title="Permalink to this headline">#</a></h3>
<p>Führen Sie einen <span class="math notranslate nohighlight">\(2\)</span>-Stichproben <span class="math notranslate nohighlight">\(t\)</span>-Test für folgende unabhängige Daten mit gleicher Standardabweichung bei einem Signifikanzniveau <span class="math notranslate nohighlight">\(\alpha = 0,01\)</span> aus:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Überprüfen Sie die Nullhypothese:</p>
<div class="math notranslate nohighlight">
\[H_0: \quad \mu_1 = \mu_2\]</div>
<p>und</p>
<p>alternative Hypothese:</p>
<div class="math notranslate nohighlight">
\[H_A: \quad \mu_1 \ne \mu_2\]</div>
<ol class="simple">
<li><p>für den <span class="math notranslate nohighlight">\(p\)</span>-Wert Ansatz</p></li>
<li><p>für den kritischen Wert</p></li>
<li><p>Interpretieren Sie das Ergebnis</p></li>
</ol>
<hr class="docutils" />
<section id="losungen">
<h4>Lösungen<a class="headerlink" href="#losungen" title="Permalink to this headline">#</a></h4>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">statistics</span><span class="p">,</span> <span class="n">pvalue</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">equal_var</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pvalue</span> <span class="o">&lt;=</span> <span class="n">alpha</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">statistics</span><span class="p">,</span> <span class="n">pvalue</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">equal_var</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># unterer kritischer Punkt</span>
<span class="n">lower</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1"># oberer kritischer Punkt</span>
<span class="n">upper</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">(</span><span class="n">statistics</span> <span class="o">&lt;=</span> <span class="n">lower</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">statistics</span> <span class="o">&gt;=</span> <span class="n">upper</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="toggle docutils container">
<p>Wir führen einen <span class="math notranslate nohighlight">\(2\)</span>-Stichproben <span class="math notranslate nohighlight">\(t\)</span>-Test durch.</p>
<p>Die Nullhypothese besagt, dass der Mittelwert des <span class="math notranslate nohighlight">\(1\)</span>-ten Datensatzes (<span class="math notranslate nohighlight">\(μ_1\)</span>) gleich dem Mittelwert des <span class="math notranslate nohighlight">\(2\)</span>-ten Datensatzes (<span class="math notranslate nohighlight">\(μ_2\)</span>) ist.
$<span class="math notranslate nohighlight">\(H_0: \quad \mu_1 = \mu_2\)</span>$</p>
<p>Wir wollen prüfen, ob sich der Mittelwert des <span class="math notranslate nohighlight">\(1\)</span>-ten Datensatzes (<span class="math notranslate nohighlight">\(μ_1\)</span>) von dem Mittelwert des <span class="math notranslate nohighlight">\(2\)</span>-ten Datensatzes (<span class="math notranslate nohighlight">\(μ_2\)</span>) unterscheidet, daher wird die Alternativhypothese wie folgt formuliert:
$<span class="math notranslate nohighlight">\(H_A: \quad \mu_1 \ne \mu_2\)</span>$</p>
<p>Aus dieser Formulierung ergibt sich ein zweiseitiger Hypothesentest.</p>
<p>Der <span class="math notranslate nohighlight">\(p\)</span>-Wert ist kleiner als das angegebene Signifikanzniveau von <span class="math notranslate nohighlight">\(0,01\)</span>; wir verwerfen <span class="math notranslate nohighlight">\(H_0\)</span>. Die Testergebnisse sind statistisch signifikant auf dem <span class="math notranslate nohighlight">\(1 \%\)</span>-Niveau und liefern einen sehr starken Beweis gegen die Nullhypothese.</p>
<p>Alternaite, wenn gilt, dass die Teststatistik <span class="math notranslate nohighlight">\(\lt \)</span> unterer dem kritischer Wert oder die Teststatistik <span class="math notranslate nohighlight">\(\gt\)</span> oberer dem kritischer Wert liegt, müssen wir <span class="math notranslate nohighlight">\(H_0\)</span> ablehnen.</p>
</div>
</section>
</section>
</div>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-Lernziele/Kapitel7_Lernziele"></span><section class="tex2jax_ignore mathjax_ignore" id="lernziele">
<h2>Lernziele<a class="headerlink" href="#lernziele" title="Permalink to this headline">#</a></h2>
<section id="varianzanalyse-anova">
<h3>Varianzanalyse - ANOVA<a class="headerlink" href="#varianzanalyse-anova" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Das Grundkonzept von Varianzanalyse wird am Beispiel des einfaktoriellen ANOVA-Hypothesentests erklärt</p></li>
<li><p>Maße der Variabilität der beobachteten Variable (SST) zwischen Gruppen (SSG) und innerhalb der Gruppen (SSE) werden definiert</p></li>
<li><p>Das Problem der Alphafehler-Kumulierung bei multiplen Testprozeduren wird demonstriert und mögliche Korrekturen wie Bonferroni-Korrektur und Tukey’s Test werden vermittelt</p></li>
<li><p>Zusammengefasst werden folgende Begriffe und Methoden besprochen : Varianzanalyse , einfaktorieller ANOVA-Hypothesentest , Multiples Testproblem , Alphafehler-Kumulierung , Bonferroni-Korrektur , Tukey’s Test</p></li>
</ul>
</section>
</section>
<span id="document-Kapitel07/01_Analyse_der_Varianz_ANOVA"></span><section class="tex2jax_ignore mathjax_ignore" id="varianzanalyse-anova">
<h2>Varianzanalyse - ANOVA<a class="headerlink" href="#varianzanalyse-anova" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">f</span><span class="p">,</span> <span class="n">f_oneway</span><span class="p">,</span> <span class="n">ttest_ind</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">smi</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.multicomp</span> <span class="kn">import</span> <span class="n">pairwise_tukeyhsd</span>
</pre></div>
</div>
</div>
</div>
<p>In diesem Abschnitt wird eine Methode namens <a href="https://de.wikipedia.org/wiki/Varianzanalyse">Varianzanalyse</a> (englisch analysis of variance, kurz ANOVA) erörtert, mit der mehrere Mittelwerte einer Grundgesamtheit verglichen werden können.</p>
<p>Genauer gesagt geht es um die sogenannte einfaktorielle Varianzanalyse (<span id="id1">Fahrmeir <em>et al.</em> [<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">2016</a>]</span> s.478). Bei dieser Art der ANOVA werden die Mittelwerte einer Variablen verglichen, die sich aus der Klassifizierung durch <em>eine</em> andere Variable, dem sogenannten <strong>Faktor</strong>, ergeben. Um das Konzept zu veranschaulichen, wollen wir ein einfaches Beispiel entwerfen. Angenommen, wir vergleichen die mittleren Jahresgehälter der in Deutschland lebenden Personen, gruppiert nach Bundesländern, dann erhalten wir <span class="math notranslate nohighlight">\(16\)</span> Mittelwerte der Jahresgehälter, einen für jedes Bundesland. In diesem Beispiel ist die Bundeslandvariable also eine Klassifikationsvariable, der so genannte Faktor.</p>
<p>Bitte beachten Sie, dass die einfaktorielle Varianzanalyse die Verallgemeinerung des <span class="math notranslate nohighlight">\(2\)</span>-Stichproben <span class="math notranslate nohighlight">\(t\)</span>-Tests auf mehr als zwei Grundgesamtheiten ist.</p>
<section id="einfaktorielle-anova">
<h3>Einfaktorielle ANOVA<a class="headerlink" href="#einfaktorielle-anova" title="Permalink to this headline">#</a></h3>
<p>Die grundlegende Logik einer einfaktoriellen ANOVA besteht darin, aus jeder Gruppe unabhängige Zufallsstichproben zu ziehen, dann die Stichprobenmittelwerte für jede Gruppe zu berechnen und anschließend die Variation der Stichprobenmittelwerte zwischen den Gruppen mit der Variation innerhalb der Gruppen zu vergleichen. Schließlich wird auf der Grundlage einer Teststatistik entschieden, ob die Mittelwerte der Gruppen gleich sind oder nicht.</p>
<p>Auf der Grundlage dieser Logik benötigen wir quantitative <strong>Maße für die Variabilität</strong>. Daher teilen wir die Gesamtvariabilität in zwei Segmente auf: Eines, das die <strong>Variabilität zwischen den Gruppen</strong> berücksichtigt, und das andere, das die <strong>Variabilität innerhalb der Gruppen</strong> berücksichtigt.</p>
<section id="masze-der-variabilitat">
<h4>Maße der Variabilität<a class="headerlink" href="#masze-der-variabilitat" title="Permalink to this headline">#</a></h4>
<p>Wir führen drei quantitative Maße für die Variation ein:</p>
<ul class="simple">
<li><p>Summe der Gesamtquadrate (SST)</p></li>
<li><p>Summe der Gruppenquadrate (SSG)</p></li>
<li><p>Summe der Fehlerquadrate (SSE)</p></li>
</ul>
<p>Die <strong>Summe der Gesamtquadrate (SST)</strong> ist ein Maß für die Gesamtvariabilität der Variablen. Sie ist gegeben durch</p>
<div class="math notranslate nohighlight">
\[SST = \sum_{i=1}^n(x_i-\bar x)^2\text{,}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(x_i\)</span> den Beobachtungen in den Stichproben entspricht und <span class="math notranslate nohighlight">\(\bar x\)</span> für den Gesamtmittelwert aller Stichproben steht.</p>
<p>Die <strong>Summe der Gruppenquadrate (SSG)</strong> ist ein Maß für die Variabilität zwischen Gruppen und entspricht der quadrierten Abweichung der Gruppenmittelwerte vom Gesamtmittelwert, gewichtet mit dem Stichprobenumfang.</p>
<div class="math notranslate nohighlight">
\[SSG = \sum_{i=1}^n n_j(\bar x_i-\bar x)^2\]</div>
<p>Dabei steht <span class="math notranslate nohighlight">\(n_j\)</span> für den Stichprobenumfang der Gruppe <span class="math notranslate nohighlight">\(j\)</span>, <span class="math notranslate nohighlight">\(\bar{x}_i\)</span> für den Mittelwert der Gruppe <span class="math notranslate nohighlight">\(j\)</span> und <span class="math notranslate nohighlight">\(\bar{x}\)</span> für den Gesamtmittelwert der Stichprobe.</p>
<p>Die <strong>Summe der Fehlerquadrate (<span class="math notranslate nohighlight">\(SSE\)</span>)</strong> schließlich ist ein Maß für die Variabilität innerhalb der Gruppen. Sie steht im Zusammenhang mit der unerklärten Variabilität, d. h. der Variabilität, die nicht durch die Gruppenvariable erklärt werden kann. Die Summe der Fehlerquadrate ist gegeben durch</p>
<div class="math notranslate nohighlight">
\[SSE = \sum_{i=1}^n (n_j-1)s_j^2\text{,}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(n_j\)</span> den Stichprobenumfang für Gruppe <span class="math notranslate nohighlight">\(j\)</span> und <span class="math notranslate nohighlight">\(s^2_{j}\)</span> die Varianz von Gruppe <span class="math notranslate nohighlight">\(j\)</span> bezeichnet. Alternativ kann man <span class="math notranslate nohighlight">\(SSE\)</span> sowie die Differenz von <span class="math notranslate nohighlight">\(SST\)</span> und <span class="math notranslate nohighlight">\(SSG\)</span> berechnen</p>
<div class="math notranslate nohighlight">
\[SSE = SST-SSG\text{.}\]</div>
</section>
<section id="masze-der-mittleren-variabilitat">
<h4>Maße der mittleren Variabilität<a class="headerlink" href="#masze-der-mittleren-variabilitat" title="Permalink to this headline">#</a></h4>
<p>Bisher haben wir Maße für die Gesamtvariabilität (<span class="math notranslate nohighlight">\(SST\)</span>), die Variabilität zwischen Gruppen (<span class="math notranslate nohighlight">\(SSG\)</span>) und die Variabilität innerhalb von Gruppen (<span class="math notranslate nohighlight">\(SSE\)</span>) berechnet. Um eine durchschnittliche Variabilität zu erhalten, skalieren wir im nächsten Schritt diese Variabilitätsmaße mit dem Stichprobenumfang (genauer gesagt mit den Freiheitsgraden, <span class="math notranslate nohighlight">\(df\)</span>).</p>
<p>Die <strong>Freiheitsgrade</strong> werden für jede Unterteilung der Variabilität (Gesamtvariabilität, Variabilität zwischen Gruppen und Variabilität innerhalb von Gruppen) definiert.</p>
<ul class="simple">
<li><p>Gesamtvariabilität</p></li>
</ul>
<div class="math notranslate nohighlight">
\[df_T = n-1\text{,}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(n\)</span> den Gesamtumfang der Stichprobe bezeichnet. den Gesamtumfang der Stichprobe bezeichnet.</p>
<ul class="simple">
<li><p>Variabilität zwischen den Gruppen</p></li>
</ul>
<div class="math notranslate nohighlight">
\[df_G=k-1\text{,}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(k\)</span> die Anzahl der Gruppen bezeichnet.
den Gesamtumfang der Stichprobe bezeichnet.</p>
<ul class="simple">
<li><p>Variabilität innerhalb der Gruppe</p></li>
</ul>
<div class="math notranslate nohighlight">
\[df_E = n-k\text{.}\]</div>
<p>Nun können wir die <strong>mittleren Quadrate</strong> für die Variabilität zwischen den Gruppen und die Variabilität innerhalb der Gruppen berechnen. Die durchschnittliche Variabilität zwischen und innerhalb der Gruppen wird als die Gesamtvariabilität, skaliert mit den zugehörigen Freiheitsgraden, berechnet.</p>
<ul class="simple">
<li><p>Mittlere Variabilität zwischen den Gruppen</p></li>
</ul>
<div class="math notranslate nohighlight">
\[MSG = \frac{SSG}{df_G}\]</div>
<ul class="simple">
<li><p>Mittlere Variabilität innerhalb der Gruppe</p></li>
</ul>
<div class="math notranslate nohighlight">
\[MSE = \frac{SSE}{df_E}\]</div>
</section>
<section id="teststatistik-und-p-wert">
<h4>Teststatistik und <span class="math notranslate nohighlight">\(p\)</span>-Wert<a class="headerlink" href="#teststatistik-und-p-wert" title="Permalink to this headline">#</a></h4>
<p>Schließlich vergleichen wir die mittlere Variation zwischen den Gruppen, <span class="math notranslate nohighlight">\(MSG\)</span>, mit der Variation innerhalb der Gruppe, <span class="math notranslate nohighlight">\(MSE\)</span>. Daher berechnen wir das Verhältnis zwischen der durchschnittlichen Variation zwischen den Gruppen (<span class="math notranslate nohighlight">\(MSG\)</span>) und der Variation innerhalb der Gruppen (<span class="math notranslate nohighlight">\(MSE\)</span>), das mit <span class="math notranslate nohighlight">\(F\)</span> bezeichnet wird.</p>
<div class="math notranslate nohighlight">
\[F= \frac{MSG}{MSE}\]</div>
<p>Die <span class="math notranslate nohighlight">\(F\)</span>-Statistik hat die <span class="math notranslate nohighlight">\(F\)</span>-Verteilung (benannt nach <a href="https://de.wikipedia.org/wiki/Ronald_Aylmer_Fisher">Sir Ronald A. Fisher</a>) mit</p>
<div class="math notranslate nohighlight">
\[df = (k-1, n-k)\text{,}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(k\)</span> für die Anzahl der Gruppen und <span class="math notranslate nohighlight">\(n\)</span> für den Stichprobenumfang steht. Große Werte der <span class="math notranslate nohighlight">\(F\)</span>-Werte zeigen an, dass die Variation zwischen den Stichprobenmittelwerten der Gruppen im Verhältnis zur Variation innerhalb der Gruppe groß ist. Darüber hinaus können wir den <span class="math notranslate nohighlight">\(p\)</span>-Wert für jeden gegebenen <span class="math notranslate nohighlight">\(F\)</span>-Wert berechnen. Wenn der <span class="math notranslate nohighlight">\(p\)</span>-Wert klein ist, liefern die Daten überzeugende Beweise dafür, dass sich mindestens ein Paar von Gruppenmittelwerten voneinander unterscheidet. Ist der <span class="math notranslate nohighlight">\(p\)</span>-Wert groß, liefern die Daten keinen überzeugenden Beweis dafür, dass sich zumindest ein Paar von Gruppenmittelwerten voneinander unterscheidet, und die beobachteten Unterschiede in den Stichprobenmittelwerten sind somit auf Stichprobenvariabilität (oder Zufall) zurückzuführen.</p>
</section>
<section id="einfaktorielle-anova-tabellen">
<h4>Einfaktorielle ANOVA-Tabellen<a class="headerlink" href="#einfaktorielle-anova-tabellen" title="Permalink to this headline">#</a></h4>
<p>Wie oben dargestellt, umfasst die einfache Varianzanalyse mehrere Analyseschritte. Dabei ist eine gängige Methode zur Darstellung einer einfachen ANOVA die so genannte <strong>einfaktorielle ANOVA-Tabelle</strong>. Der allgemeine Aufbau einer solchen Tabelle ist unten dargestellt.</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Quelle</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(df\)</span></p></th>
<th class="head"><p>Summe der Quadrate (SS)</p></th>
<th class="head"><p>Mittlere Quadrate (MS)</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(F\)</span>-Statistik</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(p\)</span>-Wert</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Gruppe/Klasse</p></td>
<td><p><span class="math notranslate nohighlight">\(k-1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(SSG\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(MSG = \frac{SSG}{k-1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(F=\frac{MSG}{MSE}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(p\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Fehler/Residuen</p></td>
<td><p><span class="math notranslate nohighlight">\(n-k\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(SSE\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(MSE=\frac{SSE}{n-k}\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>Insgesamt</p></td>
<td><p><span class="math notranslate nohighlight">\(n-1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(SST\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="einfaktorieller-anova-hypothesentest">
<h3>Einfaktorieller ANOVA-Hypothesentest<a class="headerlink" href="#einfaktorieller-anova-hypothesentest" title="Permalink to this headline">#</a></h3>
<p>Der Zweck eines <strong>einfaktoriellen ANOVA-Hypothesentests</strong> ist der Vergleich von <span class="math notranslate nohighlight">\(k\)</span> Grundgesamtheits-/Gruppenmittelwerten, <span class="math notranslate nohighlight">\(\mu_1, \mu_2,...,\mu_k\)</span>.
Die folgenden Annahmen müssen erfüllt sein, damit eine einseitige ANOVA angewendet werden kann (<span id="id2">Fahrmeir <em>et al.</em> [<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">2016</a>]</span> s.485):</p>
<ul class="simple">
<li><p>Zufällige Stichproben</p></li>
<li><p>Unabhängige Stichproben</p></li>
<li><p>Für jede Grundgesamtheit ist die betrachtete Variable normalverteilt.</p></li>
<li><p>Die Standardabweichungen der betrachteten Variable sind für alle Grundgesamtheiten gleich.</p></li>
</ul>
<p>Ein einfaktorieller ANOVA-Hypothesentest folgt demselben schrittweisen Verfahren wie andere Hypothesentests.</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Schritt 1</p></td>
<td><p>Geben Sie die Nullhypothese <span class="math notranslate nohighlight">\(H_0\)</span> und alternative Hypothese <span class="math notranslate nohighlight">\(H_A\)</span> an</p></td>
</tr>
<tr class="row-odd"><td><p>Schritt 2</p></td>
<td><p>Legen Sie das Signifikanzniveau,<span class="math notranslate nohighlight">\(\alpha\)</span> fest</p></td>
</tr>
<tr class="row-even"><td><p>Schritt 3</p></td>
<td><p>Berechnen Sie den Wert der Teststatistik</p></td>
</tr>
<tr class="row-odd"><td><p>Schritt 4</p></td>
<td><p>Bestimmen Sie den p-Wert</p></td>
</tr>
<tr class="row-even"><td><p>Schritt 5</p></td>
<td><p>Wenn <span class="math notranslate nohighlight">\(p \le \alpha\)</span>, <span class="math notranslate nohighlight">\(H_0\)</span> ablehnen; ansonsten <span class="math notranslate nohighlight">\(H_0\)</span> nicht ablehnen</p></td>
</tr>
<tr class="row-odd"><td><p>Schritt 6</p></td>
<td><p>Interpretieren Sie das Ergebnis des Hypothesentests</p></td>
</tr>
</tbody>
</table>
<section id="einfaktorieller-anova-hypothesentest-ein-beispiel">
<h4>Einfaktorieller ANOVA-Hypothesentest: Ein Beispiel<a class="headerlink" href="#einfaktorieller-anova-hypothesentest-ein-beispiel" title="Permalink to this headline">#</a></h4>
<p>Um praktische Erfahrungen zu sammeln, wenden wir den <strong>einfaktoriellen ANOVA-Hypothesentest</strong> in einer Übung an. Dazu laden wir den <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz. Sie können die Datei <code class="docutils literal notranslate"><span class="pre">students.csv</span></code> <a href="https://userpage.fu-berlin.de/soga/200/2010_data_sets/students.csv">hier</a> herunterladen. Importieren Sie den Datensatz und geben Sie ihm einen passenden Namen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lese Datei students.csv als Dataframe ein</span>
<span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../data/students.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Der <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz besteht aus <span class="math notranslate nohighlight">\(8239\)</span> Zeilen, von denen jede einen bestimmten Studenten repräsentiert, und <span class="math notranslate nohighlight">\(16\)</span> Spalten, von denen jede einer Variable/einem Merkmal entspricht, das sich auf diesen bestimmten Studenten bezieht. Diese selbsterklärenden Variablen sind: <em>stud_id, name, gender, age, height, weight, religion, nc_score, semester, major, minor, score1, score2, online_tutorial, graduated, salary.</em></p>
<p>Um den <strong>einfaktoriellen ANOVA-Hypothesentest</strong> zu veranschaulichen, untersuchen wir das mittlere Jahresgehalt der Absolventen, gruppiert nach ihrem Hauptstudienfach. Zur Verdeutlichung: In diesem Beispiel erfolgt die Klassifizierung/Gruppierung durch eine Variable, die Hauptvariable, den so genannten Faktor, wir führen also eine einfaktorielle ANOVA durch. In dieser Übung <strong>wollen wir testen, ob sich das mittlere Jahresgehalt der Absolventen zwischen den Absolventen verschiedener Studienfächer unterscheidet.</strong></p>
</section>
<section id="datenexploration-und-aufbereitung">
<h4>Datenexploration und Aufbereitung<a class="headerlink" href="#datenexploration-und-aufbereitung" title="Permalink to this headline">#</a></h4>
<p>Wir beginnen unsere Datenanalyse mit dem Zufallsstichprobenverfahren. Wir ziehen eine Zufallsstichprobe von <span class="math notranslate nohighlight">\(275\)</span> Studenten aus dem Datensatz mit Hilfe der <code class="docutils literal notranslate"><span class="pre">sample()</span></code> Methode in Python. Wir wollen sicherstellen, dass wir nur Studenten mit abgeschlossenem Studium in die Stichprobe aufnehmen, deshalb unterteilen wir die Daten des Dataframes zuvor in Python. Des Weiteren reduzieren wir unseren Datensatz auf die zwei Variablen von Interesse, die kategoriale Variable <code class="docutils literal notranslate"><span class="pre">major</span></code> und die numerische Variable <code class="docutils literal notranslate"><span class="pre">salary</span></code>. Dann zeigen wir die ersten <span class="math notranslate nohighlight">\(10\)</span> Zeilen des Datensatzes an.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">275</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">students</span><span class="p">[</span><span class="s2">&quot;graduated&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="s2">&quot;salary&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
    <span class="n">n</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>major</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5018</th>
      <td>Biology</td>
      <td>49976.94</td>
    </tr>
    <tr>
      <th>4476</th>
      <td>Political Science</td>
      <td>27821.99</td>
    </tr>
    <tr>
      <th>240</th>
      <td>Environmental Sciences</td>
      <td>37668.89</td>
    </tr>
    <tr>
      <th>7165</th>
      <td>Biology</td>
      <td>60958.21</td>
    </tr>
    <tr>
      <th>2488</th>
      <td>Economics and Finance</td>
      <td>59920.48</td>
    </tr>
    <tr>
      <th>1193</th>
      <td>Mathematics and Statistics</td>
      <td>46116.22</td>
    </tr>
    <tr>
      <th>241</th>
      <td>Social Sciences</td>
      <td>35881.74</td>
    </tr>
    <tr>
      <th>2968</th>
      <td>Economics and Finance</td>
      <td>48456.79</td>
    </tr>
    <tr>
      <th>1475</th>
      <td>Mathematics and Statistics</td>
      <td>61384.55</td>
    </tr>
    <tr>
      <th>6764</th>
      <td>Biology</td>
      <td>61819.85</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Aus reinem Interesse visualisieren wir die Zählungen für jede der <span class="math notranslate nohighlight">\(6\)</span> verschiedenen Studienteilnehmer in unserer Stichprobe, indem wir ein Balkendiagramm erstellen. Wir verwenden die <code class="docutils literal notranslate"><span class="pre">barh()</span></code> Funktion aus der <code class="docutils literal notranslate"><span class="pre">mathplotlib</span></code> Bibliothek für die Darstellung.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;major&quot;</span><span class="p">)[</span><span class="s2">&quot;salary&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Anzahl&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;Anzahl&#39;)
</pre></div>
</div>
<img alt="_images/01_Analyse_der_Varianz_ANOVA_49_1.png" src="_images/01_Analyse_der_Varianz_ANOVA_49_1.png" />
</div>
</div>
<p>Wir sehen, dass die verschiedenen Studienteilnehmer in unserer Stichprobe nicht gleich verteilt sind, aber das ist in Ordnung.</p>
<p>Bevor wir mit dem Hypothesentest beginnen, überprüfen wir, ob die Annahmen für den einfaktoriellen ANOVA-Hypothesentest erfüllt sind. Die Stichproben sind Zufallsstichproben und unabhängig. Das ist in Ordnung. Wir überprüfen die Normalitätsannahme, indem wir für jede gruppierte Variable ein Normalwahrscheinlichkeitsdiagramm (<a href="https://de.wikipedia.org/wiki/Quantil-Quantil-Diagramm">Q-Q-Diagramm</a>) erstellen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Erzeuge Q-Q Plot</span>
<span class="k">for</span> <span class="n">_major</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">major</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">smi</span><span class="o">.</span><span class="n">qqplot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;major&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">_major</span><span class="p">,</span> <span class="s2">&quot;salary&quot;</span><span class="p">],</span> <span class="n">line</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">_major</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Theoretische Quantile&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Stichproben Quantile&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/01_Analyse_der_Varianz_ANOVA_51_0.png" src="_images/01_Analyse_der_Varianz_ANOVA_51_0.png" />
<img alt="_images/01_Analyse_der_Varianz_ANOVA_51_1.png" src="_images/01_Analyse_der_Varianz_ANOVA_51_1.png" />
<img alt="_images/01_Analyse_der_Varianz_ANOVA_51_2.png" src="_images/01_Analyse_der_Varianz_ANOVA_51_2.png" />
<img alt="_images/01_Analyse_der_Varianz_ANOVA_51_3.png" src="_images/01_Analyse_der_Varianz_ANOVA_51_3.png" />
<img alt="_images/01_Analyse_der_Varianz_ANOVA_51_4.png" src="_images/01_Analyse_der_Varianz_ANOVA_51_4.png" />
<img alt="_images/01_Analyse_der_Varianz_ANOVA_51_5.png" src="_images/01_Analyse_der_Varianz_ANOVA_51_5.png" />
</div>
</div>
<p>Als nächstes testen wir die Annahme gleicher Standardabweichungen. Dazu berechnen wir die Standardabweichung für jede Gruppe. Die Programmiersprache Python bietet einige ausgezeichnete Funktionen zur Berechnung statistischer Parameter für verschiedene Gruppierungen eines Datensatzes. Für unser Beispiel verwenden wir die Funktion <code class="docutils literal notranslate"><span class="pre">pivot_table()</span></code>, um die Standardabweichungen für jede Gruppe zu berechnen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>major</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5018</th>
      <td>Biology</td>
      <td>49976.94</td>
    </tr>
    <tr>
      <th>4476</th>
      <td>Political Science</td>
      <td>27821.99</td>
    </tr>
    <tr>
      <th>240</th>
      <td>Environmental Sciences</td>
      <td>37668.89</td>
    </tr>
    <tr>
      <th>7165</th>
      <td>Biology</td>
      <td>60958.21</td>
    </tr>
    <tr>
      <th>2488</th>
      <td>Economics and Finance</td>
      <td>59920.48</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;major&quot;</span><span class="p">)[</span><span class="s2">&quot;salary&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">table</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>major
Biology                        8470.015961
Economics and Finance          7175.592211
Environmental Sciences         6460.464104
Mathematics and Statistics     8384.558228
Political Science             10273.903364
Social Sciences                7227.381320
Name: salary, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Als Faustregel gilt die Annahme gleicher Standardabweichungen als erfüllt, wenn das Verhältnis der größten zur kleinsten Standardabweichung der Stichprobe kleiner als <span class="math notranslate nohighlight">\(2\)</span> ist.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ratio</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">/</span> <span class="n">table</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">ratio</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.590273268094179
</pre></div>
</div>
</div>
</div>
<p>Das Verhältnis zwischen der größten und der kleinsten Standardabweichung der Stichprobe beträgt <span class="math notranslate nohighlight">\(1,59\)</span>. Das liegt nahe am Schwellenwert von <span class="math notranslate nohighlight">\(2\)</span>, ist aber für unser Musterbeispiel noch akzeptabel. Daraus können wir schließen, dass die Annahmen erfüllt sind.</p>
<p>Beachten Sie, dass die einseitige ANOVA robust gegenüber moderaten Verstößen gegen die Normalitätsannahme und die Annahme gleicher Standardabweichungen ist (<span id="id3">Fahrmeir <em>et al.</em> [<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">2016</a>]</span> s.486).</p>
</section>
<section id="uberprufung-der-hypothesen">
<h4>Überprüfung der Hypothesen<a class="headerlink" href="#uberprufung-der-hypothesen" title="Permalink to this headline">#</a></h4>
<p>Um den <strong>einfaktoriellen ANOVA-Hypothesentest</strong> durchzuführen, folgen wir dem schrittweisen Durchführungsverfahren für Hypothesentests.</p>
<p><strong>Schritt 1 : Geben Sie die Nullhypothese <span class="math notranslate nohighlight">\(H_0\)</span> und alternative Hypothese <span class="math notranslate nohighlight">\(H_A\)</span> an</strong></p>
<p>Die Nullhypothese besagt, dass das mittlere Jahresgehalt bei allen Gruppen von Absolventen gleich ist.</p>
<div class="math notranslate nohighlight">
\[H_0: \quad \mu_1=\mu_2=\mu_3=\mu_4=\mu_5=\mu_6\]</div>
<p><strong>Alternative Hypothese</strong></p>
<div class="math notranslate nohighlight">
\[H_A: \quad \text{Nicht alle Mittelwerte sind gleich}\]</div>
<p><strong>Schritt 2: Legen Sie das Signifikanzniveau,<span class="math notranslate nohighlight">\(\alpha\)</span> fest</strong></p>
<div class="math notranslate nohighlight">
\[\alpha = 0,01\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.01</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Schritt 3 und 4: Berechnen Sie den Wert der Teststatistik und den <span class="math notranslate nohighlight">\(p\)</span>-Wert</strong></p>
<p>Um die <span class="math notranslate nohighlight">\(F\)</span>-Test-Statistik zu berechnen, müssen wir zuvor mehrere Größen bestimmen. Zur Veranschaulichung berechnen wir die <span class="math notranslate nohighlight">\(F\)</span>-Teststatistik manuell in Python. Schritt für Schritt füllen wir die ANOVA-Tabelle aus, bis wir schließlich die <span class="math notranslate nohighlight">\(F\)</span>-Teststatistik und folglich den <span class="math notranslate nohighlight">\(p\)</span>-Wert erhalten.</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Quelle</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(df\)</span></p></th>
<th class="head"><p>Summe der Quadrate (SS)</p></th>
<th class="head"><p>Mittlere Quadrate (MS)</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(F\)</span>-Statistik</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(p\)</span>-Wert</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Gruppe/Klasse</p></td>
<td><p><span class="math notranslate nohighlight">\(k-1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(SSG\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(MSG = \frac{SSG}{k-1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(F=\frac{MSG}{MSE}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(p\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Fehler/Residuen</p></td>
<td><p><span class="math notranslate nohighlight">\(n-k\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(SSE\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(MSE=\frac{SSE}{n-k}\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>Insgesamt</p></td>
<td><p><span class="math notranslate nohighlight">\(n-1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(SST\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<p>Wir beginnen mit der ersten Spalte und berechnen die Freiheitsgrade.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;major&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">df_G</span> <span class="o">=</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">df_G</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_E</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="n">k</span>
<span class="n">df_E</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>269
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_T</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">df_T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>274
</pre></div>
</div>
</div>
</div>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Quelle</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(df\)</span></p></th>
<th class="head"><p>Summe der Quadrate (SS)</p></th>
<th class="head"><p>Mittlere Quadrate (MS)</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(F\)</span>-Statistik</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(p\)</span>-Wert</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Gruppe/Klasse</p></td>
<td><p><span class="math notranslate nohighlight">\(5\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(SSG\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(MSG = \frac{SSG}{k-1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(F=\frac{MSG}{MSE}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(p\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Fehler/Residuen</p></td>
<td><p><span class="math notranslate nohighlight">\(269\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(SSE\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(MSE=\frac{SSE}{n-k}\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>Insgesamt</p></td>
<td><p><span class="math notranslate nohighlight">\(274\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(SST\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<p>Außerdem berechnen wir die drei Summen der Quadrate, <span class="math notranslate nohighlight">\(SST\)</span>, <span class="math notranslate nohighlight">\(SSG\)</span> und <span class="math notranslate nohighlight">\(SSE\)</span>. Erinnern Sie sich an die Gleichungen von oben.</p>
<div class="math notranslate nohighlight">
\[SST = \sum_{i=1}^n(x_i-\bar x)^2\text{,}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(x_i\)</span>den Beobachtungen in den Stichproben und <span class="math notranslate nohighlight">\(\bar x\)</span> dem Gesamtmittelwert aller Stichproben entspricht.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne Gesamtmittelwert</span>
<span class="n">x_bar</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;salary&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Beobachtungen</span>
<span class="n">xi</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;salary&quot;</span><span class="p">]</span>

<span class="c1"># Berechne SST</span>
<span class="n">SST</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">xi</span> <span class="o">-</span> <span class="n">x_bar</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">SST</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>33169010775.846596
</pre></div>
</div>
</div>
</div>
<div class="math notranslate nohighlight">
\[SSG = \sum_{i=1}^n n_j(\bar x_i-\bar x)^2\]</div>
<p>Dabei steht <span class="math notranslate nohighlight">\(n_j\)</span> für den Stichprobenumfang der Gruppe <span class="math notranslate nohighlight">\(j, \bar{x}_i\)</span> für den Mittelwert der Gruppe <span class="math notranslate nohighlight">\(j\)</span> und <span class="math notranslate nohighlight">\(\bar x\)</span> für den Gesamtmittelwert aller Stichproben.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_j</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;major&quot;</span><span class="p">)[</span><span class="s2">&quot;salary&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="n">n_j</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>major
Biology                       50
Economics and Finance         48
Environmental Sciences        53
Mathematics and Statistics    40
Political Science             50
Social Sciences               34
Name: salary, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne Stichprobengrösse für alle Gruppen</span>
<span class="n">n_j</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;major&quot;</span><span class="p">)[</span><span class="s2">&quot;salary&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>

<span class="c1"># Berechne Mittelwert für alle Gruppen</span>
<span class="n">xi_bar</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;major&quot;</span><span class="p">)[</span><span class="s2">&quot;salary&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Berechne SSG</span>
<span class="n">SSG</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">n_j</span> <span class="o">*</span> <span class="p">(</span><span class="n">xi_bar</span> <span class="o">-</span> <span class="n">x_bar</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">SSG</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15425759982.382113
</pre></div>
</div>
</div>
</div>
<div class="math notranslate nohighlight">
\[SSE = \sum_{i=1}^n (n_j-1)s_j^2\text{,}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(n_j\)</span> den Stichprobenumfang für die Gruppe <span class="math notranslate nohighlight">\(j\)</span> und <span class="math notranslate nohighlight">\(s^2_j\)</span> die Varianz der Gruppe <span class="math notranslate nohighlight">\(j\)</span> bezeichnet.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne Standardabweichung für die einzelnen Gruppen</span>
<span class="n">s2_j</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;major&quot;</span><span class="p">)[</span><span class="s2">&quot;salary&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="c1"># Berechne SSE</span>
<span class="n">SSE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">n_j</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">s2_j</span><span class="o">**</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">SSE</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>17743250793.46448
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># alternativ kann SSE auch so berechnet werden</span>
<span class="n">SSE2</span> <span class="o">=</span> <span class="n">SST</span> <span class="o">-</span> <span class="n">SSG</span>
<span class="n">SSE2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>17743250793.464485
</pre></div>
</div>
</div>
</div>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Quelle</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(df\)</span></p></th>
<th class="head"><p>Summe der Quadrate (SS)</p></th>
<th class="head"><p>Mittlere Quadrate (MS)</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(F\)</span>-Statistik</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(p\)</span>-Wert</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Gruppe/Klasse</p></td>
<td><p><span class="math notranslate nohighlight">\(5\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1,542576 \cdot 10^{10}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(MSG = \frac{SSG}{k-1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(F=\frac{MSG}{MSE}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(p\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Fehler/Residuen</p></td>
<td><p><span class="math notranslate nohighlight">\(269\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1,774325 \cdot 10^{10}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(MSE=\frac{SSE}{n-k}\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>Insgesamt</p></td>
<td><p><span class="math notranslate nohighlight">\(274\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(3,316901 \cdot 10^{10}\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<p>Nun berechnen wir die beiden Maße für die mittlere Variabilität, <span class="math notranslate nohighlight">\(MSG\)</span> und <span class="math notranslate nohighlight">\(MSE\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne MSG</span>
<span class="n">MSG</span> <span class="o">=</span> <span class="n">SSG</span> <span class="o">/</span> <span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">MSG</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3085151996.4764223
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne MSE</span>
<span class="n">MSE</span> <span class="o">=</span> <span class="n">SSE</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">k</span><span class="p">)</span>
<span class="n">MSE</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>65960040.124403276
</pre></div>
</div>
</div>
</div>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Quelle</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(df\)</span></p></th>
<th class="head"><p>Summe der Quadrate (SS)</p></th>
<th class="head"><p>Mittlere Quadrate (MS)</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(F\)</span>-Statistik</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(p\)</span>-Wert</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Gruppe/Klasse</p></td>
<td><p><span class="math notranslate nohighlight">\(5\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1,542576 \cdot 10^{10}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(3,085152 \cdot 10^{9}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(F=\frac{MSG}{MSE}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(p\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Fehler/Residuen</p></td>
<td><p><span class="math notranslate nohighlight">\(269\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1,774325 \cdot 10^{10}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(6,596004 \cdot 10^{7}\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>Insgesamt</p></td>
<td><p><span class="math notranslate nohighlight">\(274\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(3,316901 \cdot 10^{10}\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<p>Schließlich erhalten wir die <span class="math notranslate nohighlight">\(F\)</span>-Statistiken durch das Verhältnis von <span class="math notranslate nohighlight">\(MSG\)</span> und <span class="math notranslate nohighlight">\(MSE\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne Teststatistik</span>
<span class="n">Fstat</span> <span class="o">=</span> <span class="n">MSG</span> <span class="o">/</span> <span class="n">MSE</span>
<span class="n">Fstat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>46.773046084533945
</pre></div>
</div>
</div>
</div>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Quelle</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(df\)</span></p></th>
<th class="head"><p>Summe der Quadrate (SS)</p></th>
<th class="head"><p>Mittlere Quadrate (MS)</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(F\)</span>-Statistik</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(p\)</span>-Wert</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Gruppe/Klasse</p></td>
<td><p><span class="math notranslate nohighlight">\(5\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1,542576 \cdot 10^{10}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(3,085152 \cdot 10^{9}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(46,77304\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(p\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Fehler/Residuen</p></td>
<td><p><span class="math notranslate nohighlight">\(269\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1,774325 \cdot 10^{10}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(6,596004 \cdot 10^{7}\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>Insgesamt</p></td>
<td><p><span class="math notranslate nohighlight">\(274\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(3,316901 \cdot 10^{10}\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<p>Im letzten Schritt berechnen wir den <span class="math notranslate nohighlight">\(p\)</span>-Wert durch Aufruf der Funktion <code class="docutils literal notranslate"><span class="pre">f.cdf()</span></code> in Python. Erinnern Sie sich, wie man die Freiheitsgrade berechnet.</p>
<div class="math notranslate nohighlight">
\[df = (k-1, n-k)\]</div>
<p>Da die Nullhypothese nur dann abgelehnt wird, wenn die Teststatistik <span class="math notranslate nohighlight">\(F\)</span> zu groß ist, ist ein einfaktorieller ANOVA-Test immer rechtsschief.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="n">k</span>

<span class="n">p_value</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">Fstat</span><span class="p">,</span> <span class="n">dfn</span><span class="o">=</span><span class="n">df1</span><span class="p">,</span> <span class="n">dfd</span><span class="o">=</span><span class="n">df2</span><span class="p">)</span>
<span class="n">p_value</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0932037477708007e-34
</pre></div>
</div>
</div>
</div>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Quelle</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(df\)</span></p></th>
<th class="head"><p>Summe der Quadrate (SS)</p></th>
<th class="head"><p>Mittlere Quadrate (MS)</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(F\)</span>-Statistik</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(p\)</span>-Wert</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Gruppe/Klasse</p></td>
<td><p><span class="math notranslate nohighlight">\(5\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1,542576 \cdot 10^{10}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(3,085152 \cdot 10^{9}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(46,77304\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1,093212 \cdot 10^{-34}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Fehler/Residuen</p></td>
<td><p><span class="math notranslate nohighlight">\(269\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1,774325 \cdot 10^{10}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(6,596004 \cdot 10^{7}\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>Insgesamt</p></td>
<td><p><span class="math notranslate nohighlight">\(274\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(3,316901 \cdot 10^{10}\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<p><strong>Schritt 5: Wenn <span class="math notranslate nohighlight">\(p \le \alpha , H_0\)</span> ablehnen; ansonsten <span class="math notranslate nohighlight">\(H_0\)</span> nicht ablehnen</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_value</span> <span class="o">&lt;=</span> <span class="n">alpha</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>Der <span class="math notranslate nohighlight">\(p\)</span>-Wert ist kleiner als das angegebene Signifikanzniveau von <span class="math notranslate nohighlight">\(0,01\)</span>; wir verwerfen <span class="math notranslate nohighlight">\(H_0\)</span>. Die Testergebnisse sind statistisch signifikant auf dem <span class="math notranslate nohighlight">\(1 \%\)</span>-Niveau und liefern einen sehr starken Beweis gegen die Nullhypothese.</p>
<p><strong>Schritt 6: Interpretieren Sie das Ergebnis des Hypothesentests</strong></p>
<p><span class="math notranslate nohighlight">\(p=1,093212 \cdot 10^{-34}\)</span>. Bei einem Signifikanzniveau von <span class="math notranslate nohighlight">\(1 \%\)</span> liefern die Daten sehr starke Hinweise darauf, dass sich mindestens ein Paar von Gruppenmittelwerten voneinander unterscheidet.</p>
</section>
<section id="hypothesentests-in-python">
<h4>Hypothesentests in Python<a class="headerlink" href="#hypothesentests-in-python" title="Permalink to this headline">#</a></h4>
<p>Wir haben gerade einen einfaktoriellen ANOVA-Hypothesentest in Python manuell durchgeführt. Toll, aber jetzt wiederholen wir das Beispiel und nutzen die Möglichkeiten von Python, um das gleiche Ergebnis wie oben mit nur wenigen Zeilen Code zu erhalten!</p>
<p>Um einen einseitigen ANOVA-Hypothesentest in Python durchzuführen, verwenden wir die Funktion <code class="docutils literal notranslate"><span class="pre">f_oneway()</span></code>. Die <code class="docutils literal notranslate"><span class="pre">f_oneway()</span></code>-Funktion erwartet die Eingabe der zu vergleichenden Untergruppen. Hierfür verwenden wir eine <code class="docutils literal notranslate"><span class="pre">list-comprehension</span></code>. Außerdem lesen wir die <span class="math notranslate nohighlight">\(F\)</span>-Teststatistik <code class="docutils literal notranslate"><span class="pre">statistics</span></code> und <span class="math notranslate nohighlight">\(p\)</span>-Wert <code class="docutils literal notranslate"><span class="pre">p_value</span></code> aus.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dat</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;major&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">major</span><span class="p">,</span> <span class="s2">&quot;salary&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="k">for</span> <span class="n">major</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;major&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="p">]</span>
<span class="n">statistics</span><span class="p">,</span> <span class="n">pvalue</span> <span class="o">=</span> <span class="n">f_oneway</span><span class="p">(</span><span class="o">*</span><span class="n">dat</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wert der F-Statistik: </span><span class="si">{</span><span class="n">statistics</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-Wert: </span><span class="si">{</span><span class="n">pvalue</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Wert der F-Statistik: 46.77304608453393
p-Wert: 1.0932037477708007e-34
</pre></div>
</div>
</div>
</div>
<p>Es hat gut funktioniert! Vergleichen Sie die Ausgabe der Funktion <code class="docutils literal notranslate"><span class="pre">f_oneway()</span></code> mit unserem Ergebnis von oben. Auch hier können wir zu dem Schluss kommen, dass die Daten bei einem Signifikanzniveau von <span class="math notranslate nohighlight">\(1 \%\)</span> sehr starke Hinweise darauf liefern, dass sich mindestens ein Paar von Gruppenmitteln voneinander unterscheidet.</p>
</section>
</section>
<section id="multiples-testproblem">
<h3>Multiples Testproblem<a class="headerlink" href="#multiples-testproblem" title="Permalink to this headline">#</a></h3>
<p>Eine Einschränkung der ANOVA besteht darin, dass wir, wenn wir die Nullhypothese ablehnen, feststellen, dass die Mittelwerte der betrachteten Populationen nicht alle gleich sind. Wir können jedoch weder entscheiden, welche Mittelwerte unterschiedlich sind, noch, in welchem Verhältnis die Mittelwerte zueinander stehen.</p>
<p>Um diese Frage zu klären, wenden wir Methoden an, die als <strong>multiples Testen</strong> oder <strong>Mehrfachvergleiche</strong> bezeichnet werden. Das Problem bei Mehrfachvergleichen ist, dass je mehr Hypothesen für einen bestimmten Datensatz getestet werden, desto wahrscheinlicher ist es, dass die Nullhypothese fälschlicherweise zurückgewiesen wird. Daher erfordern die Methoden des Mehrfachvergleichs eine höhere Signifikanzschwelle (<span class="math notranslate nohighlight">\(\alpha\)</span>) für einzelne Vergleiche, um die Anzahl der gezogenen Schlüsse zu kompensieren.</p>
<section id="alphafehler-kumulierung-engl-family-wise-error-rate-fwer">
<h4>Alphafehler-Kumulierung (engl. Family Wise Error Rate - FWER)<a class="headerlink" href="#alphafehler-kumulierung-engl-family-wise-error-rate-fwer" title="Permalink to this headline">#</a></h4>
<p>Eine <strong>Testfamilie</strong> ist der Fachbegriff für eine Reihe von Tests, die an einem Datensatz durchgeführt werden. Die <a href="https://de.wikipedia.org/wiki/Alphafehler-Kumulierung">Alphafehler-Kumulierung</a> (engl. Family Wise Error Rate) ist die Wahrscheinlichkeit, dass bei der Durchführung von Mehrfachhypothesentests ein oder mehrere falsche Zurückweisungen der Null-Hypothese oder Fehler vom <a href="https://de.wikipedia.org/wiki/Fehler_1._und_2._Art">Typ I</a> gemacht werden.</p>
<p>Es sei daran erinnert, dass bei einem Signifikanzniveau von <span class="math notranslate nohighlight">\(\alpha=0,05\)</span> die Wahrscheinlichkeit, einen Fehler vom Typ I zu machen, <span class="math notranslate nohighlight">\(0,05\)</span> oder <span class="math notranslate nohighlight">\(5 \%\)</span> beträgt. Folglich ist die Wahrscheinlichkeit, keinen Fehler vom Typ I zu machen, <span class="math notranslate nohighlight">\(1-\alpha=1-0,05=0,95\)</span>. Außerdem ist die Wahrscheinlichkeit, zwei unabhängige Ereignisse zu beobachten, das Produkt ihrer Wahrscheinlichkeiten. Wenn wir also zwei unabhängige Tests durchführen, ist die Wahrscheinlichkeit, beim ersten und beim zweiten Test keinen Fehler vom Typ I zu machen</p>
<div class="math notranslate nohighlight">
\[(1-\alpha) \times (1-\alpha) = (1-\alpha)^2\]</div>
<p>Wenn <span class="math notranslate nohighlight">\(\alpha=0,05\)</span> ist, ergibt sich eine Wahrscheinlichkeit, dass beim ersten und zweiten Test kein Fehler vom Typ I auftritt, von</p>
<div class="math notranslate nohighlight">
\[(1 - \alpha)^2 = (1-0,05)^2 = 0,95^2 \approx 0,902\]</div>
<p>Für eine Familie von <span class="math notranslate nohighlight">\(C\)</span>-Tests ist die Wahrscheinlichkeit, dass kein Fehler vom Typ I für die gesamte Familie auftritt, formal ausgedrückt</p>
<div class="math notranslate nohighlight">
\[(1-\alpha)^C\text{.}\]</div>
<p>Betrachten wir nun <span class="math notranslate nohighlight">\(C=10\)</span> und <span class="math notranslate nohighlight">\(\alpha=0,05\)</span>. Wir führen also <span class="math notranslate nohighlight">\(10\)</span> Mehrfachvergleiche mit einem Datensatz durch. Die Wahrscheinlichkeit, keinen Fehler vom Typ I in der Familie zu machen, ist dann</p>
<div class="math notranslate nohighlight">
\[(1-\alpha)^C=(1-0,05)^{10} \approx 0,599\]</div>
<p>Folglich ist die Wahrscheinlichkeit, dass <strong>ein oder mehrere Fehler vom Typ I</strong> in der Testfamilie auftreten</p>
<div class="math notranslate nohighlight">
\[1 - (1-\alpha)^C\]</div>
<p>Für unser Beispiel finden wir</p>
<div class="math notranslate nohighlight">
\[1 - (1-\alpha)^C = 1 - (1-0,05)^{10} \approx 0,401\]</div>
<p>Somit ist bei <span class="math notranslate nohighlight">\(\alpha=0,05\)</span> für jeden der <span class="math notranslate nohighlight">\(10\)</span> Mehrfachvergleiche die Wahrscheinlichkeit, dass die Nullhypothese falsch zurückgewiesen wird, <span class="math notranslate nohighlight">\(0,401\)</span> oder <span class="math notranslate nohighlight">\(40,1 \%\)</span>.</p>
<p>Um diesem Problem Rechnung zu tragen, gibt es <a href="https://de.wikipedia.org/wiki/Alphafehler-Kumulierung#Adjustierung_des_globalen_%CE%B1-Niveaus">mehrere statistische Methoden</a>. In diesem Abschnitt werden die <a href="https://de.wikipedia.org/wiki/Bonferroni-Korrektur">Bonferroni-Korrektur</a> und die <a href="https://de.wikipedia.org/wiki/Post-hoc-Test#Tukey-Test">Tukey-Test</a>, auch bekannt als <strong>Tukeys HSD-Test (hoenstly significant difference)</strong>, behandelt.</p>
</section>
<section id="beispiel-daten">
<h4>Beispiel-Daten<a class="headerlink" href="#beispiel-daten" title="Permalink to this headline">#</a></h4>
<p>In diesem Abschnitt wiederholen wir das Beispiel aus dem vorherigen Abschnitt. Dort haben wir eine einfaktorielle ANOVA angewandt, um zu <strong>testen, ob sich das mittlere Jahresgehalt der Absolventen zwischen den Absolventen verschiedener Studienfächer unterscheidet</strong>. Dieses Mal werden wir jedoch mehrere Vergleiche durchführen, um die Beziehung zwischen allen Gruppenmittelwerten zu analysieren.</p>
<p>Laden Sie den <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz erneut (Sie können die Datei <code class="docutils literal notranslate"><span class="pre">students.csv</span></code> <a href="https://userpage.fu-berlin.de/soga/200/2010_data_sets/students.csv">hier</a> herunterladen).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lese Datei students.csv als Dataframe ein</span>
<span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../data/students.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Der <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz besteht aus <span class="math notranslate nohighlight">\(8239\)</span> Zeilen, von denen jede einen bestimmten Studenten repräsentiert, und <span class="math notranslate nohighlight">\(16\)</span> Spalten, von denen jede einer Variable/einem Merkmal entspricht, das sich auf diesen bestimmten Studenten bezieht. Diese selbsterklärenden Variablen sind: <em>stud_id, name, gender, age, height, weight, religion, nc_score, semester, major, minor, score1, score2, online_tutorial, graduated, salary.</em></p>
<p>Aus dem Datensatz der Studierenden ziehen wir eine Zufallsstichprobe von <span class="math notranslate nohighlight">\(275\)</span> Absolventen und reduzieren den Datensatz auf die beiden interessierenden Variablen, die kategoriale Variable <code class="docutils literal notranslate"><span class="pre">major</span></code> und die numerische Variable <code class="docutils literal notranslate"><span class="pre">salary</span></code>. Für eine bessere Lesbarkeit in der folgenden Analyse ersetzen wir die Namen der Studienfächer durch entsprechende Abkürzungen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">275</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">students</span><span class="p">[</span><span class="s2">&quot;graduated&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="s2">&quot;salary&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
    <span class="n">n</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">300</span>
<span class="p">)</span>

<span class="n">lookup</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Biology&quot;</span><span class="p">:</span> <span class="s2">&quot;Bio&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Political Science&quot;</span><span class="p">:</span> <span class="s2">&quot;PoS&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Economics and Finance&quot;</span><span class="p">:</span> <span class="s2">&quot;EcFi&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Environmental Sciences&quot;</span><span class="p">:</span> <span class="s2">&quot;EnS&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Mathematics and Statistics&quot;</span><span class="p">:</span> <span class="s2">&quot;MaSt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Social Sciences&quot;</span><span class="p">:</span> <span class="s2">&quot;SoS&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;major&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;major&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">lookup</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>

<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>major</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3825</th>
      <td>MaSt</td>
      <td>57849.34</td>
    </tr>
    <tr>
      <th>794</th>
      <td>MaSt</td>
      <td>56558.16</td>
    </tr>
    <tr>
      <th>2126</th>
      <td>PoS</td>
      <td>46945.17</td>
    </tr>
    <tr>
      <th>1291</th>
      <td>Bio</td>
      <td>40093.46</td>
    </tr>
    <tr>
      <th>5912</th>
      <td>EnS</td>
      <td>35106.96</td>
    </tr>
    <tr>
      <th>1870</th>
      <td>EnS</td>
      <td>33216.12</td>
    </tr>
    <tr>
      <th>1852</th>
      <td>EnS</td>
      <td>30606.20</td>
    </tr>
    <tr>
      <th>1483</th>
      <td>PoS</td>
      <td>37240.11</td>
    </tr>
    <tr>
      <th>5618</th>
      <td>MaSt</td>
      <td>50913.04</td>
    </tr>
    <tr>
      <th>2298</th>
      <td>EcFi</td>
      <td>50365.10</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Des Weiteren führen wir einen einfaktoriellen ANOVA-Hypothesentest in Python durch, indem wir die Funktion <code class="docutils literal notranslate"><span class="pre">f_oneway()</span></code> anwenden.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dat</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;major&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">major</span><span class="p">,</span> <span class="s2">&quot;salary&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="k">for</span> <span class="n">major</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;major&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="p">]</span>
<span class="n">statistics</span><span class="p">,</span> <span class="n">pvalue</span> <span class="o">=</span> <span class="n">f_oneway</span><span class="p">(</span><span class="o">*</span><span class="n">dat</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wert der F-Statistik: </span><span class="si">{</span><span class="n">statistics</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-Wert: </span><span class="si">{</span><span class="n">pvalue</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Wert der F-Statistik: 41.14261117043315
p-Wert: 2.2839018706608163e-31
</pre></div>
</div>
</div>
</div>
</section>
<section id="bonferroni-korrektur">
<h4>Bonferroni-Korrektur<a class="headerlink" href="#bonferroni-korrektur" title="Permalink to this headline">#</a></h4>
<p>Die Bonferroni-Korrektur kompensiert die erhöhte Wahrscheinlichkeit, dass eine Nullhypothese aufgrund von Mehrfachvergleichen fälschlicherweise abgelehnt wird (Fehler vom Typ I), indem das Signifikanzniveau <span class="math notranslate nohighlight">\(\alpha\)</span> in folgender Form angepasst wird</p>
<div class="math notranslate nohighlight">
\[\alpha = \frac{\alpha}{m}\text{,}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(m\)</span> der Anzahl der Vergleiche entspricht, die gegeben ist durch</p>
<div class="math notranslate nohighlight">
\[m=\frac{k(k-1)}{2}\text{,}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(k\)</span> den Ebenen des Faktors entspricht, der die kategoriale Klassifikationsvariable ist.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bonferroni</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Computes the boferroni correction&quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">bonf</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">/</span> <span class="n">m</span>
    <span class="k">return</span> <span class="n">bonf</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="der-paarweiser-t-test-in-python-bonferroni-korrektur">
<h4>Der paarweiser <span class="math notranslate nohighlight">\(t\)</span>-Test in Python: Bonferroni-Korrektur<a class="headerlink" href="#der-paarweiser-t-test-in-python-bonferroni-korrektur" title="Permalink to this headline">#</a></h4>
<p>Wie im vorigen Abschnitt erwähnt, ist eine einfaktorielle Varianzanalyse die Verallgemeinerung des <span class="math notranslate nohighlight">\(2\)</span>-Stichproben <span class="math notranslate nohighlight">\(t\)</span>-Tests auf mehr als zwei Grundgesamtheiten. Die Python-Funktion zur Durchführung von Mehrfachvergleichen ist <code class="docutils literal notranslate"><span class="pre">ttest_ind()</span></code>. Die Funktion <code class="docutils literal notranslate"><span class="pre">ttest_ind()</span></code> vergleicht die jeweiligen Gehaltsverteilungen (<code class="docutils literal notranslate"><span class="pre">salary</span></code>) nach Studienfächer gruppiert (<code class="docutils literal notranslate"><span class="pre">major</span></code>) miteinander.</p>
<p>Zunächst führen wir einen paarweisen <span class="math notranslate nohighlight">\(t\)</span>-Test ohne Anpassung durch, wodurch sich die Wahrscheinlichkeit erhöht, dass die Nullhypothese falsch zurückgewiesen wird.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">combinations</span>

<span class="n">major</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">combinations</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">major</span><span class="o">.</span><span class="n">unique</span><span class="p">(),</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">major</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;MaSt&#39;, &#39;PoS&#39;),
 (&#39;MaSt&#39;, &#39;Bio&#39;),
 (&#39;MaSt&#39;, &#39;EnS&#39;),
 (&#39;MaSt&#39;, &#39;EcFi&#39;),
 (&#39;MaSt&#39;, &#39;SoS&#39;),
 (&#39;PoS&#39;, &#39;Bio&#39;),
 (&#39;PoS&#39;, &#39;EnS&#39;),
 (&#39;PoS&#39;, &#39;EcFi&#39;),
 (&#39;PoS&#39;, &#39;SoS&#39;),
 (&#39;Bio&#39;, &#39;EnS&#39;),
 (&#39;Bio&#39;, &#39;EcFi&#39;),
 (&#39;Bio&#39;, &#39;SoS&#39;),
 (&#39;EnS&#39;, &#39;EcFi&#39;),
 (&#39;EnS&#39;, &#39;SoS&#39;),
 (&#39;EcFi&#39;, &#39;SoS&#39;)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>

<span class="k">for</span> <span class="n">major1</span><span class="p">,</span> <span class="n">major2</span> <span class="ow">in</span> <span class="n">major</span><span class="p">:</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">ttest_ind</span><span class="p">(</span>
        <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;major&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">major1</span><span class="p">,</span> <span class="s2">&quot;salary&quot;</span><span class="p">],</span>
        <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;major&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">major2</span><span class="p">,</span> <span class="s2">&quot;salary&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">major1</span><span class="si">}</span><span class="s2"> vs. </span><span class="si">{</span><span class="n">major2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value:   </span><span class="si">{</span><span class="n">p_value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reject H0 (p-value &lt;= </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">p_value</span> <span class="o">&lt;=</span> <span class="n">alpha</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MaSt vs. PoS
p-value:   5.285766661005193e-11
Reject H0 (p-value &lt;= 0.05): True

MaSt vs. Bio
p-value:   0.23955822802713908
Reject H0 (p-value &lt;= 0.05): False

MaSt vs. EnS
p-value:   2.873918020813552e-10
Reject H0 (p-value &lt;= 0.05): True

MaSt vs. EcFi
p-value:   0.6139625494797094
Reject H0 (p-value &lt;= 0.05): False

MaSt vs. SoS
p-value:   1.0518797210598569e-10
Reject H0 (p-value &lt;= 0.05): True

PoS vs. Bio
p-value:   4.8406921036979525e-15
Reject H0 (p-value &lt;= 0.05): True

PoS vs. EnS
p-value:   0.12016488500152636
Reject H0 (p-value &lt;= 0.05): False

PoS vs. EcFi
p-value:   2.6490333956019106e-12
Reject H0 (p-value &lt;= 0.05): True

PoS vs. SoS
p-value:   0.230977569202981
Reject H0 (p-value &lt;= 0.05): False

Bio vs. EnS
p-value:   1.7902286073326123e-14
Reject H0 (p-value &lt;= 0.05): True

Bio vs. EcFi
p-value:   0.5127687451099829
Reject H0 (p-value &lt;= 0.05): False

Bio vs. SoS
p-value:   6.474696427603517e-14
Reject H0 (p-value &lt;= 0.05): True

EnS vs. EcFi
p-value:   8.151863146368181e-12
Reject H0 (p-value &lt;= 0.05): True

EnS vs. SoS
p-value:   0.0055758247214054745
Reject H0 (p-value &lt;= 0.05): True

EcFi vs. SoS
p-value:   7.145673135006304e-12
Reject H0 (p-value &lt;= 0.05): True
</pre></div>
</div>
</div>
</div>
<p>Der paarweise <span class="math notranslate nohighlight">\(t\)</span>-Test zeigt, dass bei einem Signifikanzniveau von <span class="math notranslate nohighlight">\(5 \%\)</span> die Mittelwerte für <span class="math notranslate nohighlight">\(5\)</span> Kombinationen <strong>nicht</strong> statistisch signifikant unterschiedlich sind. Diese Kombinationen sind Bio-EcFi, Bio-MaSt, EcFi-MaSt, EnS-PoS, PoS-SoS mit <span class="math notranslate nohighlight">\(p\)</span>-Werten von <span class="math notranslate nohighlight">\(0,5128\)</span>, <span class="math notranslate nohighlight">\(0,2396\)</span>, <span class="math notranslate nohighlight">\(0,61396\)</span> , <span class="math notranslate nohighlight">\(0,1202\)</span> , <span class="math notranslate nohighlight">\(0,635057\)</span> bzw. <span class="math notranslate nohighlight">\(0,230977\)</span>. Für die restlichen <span class="math notranslate nohighlight">\(10\)</span> Kombinationen verwerfen wir <span class="math notranslate nohighlight">\(H_0\)</span>; d. h. für <span class="math notranslate nohighlight">\(10\)</span> Kombinationen sind die Mittelwerte bei einem Signifikanzniveau von <span class="math notranslate nohighlight">\(5 \%\)</span> unterschiedlich!</p>
<p>Zweitens führen wir einen <strong>paarweisen <span class="math notranslate nohighlight">\(t\)</span>-Test mit der Bonferroni-Anpassung</strong> durch.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bonf</span> <span class="o">=</span> <span class="n">bonferroni</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">major</span><span class="o">.</span><span class="n">nunique</span><span class="p">())</span>
<span class="n">bonf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0033333333333333335
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">major1</span><span class="p">,</span> <span class="n">major2</span> <span class="ow">in</span> <span class="n">major</span><span class="p">:</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">ttest_ind</span><span class="p">(</span>
        <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;major&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">major1</span><span class="p">,</span> <span class="s2">&quot;salary&quot;</span><span class="p">],</span>
        <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;major&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">major2</span><span class="p">,</span> <span class="s2">&quot;salary&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">major1</span><span class="si">}</span><span class="s2"> vs. </span><span class="si">{</span><span class="n">major2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value:   </span><span class="si">{</span><span class="n">p_value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reject H0 (p-value &lt;= </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">bonf</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">p_value</span> <span class="o">&lt;=</span> <span class="n">bonf</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MaSt vs. PoS
p-value:   5.285766661005193e-11
Reject H0 (p-value &lt;= 0.00333): True

MaSt vs. Bio
p-value:   0.23955822802713908
Reject H0 (p-value &lt;= 0.00333): False

MaSt vs. EnS
p-value:   2.873918020813552e-10
Reject H0 (p-value &lt;= 0.00333): True

MaSt vs. EcFi
p-value:   0.6139625494797094
Reject H0 (p-value &lt;= 0.00333): False

MaSt vs. SoS
p-value:   1.0518797210598569e-10
Reject H0 (p-value &lt;= 0.00333): True

PoS vs. Bio
p-value:   4.8406921036979525e-15
Reject H0 (p-value &lt;= 0.00333): True

PoS vs. EnS
p-value:   0.12016488500152636
Reject H0 (p-value &lt;= 0.00333): False

PoS vs. EcFi
p-value:   2.6490333956019106e-12
Reject H0 (p-value &lt;= 0.00333): True

PoS vs. SoS
p-value:   0.230977569202981
Reject H0 (p-value &lt;= 0.00333): False

Bio vs. EnS
p-value:   1.7902286073326123e-14
Reject H0 (p-value &lt;= 0.00333): True

Bio vs. EcFi
p-value:   0.5127687451099829
Reject H0 (p-value &lt;= 0.00333): False

Bio vs. SoS
p-value:   6.474696427603517e-14
Reject H0 (p-value &lt;= 0.00333): True

EnS vs. EcFi
p-value:   8.151863146368181e-12
Reject H0 (p-value &lt;= 0.00333): True

EnS vs. SoS
p-value:   0.0055758247214054745
Reject H0 (p-value &lt;= 0.00333): False

EcFi vs. SoS
p-value:   7.145673135006304e-12
Reject H0 (p-value &lt;= 0.00333): True
</pre></div>
</div>
</div>
</div>
<p>Der paarweise <span class="math notranslate nohighlight">\(t\)</span>-Test mit der Bonferroni-Anpassung zeigt, dass bei einem Signifikanzniveau von <span class="math notranslate nohighlight">\(5 \%\)</span> die Mittelwerte für <span class="math notranslate nohighlight">\(6\)</span> Kombinationen nicht statistisch signifikant unterschiedlich sind. Bei diesen Kombinationen handelt es sich um Bio-EcFi, Bio-MaSt, EcFi-MaSt, EnS-PoS, PoS-SoS, EnS-SoS mit <span class="math notranslate nohighlight">\(p\)</span>-Werten von <span class="math notranslate nohighlight">\(0,5128\)</span>, <span class="math notranslate nohighlight">\(0,2396\)</span>, <span class="math notranslate nohighlight">\(0,61397\)</span>, <span class="math notranslate nohighlight">\(0,1202\)</span>, <span class="math notranslate nohighlight">\(0,230978\)</span> bzw. <span class="math notranslate nohighlight">\(0,00558\)</span>. (beim Bonferroni-Verfahren wird <span class="math notranslate nohighlight">\(\alpha\)</span> durch die Anzahl der Tests geteilt bzw. der <span class="math notranslate nohighlight">\(p\)</span>-Wert mit dieser Anzahl multipliziert und auf <span class="math notranslate nohighlight">\(1\)</span> gekürzt, wenn das Ergebnis über <span class="math notranslate nohighlight">\(1\)</span> liegt und somit keine Wahrscheinlichkeit darstellt). Für die verbleibenden <span class="math notranslate nohighlight">\(9\)</span> Kombinationen haben wir <span class="math notranslate nohighlight">\(H_0\)</span> abgelehnt, d. h. für <span class="math notranslate nohighlight">\(9\)</span> Kombinationen sind die Mittelwerte bei einem Signifikanzniveau von <span class="math notranslate nohighlight">\(\approx 0,0067 \%\)</span> unterschiedlich!</p>
</section>
<section id="tukey-mehrfach-vergleichsmethode">
<h4>Tukey-Mehrfach-Vergleichsmethode<a class="headerlink" href="#tukey-mehrfach-vergleichsmethode" title="Permalink to this headline">#</a></h4>
<p>Der <a href="https://de.wikipedia.org/wiki/Post-hoc-Test#Tukey-Test">Tukey-Test</a>, auch bekannt als <strong>Tukey’s HSD-Test (honest significant difference)</strong>, basiert auf der <a href="https://de.wikipedia.org/wiki/Studentisierung">studentized range-Verteilung</a>, die manchmal auch als <span class="math notranslate nohighlight">\(q\)</span>-Verteilung bezeichnet wird. Die <strong><span class="math notranslate nohighlight">\(q\)</span>-Verteilung</strong> ist eine rechtsschiefe Wahrscheinlichkeitsdichtekurve mit zwei Parametern, <span class="math notranslate nohighlight">\(\kappa\)</span> und <span class="math notranslate nohighlight">\(\nu\)</span>, die ihre Form beschreiben. Diese Parameter sind gegeben durch</p>
<div class="math notranslate nohighlight">
\[\kappa = k\]</div>
<p>und</p>
<div class="math notranslate nohighlight">
\[\nu = n-k\text{,}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(n\)</span> die Gesamtzahl der Beobachtungen ist und <span class="math notranslate nohighlight">\(k\)</span> die Anzahl der Gruppen/Klassen.</p>
<p>Der Tukey-Test vergleicht die Mittelwerte jeder Gruppe mit den Mittelwerten jeder anderen Gruppe. Er liefert das Konfidenzintervall für jedes</p>
<div class="math notranslate nohighlight">
\[\mu_i-\mu_j\text{.}\]</div>
<p>Wenn das Konfidenzintervall für einen paarweisen Vergleich <span class="math notranslate nohighlight">\(0\)</span> einschließt, wird <span class="math notranslate nohighlight">\(H_0\)</span> nicht verworfen, es wird nicht angenommen, dass sie signifikant unterschiedlich sind. Alle anderen Paare, für die das Konfidenzintervall nicht <span class="math notranslate nohighlight">\(0\)</span> einschließt, sind signifikant unterschiedlich, <span class="math notranslate nohighlight">\(H_0\)</span> wird also verworfen.</p>
</section>
<section id="tukey-s-test-in-python">
<h4>Tukey’s Test in Python<a class="headerlink" href="#tukey-s-test-in-python" title="Permalink to this headline">#</a></h4>
<p>In Python werden Tukey’s HSD Tests durch die <code class="docutils literal notranslate"><span class="pre">pairwise_tukeyhsd()</span></code> Funktion berechnet. Die <code class="docutils literal notranslate"><span class="pre">pairwise_tukeyhsd()</span></code>-Funktion erwartet als Eingabe <code class="docutils literal notranslate"><span class="pre">endog</span></code>, die zu vergleichende Größe und <code class="docutils literal notranslate"><span class="pre">groups</span></code> die Aufteilung der Gruppen. Um die Breite der Konfidenzintervalle festzulegen, geben wir der Funktion das Konfidenzniveau mit dem Argument <code class="docutils literal notranslate"><span class="pre">alpha</span></code> an.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tukey&#39;s test ausführen</span>
<span class="n">tukey</span> <span class="o">=</span> <span class="n">pairwise_tukeyhsd</span><span class="p">(</span><span class="n">endog</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;salary&quot;</span><span class="p">],</span> <span class="n">groups</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;major&quot;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">tukey</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>Multiple Comparison of Means - Tukey HSD, FWER=0.05</caption>
<tr>
  <th>group1</th> <th>group2</th>  <th>meandiff</th>    <th>p-adj</th>    <th>lower</th>       <th>upper</th>    <th>reject</th>
</tr>
<tr>
    <td>Bio</td>   <td>EcFi</td>  <td>-1012.3074</td>   <td>0.983</td> <td>-5228.5838</td>   <td>3203.969</td>    <td>False</td>
</tr>
<tr>
    <td>Bio</td>    <td>EnS</td>  <td>-11777.6591</td>   <td>0.0</td>  <td>-15810.771</td>  <td>-7744.5472</td>   <td>True</td> 
</tr>
<tr>
    <td>Bio</td>   <td>MaSt</td>  <td>-1846.3676</td>  <td>0.8039</td> <td>-6036.7579</td>   <td>2344.0227</td>   <td>False</td>
</tr>
<tr>
    <td>Bio</td>    <td>PoS</td>  <td>-13913.1332</td>   <td>0.0</td>  <td>-18078.5881</td> <td>-9747.6782</td>   <td>True</td> 
</tr>
<tr>
    <td>Bio</td>    <td>SoS</td>  <td>-16091.4847</td>   <td>0.0</td>  <td>-21100.6999</td> <td>-11082.2695</td>  <td>True</td> 
</tr>
<tr>
   <td>EcFi</td>    <td>EnS</td>  <td>-10765.3517</td>   <td>0.0</td>  <td>-15067.6405</td> <td>-6463.0629</td>   <td>True</td> 
</tr>
<tr>
   <td>EcFi</td>   <td>MaSt</td>   <td>-834.0602</td>  <td>0.9946</td> <td>-5284.1241</td>   <td>3616.0036</td>   <td>False</td>
</tr>
<tr>
   <td>EcFi</td>    <td>PoS</td>  <td>-12900.8257</td>   <td>0.0</td>  <td>-17327.4172</td> <td>-8474.2343</td>   <td>True</td> 
</tr>
<tr>
   <td>EcFi</td>    <td>SoS</td>  <td>-15079.1773</td>   <td>0.0</td>  <td>-20307.5551</td> <td>-9850.7995</td>   <td>True</td> 
</tr>
<tr>
    <td>EnS</td>   <td>MaSt</td>   <td>9931.2915</td>    <td>0.0</td>   <td>5654.3682</td>  <td>14208.2148</td>   <td>True</td> 
</tr>
<tr>
    <td>EnS</td>    <td>PoS</td>   <td>-2135.474</td>  <td>0.7016</td> <td>-6387.9695</td>   <td>2117.0214</td>   <td>False</td>
</tr>
<tr>
    <td>EnS</td>    <td>SoS</td>  <td>-4313.8256</td>  <td>0.1475</td>  <td>-9395.65</td>    <td>767.9988</td>    <td>False</td>
</tr>
<tr>
   <td>MaSt</td>    <td>PoS</td>  <td>-12066.7655</td>   <td>0.0</td>  <td>-16468.7078</td> <td>-7664.8232</td>   <td>True</td> 
</tr>
<tr>
   <td>MaSt</td>    <td>SoS</td>  <td>-14245.1171</td>   <td>0.0</td>  <td>-19452.6422</td> <td>-9037.5919</td>   <td>True</td> 
</tr>
<tr>
    <td>PoS</td>    <td>SoS</td>  <td>-2178.3516</td>   <td>0.834</td> <td>-7365.8329</td>   <td>3009.1297</td>   <td>False</td>
</tr>
</table></div></div>
</div>
<p>Bitte beachten Sie, dass wir im Fall ohne <span class="math notranslate nohighlight">\(p\)</span>-Wert-Anpassung die Nullhypothese für <span class="math notranslate nohighlight">\(10\)</span> Kombinationen abgelehnt haben. Beim paarweisen <span class="math notranslate nohighlight">\(t\)</span>-Test mit der Tukey-Anpassung wurde die Nullhypothese für <span class="math notranslate nohighlight">\(9\)</span> Kombinationen verworfen.</p>
<p>Die Tabelle zeigt die Differenz zwischen den einzelnen Paaren, die <span class="math notranslate nohighlight">\(95 \%\)</span>-Konfidenzintervalle und den <span class="math notranslate nohighlight">\(p\)</span>-Wert der paarweisen Vergleiche. Schauen Sie sich die Tabelle genau an, und Sie werden sehen, dass für alle <span class="math notranslate nohighlight">\(6\)</span> Vergleiche, bei denen das Konfidenzintervall <span class="math notranslate nohighlight">\(0\)</span> einschließt, der <span class="math notranslate nohighlight">\(p\)</span>-Wert höher ist als das Signifikanzniveau <span class="math notranslate nohighlight">\(\alpha\)</span>. Wenn <span class="math notranslate nohighlight">\(p \gt \alpha\)</span> ist, verwerfen wir <span class="math notranslate nohighlight">\(H_0\)</span> nicht, d. h. es gibt keinen statistisch signifikanten Unterschied zwischen den Mittelwerten dieser beiden Gruppen. Für alle Paare, bei denen <span class="math notranslate nohighlight">\(p \le \alpha\)</span> ist, verwerfen wir dagegen <span class="math notranslate nohighlight">\(H_0\)</span> und stellen fest, dass ein statistisch signifikanter Unterschied zwischen den Mittelwerten dieser Paare besteht. Die <code class="docutils literal notranslate"><span class="pre">tukey.plot_simultaneous()</span></code>-Funktion bietet eine nette Plot-Funktion, die die Konfidenzintervalle für jedes Paar visualisiert.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">tukey</span><span class="o">.</span><span class="n">plot_simultaneous</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/01_Analyse_der_Varianz_ANOVA_163_0.png" src="_images/01_Analyse_der_Varianz_ANOVA_163_0.png" />
</div>
</div>
</section>
</section>
</section>
<span id="document-Aufgaben/Kapitel07/Aufgaben"></span><section class="tex2jax_ignore mathjax_ignore" id="ubungsaufgaben">
<h2>Übungsaufgaben<a class="headerlink" href="#ubungsaufgaben" title="Permalink to this headline">#</a></h2>
<div class="toctree-wrapper compound">
<span id="document-Aufgaben/Kapitel07/ANOVA_basics"></span><section class="tex2jax_ignore mathjax_ignore" id="einfaktorielle-anova-grundbegriffe">
<h3>Einfaktorielle ANOVA Grundbegriffe<a class="headerlink" href="#einfaktorielle-anova-grundbegriffe" title="Permalink to this headline">#</a></h3>
<p>Beschreiben Sie die Grundlagen der einfaktoriellen ANOVA.</p>
<ol class="simple">
<li><p>Wonach kann mittels ANOVA getestet werden? Nennen Sie mögliche praktische Anwendungen in der Wissenschaft.</p></li>
<li><p>Welche Bedingungen müssen für das Durchführen einer ANOVA gegeben sein?</p></li>
<li><p>Was sind die Einschränkungungen einer ANOVA?</p></li>
</ol>
<hr class="docutils" />
<section id="losungen">
<h4>Lösungen<a class="headerlink" href="#losungen" title="Permalink to this headline">#</a></h4>
<div class="toggle docutils container">
<ul class="simple">
<li><p>Es kann einerseits darauf getestet werden ob drei oder mehr Gruppen sich in einem Grundgesamtheitsparameter unterscheiden. Man misst dieselbe abhängige Variable für unterschiedliche unabhängige Gruppen und überprüft, anhand des mittels <span class="math notranslate nohighlight">\(F\)</span>-Teststatistik errechneten <span class="math notranslate nohighlight">\(p\)</span>-Werts, ob sich mindestens eine dieser Gruppen statistisch voneinander unterscheiden.</p></li>
<li><p>Mögliche Anwendungen für ANOVA sind Experimente mit Test- und Kontrollgruppen mit der Zielsetzung zu überprüfen ob ein Effekt in der Testgruppe eintritt. Dieses Versuchsdesign findet sich in vielen verschiedenen Bereichen wieder, vor allem aber in der Experimentalpsychologie, Wirtschaftswissenschaften und Medizin.</p></li>
</ul>
</div>
<div class="toggle docutils container">
<p>Folgende Bedingungen müssen für die ANOVA erfüllt sein:</p>
<ol class="simple">
<li><p>Die abhängige Variable (Zielgröße) muß metrisch skalieren.</p></li>
<li><p>Die Zielgröße der Grundgesamtheit sollte ungefähr normalverteilt sein.</p></li>
<li><p>Die Aufteilung in Gruppen durch mindestens eine unabhängige Variable (Faktor) muß möglich sein.</p></li>
<li><p>Die Vergleichsgruppen müssen unabhängige Zufallsstichproben sein.</p></li>
<li><p>Die Vergleichsgruppen sollten in etwa gleiche Varianzen haben.</p></li>
</ol>
<p>(<span id="id1">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.485)</p>
</div>
<div class="toggle docutils container">
<p>Die einfaktorielle ANOVA ist ein Omnibus-Verfahren. Daher kann der errechnete <span class="math notranslate nohighlight">\(p\)</span>-Wert nur aussagen ob sich eine oder mehrere der Gruppen statistisch signifikant von den anderen unterscheiden, aber nicht welche Gruppen.</p>
</div>
</section>
</section>
<span id="document-Aufgaben/Kapitel07/Einfache_ANOVA"></span><section class="tex2jax_ignore mathjax_ignore" id="einfaktorielle-anova">
<h3>Einfaktorielle ANOVA<a class="headerlink" href="#einfaktorielle-anova" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">seed</span>
<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">normal</span>

<span class="kn">import</span> <span class="nn">pylab</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">t</span>

<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">uniform</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">f_oneway</span>
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>Führen Sie jeweils eine schrittweise einfaktorielle Varianzanalyse für die folgenden Daten durch:</p></li>
</ol>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sample_dat1</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample_dat2</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample_dat3</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample_dat4</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample_dat5</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample_dat6</span></code></p></li>
</ul>
<p>\begin{array}{l}
\hline
\ \text{Schritt 1}  &amp; \text{Geben Sie die Nullhypothese } H_0 \text{ und alternative Hypothese } H_A \text{ an.}\
\ \text{Schritt 2}  &amp; \text{Legen Sie das Signifikanzniveau, } \alpha\text{ fest.} \
\ \text{Schritt 3}  &amp; \text{Berechnen Sie den Wert der Teststatistik.} \
\ \text{Schritt 4} &amp;\text{Bestimmen Sie den p-Wert.} \
\ \text{Schritt 5} &amp; \text{Wenn }p\le \alpha \text{, } H_0 \text{ ablehnen } \text{; ansonsten } H_0 \text{ nicht ablehnen} \text{.} \
\ \text{Schritt 6} &amp;\text{Interpretieren Sie das Ergebnis des Hypothesentests.} \
\hline
\end{array}</p>
<ul class="simple">
<li><p>Benutzen Sie für Schritte <span class="math notranslate nohighlight">\(3\)</span> und <span class="math notranslate nohighlight">\(4\)</span> die Funktion <code class="docutils literal notranslate"><span class="pre">f_oneway()</span></code> die Sie mit <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">scipy.stats</span> <span class="pre">import</span> <span class="pre">f_oneway</span></code> importieren können</p></li>
</ul>
<ol class="simple">
<li><p>Interpretieren Sie das Ergebnis</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span><span class="p">,</span> <span class="n">t</span>

<span class="n">rs</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">sample_dat1</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">rs</span><span class="p">)</span>
<span class="n">sample_dat2</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">rs</span><span class="p">)</span>
<span class="n">sample_dat3</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=-</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">28</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">rs</span><span class="p">)</span>
<span class="n">sample_dat4</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="mi">33</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">34</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">rs</span><span class="p">)</span>
<span class="n">sample_dat5</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="mi">26</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.22</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">27</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">rs</span><span class="p">)</span>
<span class="n">sample_dat6</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">rs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 1 ...</span>
</pre></div>
</div>
</div>
</div>
<section id="losungen">
<h4>Lösungen<a class="headerlink" href="#losungen" title="Permalink to this headline">#</a></h4>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">f_oneway</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">statistics</span><span class="p">,</span> <span class="n">pvalue</span> <span class="o">=</span> <span class="n">f_oneway</span><span class="p">(</span>
    <span class="n">sample_dat1</span><span class="p">,</span> <span class="n">sample_dat2</span><span class="p">,</span> <span class="n">sample_dat3</span><span class="p">,</span> <span class="n">sample_dat4</span><span class="p">,</span> <span class="n">sample_dat5</span><span class="p">,</span> <span class="n">sample_dat6</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wert der F-Statistik: </span><span class="si">{</span><span class="n">statistics</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-Wert: </span><span class="si">{</span><span class="n">pvalue</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">pvalue</span> <span class="o">&lt;</span> <span class="n">alpha</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Wert der F-Statistik: 5.127927927390613
p-Wert: 0.00021443138104738042
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="toggle docutils container">
<p>Basierend auf den vorliegenden Daten zeigt die ANOVA einen signifikanten Unterschied zwischen den Datensätzen. Wir verwerfen also die Null-Hypothese.</p>
</div>
</section>
</section>
<span id="document-Aufgaben/Kapitel07/Bonferroni"></span><section class="tex2jax_ignore mathjax_ignore" id="bonferroni-korrektur">
<h3>Bonferroni Korrektur<a class="headerlink" href="#bonferroni-korrektur" title="Permalink to this headline">#</a></h3>
<ol class="simple">
<li><p>Führen Sie einen post-hoc Mehrfachhypothesentests mit den Datensätzen <code class="docutils literal notranslate"><span class="pre">sample_dat1</span></code>, <code class="docutils literal notranslate"><span class="pre">sample_dat2</span></code> und <code class="docutils literal notranslate"><span class="pre">sample_dat3</span></code> durch um zu bestimmen welcher Datensatz sich von den anderen unterscheidet. Berechnen Sie hierfür die Bonferroni Korrektur bei einen <span class="math notranslate nohighlight">\(\alpha=0.05\)</span>.
Die Bonferroni Korrektur ergibt sich zu:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\alpha = \frac{\alpha}{m}\text{,}\]</div>
<div class="math notranslate nohighlight">
\[m=\frac{k(k-1)}{2}\text{,}\]</div>
<div class="math notranslate nohighlight">
\[\alpha = \frac{0,05}{3}\]</div>
<ol class="simple">
<li><p>Interpretieren Sie das Ergebnos</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span><span class="p">,</span> <span class="n">t</span>

<span class="n">rs</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">sample_dat1</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="mi">33</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">34</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">rs</span><span class="p">)</span>
<span class="n">sample_dat2</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="mi">26</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.22</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">27</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">rs</span><span class="p">)</span>
<span class="n">sample_dat3</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">rs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 1 ...</span>
</pre></div>
</div>
</div>
</div>
<section id="losungen">
<h4>Lösungen<a class="headerlink" href="#losungen" title="Permalink to this headline">#</a></h4>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">ttest_ind</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">bonf</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">/</span> <span class="n">m</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bonferroni Korrektur: </span><span class="si">{</span><span class="n">bonf</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">combinations</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="n">sample_dat1</span><span class="p">,</span> <span class="n">sample_dat2</span><span class="p">),</span>
    <span class="p">(</span><span class="n">sample_dat1</span><span class="p">,</span> <span class="n">sample_dat3</span><span class="p">),</span>
    <span class="p">(</span><span class="n">sample_dat2</span><span class="p">,</span> <span class="n">sample_dat3</span><span class="p">),</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">combination</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">:</span>
    <span class="n">statistics</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">ttest_ind</span><span class="p">(</span><span class="n">combination</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">combination</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reject H0: </span><span class="si">{</span><span class="n">p_value</span> <span class="o">&lt;=</span> <span class="n">bonf</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bonferroni Korrektur: 0.016666666666666666
Reject H0: False
Reject H0: True
Reject H0: False
</pre></div>
</div>
</div>
</div>
<div class="toggle docutils container">
<p>Der Mehrfachvergleich ergibt für <code class="docutils literal notranslate"><span class="pre">sample_dat1</span></code> und <code class="docutils literal notranslate"><span class="pre">sample_dat3</span></code> einen signifikanten Unterschiede bei Bonferroni korrigiertem <span class="math notranslate nohighlight">\(\alpha_B = \frac{0,05}{3}\)</span>.</p>
</div>
</section>
</section>
</div>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-Lernziele/Kapitel8_Lernziele"></span><section class="tex2jax_ignore mathjax_ignore" id="lernziele">
<h2>Lernziele<a class="headerlink" href="#lernziele" title="Permalink to this headline">#</a></h2>
<section id="lineare-regression">
<h3>Lineare Regression<a class="headerlink" href="#lineare-regression" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Die Grundbegriffe der linearen Regression werden erläutert und anhand des probabilistischen Modells der linearen Einfachregression, <span class="math notranslate nohighlight">\(y = a + b x + \epsilon\)</span> veranschaulicht</p></li>
<li><p>Am Beispiel des Anscombe Datensatzes werden Methoden der Regressionsdiagnostik zur Bewertung und Auswahl von Modellen wie : Bestimmtheitsmaß , Methode der gewöhnlichen kleinsten Quadrate und RMSE besprochen</p></li>
<li><p>Weiters werden Methoden zum Umgang mit Hebelpunkten und Ausreißern behandelt</p></li>
<li><p>Schließlich wird die Polynomiale Regression als Erweiterung zur linearen Regression vorgestellt</p></li>
<li><p>Zusammengefasst werden folgende Begriffe und Methoden besprochen : Lineare Regression , Lineare Einfachregression , Parameterschätzung - Methode der gewöhnlichen kleinsten Quadrate , Modelldiagnose , Regressionsdiagnostik , Anscombe-Quartett , Bestimmtheitsmaß , Hebelpunkte und Ausreißer , Multiple lineare Regression - Polynomiale Regression</p></li>
</ul>
</section>
</section>
<span id="document-Kapitel08/01_Lineare_Regression"></span><section class="tex2jax_ignore mathjax_ignore" id="lineare-regression">
<h2>Lineare Regression<a class="headerlink" href="#lineare-regression" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">linregress</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
</pre></div>
</div>
</div>
</div>
<p>Die <a href="https://de.wikipedia.org/wiki/Regressionsanalyse">Regressionsanalyse</a> ist ein statistisches Verfahren zur Schätzung der Beziehungen zwischen zwei oder mehr Variablen. Die Beziehung wird als <span class="math notranslate nohighlight">\(y \sim x\)</span> oder <span class="math notranslate nohighlight">\(y=f(x)\)</span> modelliert. Beide Modellbeschreibungen besagen, dass die Variable <span class="math notranslate nohighlight">\(y\)</span> eine Funktion von <span class="math notranslate nohighlight">\(x\)</span> ist. Daher wird die Variable <span class="math notranslate nohighlight">\(y\)</span> als <strong>Antwortvariable</strong> oder <strong>abhängige Variable</strong> bezeichnet, während die Variable <span class="math notranslate nohighlight">\(x\)</span> als <strong>Prädikatorvariable</strong> oder <strong>unabhängige Variable</strong> bezeichnet wird.</p>
<section id="einfache-lineare-regression">
<h3>Einfache lineare Regression<a class="headerlink" href="#einfache-lineare-regression" title="Permalink to this headline">#</a></h3>
<p>In diesem Abschnitt wird eine spezielle Art der Regression behandelt, die als <a href="https://de.wikipedia.org/wiki/Lineare_Einfachregression">einfache lineare Regression</a> bezeichnet wird. In diesem speziellen Fall der Regressionsanalyse wird die Beziehung zwischen der Antwortvariablen <span class="math notranslate nohighlight">\(y\)</span> und der Prädikatorvariablen <span class="math notranslate nohighlight">\(x\)</span> in Form einer <strong>linearen</strong> Gleichung dargestellt</p>
<div class="math notranslate nohighlight">
\[y= a + bx\text{,}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(a\)</span> und <span class="math notranslate nohighlight">\(b\)</span> Konstanten sind. Die Zahl <span class="math notranslate nohighlight">\(a\)</span> wird als <strong>Achsenabschnitt</strong> bezeichnet und definiert den Schnittpunkt der Regressionslinie mit der <span class="math notranslate nohighlight">\(y\)</span>-Achse (<span class="math notranslate nohighlight">\(x=0\)</span>). Die Zahl <span class="math notranslate nohighlight">\(b\)</span> wird als <strong>Regressionskoeffizient</strong> bezeichnet. Er ist ein Maß für die Steigung der <strong>Regressionsgeraden</strong>. So gibt <span class="math notranslate nohighlight">\(b\)</span> an, um wie viel sich der <span class="math notranslate nohighlight">\(y\)</span>-Wert ändert, wenn sich der <span class="math notranslate nohighlight">\(x\)</span>-Wert um <span class="math notranslate nohighlight">\(1\)</span> Einheit erhöht. Das Adjektiv <strong>einfach</strong> bezieht sich auf die Tatsache, dass die Ergebnisvariable mit einem einzigen Vorhersagewert verknüpft ist. Das Modell wird als <strong>deterministisches Modell</strong> betrachtet, da es eine genaue Beziehung zwischen <span class="math notranslate nohighlight">\(x\)</span> und <span class="math notranslate nohighlight">\(y\)</span> herstellt.</p>
<p>Lassen Sie uns ein einfaches Beispiel betrachten. Gegeben ist eine Grundgesamtheit von <span class="math notranslate nohighlight">\(n=3\)</span> Punkten mit kartesischen Koordinaten (<span class="math notranslate nohighlight">\(x_i,y_i\)</span>) von (<span class="math notranslate nohighlight">\(1,6\)</span>), (<span class="math notranslate nohighlight">\(2,8\)</span>) und (<span class="math notranslate nohighlight">\(3,10\)</span>). Diese Punkte liegen auf einer Geraden und können daher durch ein lineares Gleichungsmodell in der Form <span class="math notranslate nohighlight">\(y=a+bx\)</span> beschrieben werden, wobei der Schnittpunkt <span class="math notranslate nohighlight">\(a=4\)</span> und <span class="math notranslate nohighlight">\(b=2\)</span> ist.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">points</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">xy</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">xaxis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">xaxis</span> <span class="o">+</span> <span class="mi">4</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">xaxis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>

<span class="n">yaxis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">yaxis</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;$y = a + bx = 4 + 2x$&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">6.3</span><span class="p">),</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="mf">3.2</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.0125</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">dx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">dy</span><span class="o">=-</span><span class="mf">2.3</span><span class="p">,</span>
    <span class="n">head_width</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span>
    <span class="n">head_length</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="mf">0.0125</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">dx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">dy</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span>
    <span class="n">head_width</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span>
    <span class="n">head_length</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="mf">0.0125</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;$a=4$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;Zuhnahme um</span><span class="se">\n</span><span class="s2">1 Einheit&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">5.2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;Zuhnahme um</span><span class="se">\n</span><span class="s2">2 Einheiten (b=2)&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">3.35</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">8.2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Unabhängige Variable&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Abhängige Variable&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Abhängige Variable&#39;)
</pre></div>
</div>
<img alt="_images/01_Lineare_Regression_8_1.png" src="_images/01_Lineare_Regression_8_1.png" />
</div>
</div>
<p>In vielen Fällen ist die Beziehung zwischen zwei Variablen <span class="math notranslate nohighlight">\(x\)</span> und <span class="math notranslate nohighlight">\(y\)</span> jedoch nicht exakt. Das liegt daran, dass die Antwortvariable <span class="math notranslate nohighlight">\(y\)</span> von anderen unbekannten und/oder zufälligen Prozessen beeinflusst wird, die von der Prädikatorvariable <span class="math notranslate nohighlight">\(x\)</span> nicht vollständig erfasst werden. In einem solchen Fall liegen die Datenpunkte nicht auf einer Geraden. Die Daten können jedoch immer noch einer zugrunde liegenden linearen Beziehung folgen. Um diese Unbekannten zu berücksichtigen, wird der linearen Modellgleichung ein <strong>Zufallsfehlerterm</strong>, bezeichnet mit <span class="math notranslate nohighlight">\(\epsilon\)</span>, hinzugefügt, was im Gegensatz zum oben beschriebenen deterministischen Modell zu einem <strong>probabilistischen Modell</strong> führt.</p>
<div class="math notranslate nohighlight">
\[y = a + b x + \epsilon\]</div>
<p>wobei angenommen wird, dass der Fehlerterm <span class="math notranslate nohighlight">\(\epsilon_i\)</span> aus unabhängigen normalverteilten Werten besteht, <span class="math notranslate nohighlight">\(\epsilon_i \sim N(0,\sigma^2)\)</span>.</p>
<p>Bei der linearen Regressionsmodellierung werden folgende Annahmen über das Modell getroffen (<span id="id1">Fahrmeir <em>et al.</em> [<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">2016</a>]</span> s.439, <span id="id2">Frost [<a class="reference internal" href="intro.html#id12" title="Frost. Einfache lineare Regression - Die Grundlage für komplexe Regressionsmodelle verstehen. Springer, 2018.">2018</a>]</span>).</p>
<ul class="simple">
<li><p>Der zufällige Fehlerterm <span class="math notranslate nohighlight">\(\epsilon\)</span> hat für jedes <span class="math notranslate nohighlight">\(x\)</span> einen Mittelwert gleich Null.</p></li>
<li><p>Die mit verschiedenen Beobachtungen verbundenen Fehler sind unabhängig.</p></li>
<li><p>Für jedes gegebene <span class="math notranslate nohighlight">\(x\)</span> ist die Verteilung der Fehler normal.</p></li>
<li><p>Die Verteilung der Fehler für jedes <span class="math notranslate nohighlight">\(x\)</span> hat die gleiche (konstante) Standardabweichung, die mit <span class="math notranslate nohighlight">\(\sigma_\epsilon\)</span> bezeichnet wird.</p></li>
</ul>
<p>Betrachten wir ein weiteres Beispiel. Diesmal nehmen wir eine Zufallsstichprobe mit dem Stichprobenumfang <span class="math notranslate nohighlight">\(n=8\)</span> aus einer Grundgesamtheit. Um zu betonen, dass die Werte des Abschnitts und der Steigung aus Stichprobendaten berechnet werden, werden <span class="math notranslate nohighlight">\(a\)</span> und <span class="math notranslate nohighlight">\(b\)</span> mit <span class="math notranslate nohighlight">\(\beta_0\)</span> bzw. <span class="math notranslate nohighlight">\(\beta_1\)</span> bezeichnet. Außerdem wird der Fehlerterm <span class="math notranslate nohighlight">\(\epsilon\)</span> als <span class="math notranslate nohighlight">\(e\)</span> bezeichnet. <span class="math notranslate nohighlight">\(\beta_0\)</span>, <span class="math notranslate nohighlight">\(\beta_1\)</span> und <span class="math notranslate nohighlight">\(e\)</span> sind also Schätzungen auf der Grundlage von Stichprobendaten für die Grundgesamtheitsparameter <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span> und <span class="math notranslate nohighlight">\(\epsilon\)</span>.</p>
<div class="math notranslate nohighlight">
\[\hat y = \beta_0 + \beta_1 x + e \text{,}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(\hat y\)</span> der <strong>geschätzte oder vorhergesagte Wert</strong> von <span class="math notranslate nohighlight">\(y\)</span> für einen bestimmten Wert von <span class="math notranslate nohighlight">\(x\)</span> ist.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">b</span> <span class="o">=</span> <span class="mf">2.5</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>


<span class="k">for</span> <span class="n">xy</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">yhat</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># ax.plot((xy), (xy[0], yhat))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="p">(</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">yhat</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">xaxis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">regline</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">xaxis</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">regline</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;$\hat y = \beta_0 + \beta_1x$&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">headwidth</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">headlength</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;$(x_i, y_i)$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">2.9</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">17.8</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;$e_i = y_i - \hat y_1$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">1.6</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">13.8</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Unabhängige Variable&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Abhängige Variable&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Abhängige Variable&#39;)
</pre></div>
</div>
<img alt="_images/01_Lineare_Regression_15_1.png" src="_images/01_Lineare_Regression_15_1.png" />
</div>
</div>
<p>Der Fehler <span class="math notranslate nohighlight">\(e_i\)</span> für jedes einzelne Wertepaar (<span class="math notranslate nohighlight">\(x_i,y_i\)</span>), auch <strong>Residuum</strong> genannt, wird aus der Differenz zwischen dem beobachteten Wert <span class="math notranslate nohighlight">\(y_i\)</span> und dem durch <span class="math notranslate nohighlight">\(\hat{y}_i\)</span> gegebenen vorhergesagten Wert errechnet.</p>
<div class="math notranslate nohighlight">
\[e_i = y_i - \hat y_i\]</div>
<p>Je nach Datenlage ist <span class="math notranslate nohighlight">\(e_i\)</span> eine negative Zahl, wenn <span class="math notranslate nohighlight">\(y_i\)</span> unterhalb der Regressionslinie liegt, oder eine positive Zahl, wenn <span class="math notranslate nohighlight">\(y_i\)</span> oberhalb der Regressionslinie liegt.</p>
</section>
<section id="parameterschatzung-methode-der-gewohnlichen-kleinsten-quadrate-ols">
<h3>Parameterschätzung - Methode der gewöhnlichen kleinsten Quadrate (OLS)<a class="headerlink" href="#parameterschatzung-methode-der-gewohnlichen-kleinsten-quadrate-ols" title="Permalink to this headline">#</a></h3>
<p>Da wir nun die Beschränkungen des deterministischen Modells gelockert und einen Fehlerterm <span class="math notranslate nohighlight">\(\epsilon\)</span> eingeführt haben, stoßen wir auf ein weiteres Problem. Es gibt unendlich viele Regressionsgeraden, die die Spezifikationen des probabilistischen Modells erfüllen.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">b</span> <span class="o">=</span> <span class="mf">2.5</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">xaxis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="mi">3</span><span class="p">,</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="mi">5</span><span class="p">,</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="p">(</span><span class="n">__a</span><span class="p">,</span> <span class="n">__b</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">_a</span><span class="p">,</span> <span class="n">_b</span><span class="p">)):</span>
    <span class="n">regline</span> <span class="o">=</span> <span class="n">__a</span> <span class="o">+</span> <span class="n">__b</span> <span class="o">*</span> <span class="n">xaxis</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">regline</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;C</span><span class="si">{</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># [(6.161682980460268, 1.3593855069401755),</span>
<span class="c1">#  (0.8958678353055358, 3.5287158712720164),</span>
<span class="c1">#  (5.331259776126706, 2.3273786695000847)]</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\hat y = 0.90 + 3.53x+e$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\hat y = 5.336 + 2.33x+e$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">6.5</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\hat y = 6.16 + 1.36x+e$&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">6.5</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">28</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Unabhängige Variable&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Abhängige Variable&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Abhängige Variable&#39;)
</pre></div>
</div>
<img alt="_images/01_Lineare_Regression_21_1.png" src="_images/01_Lineare_Regression_21_1.png" />
</div>
</div>
<p>Offensichtlich brauchen wir eine Strategie, um diejenige Regressionsgerade auszuwählen, die das beste Modell zur Beschreibung der Daten darstellt. In diesem Abschnitt befassen wir uns mit einer der gängigsten Methoden zur Erfüllung dieser Aufgabe, der so genannten Methode der <a href="https://de.wikipedia.org/wiki/Methode_der_kleinsten_Quadrate">gewöhnlichen kleinsten Quadrate</a> (englisch ordinary least squares, kurz: <span class="math notranslate nohighlight">\(OLS\)</span>).</p>
<p>Wie im vorigen Abschnitt erwähnt, wird für jedes bestimmte Wertepaar (<span class="math notranslate nohighlight">\(x_1,y_1\)</span>)
wird der Fehler <span class="math notranslate nohighlight">\(e_i\)</span> durch <span class="math notranslate nohighlight">\(y_1-\hat y\)</span> berechnet. Um die beste Anpassungsgerade für die gegebenen Daten zu erhalten, wird die <strong>Summe der Fehlerquadrate</strong>, bezeichnet als <span class="math notranslate nohighlight">\(SSE\)</span>, minimiert.</p>
<div class="math notranslate nohighlight">
\[min\; SSE = \sum_{i=1}^n e_i^2=\sum_{i=1}^n (y - \hat y)^2\]</div>
<p>Für das einfache lineare Modell gibt es eine analytische Lösung für <span class="math notranslate nohighlight">\(\beta_1\)</span></p>
<div class="math notranslate nohighlight">
\[\hat{\beta_1} = \frac{\sum_{i=1}^n ((x_i- \bar x) (y_i-\bar y))}{\sum_{i=1}^n (x_i-\bar x)^2} = \frac{cov(x,y)}{var(x)}\text{,}\]</div>
<p>und <span class="math notranslate nohighlight">\(\beta_0\)</span>:</p>
<div class="math notranslate nohighlight">
\[\hat{\beta_0} = \bar y -\hat{\beta_1} \bar x\]</div>
<p>Die <span class="math notranslate nohighlight">\(OLS\)</span> liefert die Maximum-Likelihood-Schätzung für <span class="math notranslate nohighlight">\(\hat \beta\)</span>, wenn die Parameter die gleiche Varianz haben und unkorreliert sind und die Residuen <span class="math notranslate nohighlight">\(\epsilon\)</span> unkorreliert sind und einer Gaußschen Verteilung folgen (<a href="https://de.wikipedia.org/wiki/Homoskedastizit%C3%A4t_und_Heteroskedastizit%C3%A4t">Homoskedastizität</a>).</p>
</section>
<section id="einfache-lineare-regression-ein-beispiel">
<h3>Einfache lineare Regression - Ein Beispiel<a class="headerlink" href="#einfache-lineare-regression-ein-beispiel" title="Permalink to this headline">#</a></h3>
<p>Um einige praktische Erfahrungen zu sammeln, wenden wir die einfache lineare Regression in einer Übung an. Dazu laden wir den <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz. Sie können die Datei <code class="docutils literal notranslate"><span class="pre">students.csv</span></code> <a href="https://userpage.fu-berlin.de/soga/200/2010_data_sets/students.csv">hier</a> herunterladen. Importieren Sie den Datensatz und geben Sie ihm einen passenden Namen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lese Datei students.csv als Dataframe ein</span>
<span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../data/students.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Der <code class="docutils literal notranslate"><span class="pre">students</span></code> Datensatz besteht aus <span class="math notranslate nohighlight">\(8239\)</span> Zeilen, von denen jede einen bestimmten Studenten repräsentiert, und <span class="math notranslate nohighlight">\(16\)</span> Spalten, von denen jede einer Variable/einem Merkmal entspricht, das sich auf diesen bestimmten Studenten bezieht. Diese selbsterklärenden Variablen sind: <code class="docutils literal notranslate"><span class="pre">stud_id</span></code>, <code class="docutils literal notranslate"><span class="pre">name</span></code>, <code class="docutils literal notranslate"><span class="pre">gender</span></code>, <code class="docutils literal notranslate"><span class="pre">age</span></code>, <code class="docutils literal notranslate"><span class="pre">height</span></code>, <code class="docutils literal notranslate"><span class="pre">weight</span></code>, <code class="docutils literal notranslate"><span class="pre">religion</span></code>, <code class="docutils literal notranslate"><span class="pre">nc_score</span></code>, <code class="docutils literal notranslate"><span class="pre">semester</span></code>, <code class="docutils literal notranslate"><span class="pre">major</span></code>, <code class="docutils literal notranslate"><span class="pre">minor</span></code>, <code class="docutils literal notranslate"><span class="pre">score1</span></code>, <code class="docutils literal notranslate"><span class="pre">score2</span></code>, <code class="docutils literal notranslate"><span class="pre">online_tutorial</span></code>, <code class="docutils literal notranslate"><span class="pre">graduated</span></code>, <code class="docutils literal notranslate"><span class="pre">salary</span></code>.</p>
<p>Um die <strong>einfache lineare Regression</strong> zu veranschaulichen, untersuchen wir die Beziehung zwischen zwei Variablen, <code class="docutils literal notranslate"><span class="pre">height</span></code> der Studenten als Prädiktorvariable und <code class="docutils literal notranslate"><span class="pre">weight</span></code> der Studierenden als Antwortvariable.</p>
<section id="vorbereitung-der-daten">
<h4>Vorbereitung der Daten<a class="headerlink" href="#vorbereitung-der-daten" title="Permalink to this headline">#</a></h4>
<p>Zur Datenaufbereitung ziehen wir eine Zufallsstichprobe von <span class="math notranslate nohighlight">\(12\)</span> Studenten aus dem Datensatz und erstellen einen Datensatz mit den zwei Variablen von Interesse (<code class="docutils literal notranslate"><span class="pre">height</span></code> und <code class="docutils literal notranslate"><span class="pre">weight</span></code>). Außerdem stellen wir die Daten in Form eines Streudiagramms dar, um die zugrunde liegende lineare Beziehung zwischen den beiden Variablen zu visualisieren.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">students</span><span class="p">[[</span><span class="s2">&quot;weight&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x7f225cd58f10&gt;
</pre></div>
</div>
<img alt="_images/01_Lineare_Regression_36_1.png" src="_images/01_Lineare_Regression_36_1.png" />
</div>
</div>
<p>Die visuelle Inspektion bestätigt unsere Vermutung, dass die Beziehung zwischen der Größe und der Gewichtsvariable ungefähr linear ist. Mit anderen Worten: Mit zunehmender Größe neigt der einzelne Studierende dazu, ein höheres Gewicht zu haben.</p>
</section>
<section id="schatzung-der-parameter">
<h4>Schätzung der Parameter<a class="headerlink" href="#schatzung-der-parameter" title="Permalink to this headline">#</a></h4>
<section id="losen-fur-beta-0-und-beta-1-analytisch-in-python">
<h5>Lösen für <span class="math notranslate nohighlight">\(\beta_0\)</span> und <span class="math notranslate nohighlight">\(\beta_1\)</span> analytisch in Python<a class="headerlink" href="#losen-fur-beta-0-und-beta-1-analytisch-in-python" title="Permalink to this headline">#</a></h5>
<p>Wie im vorherigen Abschnitt gezeigt, können die Parameter <span class="math notranslate nohighlight">\(\beta_0\)</span> und <span class="math notranslate nohighlight">\(\beta_1\)</span> eines einfachen linearen Modells analytisch berechnet werden. Erinnern Sie sich an die Gleichung für ein lineares Modell aus Stichprobendaten</p>
<div class="math notranslate nohighlight">
\[\hat y = \beta_0 + \beta_1 x + e \text{,}\]</div>
<p>für <span class="math notranslate nohighlight">\(\beta_1\)</span></p>
<div class="math notranslate nohighlight">
\[\hat{\beta_1} = \frac{\sum_{i=1}^n ((x_i- \bar x) (y_i-\bar y))}{\sum_{i=1}^n (x_i-\bar x)^2} = \frac{cov(x,y)}{var(x)}\text{,}\]</div>
<p>und für <span class="math notranslate nohighlight">\(\beta_0\)</span></p>
<div class="math notranslate nohighlight">
\[\hat{\beta_0} = \bar y -\hat{\beta_1} \bar x\]</div>
<p>Zum besseren Verständnis verwenden wir Python, um die einzelnen Terme zu berechnen</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne b1</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
<span class="n">x_bar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">y_bar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="n">b1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">x_bar</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">y_bar</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">x_bar</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">b1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6507615230460924
</pre></div>
</div>
</div>
</div>
<p>Die Steigung des Regressionsmodells beträgt ungefähr <span class="math notranslate nohighlight">\(0,65\)</span>. Zur Überprüfung der Korrektheit berechnen wir das Verhältnis der Kovarianz von <span class="math notranslate nohighlight">\(x\)</span> und <span class="math notranslate nohighlight">\(y\)</span> mit der Funktion <code class="docutils literal notranslate"><span class="pre">cov()</span></code> und die Varianz von <span class="math notranslate nohighlight">\(x\)</span> mit der Funktion <code class="docutils literal notranslate"><span class="pre">var()</span></code> und vergleichen es mit dem Ergebnis von oben.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6507615230460924
</pre></div>
</div>
</div>
</div>
<p>Eine perfekte Übereinstimmung!</p>
<p>Weiter berechnen wir <span class="math notranslate nohighlight">\(\beta_0\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne b0</span>
<span class="n">b0</span> <span class="o">=</span> <span class="n">y_bar</span> <span class="o">-</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">x_bar</span>
<span class="n">b0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-39.443206412825674
</pre></div>
</div>
</div>
</div>
<p>Der Achsenabschnitt <span class="math notranslate nohighlight">\(\beta_0\)</span> des Regressionsmodells beträgt ungefähr <span class="math notranslate nohighlight">\(-39,44\)</span>.</p>
<p>Wir können also das Regressionsmodell aufschreiben</p>
<div class="math notranslate nohighlight">
\[\text{Gewicht} = -39,44 + 0,65 \times \text{Höhe}\]</div>
<p>Auf der Grundlage dieser Gleichung können wir nun das Gewicht eines Studenten anhand seiner Größe bestimmen. Lassen Sie uns zum Spaß das Gewicht von Studierenden mit einer Größe von <span class="math notranslate nohighlight">\(156\)</span>, <span class="math notranslate nohighlight">\(178\)</span> und <span class="math notranslate nohighlight">\(192\)</span> cm vorhersagen.</p>
<div class="math notranslate nohighlight">
\[\text{Gewicht}_{156} = -39,44 + 0,65 \times \text{156} \approx 62 \ \text{kg}\]</div>
<div class="math notranslate nohighlight">
\[\text{Gewicht}_{178} = -39,44 + 0,65 \times \text{178} \approx 76 \ \text{kg}\]</div>
<div class="math notranslate nohighlight">
\[\text{Gewicht}_{192} = -39,44 + 0,65 \times \text{192} \approx 85 \ \text{kg}\]</div>
</section>
<section id="verwenden-sie-die-funktion-linregress-bzw-ols-in-python-um-beta-0-zu-berechnen-und-beta-1">
<h5>Verwenden Sie die Funktion <code class="docutils literal notranslate"><span class="pre">linregress()</span></code> bzw <code class="docutils literal notranslate"><span class="pre">OLS()</span></code> in Python, um <span class="math notranslate nohighlight">\(\beta_0\)</span> zu berechnen und <span class="math notranslate nohighlight">\(\beta_1\)</span><a class="headerlink" href="#verwenden-sie-die-funktion-linregress-bzw-ols-in-python-um-beta-0-zu-berechnen-und-beta-1" title="Permalink to this headline">#</a></h5>
<p>Zum einen können wir die Funktion <code class="docutils literal notranslate"><span class="pre">linregress()</span></code> nutzen um <span class="math notranslate nohighlight">\(\beta_0\)</span> und <span class="math notranslate nohighlight">\(\beta_1\)</span> zu berechnen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gradient</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">stderr</span> <span class="o">=</span> <span class="n">linregress</span><span class="p">(</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;beta_0 = </span><span class="si">{</span><span class="n">intercept</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;beta_1 = </span><span class="si">{</span><span class="n">gradient</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>beta_0 = -39.44320641282566
beta_1 = 0.6507615230460922
</pre></div>
</div>
</div>
</div>
<p>Eine andere Möglichkeit ist es das Paket <a class="reference external" href="https://www.statsmodels.org/stable/index.html"><code class="docutils literal notranslate"><span class="pre">statsmodels</span></code></a> und die Funktion <code class="docutils literal notranslate"><span class="pre">OLS()</span></code> zu nutzen, die zusätzlich zur Berechnung von <span class="math notranslate nohighlight">\(\beta_0 , \beta_1\)</span> viele weitere Möglichkeiten bietet</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="n">model</span><span class="o">.</span><span class="n">params</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>const    -39.443206
height     0.650762
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Die Ausgabe über die Methode <code class="docutils literal notranslate"><span class="pre">params</span></code> liefert den Achsenabschnitt und den Regressionskoeffizienten. Weiters kann die Methode <code class="docutils literal notranslate"><span class="pre">summary()</span></code> nützlich sein, wenn Sie auf andere Eigenschaft des Modellobjekts zugreifen möchten.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/imarevic/.local/lib/python3.10/site-packages/scipy/stats/_stats_py.py:1477: UserWarning: kurtosistest only valid for n&gt;=20 ... continuing anyway, n=12
  warnings.warn(&quot;kurtosistest only valid for n&gt;=20 ... continuing &quot;
</pre></div>
</div>
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>weight</td>      <th>  R-squared:         </th> <td>   0.921</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.913</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   115.9</td>
</tr>
<tr>
  <th>Date:</th>             <td>Wed, 15 Feb 2023</td> <th>  Prob (F-statistic):</th> <td>8.05e-07</td>
</tr>
<tr>
  <th>Time:</th>                 <td>16:59:43</td>     <th>  Log-Likelihood:    </th> <td> -22.602</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>    12</td>      <th>  AIC:               </th> <td>   49.20</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>    10</td>      <th>  BIC:               </th> <td>   50.17</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
     <td></td>       <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>  <td>  -39.4432</td> <td>   10.057</td> <td>   -3.922</td> <td> 0.003</td> <td>  -61.851</td> <td>  -17.036</td>
</tr>
<tr>
  <th>height</th> <td>    0.6508</td> <td>    0.060</td> <td>   10.766</td> <td> 0.000</td> <td>    0.516</td> <td>    0.785</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td> 2.161</td> <th>  Durbin-Watson:     </th> <td>   1.778</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.339</td> <th>  Jarque-Bera (JB):  </th> <td>   0.923</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.110</td> <th>  Prob(JB):          </th> <td>   0.630</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 1.659</td> <th>  Cond. No.          </th> <td>3.33e+03</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 3.33e+03. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</div></div>
</div>
<p>Die Methode <code class="docutils literal notranslate"><span class="pre">conf_int()</span></code> gibt das Konfidenzintervall für die Modellkoeffizienten für ein bestimmtes Konfidenzniveau zurück (Standardeinstellung entspricht <span class="math notranslate nohighlight">\(\alpha = 0,05\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">conf_int</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>const</th>
      <td>-61.850735</td>
      <td>-17.035678</td>
    </tr>
    <tr>
      <th>height</th>
      <td>0.516081</td>
      <td>0.785442</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Eine weitere nützliche Extraktormethode ist die Funktion <code class="docutils literal notranslate"><span class="pre">resid()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">resid</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>338     0.815271
2123   -1.037014
2387    1.218317
2726   -1.527876
2766   -1.035491
3593    1.164509
4151    2.655371
4432    2.072124
5099   -1.038537
7098   -2.438537
7135    0.930501
8169   -1.778637
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Wir können sofort überprüfen, ob die Summe der Residuen (<span class="math notranslate nohighlight">\(\sum e\)</span>) nahe bei Null liegt.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">sum</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">resid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7.815970093361102e-14
</pre></div>
</div>
</div>
</div>
<p>Cool, nahe an Null!</p>
<p>Um die erhaltene Regressionslinie zu zeichnen, verwenden wir die Funktion <span class="math notranslate nohighlight">\(y = \beta_0 + \beta_1 x\)</span>, die Linien auf der Grundlage des Achsenabschnitts (<span class="math notranslate nohighlight">\(\beta_0\)</span>) und der Steigung (<span class="math notranslate nohighlight">\(\beta_1\)</span>) zeichnet. Wir verwenden den Syntax <code class="docutils literal notranslate"><span class="pre">plot([x_1,x_2],[y_1,y_2])</span></code> um die Regressionsgerade zu plotten.</p>
<p>Eine weitere besonders interessante Extraktormethode ist <code class="docutils literal notranslate"><span class="pre">predict()</span></code>. Wenn sie nicht spezifiziert ist, gibt die Methode <code class="docutils literal notranslate"><span class="pre">predict()</span></code> <span class="math notranslate nohighlight">\(\hat y_i\)</span> für jedes einzelne <span class="math notranslate nohighlight">\(x_i\)</span> zurück; ähnlich wie die Methode <code class="docutils literal notranslate"><span class="pre">fittedvalues</span></code>. Man kann jedoch auch neue Daten angeben und die Funktion <code class="docutils literal notranslate"><span class="pre">predict()</span></code> wird <span class="math notranslate nohighlight">\(\hat y_i\)</span> für jedes gegebene <span class="math notranslate nohighlight">\(x_i\)</span> vorhersagen. Beachten Sie, dass die neuen Daten ein Data-Frame-Objekt oder eine Liste sein müssen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>338     69.884729
2123    71.837014
2387    67.281683
2726    64.027876
2766    70.535491
3593    70.535491
4151    78.344629
4432    64.027876
5099    73.138537
7098    73.138537
7135    56.869499
8169    64.678637
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fittedvalues</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>338     69.884729
2123    71.837014
2387    67.281683
2726    64.027876
2766    70.535491
3593    70.535491
4151    78.344629
4432    64.027876
5099    73.138537
7098    73.138537
7135    56.869499
8169    64.678637
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Datapoints&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">],</span> <span class="n">model</span><span class="o">.</span><span class="n">fittedvalues</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Fitted values&quot;</span><span class="p">)</span>
<span class="c1"># create regression line</span>
<span class="n">x_axis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">140</span><span class="p">,</span> <span class="mi">190</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">_x_axis</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">x_axis</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">_x_axis</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Gewicht&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Körpergrösse&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f225cd59240&gt;
</pre></div>
</div>
<img alt="_images/01_Lineare_Regression_75_1.png" src="_images/01_Lineare_Regression_75_1.png" />
</div>
</div>
<p>Darüber hinaus bietet Python einen einfachen Ansatz zur Erstellung von Fehlerbereichen um die angepasste Regressionslinie. Es gibt zwei Arten von Bändern, die als <em>schmale</em> und <em>breite</em> Bänder bezeichnet werden. Die schmalen Bänder, die so genannten <a href="https://de.wikipedia.org/wiki/Konfidenzintervall">Konfidenzbänder</a>, spiegeln die Unsicherheit über die Linie selbst wider. Die Bänder sind schmal, wenn es viele Beobachtungen gibt, und spiegeln eine gut bestimmte Linie wider. Die breiten Banden, die so genannten Prognosebänder (<span id="id3">Frost [<a class="reference internal" href="intro.html#id12" title="Frost. Einfache lineare Regression - Die Grundlage für komplexe Regressionsmodelle verstehen. Springer, 2018.">2018</a>]</span> s.27), beinhalten die Unsicherheit über zukünftige Beobachtungen. Diese Bänder erfassen die Mehrheit der beobachteten Punkte und fallen nicht zu einer Linie zusammen, wenn die Anzahl der Beobachtungen zunimmt.</p>
<p>Um diese Unsicherheitsbänder zu berechnen, wenden wir die Methode <code class="docutils literal notranslate"><span class="pre">get_prediction()</span></code> an und fügen die Methode <code class="docutils literal notranslate"><span class="pre">summary_frame()</span></code> hinzu, um den Vektor der vorhergesagten Werte zu erhalten, der mit Grenzwerten ergänzt wird.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">140</span><span class="p">,</span> <span class="mi">190</span><span class="p">)</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>
<span class="n">model_predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_prediction</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span><span class="o">.</span><span class="n">summary_frame</span><span class="p">()</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Beobachtungen&quot;</span><span class="p">)</span>

<span class="c1"># create regression line</span>
<span class="n">x_axis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">140</span><span class="p">,</span> <span class="mi">190</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">model_predictions</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Regressionslinie&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <span class="n">x_axis</span><span class="p">,</span>
    <span class="n">model_predictions</span><span class="p">[</span><span class="s2">&quot;obs_ci_lower&quot;</span><span class="p">],</span>
    <span class="n">model_predictions</span><span class="p">[</span><span class="s2">&quot;obs_ci_upper&quot;</span><span class="p">],</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Prognoseinterval&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <span class="n">x_axis</span><span class="p">,</span>
    <span class="n">model_predictions</span><span class="p">[</span><span class="s2">&quot;mean_ci_lower&quot;</span><span class="p">],</span>
    <span class="n">model_predictions</span><span class="p">[</span><span class="s2">&quot;mean_ci_upper&quot;</span><span class="p">],</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Konvidenzinterval&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Gewicht&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Körpergrösse&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f225cb7a860&gt;
</pre></div>
</div>
<img alt="_images/01_Lineare_Regression_77_1.png" src="_images/01_Lineare_Regression_77_1.png" />
</div>
</div>
<p>Es gibt viele weitere Attribute und Methoden eines <code class="docutils literal notranslate"><span class="pre">OLS</span></code>-Objekts auf die zugegriffen werden kann. Die Funktion <code class="docutils literal notranslate"><span class="pre">dir()</span></code> gibt einen Überblick über die Struktur des Modellobjekts.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">dir</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;HC0_se&#39;,
 &#39;HC1_se&#39;,
 &#39;HC2_se&#39;,
 &#39;HC3_se&#39;,
 &#39;_HCCM&#39;,
 &#39;__class__&#39;,
 &#39;__delattr__&#39;,
 &#39;__dict__&#39;,
 &#39;__dir__&#39;,
 &#39;__doc__&#39;,
 &#39;__eq__&#39;,
 &#39;__format__&#39;,
 &#39;__ge__&#39;,
 &#39;__getattribute__&#39;,
 &#39;__gt__&#39;,
 &#39;__hash__&#39;,
 &#39;__init__&#39;,
 &#39;__init_subclass__&#39;,
 &#39;__le__&#39;,
 &#39;__lt__&#39;,
 &#39;__module__&#39;,
 &#39;__ne__&#39;,
 &#39;__new__&#39;,
 &#39;__reduce__&#39;,
 &#39;__reduce_ex__&#39;,
 &#39;__repr__&#39;,
 &#39;__setattr__&#39;,
 &#39;__sizeof__&#39;,
 &#39;__str__&#39;,
 &#39;__subclasshook__&#39;,
 &#39;__weakref__&#39;,
 &#39;_abat_diagonal&#39;,
 &#39;_cache&#39;,
 &#39;_data_attr&#39;,
 &#39;_data_in_cache&#39;,
 &#39;_get_robustcov_results&#39;,
 &#39;_is_nested&#39;,
 &#39;_use_t&#39;,
 &#39;_wexog_singular_values&#39;,
 &#39;aic&#39;,
 &#39;bic&#39;,
 &#39;bse&#39;,
 &#39;centered_tss&#39;,
 &#39;compare_f_test&#39;,
 &#39;compare_lm_test&#39;,
 &#39;compare_lr_test&#39;,
 &#39;condition_number&#39;,
 &#39;conf_int&#39;,
 &#39;conf_int_el&#39;,
 &#39;cov_HC0&#39;,
 &#39;cov_HC1&#39;,
 &#39;cov_HC2&#39;,
 &#39;cov_HC3&#39;,
 &#39;cov_kwds&#39;,
 &#39;cov_params&#39;,
 &#39;cov_type&#39;,
 &#39;df_model&#39;,
 &#39;df_resid&#39;,
 &#39;diagn&#39;,
 &#39;eigenvals&#39;,
 &#39;el_test&#39;,
 &#39;ess&#39;,
 &#39;f_pvalue&#39;,
 &#39;f_test&#39;,
 &#39;fittedvalues&#39;,
 &#39;fvalue&#39;,
 &#39;get_influence&#39;,
 &#39;get_prediction&#39;,
 &#39;get_robustcov_results&#39;,
 &#39;info_criteria&#39;,
 &#39;initialize&#39;,
 &#39;k_constant&#39;,
 &#39;llf&#39;,
 &#39;load&#39;,
 &#39;model&#39;,
 &#39;mse_model&#39;,
 &#39;mse_resid&#39;,
 &#39;mse_total&#39;,
 &#39;nobs&#39;,
 &#39;normalized_cov_params&#39;,
 &#39;outlier_test&#39;,
 &#39;params&#39;,
 &#39;predict&#39;,
 &#39;pvalues&#39;,
 &#39;remove_data&#39;,
 &#39;resid&#39;,
 &#39;resid_pearson&#39;,
 &#39;rsquared&#39;,
 &#39;rsquared_adj&#39;,
 &#39;save&#39;,
 &#39;scale&#39;,
 &#39;ssr&#39;,
 &#39;summary&#39;,
 &#39;summary2&#39;,
 &#39;t_test&#39;,
 &#39;t_test_pairwise&#39;,
 &#39;tvalues&#39;,
 &#39;uncentered_tss&#39;,
 &#39;use_t&#39;,
 &#39;wald_test&#39;,
 &#39;wald_test_terms&#39;,
 &#39;wresid&#39;]
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="modelldiagnose">
<h3>Modelldiagnose<a class="headerlink" href="#modelldiagnose" title="Permalink to this headline">#</a></h3>
<p><a href="https://de.wikipedia.org/wiki/Regressionsdiagnostik">Regressionsdiagnostik</a> beinhaltet eine Reihe von Verfahren, die zur Bewertung der numerischen Ergebnisse einer Regressionsanalyse angewandt werden. Die Verfahren umfassen Methoden der grafischen und quantitativen Analyse oder formale statistische Hypothesentests. In diesem Abschnitt konzentrieren wir uns auf die beiden wichtigsten Methoden, die grafische und die quantitative Analyse. Statistische Hypothesentests für Regressionsprobleme finden Sie im Abschnitt über <em>Hypothesentests</em>.</p>
<section id="bestimmheitsmasz">
<h4>Bestimmheitsmaß<a class="headerlink" href="#bestimmheitsmasz" title="Permalink to this headline">#</a></h4>
<p>Der <a href="https://de.wikipedia.org/wiki/Bestimmtheitsma%C3%9F">Bestimmtheitsmaß</a>, auch als <span class="math notranslate nohighlight">\(R^2\)</span> bezeichnet, ist der Anteil der Variation der beobachteten Werte, der durch die Regressionsgleichung erklärt wird. Mit anderen Worten: <span class="math notranslate nohighlight">\(R^2\)</span> ist ein statistisches Maß dafür, wie gut die Regressionsgerade die realen Datenpunkte annähert; es ist also ein Maß für die Anpassungsfähigkeit des Modells.</p>
<p>Die Gesamtvariation der Antwortvariablen <span class="math notranslate nohighlight">\(y\)</span>
basiert auf der Abweichung jedes beobachteten Wertes <span class="math notranslate nohighlight">\(y_i\)</span> vom Mittelwert <span class="math notranslate nohighlight">\(\bar y\)</span>. Diese Größe wird als <strong>Gesamtsumme der Quadrate, <span class="math notranslate nohighlight">\(SST\)</span></strong>, bezeichnet und ist gegeben durch</p>
<div class="math notranslate nohighlight">
\[SST = \sum (y_i - \bar y)^2\text{.}\]</div>
<p>Diese Gesamtsumme der Quadrate (<span class="math notranslate nohighlight">\(SST\)</span>) kann in zwei Teile zerlegt werden: die durch die Regressionslinie erklärte Abweichung <span class="math notranslate nohighlight">\(\hat y_i- \bar y\)</span> und die verbleibende unerklärte Abweichung <span class="math notranslate nohighlight">\(y_i-\hat y_i\)</span>. Folglich wird der Anteil der Variation, der durch die Regression erklärt wird, als <strong>Summe der Quadrate aufgrund der Regression</strong>, <span class="math notranslate nohighlight">\(SSR\)</span>, bezeichnet und ist gegeben durch</p>
<div class="math notranslate nohighlight">
\[SSR = \sum (\hat y_i- \bar y)^2\text{.}\]</div>
<p>Das Verhältnis zwischen der Summe der Quadrate aufgrund der Regression (<span class="math notranslate nohighlight">\(SSR\)</span>) und der Gesamtsumme der Quadrate (<span class="math notranslate nohighlight">\(SST\)</span>) wird als Bestimmtheitsmaß bezeichnet und mit <span class="math notranslate nohighlight">\(R^2\)</span> angegeben.</p>
<div class="math notranslate nohighlight">
\[R^2 = \frac{SSR}{SST}\]</div>
<p><span class="math notranslate nohighlight">\(R^2\)</span> liegt zwischen <span class="math notranslate nohighlight">\(0\)</span> und <span class="math notranslate nohighlight">\(1\)</span>. Ein Wert nahe <span class="math notranslate nohighlight">\(0\)</span> deutet darauf hin, dass die Regressionsgleichung nicht in der Lage ist, die Daten zu erklären. Ein <span class="math notranslate nohighlight">\(R^2\)</span> von <span class="math notranslate nohighlight">\(1\)</span> zeigt an, dass die Regressionsgerade perfekt zu den Daten passt.</p>
<p>Der Vollständigkeit halber wird die Variation in den beobachteten Werten der Reaktionsvariablen, die nicht durch die Regression erklärt wird, als <strong>Summe der quadrierten Fehler der Vorhersage</strong> (<span class="math notranslate nohighlight">\(SSE\)</span>) bezeichnet und ist gegeben durch</p>
<div class="math notranslate nohighlight">
\[SSE = \sum (y_i-\hat y_i)^2\text{.}\]</div>
<p>Erinnern Sie sich, dass die <span class="math notranslate nohighlight">\(SSE\)</span>-Größe minimiert wird, um die beste Regressionslinie zur Beschreibung der Daten zu erhalten, auch bekannt als die <a href="https://de.wikipedia.org/wiki/Methode_der_kleinsten_Quadrate">Methode der gewöhnlichen kleinsten Quadrate</a> (<span class="math notranslate nohighlight">\(OLS\)</span>).</p>
</section>
<section id="die-methode-summary">
<h4>Die Methode <code class="docutils literal notranslate"><span class="pre">summary()</span></code><a class="headerlink" href="#die-methode-summary" title="Permalink to this headline">#</a></h4>
<p>Eine grundlegendes Mittel für die Regressionsdiagnose in Python ist die Methode <code class="docutils literal notranslate"><span class="pre">summary()</span></code>. Die Funktion <code class="docutils literal notranslate"><span class="pre">OLS()</span></code> gibt ein Modellobjekt zurück. Dieses <code class="docutils literal notranslate"><span class="pre">OLS()</span></code>-Objekt enthält die Modelleigenschaften, die durch Anwendung der Methode <code class="docutils literal notranslate"><span class="pre">summary()</span></code> untersucht werden können.</p>
<p>Zu Demonstrationszwecken wird dasselbe Modell wie im vorherigen Abschnitt verwendet.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lese Datei students.csv als Dataframe ein; Indexspalte wird übersprungen</span>
<span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../data/students.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">12</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">students</span><span class="p">[[</span><span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># make the predictions by the model</span>

<span class="c1"># Lese Modellwerte aus</span>
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/imarevic/.local/lib/python3.10/site-packages/scipy/stats/_stats_py.py:1477: UserWarning: kurtosistest only valid for n&gt;=20 ... continuing anyway, n=12
  warnings.warn(&quot;kurtosistest only valid for n&gt;=20 ... continuing &quot;
</pre></div>
</div>
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>weight</td>      <th>  R-squared:         </th> <td>   0.921</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.913</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   115.9</td>
</tr>
<tr>
  <th>Date:</th>             <td>Wed, 15 Feb 2023</td> <th>  Prob (F-statistic):</th> <td>8.05e-07</td>
</tr>
<tr>
  <th>Time:</th>                 <td>16:59:43</td>     <th>  Log-Likelihood:    </th> <td> -22.602</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>    12</td>      <th>  AIC:               </th> <td>   49.20</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>    10</td>      <th>  BIC:               </th> <td>   50.17</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
     <td></td>       <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>  <td>  -39.4432</td> <td>   10.057</td> <td>   -3.922</td> <td> 0.003</td> <td>  -61.851</td> <td>  -17.036</td>
</tr>
<tr>
  <th>height</th> <td>    0.6508</td> <td>    0.060</td> <td>   10.766</td> <td> 0.000</td> <td>    0.516</td> <td>    0.785</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td> 2.161</td> <th>  Durbin-Watson:     </th> <td>   1.442</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.339</td> <th>  Jarque-Bera (JB):  </th> <td>   0.923</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.110</td> <th>  Prob(JB):          </th> <td>   0.630</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 1.659</td> <th>  Cond. No.          </th> <td>3.33e+03</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 3.33e+03. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</div></div>
</div>
<ul class="simple">
<li><p>Die Ausgabe der Methode <code class="docutils literal notranslate"><span class="pre">summary()</span></code> beginnt mit einer Wiederholung der abhängigen Variable und der angewandten Methode (in diesem Fall <span class="math notranslate nohighlight">\(OLS\)</span>).</p></li>
<li><p>Die nächste Zeile zeigt <span class="math notranslate nohighlight">\(R^2\)</span>, den quadrierten <a href="https://de.wikipedia.org/wiki/Korrelationskoeffizient">Pearson Korrelationskoeffizienten</a>, auch bekannt als <a href="https://de.wikipedia.org/wiki/Bestimmtheitsma%C3%9F">Bestimmtheitsmaß</a> und das angepasste <span class="math notranslate nohighlight">\(R^2\)</span>, ein statistisches Maß, das für die Merkmalsauswahl bei der Regressionsanalyse mit mehreren Prädiktoren (multiple Regression) verwendet werden kann.</p></li>
<li><p>Die darauf folgenden Zeilen zeigen die <span class="math notranslate nohighlight">\(F\)</span>-Statistik, die Anzahl der Beobachtungen (Datenpunkte) und Freiheitsgrade.</p></li>
<li><p>In den nächsten Zeilen werden der Regressionskoeffizient (unter <code class="docutils literal notranslate"><span class="pre">height</span></code>) und der Achsenabschnitt (unter <code class="docutils literal notranslate"><span class="pre">const</span></code>) angegeben, außerdem für jeden von ihnen der Standardfehler, die <span class="math notranslate nohighlight">\(t\)</span>-Werte und die <span class="math notranslate nohighlight">\(p\)</span>-Werte.</p></li>
</ul>
</section>
<section id="diagnostische-plots">
<h4>Diagnostische Plots<a class="headerlink" href="#diagnostische-plots" title="Permalink to this headline">#</a></h4>
<p>Es ist wichtig zu wissen, dass Sie eine lineare Regressionsanalyse mit dem Softwarepaket Python oder einer anderen Statistiksoftware durchführen können, die eine Reihe von Zahlen, einschließlich eines <span class="math notranslate nohighlight">\(p\)</span>-Werts, ergibt, so dass Sie sofort feststellen können, ob die Ergebnisse signifikant waren (oder nicht). Sind wir mit der Angabe der Signifikanz der Ergebnisse fertig?</p>
<p>Nehmen wir einen sehr berühmten Datensatz, das so genannte <a href="https://de.wikipedia.org/wiki/Anscombe-Quartett">Anscombe-Quartett</a>. Das Anscombe-Quartett besteht aus vier Datensätzen und hat die folgende Form:</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>x1</p></td>
<td><p>y1</p></td>
<td><p>x2</p></td>
<td><p>y2</p></td>
<td><p>x3</p></td>
<td><p>y3</p></td>
<td><p>x4</p></td>
<td><p>y4</p></td>
</tr>
<tr class="row-odd"><td><p>10</p></td>
<td><p>8,04</p></td>
<td><p>10</p></td>
<td><p>9,14</p></td>
<td><p>10</p></td>
<td><p>7,46</p></td>
<td><p>8</p></td>
<td><p>6,58</p></td>
</tr>
<tr class="row-even"><td><p>8</p></td>
<td><p>6,95</p></td>
<td><p>8</p></td>
<td><p>8,14</p></td>
<td><p>8</p></td>
<td><p>6,77</p></td>
<td><p>8</p></td>
<td><p>5,76</p></td>
</tr>
<tr class="row-odd"><td><p>13</p></td>
<td><p>7,58</p></td>
<td><p>13</p></td>
<td><p>8,74</p></td>
<td><p>13</p></td>
<td><p>12,74</p></td>
<td><p>8</p></td>
<td><p>7,71</p></td>
</tr>
<tr class="row-even"><td><p>9</p></td>
<td><p>8,81</p></td>
<td><p>9</p></td>
<td><p>8,77</p></td>
<td><p>9</p></td>
<td><p>7,11</p></td>
<td><p>8</p></td>
<td><p>8,84</p></td>
</tr>
<tr class="row-odd"><td><p>11</p></td>
<td><p>8,33</p></td>
<td><p>11</p></td>
<td><p>9,26</p></td>
<td><p>11</p></td>
<td><p>7,81</p></td>
<td><p>8</p></td>
<td><p>8,47</p></td>
</tr>
<tr class="row-even"><td><p>14</p></td>
<td><p>9,96</p></td>
<td><p>14</p></td>
<td><p>8,1</p></td>
<td><p>14</p></td>
<td><p>8,84</p></td>
<td><p>8</p></td>
<td><p>7,04</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>7,24</p></td>
<td><p>6</p></td>
<td><p>6,13</p></td>
<td><p>6</p></td>
<td><p>6,08</p></td>
<td><p>8</p></td>
<td><p>5,25</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>4,26</p></td>
<td><p>4</p></td>
<td><p>3,1</p></td>
<td><p>4</p></td>
<td><p>5,39</p></td>
<td><p>19</p></td>
<td><p>12,5</p></td>
</tr>
<tr class="row-odd"><td><p>12</p></td>
<td><p>10,84</p></td>
<td><p>12</p></td>
<td><p>9,13</p></td>
<td><p>12</p></td>
<td><p>8,15</p></td>
<td><p>8</p></td>
<td><p>5,56</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>4,82</p></td>
<td><p>7</p></td>
<td><p>7,26</p></td>
<td><p>7</p></td>
<td><p>6,42</p></td>
<td><p>8</p></td>
<td><p>7,91</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>5,68</p></td>
<td><p>5</p></td>
<td><p>4,74</p></td>
<td><p>5</p></td>
<td><p>5,73</p></td>
<td><p>8</p></td>
<td><p>6,89</p></td>
</tr>
</tbody>
</table>
<p>Das Anscombe-Quartett wird oft verwendet um die Unterschiede zwischen grafischer und statistischer Auswertung hervorzuheben. Wir geben den Datensatz in Python ein.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">y1</span> <span class="o">=</span> <span class="p">[</span><span class="mf">8.04</span><span class="p">,</span> <span class="mf">6.95</span><span class="p">,</span> <span class="mf">7.58</span><span class="p">,</span> <span class="mf">8.81</span><span class="p">,</span> <span class="mf">8.33</span><span class="p">,</span> <span class="mf">9.96</span><span class="p">,</span> <span class="mf">7.24</span><span class="p">,</span> <span class="mf">4.26</span><span class="p">,</span> <span class="mf">10.84</span><span class="p">,</span> <span class="mf">4.82</span><span class="p">,</span> <span class="mf">5.68</span><span class="p">]</span>

<span class="n">x2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">y2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">9.14</span><span class="p">,</span> <span class="mf">8.14</span><span class="p">,</span> <span class="mf">8.74</span><span class="p">,</span> <span class="mf">8.77</span><span class="p">,</span> <span class="mf">9.26</span><span class="p">,</span> <span class="mf">8.10</span><span class="p">,</span> <span class="mf">6.13</span><span class="p">,</span> <span class="mf">3.10</span><span class="p">,</span> <span class="mf">9.13</span><span class="p">,</span> <span class="mf">7.26</span><span class="p">,</span> <span class="mf">4.74</span><span class="p">]</span>

<span class="n">x3</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">y3</span> <span class="o">=</span> <span class="p">[</span><span class="mf">7.46</span><span class="p">,</span> <span class="mf">6.77</span><span class="p">,</span> <span class="mf">12.74</span><span class="p">,</span> <span class="mf">7.11</span><span class="p">,</span> <span class="mf">7.81</span><span class="p">,</span> <span class="mf">8.84</span><span class="p">,</span> <span class="mf">6.08</span><span class="p">,</span> <span class="mf">5.39</span><span class="p">,</span> <span class="mf">8.15</span><span class="p">,</span> <span class="mf">6.42</span><span class="p">,</span> <span class="mf">5.73</span><span class="p">]</span>

<span class="n">x4</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
<span class="n">y4</span> <span class="o">=</span> <span class="p">[</span><span class="mf">6.58</span><span class="p">,</span> <span class="mf">5.76</span><span class="p">,</span> <span class="mf">7.71</span><span class="p">,</span> <span class="mf">8.84</span><span class="p">,</span> <span class="mf">8.47</span><span class="p">,</span> <span class="mf">7.04</span><span class="p">,</span> <span class="mf">5.25</span><span class="p">,</span> <span class="mf">12.50</span><span class="p">,</span> <span class="mf">5.56</span><span class="p">,</span> <span class="mf">7.91</span><span class="p">,</span> <span class="mf">6.89</span><span class="p">]</span>

<span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">x4</span><span class="p">]</span>
<span class="n">Y</span> <span class="o">=</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">y4</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Nun berechnen wir einige deskriptive statistische Maße für jedes der vier <span class="math notranslate nohighlight">\((x,y)\)</span>-Paare. Zunächst berechnen wir den Mittelwert für jedes einzelne <span class="math notranslate nohighlight">\(x\)</span> und <span class="math notranslate nohighlight">\(y\)</span> im Datensatz.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mean x</span><span class="si">{</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2"> | mean y</span><span class="si">{</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mean x1: 9.0 | mean y1: 7.501
mean x2: 9.0 | mean y2: 7.501
mean x3: 9.0 | mean y3: 7.5
mean x4: 9.0 | mean y4: 7.501
</pre></div>
</div>
</div>
</div>
<p>Die Werte stimmen entweder perfekt überein oder liegen sehr nahe beieinander!!</p>
<p>Jetzt berechnen wir die Varianz jedes <span class="math notranslate nohighlight">\((x,y)\)</span> Paares.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;variance x</span><span class="si">{</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2"> | variance y</span><span class="si">{</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>variance x1: 10.0 | variance y1: 3.752
variance x2: 10.0 | variance y2: 3.752
variance x3: 10.0 | variance y3: 3.748
variance x4: 10.0 | variance y4: 3.748
</pre></div>
</div>
</div>
</div>
<p>Sie sind zwar nicht exakt gleich, aber definitiv sehr nahe beieinander. Schließlich erstellen wir mit der Funktion <code class="docutils literal notranslate"><span class="pre">linregress()</span></code> ein lineares Modell für jede Teilmenge und berechnen die Koeffizienten des Modells und <span class="math notranslate nohighlight">\(R^2\)</span>, das Bestimmtheitsmaß.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)):</span>
    <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">std_err</span> <span class="o">=</span> <span class="n">linregress</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">x + </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">intercept</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">,  p-value: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">p_value</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="si">}</span><span class="s2">, Pearson correlation coefficient: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">r_value</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">, Standard error of the estimated slope: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">std_err</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1: 0.5x + 3.0,  p-value: 0.00217, Pearson correlation coefficient: 0.816, Standard error of the estimated slope: 0.1179
2: 0.5x + 3.0,  p-value: 0.00218, Pearson correlation coefficient: 0.816, Standard error of the estimated slope: 0.118
3: 0.5x + 3.0,  p-value: 0.00218, Pearson correlation coefficient: 0.816, Standard error of the estimated slope: 0.1179
4: 0.5x + 3.0,  p-value: 0.00216, Pearson correlation coefficient: 0.817, Standard error of the estimated slope: 0.1178
</pre></div>
</div>
</div>
</div>
<p>Erstaunlich! Sie sind fast identisch! Und jetzt <span class="math notranslate nohighlight">\(R^2\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)):</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">linregress</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;r2: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">r_value</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2: 0.667
r2: 0.666
r2: 0.666
r2: 0.667
</pre></div>
</div>
</div>
</div>
<p>Wow, was für eine Analyse! Wir haben eine Menge verschiedener statistischer Methoden auf die vier Datensätze angewandt, und ehrlich gesagt, sie sehen einander sehr ähnlich.</p>
<p>Sind wir jetzt mit unserer Analyse fertig? Nein, noch nicht! Egal was wir tun, wir sollten immer überprüfen, ob das Modell für die Daten gut funktioniert. Eine einfache Möglichkeit, dies zu tun, ist die Visualisierung der Daten. Lassen Sie uns den Anscombe-Datensatz einschließlich der Regressionslinie grafisch darstellen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="n">xaxis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)):</span>
    <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">linregress</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">regline</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">xaxis</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">regline</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;C</span><span class="si">{</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;C</span><span class="si">{</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Anscombe&#39;s Datensatz #</span><span class="si">{</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;y=</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">intercept</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">x&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/01_Lineare_Regression_110_0.png" src="_images/01_Lineare_Regression_110_0.png" />
</div>
</div>
<p>Was für eine Überraschung! Das wichtigste Ergebnis der Übung ist die Erkenntnis, dass wir auf viele verschiedene Arten prüfen müssen, ob ein Modell für Daten gut funktioniert. Wir achten auf Regressionsergebnisse wie Steigungskoeffizienten, <span class="math notranslate nohighlight">\(p\)</span>-Werte oder <span class="math notranslate nohighlight">\(R^2\)</span>, die uns sagen, wie gut ein Modell die gegebenen Daten darstellt. Das ist jedoch nicht die ganze Geschichte. Wir müssen auch visuelle Diagnosen anwenden. Die visuelle Inspektion hilft bei der Bewertung, ob die Annahmen der linearen Regression erfüllt sind, oder bei der Ermittlung von <a href="https://de.wikipedia.org/wiki/Ausrei%C3%9Fer">Ausreißern</a> und/oder statistisch bedeutsame Beobachtungen und so genannten <a href="https://de.wikipedia.org/wiki/Pr%C3%A4diktionsmatrix#Hebelwerte">Hebelwerte</a>, die das numerische Ergebnis der Regressionsanalyse beeinflussen.</p>
</section>
<section id="analyse-der-residuen">
<h4>Analyse der Residuen<a class="headerlink" href="#analyse-der-residuen" title="Permalink to this headline">#</a></h4>
<p>Ein <a href="https://de.wikipedia.org/wiki/St%C3%B6rgr%C3%B6%C3%9Fe_und_Residuum">Residuum</a> eines beobachteten Wertes ist die Differenz zwischen dem beobachteten Wert und dem geschätzten Wert <span class="math notranslate nohighlight">\((y_i- \hat y_i)\)</span>. Es handelt sich um die Residuen, die nach der Anpassung eines Modells an die Daten übrig bleiben. Die <strong>Summe der quadrierten Vorhersagefehler</strong> (<span class="math notranslate nohighlight">\(SSE\)</span>), auch bekannt als die <strong>Summe der quadrierten Residuen</strong> oder die <strong>Fehlersumme der Quadrate</strong>, ist ein Indikator dafür, wie gut ein Modell die Daten darstellt.</p>
<p>Wenn die absoluten Residuen, definiert für die Beobachtung <span class="math notranslate nohighlight">\(x_i\)</span> als <span class="math notranslate nohighlight">\(e_i=y_i- \hat y_i\)</span> definiert sind, ungewöhnlich groß sind, kann es sein, dass die Beobachtung aus einer anderen Grundgesamtheit stammt oder dass bei der Durchführung oder Aufzeichnung der Beobachtung ein Fehler aufgetreten ist.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">xaxis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;C1&quot;</span><span class="p">,</span> <span class="s2">&quot;C3&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">((</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Y</span><span class="p">[</span><span class="mi">2</span><span class="p">]))):</span>
    <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">linregress</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">regline</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">xaxis</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">regline</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">e</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">e</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">_x</span><span class="p">,</span> <span class="n">_y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">yhat</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">_x</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="n">_x</span><span class="p">,</span> <span class="n">_x</span><span class="p">),</span> <span class="p">(</span><span class="n">_y</span><span class="p">,</span> <span class="n">yhat</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Anscombe&#39;s Datensatz #</span><span class="si">{</span><span class="n">colors</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/01_Lineare_Regression_114_0.png" src="_images/01_Lineare_Regression_114_0.png" />
</div>
</div>
<p>Die beiden obigen Diagramme zeigen, dass ein Datenpunkt in Anscombes Datensatz Nr. <span class="math notranslate nohighlight">\(3\)</span> (rechtes Diagramm) ein ungewöhnlich großes Residuum aufweist. Ein solcher Datenpunkt erfordert besondere Aufmerksamkeit, da er die Regressionsanalyse beeinflusst. Es gibt keine allgemeingültige Regel, wie mit Ausreißern umzugehen ist, aber je nach den Fachkenntnissen des Forschers kann es Fälle geben, in denen man beschließt, einen solchen Ausreißer aus der Analyse auszuschließen.</p>
<p>Darüber hinaus können wir die Residuen analysieren, um zu prüfen, ob die Annahmen der linearen Regression erfüllt sind. Regressionsresiduen sollten annähernd normalverteilt sein, d. h. die Regression sollte die Struktur erklären, und was übrig bleibt, sollte nur Rauschen sein, das durch Messfehler oder viele kleine unkorrelierte Faktoren verursacht wird. Die Normalität der Residuen kann grafisch überprüft werden, indem man die Residuen gegen die Werte der Prädiktorvariablen aufträgt. In einem solchen <strong>Residuen-Plot</strong> sollten die Residuen zufällig um <span class="math notranslate nohighlight">\(0\)</span> streuen
und die Variation um <span class="math notranslate nohighlight">\(0\)</span> sollte gleich sein.</p>
<p>Vor der Darstellung der Residuen ist es üblich, die Residuen zu standardisieren. Python bietet die Möglichkeit mit <code class="docutils literal notranslate"><span class="pre">get_influence()</span></code> auf die standardisierten Residuen zuzugreifen (<code class="docutils literal notranslate"><span class="pre">influence</span> <span class="pre">=</span> <span class="pre">model.get_influence()</span> </code> und <code class="docutils literal notranslate"><span class="pre">standardized_residuals</span> <span class="pre">=</span> <span class="pre">influence.resid_studentized_internal</span></code>) und alternativ kann man mit <code class="docutils literal notranslate"><span class="pre">stud_res</span> <span class="pre">=</span> <span class="pre">model.outlier_test()</span></code> die studentisierten Residuen (<span id="id4">Fahrmeir <em>et al.</em> [<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">2016</a>]</span> s.152) berechnen.</p>
<p>Wenn die Annahmen für Regressionsschlussfolgerungen erfüllt sind, sollten die folgenden zwei Bedingungen gelten (<span id="id5">Fahrmeir <em>et al.</em> [<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">2016</a>]</span> s.443):</p>
<ul class="simple">
<li><p>Eine Darstellung der Residuen (Residuenplot) gegen die Werte der Prädiktorvariablen sollte ungefähr in ein horizontales Band fallen, das um die <span class="math notranslate nohighlight">\(x\)</span>-Achse zentriert und symmetrisch ist.</p></li>
<li><p>Eine Normalwahrscheinlichkeitsdarstellung der Residuen sollte in etwa linear sein.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">toy_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">toy1_y</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">toy_x</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">toy2_y</span> <span class="o">=</span> <span class="n">toy_x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">eps</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">*</span> <span class="p">(</span><span class="n">toy_x</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">toy3_y</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">toy_x</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="n">toys</span> <span class="o">=</span> <span class="p">[</span><span class="n">toy1_y</span><span class="p">,</span> <span class="n">toy2_y</span><span class="p">,</span> <span class="n">toy3_y</span><span class="p">]</span>
<span class="n">titles</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Keine Verletzung&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Verletzung der Linearität&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Verletzung der konstanten Standardabweichung (Heteroskedastizität)&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">toy_x</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">toys</span><span class="p">))</span>
<span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">toy</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">toys</span><span class="p">):</span>
    <span class="n">_model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">toy</span><span class="p">,</span> <span class="n">toy_x</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
    <span class="n">influence</span> <span class="o">=</span> <span class="n">_model</span><span class="o">.</span><span class="n">get_influence</span><span class="p">()</span>
    <span class="n">standardized_residuals</span> <span class="o">=</span> <span class="n">influence</span><span class="o">.</span><span class="n">resid_studentized_internal</span>

    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">toy_x</span><span class="p">,</span> <span class="n">standardized_residuals</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">titles</span><span class="p">[</span><span class="n">e</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">4.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Residuen-Plots&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">28</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.85</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/01_Lineare_Regression_116_0.png" src="_images/01_Lineare_Regression_116_0.png" />
</div>
</div>
<p>Nur in der obersten Grafik sind die Residuen relativ gut um den Nullpunkt verteilt, während dies in den beiden unteren Grafiken nicht der Fall ist, was darauf hindeutet, dass die linearen Modellannahmen für dieses Modell nicht erfüllt sind.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">toys</span> <span class="o">=</span> <span class="p">[</span><span class="n">toy1_y</span><span class="p">,</span> <span class="n">toy2_y</span><span class="p">,</span> <span class="n">toy3_y</span><span class="p">]</span>
<span class="n">titles</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Keine Verletzung&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Verletzung der Linearität&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Heteroskedastizität&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">toys</span><span class="p">))</span>
<span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">toy</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">toys</span><span class="p">):</span>
    <span class="n">_model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">toy</span><span class="p">,</span> <span class="n">toy_x</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
    <span class="n">influence</span> <span class="o">=</span> <span class="n">_model</span><span class="o">.</span><span class="n">get_influence</span><span class="p">()</span>
    <span class="n">standardized_residuals</span> <span class="o">=</span> <span class="n">influence</span><span class="o">.</span><span class="n">resid_studentized_internal</span>
    <span class="n">sm</span><span class="o">.</span><span class="n">qqplot</span><span class="p">(</span><span class="n">standardized_residuals</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">titles</span><span class="p">[</span><span class="n">e</span><span class="p">])</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Q-Q-Diagramm&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">28</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.85</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/01_Lineare_Regression_118_0.png" src="_images/01_Lineare_Regression_118_0.png" />
</div>
</div>
<p>Die Normalwahrscheinlichkeitsdiagramme, die oft als <a href="https://de.wikipedia.org/wiki/Quantil-Quantil-Diagramm">Q-Q-Diagramme</a> bezeichnet werden, zeigen, dass nur im linken Diagramm die Datenpunkte in etwa auf eine gerade Linie fallen. Dies ist bei den anderen Diagrammen nicht der Fall, was darauf hindeutet, dass die Annahmen des linearen Modells nicht erfüllt sind.</p>
</section>
<section id="ausreiszer-und-einfluszreiche-beobachtungen">
<h4>Ausreißer und einflußreiche Beobachtungen<a class="headerlink" href="#ausreiszer-und-einfluszreiche-beobachtungen" title="Permalink to this headline">#</a></h4>
<p><strong>Ausreißer</strong> sind Punkte, die aus der Wolke der Datenpunkte herausfallen. Ausreißer, die horizontal von der Mitte der Wolke wegfallen und die Neigung der Regressionslinie nicht beeinflussen, werden als <strong>Leverage-Werte</strong> (Hebelwerte) bezeichnet. Ausreißer, die die Steigung der Regressionsgeraden tatsächlich beeinflussen, werden als <strong>einflußreiche Beobachtungen</strong> bezeichnet, bei denen es sich in der Regel um hohe Leverage-Punkte handelt.</p>
<p>Wir wollen einen Beispielsdatensatz erstellen, um das Konzept der statistisch bedeutsamen Beobachtungen zu untersuchen.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">110</span><span class="p">)</span>  <span class="c1"># seede zufallswerte</span>

<span class="c1"># Erzeuge Zufallswerte</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">beta0</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">beta1</span> <span class="o">=</span> <span class="mf">2.5</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">beta0</span> <span class="o">+</span> <span class="n">beta1</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>  <span class="c1"># add random noise</span>

<span class="c1"># Erzeuge Hebelwerte</span>
<span class="n">n_lev</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="n">x_lev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">n_lev</span><span class="p">)</span>
<span class="n">y_lev</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">beta0</span><span class="o">**</span><span class="mf">1.5</span> <span class="o">+</span> <span class="n">beta1</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="n">x_lev</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n_lev</span><span class="p">)</span>
<span class="p">)</span>  <span class="c1"># add random noise</span>

<span class="c1"># Erzeuge einflußreiche Beobachtungen</span>
<span class="n">n_inf</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="mf">0.02</span><span class="p">)</span>
<span class="n">x_inf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="n">n_inf</span><span class="p">)</span>
<span class="n">y_inf</span> <span class="o">=</span> <span class="n">beta0</span> <span class="o">+</span> <span class="n">beta1</span><span class="o">**</span><span class="mf">2.5</span> <span class="o">*</span> <span class="n">x_inf</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n_inf</span><span class="p">)</span>


<span class="c1"># Baue Datensätze</span>
<span class="n">x_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">x_inf</span><span class="p">,</span> <span class="n">x_lev</span><span class="p">])</span>
<span class="n">y_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">y</span><span class="p">,</span> <span class="n">y_inf</span><span class="p">,</span> <span class="n">y_lev</span><span class="p">])</span>

<span class="c1"># Fitte lineares Modell</span>
<span class="n">base_model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">lev_model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">y</span><span class="p">,</span> <span class="n">y_lev</span><span class="p">]),</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">x_lev</span><span class="p">])))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">inf_model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">y</span><span class="p">,</span> <span class="n">y_inf</span><span class="p">]),</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">x_inf</span><span class="p">])))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">full_model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">y_full</span><span class="p">,</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">x_full</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Datenpunkte ohne Ausreisser&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_lev</span><span class="p">,</span> <span class="n">y_lev</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Hebelpunkte&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_inf</span><span class="p">,</span> <span class="n">y_inf</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Aussreisser mit Einfluss&quot;</span><span class="p">)</span>

<span class="n">xaxis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="k">for</span> <span class="n">_model</span> <span class="ow">in</span> <span class="p">[</span><span class="n">base_model</span><span class="p">,</span> <span class="n">lev_model</span><span class="p">,</span> <span class="n">inf_model</span><span class="p">]:</span>
    <span class="n">pred</span> <span class="o">=</span> <span class="n">_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">xaxis</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">pred_full</span> <span class="o">=</span> <span class="n">full_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">xaxis</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">pred_full</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-1.65, 12.65, -23.52561113057294, 125.83725556438257)
</pre></div>
</div>
<img alt="_images/01_Lineare_Regression_122_1.png" src="_images/01_Lineare_Regression_122_1.png" />
</div>
</div>
<p>Die obige Abbildung zeigt deutlich die Auswirkungen der verschiedenen Arten von Ausreißern. Die blaue gestrichelte Linie zeigt die Regressionslinie ohne Ausreißer, die orange gestrichelte Linie zeigt die Regressionslinie, wenn die orangen Hebelpunkte enthalten sind, die grüne gestrichelte Linie zeigt die Regressionslinie, wenn die grünen Ausreisser enthalten sind, und die rote Linie zeigt die Regressionslinie, wenn alle Daten enthalten sind. Offensichtlich haben die grünen Punkte den größten Einfluss auf die Steigung der Regressionslinie!</p>
<section id="leverage">
<h5>Leverage<a class="headerlink" href="#leverage" title="Permalink to this headline">#</a></h5>
<p>Die <a href="https://de.wikipedia.org/wiki/Pr%C3%A4diktionsmatrix#Hebelwerte">Leverage</a> einer Beobachtung zeigt an, ob sie das Regressionsmodell beeinflussen kann. Diese Beobachtungen sind nicht notwendigerweise ein Fehler, aber sie sollten identifiziert und überprüft werden. Die Leverage wird durch den <strong><span class="math notranslate nohighlight">\(H\)</span>-Wert</strong> gemessen, der den Gesamteinfluss einer einzelnen Beobachtung auf die Modellvorhersagen misst. Der <span class="math notranslate nohighlight">\(H\)</span>-Wert nimmt Werte zwischen <span class="math notranslate nohighlight">\(0\)</span> und <span class="math notranslate nohighlight">\(1\)</span> an. Ein Punkt mit einer Hebelwirkung von Null hat keinen Einfluss auf das Regressionsmodell. Je höher der <span class="math notranslate nohighlight">\(H\)</span>-Wert ist, desto größer ist der Einfluss des betreffenden Punktes auf das Regressionsmodell.</p>
</section>
<section id="cook-abstand">
<h5>Cook-Abstand<a class="headerlink" href="#cook-abstand" title="Permalink to this headline">#</a></h5>
<p>Eine weitere Methode zur Erfassung einflussreicher Ausreißer ist der <a href="https://de.wikipedia.org/wiki/Cook-Abstand">Cook-Abstand</a>. Das Maß ist eine Kombination aus Leverage und Residuen der einzelnen Beobachtungen. Je höher die Hebelwirkung und der Rückstand, desto größer ist der Cook-Abstand. Normalerweise werden Punkte mit einem Cook-Abstand von mehr als <span class="math notranslate nohighlight">\(1\)</span> als einflussreich eingestuft. In Python wird der Cook-Abstand mit dem Attribut <code class="docutils literal notranslate"><span class="pre">cooks.distance</span></code> berechnet.</p>
</section>
<section id="andere-nutzliche-regressionsdiagnosen">
<h5>Andere nützliche Regressionsdiagnosen<a class="headerlink" href="#andere-nutzliche-regressionsdiagnosen" title="Permalink to this headline">#</a></h5>
<p>Weitere nützliche Werkzeuge für die Regressionsanalysediagnose sind DFFITS (“difference in fit(s)”), die angibt, wie sehr eine Beobachtung den zugehörigen angepassten Wert beeinflusst, und die DFBETAS, die die Änderung der geschätzten Parameter angibt, wenn eine Beobachtung im Verhältnis zu ihrem Standardfehler ausgeschlossen wird.</p>
<p>In Paket statsmodels kann auf diese die genanten und weitere diagnostische Verfahren sehr leicht über die Methdode <code class="docutils literal notranslate"><span class="pre">get_influence().summary_frame()</span></code>zurückgegriffen werden.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">full_model</span><span class="o">.</span><span class="n">get_influence</span><span class="p">()</span><span class="o">.</span><span class="n">summary_frame</span><span class="p">()</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dfb_const</th>
      <th>dfb_x1</th>
      <th>cooks_d</th>
      <th>standard_resid</th>
      <th>hat_diag</th>
      <th>dffits_internal</th>
      <th>student_resid</th>
      <th>dffits</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>17</th>
      <td>-0.008556</td>
      <td>-0.006683</td>
      <td>0.000378</td>
      <td>-0.274503</td>
      <td>0.009938</td>
      <td>-0.027502</td>
      <td>-0.273291</td>
      <td>-0.027380</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.000263</td>
      <td>0.009673</td>
      <td>0.000158</td>
      <td>0.152658</td>
      <td>0.013345</td>
      <td>0.017754</td>
      <td>0.151946</td>
      <td>0.017671</td>
    </tr>
    <tr>
      <th>19</th>
      <td>0.066637</td>
      <td>-0.022027</td>
      <td>0.004280</td>
      <td>0.924806</td>
      <td>0.009908</td>
      <td>0.092515</td>
      <td>0.924163</td>
      <td>0.092451</td>
    </tr>
    <tr>
      <th>86</th>
      <td>-0.075890</td>
      <td>0.031410</td>
      <td>0.004754</td>
      <td>-0.949855</td>
      <td>0.010429</td>
      <td>-0.097511</td>
      <td>-0.949408</td>
      <td>-0.097465</td>
    </tr>
    <tr>
      <th>39</th>
      <td>0.003107</td>
      <td>-0.002012</td>
      <td>0.000006</td>
      <td>0.027135</td>
      <td>0.014813</td>
      <td>0.003327</td>
      <td>0.027006</td>
      <td>0.003311</td>
    </tr>
    <tr>
      <th>82</th>
      <td>0.023955</td>
      <td>-0.091890</td>
      <td>0.009254</td>
      <td>-1.028980</td>
      <td>0.017179</td>
      <td>-0.136041</td>
      <td>-1.029271</td>
      <td>-0.136080</td>
    </tr>
    <tr>
      <th>21</th>
      <td>0.027092</td>
      <td>-0.097669</td>
      <td>0.010127</td>
      <td>-1.061836</td>
      <td>0.017647</td>
      <td>-0.142317</td>
      <td>-1.062488</td>
      <td>-0.142404</td>
    </tr>
    <tr>
      <th>36</th>
      <td>0.040591</td>
      <td>-0.033427</td>
      <td>0.000833</td>
      <td>0.236372</td>
      <td>0.028942</td>
      <td>0.040807</td>
      <td>0.235306</td>
      <td>0.040623</td>
    </tr>
    <tr>
      <th>64</th>
      <td>-0.068953</td>
      <td>0.023327</td>
      <td>0.004514</td>
      <td>-0.948047</td>
      <td>0.009946</td>
      <td>-0.095021</td>
      <td>-0.947586</td>
      <td>-0.094975</td>
    </tr>
    <tr>
      <th>69</th>
      <td>0.009371</td>
      <td>-0.006311</td>
      <td>0.000049</td>
      <td>0.077862</td>
      <td>0.015872</td>
      <td>0.009888</td>
      <td>0.077493</td>
      <td>0.009841</td>
    </tr>
    <tr>
      <th>47</th>
      <td>0.039709</td>
      <td>-0.028573</td>
      <td>0.000839</td>
      <td>0.299574</td>
      <td>0.018354</td>
      <td>0.040963</td>
      <td>0.298272</td>
      <td>0.040785</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0.125702</td>
      <td>-0.105563</td>
      <td>0.007940</td>
      <td>0.696475</td>
      <td>0.031701</td>
      <td>0.126018</td>
      <td>0.694757</td>
      <td>0.125708</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Ebenso stehen Visualisierungsmethoden zur Auswahl.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">influence_plot</span><span class="p">(</span><span class="n">full_model</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s2">&quot;cooks&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/01_Lineare_Regression_133_0.png" src="_images/01_Lineare_Regression_133_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">influence_plot</span><span class="p">(</span><span class="n">full_model</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s2">&quot;DFFITS&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/01_Lineare_Regression_134_0.png" src="_images/01_Lineare_Regression_134_0.png" />
</div>
</div>
</section>
</section>
</section>
</section>
<span id="document-Kapitel08/02_Polynomiale_Regression"></span><section class="tex2jax_ignore mathjax_ignore" id="polynomiale-regression">
<h2>Polynomiale Regression<a class="headerlink" href="#polynomiale-regression" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">PolynomialFeatures</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
</pre></div>
</div>
</div>
</div>
<p>Die <a href="https://de.wikipedia.org/wiki/Multiple_lineare_Regression#Polynomiale_Regression">polynomiale Regression</a> ist eine spezielle Art der linearen Regression, bei der die Beziehung zwischen der unabhängigen Variablen <span class="math notranslate nohighlight">\(x\)</span> und der abhängigen Variablen <span class="math notranslate nohighlight">\(y\)</span> durch ein Polynom <span class="math notranslate nohighlight">\(n\)</span>-ten Grades in <span class="math notranslate nohighlight">\(x\)</span> modelliert wird. Mit anderen Worten, wir nehmen neben dem ursprünglichen linearen Term auch Potenzen zweiter Ordnung und höherer Potenzen einer Variablen in das Modell auf. Die Einbeziehung von Polynomen <span class="math notranslate nohighlight">\(n\)</span>-ten Grades führt zu einer nichtlinearen Beziehung zwischen <span class="math notranslate nohighlight">\(y\)</span> und <span class="math notranslate nohighlight">\(x\)</span>, aber das Modell ist immer noch ein lineares Modell, da die Beziehung zwischen den Koeffizienten (<span class="math notranslate nohighlight">\(\beta_i\)</span>) und den erwarteten Beobachtungen linear ist. Somit kann die Modellgleichung wie folgt geschrieben werden</p>
<div class="math notranslate nohighlight">
\[\hat y = \beta_0+\beta_1x+\beta_2x^2+...+\beta_kx^k+\epsilon\text{.}\]</div>
<p>Die Werte der Koeffizienten werden durch Anpassung des Polynoms an die Beobachtungsdaten (<span class="math notranslate nohighlight">\(y\)</span>) bestimmt. Wie bei der einfachen linearen Regression, die im vorigen Abschnitt behandelt wurde, geschieht dies durch Minimierung der <strong>Summe der quadrierten Fehler (<span class="math notranslate nohighlight">\(SSE\)</span>)</strong>, die durch folgende Gleichung gegeben ist</p>
<div class="math notranslate nohighlight">
\[SSE = \sum e^2 = \sum (\hat y - y)^2\text{.}\]</div>
<p>Bei der Anpassung eines Polynoms an Beobachtungen stellt sich das Problem der Wahl der Ordnung <span class="math notranslate nohighlight">\(k\)</span> des Polynoms. Wie man die richtige Zahl für das Polynom wählt, ist eine Frage eines wichtigen Konzepts, das <strong>Modellauswahl</strong> oder <a href="https://de.wikipedia.org/wiki/Informationskriterium"><strong>Informationskriterium</strong></a> genannt wird. Der Einfachheit halber verwenden wir die Wurzel des mittleren quadratischen Fehlers <a href="https://de.wikipedia.org/wiki/Mittlere_quadratische_Abweichung">(root-mean-square error, RMSE)</a>, definiert durch</p>
<div class="math notranslate nohighlight">
\[RMSE = \sqrt{\frac{\sum_{i=1}^n (\hat y - y)^2}{n}}\]</div>
<p>um die Eignung des Modells zu bewerten.</p>
<section id="id1">
<h3>Polynomiale Regression<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h3>
<hr class="docutils" />
<p>Wir beginnen mit unserer Übung, indem wir Daten sammeln. Die Daten werden von einer Funktion generiert, die Sie nicht kennen. Diese Vorbedingung macht das Beispiel realistischer, da wir in realen Anwendungen die genauen Spezifikationen des zugrunde liegenden Datenerzeugungsprozesses nicht kennen. Am Ende dieses Abschnitts lüften wir das Geheimnis des Datengenerierungsprozesses.</p>
<p>Dies sind die Daten, unsere Beobachtungen, in tabellarischer Form. Wir haben <span class="math notranslate nohighlight">\(25\)</span> Datenpunkte, jeder Datenpunkt ist ein (<span class="math notranslate nohighlight">\(x,y\)</span>) Paar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">poly_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">y</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<p>Hier sind die Daten in Form eines Streudiagramms dargestellt:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">poly_data</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">poly_data</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;y&#39;)
</pre></div>
</div>
<img alt="_images/02_Polynomiale_Regression_14_1.png" src="_images/02_Polynomiale_Regression_14_1.png" />
</div>
</div>
<section id="anpassen-einer-kurve-in-python-die-notation-in-python">
<h4>Anpassen einer Kurve in Python: Die Notation in Python<a class="headerlink" href="#anpassen-einer-kurve-in-python-die-notation-in-python" title="Permalink to this headline">#</a></h4>
<p>Python bietet leistungsstarke Funktionen zur Anpassung eines Polynoms an Daten. Um ein <span class="math notranslate nohighlight">\(k\)</span>-dimensionales Polynom anzupassen, verwenden wir <code class="docutils literal notranslate"><span class="pre">linear_model</span></code> aus dem <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> Paket  und fügen dem Funktionsaufruf <code class="docutils literal notranslate"><span class="pre">LinearRegression()</span></code> zusätzliche <code class="docutils literal notranslate"><span class="pre">PolynomialFeatures</span></code> hinzu. Darüber hinaus gibt es zwei verschiedene Möglichkeiten, eine polynomiale Regression zu kodieren.</p>
<p>Für ein Polynom <span class="math notranslate nohighlight">\(2\)</span>. Ordnung besteht die erste Möglichkeit darin, <code class="docutils literal notranslate"><span class="pre">model.predict(X-werte)</span></code> einzugeben und zu plotten, und die zweite Möglichkeit ist die Koeffizienten mit <code class="docutils literal notranslate"><span class="pre">model.coef_</span></code> aus dem Model auszulesen und daraus äquivalent zu <span class="math notranslate nohighlight">\(\hat y = \beta_0+\beta_1x+\beta_2x^2+...+\beta_kx^k+\epsilon\)</span>  ,  <code class="docutils literal notranslate"><span class="pre">model.coef_[0][0]</span> <span class="pre">+</span> <span class="pre">model.coef_[0][1]</span> <span class="pre">*</span> <span class="pre">X-werte</span> <span class="pre">+</span> <span class="pre">model.coef_[0][2]</span> <span class="pre">*</span> <span class="pre">(X-werte)**2</span> <span class="pre">+</span> <span class="pre">...</span></code> zu konstruieren.</p>
<p>Um die Verwirrung zu lindern, zeigen wir ein Beispiel in Python. Wir konstruieren zwei Polynome der Ordnung <span class="math notranslate nohighlight">\(2\)</span> für <code class="docutils literal notranslate"><span class="pre">poly_data</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">poly_data</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">poly_data</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Polynomialer Fit</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">X_poly</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_poly</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>LinearRegression()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">LinearRegression</label><div class="sk-toggleable__content"><pre>LinearRegression()</pre></div></div></div></div></div></div></div>
</div>
<p>Zum Auslesen der Koeffizienten und des Achsenabschnitts des Modells verwenden wir das Attribut <code class="docutils literal notranslate"><span class="pre">coef_</span></code> und <code class="docutils literal notranslate"><span class="pre">intercept_</span></code>.</p>
<p>Wir überprüfen die Ergebnisse des Modells.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Achsenabschnitt: </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">intercept_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Koeffizienten:   </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">coef_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Achsenabschnitt: [1.07678298]
Koeffizienten:   [[ 0.         -2.45381544  0.82240915]]
</pre></div>
</div>
</div>
</div>
<p>Bei der Ausgabe der Koeffizienten dient der nullte Koeffizient als Platzhalter für den Achsenabschnitt und kann daher ignoriert werden. Setzen wir nun die Parameter in die Gleichung ein, erhalten wir die Regressionslinie.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Definiere x- Achse zur Vorhersage von Datenpunkten</span>
<span class="n">x_axis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="c1"># Konstruiere Regressionslinie</span>
<span class="n">regline</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">model</span><span class="o">.</span><span class="n">intercept_</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">x_axis</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">x_axis</span><span class="o">**</span><span class="mi">2</span>
<span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">poly_data</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">],</span> <span class="n">poly_data</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Beobachtungen&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">regline</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Regressionlinie&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fb07e6d0700&gt;
</pre></div>
</div>
<img alt="_images/02_Polynomiale_Regression_22_1.png" src="_images/02_Polynomiale_Regression_22_1.png" />
</div>
</div>
<p>Andererseits können wir die Regressionslinie auch mit der Methode <code class="docutils literal notranslate"><span class="pre">predict()</span></code> für beliebige <span class="math notranslate nohighlight">\(x\)</span>-Werte erzeugen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_poly</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_axis</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">regline</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_poly</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">regline</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Regressionlinie&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Beobachtungen&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fb07c580460&gt;
</pre></div>
</div>
<img alt="_images/02_Polynomiale_Regression_24_1.png" src="_images/02_Polynomiale_Regression_24_1.png" />
</div>
</div>
</section>
<section id="anpassen-einer-kurve-in-python-fortsetzung">
<h4>Anpassen einer Kurve in Python (Fortsetzung)<a class="headerlink" href="#anpassen-einer-kurve-in-python-fortsetzung" title="Permalink to this headline">#</a></h4>
<p>Da wir nun die Notation in Python kennen, beginnen wir mit der Erstellung von <span class="math notranslate nohighlight">\(6\)</span> verschiedenen Modellen, mit <span class="math notranslate nohighlight">\(k=1,2,3,5,9,12\)</span>. Für jedes Modell berechnen wir den <span class="math notranslate nohighlight">\(RMSE\)</span>. Schließlich stellen wir die Daten zusammen mit der Regressionslinie dar, die durch jedes einzelne Modell gegeben ist. Der Einfachheit halber konstruieren wir eine Schleife, um den Kodierungsaufwand zu verringern.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">RMSE</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">poly_data</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">poly_data</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">x_axis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>

<span class="n">orders</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">order</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">orders</span><span class="p">):</span>
    <span class="n">poly</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>
    <span class="n">X_poly</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_poly</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">y_hat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_poly</span><span class="p">)</span>
    <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_hat</span><span class="p">)</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
    <span class="n">RMSE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>

    <span class="n">X_poly</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_axis</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">regline</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_poly</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">regline</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Regressionslinie der </span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s2">. Ordnung&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Beobachtungen&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;RMSE (k=</span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">rmse</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/02_Polynomiale_Regression_27_0.png" src="_images/02_Polynomiale_Regression_27_0.png" />
</div>
</div>
<p>Fantastische Diagramme! Die Abbildung zeigt, dass wenn wir <span class="math notranslate nohighlight">\(k\)</span>, die Ordnung des Polynoms, erhöht, wird die Kurve flexibler und passt immer besser zu den Daten. Je besser die Daten angepasst werden, desto geringer wird der Fehler, <span class="math notranslate nohighlight">\(RMSE\)</span>.</p>
<p>Der Einfachheit halber plotten wir den <span class="math notranslate nohighlight">\(RMSE\)</span> gegen <span class="math notranslate nohighlight">\(k\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">orders</span><span class="p">,</span> <span class="n">RMSE</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;RMSE&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;k-te Ordnung&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;k-te Ordnung&#39;)
</pre></div>
</div>
<img alt="_images/02_Polynomiale_Regression_29_1.png" src="_images/02_Polynomiale_Regression_29_1.png" />
</div>
</div>
<p>Daher stellt sich wieder einmal die Frage, welches Polynom am besten zu den Daten passt. Glauben wir, dass das Polynom der Ordnung <span class="math notranslate nohighlight">\(9\)</span> am besten zu dem zugrunde liegenden Datenerzeugungsprozess passt? Obwohl wir eine hervorragende Anpassung an die Beobachtungsdaten erhalten, indem wir die Ordnung des Polynoms erhöhen, bleibt es fraglich, ob das Polynom hoher Ordnung gut verallgemeinert werden kann. Stellen Sie sich vor, wir führen eine neue Messreihe durch und erhalten neue Daten. Glauben Sie, dass die wild schwingende Kurve eines Polynoms hoher Ordnung immer noch gut zu den Daten passt? Nein, wahrscheinlich nicht!</p>
<p>Dieses Verhalten wird als <a href="https://de.wikipedia.org/wiki/%C3%9Cberanpassung">Überanpassung</a> bezeichnet. Erinnern Sie sich daran, dass das Ziel darin besteht, die Parameter aus den Daten zu lernen. Wir sind also daran interessiert, eine gute Verallgemeinerung des Modells zu erreichen und nicht unbedingt perfekt angepasste Beobachtungsdaten.</p>
</section>
<section id="aus-den-daten-lernen">
<h4>Aus den Daten lernen<a class="headerlink" href="#aus-den-daten-lernen" title="Permalink to this headline">#</a></h4>
<p>Wie können wir das Problem lösen? Wie bestimmen wir das beste Polynom <span class="math notranslate nohighlight">\(n\)</span>-ter Ordnung für unseren Datensatz? Nun, es gibt viele Methoden und Strategien, um einer Überanpassung entgegenzuwirken. In diesem Abschnitt verfolgen wir einen einfachen Ansatz. Zunächst teilen wir den Datensatz in zwei Teile auf. Einen Teil nennen wir <strong>Trainingsmenge</strong>, den anderen Teil nennen wir <strong>Validierungsmenge</strong>. Dann verwenden wir alle Daten des Trainingssatzes, um die Modellparameter <span class="math notranslate nohighlight">\(\beta_i\)</span> zu lernen, und zwar auf die gleiche Weise wie oben. Danach wenden wir das gelernte Modell an, um die Daten des Validierungssatzes vorherzusagen, und bewerten die Leistung des Modells, indem wir den <span class="math notranslate nohighlight">\(RMSE\)</span> berechnen. Wir verwenden also die Validierungsmenge, um die, durch <span class="math notranslate nohighlight">\(k\)</span> gegebene, Komplexität des Modells zu optimieren.</p>
<p>Leider brauchen wir, wenn wir aus Daten lernen wollen, letztendlich auch Daten, aus denen wir lernen können. Bislang haben wir mit <span class="math notranslate nohighlight">\(25\)</span> Beobachtungen gearbeitet. Das ist nicht viel. In realen Anwendungen müssten wir wahrscheinlich neue Beobachtungen durch eine neue Messreihen gewinnen. In unserer Übung können wir jedoch relativ leicht mehr Daten erzeugen. Daher setzen wir dieses Beispiel mit einem neuen Datensatz von <span class="math notranslate nohighlight">\(150\)</span> Beobachtungen fort.</p>
<p>Lassen Sie uns die Daten plotten!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">150</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">415</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">new_poly_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">y</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_poly_data</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/imarevic/.local/lib/python3.10/site-packages/pandas/plotting/_matplotlib/core.py:1114: UserWarning: No data for colormapping provided via &#39;c&#39;. Parameters &#39;cmap&#39; will be ignored
  scatter = ax.scatter(
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;x&#39;, ylabel=&#39;y&#39;&gt;
</pre></div>
</div>
<img alt="_images/02_Polynomiale_Regression_34_2.png" src="_images/02_Polynomiale_Regression_34_2.png" />
</div>
</div>
</section>
<section id="trainings-und-validierungsmenge">
<h4>Trainings- und Validierungsmenge<a class="headerlink" href="#trainings-und-validierungsmenge" title="Permalink to this headline">#</a></h4>
<p>Nun sind wir bereit, unsere Trainings- und Validierungsmenge zu erstellen. Dazu verwenden wir die Funktion <code class="docutils literal notranslate"><span class="pre">train_test_split()</span></code> aus dem <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>-Paket. Wir teilen die Daten so auf, dass <span class="math notranslate nohighlight">\(65 \%\)</span> der Daten dem Trainingsset und der Rest, <span class="math notranslate nohighlight">\(35 \%\)</span> der Daten, dem Validationsset zugewiesen werden.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">new_poly_data</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">new_poly_data</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.35</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Überprüfen der Dimension von Training und Validierungsdatensatz</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Trainingset&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;X_train: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;y_train: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Validierungsset&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;X_val: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;y_val: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">y_val</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Trainingset
X_train: (97, 1)
y_train: (97, 1)

Validierungsset
X_val: (53, 1)
y_val: (53, 1)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Trainingsdaten&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Validierungsdaten&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fb07c1ce680&gt;
</pre></div>
</div>
<img alt="_images/02_Polynomiale_Regression_39_1.png" src="_images/02_Polynomiale_Regression_39_1.png" />
</div>
</div>
</section>
<section id="modellbildung-und-modellbewertung">
<h4>Modellbildung und Modellbewertung<a class="headerlink" href="#modellbildung-und-modellbewertung" title="Permalink to this headline">#</a></h4>
<p>In dieser Übung werden wir <span class="math notranslate nohighlight">\(10\)</span> Modelle mit <span class="math notranslate nohighlight">\(k=1,2,...,10\)</span> erstellen. Wir bewerten jedes der <span class="math notranslate nohighlight">\(10\)</span> polynomialen Regressionsmodelle, indem wir den <span class="math notranslate nohighlight">\(RMSE\)</span> auf dem Trainingssatz berechnen. Nach der Erstellung des Modells und der Ermittlung der Modellparameter <span class="math notranslate nohighlight">\(\beta_i\)</span> verwenden wir das Modell, um die Antwortvariable in der Validierungsmenge vorherzusagen. Auch hier stützen wir uns auf den <span class="math notranslate nohighlight">\(RMSE\)</span>, um die Vorhersagen für den Validierungssatz zu bewerten. Schließlich stellen wir den <span class="math notranslate nohighlight">\(RMSE\)</span> jedes Modells sowohl für die Trainingsmenge als auch für die Validierungsmenge dar. Anhand des <span class="math notranslate nohighlight">\(RMSE\)</span> bewerten wir die Generalisierung des Modells.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rmse_train</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">rmse_val</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">order</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">):</span>
    <span class="c1"># Polynomial Fit</span>
    <span class="n">poly</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>
    <span class="n">X_train_poly</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>  <span class="c1"># .reshape(-1, 1)</span>
    <span class="n">X_val_poly</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>  <span class="c1"># .reshape(-1, 1)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_train_poly</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>

    <span class="c1"># Berechne RMSE - Trainingsset</span>
    <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_poly</span><span class="p">))</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMSE train (k=</span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">rmse</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">rmse_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>

    <span class="c1"># Berechne RMSE - Validierungsset</span>
    <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val_poly</span><span class="p">))</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMSE val (k=</span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s2">):   </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">rmse</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">rmse_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;------------------------&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RMSE train (k=1): 0.554
RMSE val (k=1):   0.539
------------------------
RMSE train (k=2): 0.553
RMSE val (k=2):   0.538
------------------------
RMSE train (k=3): 0.312
RMSE val (k=3):   0.324
------------------------
RMSE train (k=4): 0.306
RMSE val (k=4):   0.329
------------------------
RMSE train (k=5): 0.284
RMSE val (k=5):   0.344
------------------------
RMSE train (k=6): 0.282
RMSE val (k=6):   0.346
------------------------
RMSE train (k=7): 0.282
RMSE val (k=7):   0.345
------------------------
RMSE train (k=8): 0.282
RMSE val (k=8):   0.345
------------------------
RMSE train (k=9): 0.282
RMSE val (k=9):   0.345
------------------------
RMSE train (k=10): 0.282
RMSE val (k=10):   0.345
------------------------
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">rmse_train</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Trainingsset&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">rmse_val</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Validierungsset&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;RMSE&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;k-te Ordnung&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fb07c277250&gt;
</pre></div>
</div>
<img alt="_images/02_Polynomiale_Regression_43_1.png" src="_images/02_Polynomiale_Regression_43_1.png" />
</div>
</div>
<p>Die Abbildung zeigt, dass der Fehler bei den Trainingsdaten (blaue Linie) stetig abnimmt. Das macht durchaus Sinn, denn je komplexer das Modell wird, indem <span class="math notranslate nohighlight">\(k\)</span> erhöht wird, desto besser passt das Modell zu den Trainingsdaten. Das gleiche Verhalten haben wir im obigen Abschnitt beobachtet, als wir unser Modell mit nur <span class="math notranslate nohighlight">\(25\)</span> Beobachtungen trainiert haben. Wenn wir uns den <span class="math notranslate nohighlight">\(RMSE\)</span> für den Validierungssatz (rote Linie) ansehen, sehen wir, dass mit zunehmendem <span class="math notranslate nohighlight">\(k\)</span> und damit zunehmender Modellkomplexität der Fehler abnimmt. Es gibt jedoch einen “Sweet Spot”, der durch den niedrigsten <span class="math notranslate nohighlight">\(RMSE\)</span> angezeigt wird, an dem das Modell gerade komplex genug ist, um auf den bisher ungesehenen Validierungsdaten gut zu generalisieren. Wenn die Modellkomplexität weiter zunimmt, beginnt auch der <span class="math notranslate nohighlight">\(RMSE\)</span> zu steigen. Dies deutet auf eine Überanpassung des Modells hin. Das Modell merkt sich also die Daten in der Trainingsmenge gut, aber die Vorhersagekraft des Modells für bisher ungesehene Daten, wie die Daten der Validierungsmenge, wird schlechter. Ein Blick auf die obige Abbildung zeigt, dass der niedrigste Fehler im Validierungssatz, der so genannte Sweet Spot, für ein Regressionsmodell <span class="math notranslate nohighlight">\(3\)</span>-ter Ordnung erreicht wird.</p>
</section>
<section id="vorstellung-des-modells">
<h4>Vorstellung des Modells<a class="headerlink" href="#vorstellung-des-modells" title="Permalink to this headline">#</a></h4>
<p>Im vorangegangenen Abschnitt haben wir festgestellt, dass ein polynomiales Regressionsmodell der Ordnung <span class="math notranslate nohighlight">\(3\)</span> in der Validierungsgruppe am besten funktioniert. Nun stellen wir dieses Modell auf dem gesamten Datensatz dar, um seine Qualität visuell zu bewerten. Außerdem stellen wir die Funktion dar, die dem Prozess der Datengenerierung zugrunde liegt.</p>
<blockquote>
<div><p><strong>Datenerzeugung:</strong> Die Eingabewerte <span class="math notranslate nohighlight">\(x_n\)</span> für die zugrundeliegende Funktion werden gleichmäßig im Bereich <span class="math notranslate nohighlight">\(U(0,1)\)</span> erzeugt, und die entsprechenden Zielwerte <span class="math notranslate nohighlight">\(y\)</span> erhält man, indem man zunächst die entsprechenden Werte der Funktion <span class="math notranslate nohighlight">\(\sin( \pi x )\)</span> berechnet und dann zufälliges Rauschen mit einer Gaußschen Verteilung mit einer Standardabweichung von <span class="math notranslate nohighlight">\(0,35\)</span> hinzufügt.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Erzeuge Daten</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">raw_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">y</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">raw_data</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">raw_data</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Polynomial Fit</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">X_poly</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_poly</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">x_axis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
<span class="n">x_axis_poly</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_axis</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">y_reg_line</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_axis_poly</span><span class="p">)</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Stichprobe&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">y_reg_line</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Regressionslinie&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x_axis</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Datenerzeugungsfunktion&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fb07c23ab60&gt;
</pre></div>
</div>
<img alt="_images/02_Polynomiale_Regression_48_1.png" src="_images/02_Polynomiale_Regression_48_1.png" />
</div>
</div>
<p>Die Abbildung zeigt, dass unser Modell die Daten gut abbildet und wir daher recht zufrieden damit sein können.</p>
</section>
</section>
</section>
<span id="document-Aufgaben/Kapitel08/Aufgaben"></span><section class="tex2jax_ignore mathjax_ignore" id="ubungsaufgaben">
<h2>Übungsaufgaben<a class="headerlink" href="#ubungsaufgaben" title="Permalink to this headline">#</a></h2>
<div class="toctree-wrapper compound">
<span id="document-Aufgaben/Kapitel08/LinReg_basics"></span><section class="tex2jax_ignore mathjax_ignore" id="lineare-regression-grundbegriffe">
<h3>Lineare Regression - Grundbegriffe<a class="headerlink" href="#lineare-regression-grundbegriffe" title="Permalink to this headline">#</a></h3>
<ol class="simple">
<li><p>Was versteht man unter Residuen?</p></li>
<li><p>Was versteht man unter Homoskedastizität?</p></li>
<li><p>Was sind Hebelpunkte?</p></li>
</ol>
<hr class="docutils" />
<section id="losungen">
<h4>Lösungen<a class="headerlink" href="#losungen" title="Permalink to this headline">#</a></h4>
<div class="toggle docutils container">
<p>Residuen sind die Abweichungen der beobachteten <span class="math notranslate nohighlight">\(y\)</span>-Werten zu den durch die berechnete Regressionsgerade vorhergesagten <span class="math notranslate nohighlight">\(y\)</span>-Werten und sind gegeben durch:</p>
<div class="math notranslate nohighlight">
\[\hat \epsilon_i = y_i - \hat y_i \ , \ i = 1, \cdots, n\]</div>
<p>Sie ermöglichen es ein Maß für die Güte eines Regressionsmodells zu definieren.</p>
<p>(<span id="id1">[<a class="reference internal" href="intro.html#id3" title="Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. Statistik : Der Weg zur Datenanalyse. Springer-Verlag, 2016.">Fahrmeir <em>et al.</em>, 2016</a>]</span> s.149)</p>
</div>
<div class="toggle docutils container">
<p>Homoskedastizität ist dann gegeben, wenn die Varianz der Residuen ungefähr konstant ist. Alle Datenpunkte liegen in etwa in gleichem Abstand zur Regressionsgeraden.</p>
</div>
<div class="toggle docutils container">
<p>Hebelpunkte sind einzelne Datenpunkt, die weit außerhalb der Datenmenge liegen. Durch ihr hohes Residuum, dass quadratische in die Methode der kleinsten Quadrate eingeht, haben sie einen überproportionale Effekt auf die resultierende Regressionskurve.</p>
</div>
</section>
</section>
<span id="document-Aufgaben/Kapitel08/LineareReg"></span><section class="tex2jax_ignore mathjax_ignore" id="lineare-regression">
<h3>Lineare Regression<a class="headerlink" href="#lineare-regression" title="Permalink to this headline">#</a></h3>
<ol class="simple">
<li><p>Führen Sie eine lineare Regression für die folgenden Daten (<code class="docutils literal notranslate"><span class="pre">x,y</span></code>) durch und stellen Sie die Regressionsgerade und die Daten graphisch dar.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">noise</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 1 ...</span>
</pre></div>
</div>
</div>
</div>
<section id="losungen">
<h4>Lösungen<a class="headerlink" href="#losungen" title="Permalink to this headline">#</a></h4>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Stichprobe&quot;</span><span class="p">)</span>

<span class="c1"># Fitte das Modell</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">x_axis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">reg_line</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">x_axis</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">reg_line</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Regressionslinie&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/LineareReg_7_0.png" src="_images/LineareReg_7_0.png" />
</div>
</div>
</section>
</section>
<span id="document-Aufgaben/Kapitel08/PolyReg"></span><section class="tex2jax_ignore mathjax_ignore" id="polynomiale-regression">
<h3>Polynomiale Regression<a class="headerlink" href="#polynomiale-regression" title="Permalink to this headline">#</a></h3>
<ol class="simple">
<li><p>Führen Sie eine polynomiale Regression <span class="math notranslate nohighlight">\(2\)</span>-ten Grades für die folgenden Daten (<code class="docutils literal notranslate"><span class="pre">x</span></code>,<code class="docutils literal notranslate"><span class="pre">y</span></code>) durch und stellen Sie die Regressionsgerade und die Daten graphisch dar.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">162</span><span class="p">,</span> <span class="mi">209</span><span class="p">,</span> <span class="mi">262</span><span class="p">,</span> <span class="mi">321</span><span class="p">])</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span>
    <span class="n">y</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/PolyReg_3_0.png" src="_images/PolyReg_3_0.png" />
</div>
</div>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Frage 1 ...</span>
</pre></div>
</div>
</div>
</div>
<section id="losungen">
<h4>Lösungen<a class="headerlink" href="#losungen" title="Permalink to this headline">#</a></h4>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">PolynomialFeatures</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">poly</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">X_2</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_2</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">xaxis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">xaxis_2</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">xaxis</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">reg_line</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">xaxis_2</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">reg_line</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Regressionlinie&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Beobachtungen&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/PolyReg_7_0.png" src="_images/PolyReg_7_0.png" />
</div>
</div>
</section>
</section>
</div>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-Lernziele/Kapitel9_Lernziele"></span><section class="tex2jax_ignore mathjax_ignore" id="lernziele">
<h2>Lernziele<a class="headerlink" href="#lernziele" title="Permalink to this headline">#</a></h2>
<section id="logistische-regression">
<h3>Logistische Regression<a class="headerlink" href="#logistische-regression" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Den Studierenden wird das Modell der logistischen Regression vorgestellt</p></li>
<li><p>Die Logit Funktion und ihr Zusammenhang mit Odds und der Sigmoidfunktion wird besprochen</p></li>
<li><p>Die Studierenden lernen anhand eines Beispiels die praktische Anwendung des logistischen Regressionsmodells</p></li>
<li><p>Zusammengefasst werden folgende Begriffe und Methoden besprochen : Logistische Regression , Logit-Funktion , Odds - Log Odds , Sigmoidfunktion</p></li>
</ul>
</section>
</section>
<span id="document-Kapitel09/01_Logistische_Regression"></span><section class="tex2jax_ignore mathjax_ignore" id="logistische-regression">
<h2>Logistische Regression<a class="headerlink" href="#logistische-regression" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">folium</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
</pre></div>
</div>
</div>
</div>
<p>Die <a href="https://de.wikipedia.org/wiki/Logistische_Regression">logistische Regression</a>, auch bekannt als <strong>Logit-Regression</strong> oder <strong>Logit-Modell</strong>, ist ein probabilistisches lineares Modell für dichotome Daten. Die Antwortvariable ist eine binäre Variable (Nominalvariable), d. h. die Variable hat zwei Kategorien oder zwei Werte: Wahr vs. Falsch oder <span class="math notranslate nohighlight">\(1\)</span> vs. <span class="math notranslate nohighlight">\(0\)</span> oder Erfolg vs. Misserfolg, mit den Wahrscheinlichkeiten <span class="math notranslate nohighlight">\(\pi\)</span> bzw. <span class="math notranslate nohighlight">\(1-\pi\)</span>. Somit folgt die Antwortvariable einer Binomialverteilung, die wie folgt geschrieben wird</p>
<div class="math notranslate nohighlight">
\[y \sim B(\eta,\pi)\text{,} \]</div>
<p>wobei <span class="math notranslate nohighlight">\(\eta\)</span> der binomische Nenner ist, der für eine binäre Variable <span class="math notranslate nohighlight">\(0\)</span> oder <span class="math notranslate nohighlight">\(1\)</span> ist, und <span class="math notranslate nohighlight">\(\pi\)</span> die Erfolgswahrscheinlichkeit ist.</p>
<section id="die-logit-funktion">
<h3>Die Logit-Funktion<a class="headerlink" href="#die-logit-funktion" title="Permalink to this headline">#</a></h3>
<p>Das Ergebnis einer logistischen Regression ist eine Wahrscheinlichkeit (<span class="math notranslate nohighlight">\(\pi\)</span>), also ein Wert zwischen <span class="math notranslate nohighlight">\(0\)</span> und <span class="math notranslate nohighlight">\(1\)</span>. Außerdem ist dieses Ergebnis eine lineare Funktion bekannter Kovariaten <span class="math notranslate nohighlight">\(x_i\)</span>, was nur ein anderes Wort für die Beobachtungen in unserem Datensatz ist.</p>
<div class="math notranslate nohighlight">
\[\pi =\beta_0+ \beta_1x_1+ \beta_2x_2+ ... +\beta_kx_k\]</div>
<p>Für ein einfaches logistisches Regressionsmodell mit einer Vorhersagevariablen vereinfacht sich die obige Gleichung zu</p>
<div class="math notranslate nohighlight">
\[\pi = \beta_0+ \beta_1x_1\text{.}\]</div>
<p>Der rechte Term der Gleichung kann jedoch jeden reellen Wert annehmen, während der linke Term der Gleichung eine Wahrscheinlichkeit auf der Skala von <span class="math notranslate nohighlight">\(0\)</span> bis <span class="math notranslate nohighlight">\(1\)</span> ist. Um die Skala der Daten (rechter Term) in eine Wahrscheinlichkeit zwischen <span class="math notranslate nohighlight">\(0\)</span> und <span class="math notranslate nohighlight">\(1\)</span> abzubilden wenden wir eine so genannte <strong>Verknüpfungsfunktion</strong> an.</p>
<p>Für das logistische Regressionsmodell ist diese Verknüpfungsfunktion die <a href="https://de.wikipedia.org/wiki/Logit">Logit-Funktion</a>. Die Logit-Funktion bildet Wahrscheinlichkeiten aus dem Bereich (<span class="math notranslate nohighlight">\(0,1\)</span>)
auf den gesamten reellen Zahlenbereich (<span class="math notranslate nohighlight">\(-\infty,\infty\)</span>). Sie wird geschrieben als</p>
<div class="math notranslate nohighlight">
\[\eta = logit(\pi)\text{,}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(\pi\)</span> die Wahrscheinlichkeit ist.</p>
<p>Um den Logit zu verstehen, führen wir zunächst die <a href="https://de.wikipedia.org/wiki/Chance_(Stochastik)">Chance</a> oder kurz <strong>Odds</strong> ein. Die Odds (<span class="math notranslate nohighlight">\(o\)</span>) können geschrieben werden als</p>
<div class="math notranslate nohighlight">
\[o = \frac{\pi}{1-\pi}\text{,}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(\pi\)</span> die Wahrscheinlichkeit ist, dass ein Ereignis eintritt. Wenn die Wahrscheinlichkeit eines Ereignisses <span class="math notranslate nohighlight">\(0,5\)</span> beträgt, ist die Wahrscheinlichkeit eins zu eins oder gerade <span class="math notranslate nohighlight">\(\left(\frac{0.5}{1-0.5}=1\right)\)</span>. Wenn die Wahrscheinlichkeit <span class="math notranslate nohighlight">\(1/3\)</span> beträgt, ist die Wahrscheinlichkeit eins zu zwei <span class="math notranslate nohighlight">\(\left(\frac{1/3}{1-1/3}=1/2\right)\)</span>. Die Odds können jeden positiven Wert annehmen und unterliegen daher keiner Beschränkung nach oben <span class="math notranslate nohighlight">\([0 \ \)</span>,<span class="math notranslate nohighlight">\( \ \infty[\)</span>. Daher definieren wir weiter die <strong>Log-Odds</strong>, die der Logarithmus der Odds ist:</p>
<div class="math notranslate nohighlight">
\[\eta = logit(\pi) = log \left( \frac{\pi}{1-\pi}\right)\]</div>
<p>Diese logarithmische Funktion bewirkt, dass die Beschränkung der Untergrenze aufgehoben wird, so dass die Funktion, die <a href="https://de.wikipedia.org/wiki/Logit">Logit-Funktion</a>, unsere Verknüpfungsfunktion, Werte im Bereich von <span class="math notranslate nohighlight">\(0\)</span> bis <span class="math notranslate nohighlight">\(1\)</span> in Werte über den gesamten realen Zahlenbereich <span class="math notranslate nohighlight">\(]-\infty \ \)</span>,<span class="math notranslate nohighlight">\( \ +\infty[\)</span> umwandelt. Wenn die Wahrscheinlichkeit <span class="math notranslate nohighlight">\(1/2\)</span> beträgt sind die Odds gerade und der Logit ist Null. Negative Logits stehen für Wahrscheinlichkeiten unter der Hälfte und positive Logits für Wahrscheinlichkeiten über der Hälfte.</p>
<p>Die umgekehrte Form der Logitfunktion wird auch als <a href="https://de.wikipedia.org/wiki/Logistische_Funktion">logistische Funktion</a> bezeichnet, die aufgrund ihrer charakteristischen <span class="math notranslate nohighlight">\(S\)</span>-Form manchmal einfach als <strong><a href="https://de.wikipedia.org/wiki/Sigmoidfunktion">Sigmoidfunktion</a></strong> abgekürzt wird. Sie ermöglicht es uns, von Logits auf Wahrscheinlichkeiten umzuschalten.</p>
<div class="math notranslate nohighlight">
\[\pi = logit^{-1}(\eta) = \frac{e^{\eta}}{1+e^{\eta}} = \frac{1}{1+e^{-\eta}} = \frac{1}{1+e^{-(\beta_0+ \beta_1x_1+ \beta_2x_2+ ... +\beta_kx_k)}}\]</div>
<p>Die logistische Funktion für das Intervall <span class="math notranslate nohighlight">\([-6 \ \)</span>,<span class="math notranslate nohighlight">\( \ 6]\)</span> ist unten dargestellt. Für Werte von <span class="math notranslate nohighlight">\(\eta\)</span> im Bereich von <span class="math notranslate nohighlight">\(-\infty\)</span> bis <span class="math notranslate nohighlight">\(\infty\)</span> liegt <span class="math notranslate nohighlight">\(\pi\)</span> im Bereich von <span class="math notranslate nohighlight">\(0\)</span> bis <span class="math notranslate nohighlight">\(1\)</span>.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$\eta$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$\pi$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">_y</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">_y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/01_Logistische_Regression_20_0.png" src="_images/01_Logistische_Regression_20_0.png" />
</div>
</div>
</section>
<section id="das-logistische-regressionsmodell">
<h3>Das logistische Regressionsmodell<a class="headerlink" href="#das-logistische-regressionsmodell" title="Permalink to this headline">#</a></h3>
<p>Die Logit-Funktion bildet Wahrscheinlichkeiten auf Werte über den gesamten realen Zahlenbereich ab. Die Wahrscheinlichkeit, dass ein Ereignis/Ergebnis/Erfolg wahr ist (<span class="math notranslate nohighlight">\(y=1\)</span>), wenn die Menge der unabhängigen Variablen <span class="math notranslate nohighlight">\(x_i\)</span>, unsere Daten, gegeben ist, wird also geschrieben als</p>
<div class="math notranslate nohighlight">
\[logit(P(y=1|x_i)) = \beta_0+ \beta_1x_1+ \beta_2x_2 + ... + \beta_kx_k\text{,}\]</div>
<p>Der Einfachheit halber drücken wir das Inverse der obigen Funktion wie folgt aus</p>
<div class="math notranslate nohighlight">
\[\phi(\eta) = \frac{1}{1+e^{-\eta}}\text{,}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(\eta\)</span> die Linearkombination von Koeffizienten (<span class="math notranslate nohighlight">\(\beta_i\)</span>) und unabhängiger Variablen (<span class="math notranslate nohighlight">\(x_i\)</span>) ist, berechnet als <span class="math notranslate nohighlight">\(\eta = \beta_0 + \beta_1x_1 + \beta_2x_2 + ... + \beta_kx_k\)</span>.</p>
<p>Die Parameter (<span class="math notranslate nohighlight">\(\beta_i\)</span>) des Logit-Modells werden nach der <a href="https://de.wikipedia.org/wiki/Maximum-Likelihood-Methode">Methode der maximalen Wahrscheinlichkeit</a> geschätzt. Es gibt jedoch keine geschlossene Lösung, so dass die Maximum-Likelihood-Schätzungen u. a. durch iterative Algorithmen wie <a href="https://de.wikipedia.org/wiki/Newtonverfahren">Newton-Raphson</a>, iterativ neu gewichtete kleinste Quadrate oder <a href="https://de.wikipedia.org/wiki/Gradientenverfahren">Gradientenverfahren</a> ermittelt werden.</p>
<p>Das Ergebnis der Sigmoidfunktion wird als die Wahrscheinlichkeit interpretiert, dass eine bestimmte Beobachtung zur Klasse <span class="math notranslate nohighlight">\(1\)</span> gehört. Sie wird geschrieben als <span class="math notranslate nohighlight">\(\phi(\eta)=P(y=1|x_i,\beta_i)\)</span>, die Erfolgswahrscheinlichkeit (<span class="math notranslate nohighlight">\(y=1\)</span>) bei den durch die Koeffizienten <span class="math notranslate nohighlight">\(\beta_i\)</span> parametrisierten Prädiktorvariablen <span class="math notranslate nohighlight">\(x_i\)</span>. Wenn wir beispielsweise für eine bestimmte Beobachtung <span class="math notranslate nohighlight">\(\phi(\eta)=0,65\)</span> berechnen, bedeutet dies, dass die Wahrscheinlichkeit, dass diese Beobachtung zur Klasse <span class="math notranslate nohighlight">\(1\)</span> gehört, <span class="math notranslate nohighlight">\(65 \%\)</span> beträgt. In ähnlicher Weise wird die Wahrscheinlichkeit, dass diese Beobachtung zu Klasse <span class="math notranslate nohighlight">\(2\)</span> gehört, berechnet als $<span class="math notranslate nohighlight">\(\phi(\eta) = P(y=0|x_i,\beta_i) = 1 - P(y=1|x_i,\beta_i) = 1 - 0,65=0,35\)</span><span class="math notranslate nohighlight">\( oder \)</span>35 %$. Für die Klassenzuordnung wird die vorhergesagte Wahrscheinlichkeit dann über eine Einheitssprungfunktion in ein binäres Ergebnis umgewandelt:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\hat{y} =
\begin{cases}
1,  &amp; \text{wenn $\phi(\eta) \ge$ 0,5} \\
0, &amp; \text{sonst}
\end{cases}\end{split}\]</div>
</section>
<section id="logistische-regression-in-python-ein-beispiel">
<h3>Logistische Regression in Python - ein Beispiel<a class="headerlink" href="#logistische-regression-in-python-ein-beispiel" title="Permalink to this headline">#</a></h3>
<p>Die logistische Regressionsanalyse gehört zur Klasse der <a href="https://de.wikipedia.org/wiki/Verallgemeinerte_lineare_Modelle">verallgemeinerten linearen Modelle</a>. In Python werden verallgemeinerte lineare Modelle mit der Funktion <code class="docutils literal notranslate"><span class="pre">GLM()</span></code> verarbeitet. Die Funktion wird als <code class="docutils literal notranslate"><span class="pre">GLM(y=Antwort,</span> <span class="pre">X=Prädiktor,</span> <span class="pre">family=sm.families.Binomial())</span></code> geschrieben. Bitte beachten Sie, dass <code class="docutils literal notranslate"><span class="pre">logit</span></code> die Vorgabe für binomial ist; wir müssen es also nicht explizit eingeben. Die Funktion <code class="docutils literal notranslate"><span class="pre">GLM()</span></code> gibt ein Modellobjekt zurück, auf das wir Extraktormethoden wie <code class="docutils literal notranslate"><span class="pre">summary()</span></code>, <code class="docutils literal notranslate"><span class="pre">fitted()</span></code> oder <code class="docutils literal notranslate"><span class="pre">predict()</span></code> anwenden können.</p>
<section id="einfuhrung-und-explorative-datenanalyse">
<h4>Einführung und explorative Datenanalyse<a class="headerlink" href="#einfuhrung-und-explorative-datenanalyse" title="Permalink to this headline">#</a></h4>
<p>Dieses Beispiel ist inspiriert von der Arbeit von <a href="https://myweb.fsu.edu/jelsner/_site/index.html">James B. Elsner</a> und seinen Kollegen (<a href="https://journals.ametsoc.org/view/journals/clim/9/11/1520-0442_1996_009_2880_ocoah_2_0_co_2.xml">Elsner et al. 1996</a> und <a href="https://journals.ametsoc.org/doi/10.1175/1520-0442-11.8.2062">Kimberlain und Elsner 1998</a>), die an der <strong>Klassifizierung der nordatlantischen Hurrikane</strong> auf der Grundlage von Entstehungs- und Entwicklungsmechanismen gearbeitet haben. Die Klassifizierung ergibt drei verschiedene Gruppen: tropische Wirbelstürme, Wirbelstürme unter baroklinem Einfluss und Wirbelstürme mit baroklinem Ursprung. Der Begriff “baroklin” bezieht sich auf die Tatsache, dass diese Hurrikane von Störungen der äußeren Tropen beeinflusst werden oder sogar in den äußeren Tropen entstehen. Die stärkeren tropischen Wirbelstürme entwickeln sich weiter südlich und treten hauptsächlich im August und September auf. Die schwächeren außertropischen Wirbelstürme treten während einer längeren Saison auf. Der ursprüngliche Datensatz zur objektiven Hurrikan-Klassifizierung kann <a href="https://myweb.fsu.edu/jelsner/temp/Data.html">hier</a> abgerufen werden. Die Analyse von James B. Elsner kann <a href="https://rpubs.com/jelsner/5206">hier</a> eingesehen werden.</p>
<p><strong>Ziel der Übung ist es, ein Modell zu erstellen, das die Gruppenzugehörigkeit eines Hurrikans, entweder tropisch oder aussertropisch, auf der Grundlage des Breitengrades seiner Entstehung vorhersagt.</strong></p>
<p>Wir beginnen die Analyse mit dem Laden des Datensatzes. Laden Sie die Daten auf Ihren Computer <a href="https://myweb.fsu.edu/jelsner/temp/Data.html">herunter</a> und öffnen Sie die Datei. Bitte beachten Sie, dass es sich bei der Datei um ein <em>Excel</em>-Tabelle handelt. Um mit <em>Excel</em>-Tabellen umgehen zu können benutzen wir <code class="docutils literal notranslate"><span class="pre">read_excel()</span></code> aus dem <code class="docutils literal notranslate"><span class="pre">Pandas</span></code> Paket.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hurricanes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;../../data/hurricanes.xlsx&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">hurricanes</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Number</th>
      <th>Name</th>
      <th>Year</th>
      <th>Type</th>
      <th>FirstLat</th>
      <th>FirstLon</th>
      <th>MaxLat</th>
      <th>MaxLon</th>
      <th>LastLat</th>
      <th>LastLon</th>
      <th>MaxInt</th>
    </tr>
    <tr>
      <th>RowNames</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>430</td>
      <td>NOTNAMED</td>
      <td>1944</td>
      <td>1</td>
      <td>30.2</td>
      <td>-76.1</td>
      <td>32.1</td>
      <td>-74.8</td>
      <td>35.1</td>
      <td>-69.2</td>
      <td>80</td>
    </tr>
    <tr>
      <th>2</th>
      <td>432</td>
      <td>NOTNAMED</td>
      <td>1944</td>
      <td>0</td>
      <td>25.6</td>
      <td>-74.9</td>
      <td>31.0</td>
      <td>-78.1</td>
      <td>32.6</td>
      <td>-78.2</td>
      <td>80</td>
    </tr>
    <tr>
      <th>3</th>
      <td>433</td>
      <td>NOTNAMED</td>
      <td>1944</td>
      <td>0</td>
      <td>14.2</td>
      <td>-65.2</td>
      <td>16.6</td>
      <td>-72.2</td>
      <td>20.6</td>
      <td>-88.5</td>
      <td>105</td>
    </tr>
    <tr>
      <th>4</th>
      <td>436</td>
      <td>NOTNAMED</td>
      <td>1944</td>
      <td>0</td>
      <td>20.8</td>
      <td>-58.0</td>
      <td>26.3</td>
      <td>-72.3</td>
      <td>42.1</td>
      <td>-71.5</td>
      <td>120</td>
    </tr>
    <tr>
      <th>5</th>
      <td>437</td>
      <td>NOTNAMED</td>
      <td>1944</td>
      <td>0</td>
      <td>20.0</td>
      <td>-84.2</td>
      <td>20.6</td>
      <td>-84.9</td>
      <td>19.1</td>
      <td>-93.9</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Zunächst untersuchen wir die Struktur des Datensatzes, indem wir die Methode <code class="docutils literal notranslate"><span class="pre">info()</span></code> anwenden.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hurricanes</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 337 entries, 1 to 337
Data columns (total 11 columns):
 #   Column    Non-Null Count  Dtype  
---  ------    --------------  -----  
 0   Number    337 non-null    int64  
 1   Name      337 non-null    object 
 2   Year      337 non-null    int64  
 3   Type      337 non-null    int64  
 4   FirstLat  337 non-null    float64
 5   FirstLon  337 non-null    float64
 6   MaxLat    337 non-null    float64
 7   MaxLon    337 non-null    float64
 8   LastLat   337 non-null    float64
 9   LastLon   337 non-null    float64
 10  MaxInt    337 non-null    int64  
dtypes: float64(6), int64(4), object(1)
memory usage: 31.6+ KB
</pre></div>
</div>
</div>
</div>
<p>Der Datensatz besteht aus <span class="math notranslate nohighlight">\(337\)</span> Beobachtungen und <span class="math notranslate nohighlight">\(12\)</span> Variablen. Wir interessieren uns in erster Linie für die Variable <code class="docutils literal notranslate"><span class="pre">Type</span></code>, die unsere Antwortvariable ist, und für die Variable <code class="docutils literal notranslate"><span class="pre">FirstLat</span></code>, die dem Breitengrad der Entstehung entspricht und somit unsere Prädiktorvariable ist. Um jedoch ein Gefühl für den Datensatz zu bekommen, stellen wir die Anzahl der Hurrikane für jedes Jahr als Balkendiagramm mit dem <code class="docutils literal notranslate"><span class="pre">mathplotlib</span></code>-Paket dar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hurricanes</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="_images/01_Logistische_Regression_38_1.png" src="_images/01_Logistische_Regression_38_1.png" />
</div>
</div>
<p>Das ist eine schöne Darstellung. Indem wir den Datensatz umformen können wir die Balken zusätzlich entsprechend der Variable <code class="docutils literal notranslate"><span class="pre">Type</span></code> einfärben.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hurricane_types</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">hurricanes</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">)[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">hurricane_types</span> <span class="o">=</span> <span class="n">hurricane_types</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;Tropisch&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;Baroklinisch beeinflusst&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;Barokline Entstehung&quot;</span><span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hurricane_types</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;Year&#39;&gt;
</pre></div>
</div>
<img alt="_images/01_Logistische_Regression_41_1.png" src="_images/01_Logistische_Regression_41_1.png" />
</div>
</div>
<p>Für eine numerische Darstellung der Hurricane-Klassen verwenden wir die Methode <code class="docutils literal notranslate"><span class="pre">sum()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Klasse 0 (tropische Wirbelstürme) Hurrikans: </span><span class="si">{</span><span class="n">hurricane_types</span><span class="p">[</span><span class="s1">&#39;Tropisch&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Klasse 1 (barokline Einflüsse) Hurrikans: </span><span class="si">{</span><span class="n">hurricane_types</span><span class="p">[</span><span class="s1">&#39;Baroklinisch beeinflusst&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Klasse 3 (barokline Auslösung) Hurrikans: </span><span class="si">{</span><span class="n">hurricane_types</span><span class="p">[</span><span class="s1">&#39;Barokline Entstehung&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Klasse 0 (tropische Wirbelstürme) Hurrikans: 187.0
Klasse 1 (barokline Einflüsse) Hurrikans: 77.0
Klasse 3 (barokline Auslösung) Hurrikans: 73.0
</pre></div>
</div>
</div>
</div>
<p>Für die <strong>Klasse</strong> <span class="math notranslate nohighlight">\(0\)</span>, <em>tropische Wirbelstürme</em>, gibt es <span class="math notranslate nohighlight">\(187\)</span> Beobachtungen, für die <strong>Klasse</strong> <span class="math notranslate nohighlight">\(1\)</span>, <em>barokline Einflüsse</em>, gibt es <span class="math notranslate nohighlight">\(77\)</span> Beobachtungen und für die <strong>Klasse</strong> <span class="math notranslate nohighlight">\(3\)</span>, <em>barokline Auslösung</em>, gibt es <span class="math notranslate nohighlight">\(73\)</span> Beobachtungen. Bei der logistischen Regression haben wir es mit dichotomen Daten zu tun; der Einfachheit halber kodieren wir die Klassen neu und weisen der Klasse <span class="math notranslate nohighlight">\(1\)</span> und der Klasse <span class="math notranslate nohighlight">\(3\)</span>, die beide von den äußeren Tropen beeinflusst werden, die Bezeichnung <code class="docutils literal notranslate"><span class="pre">aussertropisch</span></code> zu.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hurricanes</span><span class="p">[</span><span class="s2">&quot;Origins&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hurricanes</span><span class="p">[</span><span class="s2">&quot;Type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;tropisch&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;aussertropisch&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;aussertropisch&quot;</span><span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Wir haben nun eine binäre Antwortvariable mit zwei Klassen: Tropische und aussertropische Wirbelstürmen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hurricanes</span><span class="p">[</span><span class="s2">&quot;Origins&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tropisch          187
aussertropisch    150
Name: Origins, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Um diesen Teil der explorativen Datenanalyse abzuschließen, stellen wir die Daten auf einer interaktiven Karte dar, indem wir das <code class="docutils literal notranslate"><span class="pre">folium</span></code>-Paket verwenden.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hurricanes</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Number</th>
      <th>Name</th>
      <th>Year</th>
      <th>Type</th>
      <th>FirstLat</th>
      <th>FirstLon</th>
      <th>MaxLat</th>
      <th>MaxLon</th>
      <th>LastLat</th>
      <th>LastLon</th>
      <th>MaxInt</th>
      <th>Origins</th>
    </tr>
    <tr>
      <th>RowNames</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>430</td>
      <td>NOTNAMED</td>
      <td>1944</td>
      <td>1</td>
      <td>30.2</td>
      <td>-76.1</td>
      <td>32.1</td>
      <td>-74.8</td>
      <td>35.1</td>
      <td>-69.2</td>
      <td>80</td>
      <td>aussertropisch</td>
    </tr>
    <tr>
      <th>2</th>
      <td>432</td>
      <td>NOTNAMED</td>
      <td>1944</td>
      <td>0</td>
      <td>25.6</td>
      <td>-74.9</td>
      <td>31.0</td>
      <td>-78.1</td>
      <td>32.6</td>
      <td>-78.2</td>
      <td>80</td>
      <td>tropisch</td>
    </tr>
    <tr>
      <th>3</th>
      <td>433</td>
      <td>NOTNAMED</td>
      <td>1944</td>
      <td>0</td>
      <td>14.2</td>
      <td>-65.2</td>
      <td>16.6</td>
      <td>-72.2</td>
      <td>20.6</td>
      <td>-88.5</td>
      <td>105</td>
      <td>tropisch</td>
    </tr>
    <tr>
      <th>4</th>
      <td>436</td>
      <td>NOTNAMED</td>
      <td>1944</td>
      <td>0</td>
      <td>20.8</td>
      <td>-58.0</td>
      <td>26.3</td>
      <td>-72.3</td>
      <td>42.1</td>
      <td>-71.5</td>
      <td>120</td>
      <td>tropisch</td>
    </tr>
    <tr>
      <th>5</th>
      <td>437</td>
      <td>NOTNAMED</td>
      <td>1944</td>
      <td>0</td>
      <td>20.0</td>
      <td>-84.2</td>
      <td>20.6</td>
      <td>-84.9</td>
      <td>19.1</td>
      <td>-93.9</td>
      <td>70</td>
      <td>tropisch</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the map</span>
<span class="n">hurricane_map</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">],</span> <span class="n">zoom_start</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="c1"># add marker one by one on the map</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;aussertropisch&quot;</span><span class="p">:</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;tropisch&quot;</span><span class="p">:</span> <span class="s2">&quot;red&quot;</span><span class="p">}</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">hurricanes</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span>
        <span class="n">location</span><span class="o">=</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">FirstLat</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">FirstLon</span><span class="p">],</span> <span class="n">icon</span><span class="o">=</span><span class="n">folium</span><span class="o">.</span><span class="n">Icon</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">Origins</span><span class="p">])</span>
    <span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add_to</span><span class="p">(</span><span class="n">hurricane_map</span><span class="p">)</span>
<span class="c1"># Show the map</span>
<span class="n">hurricane_map</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div style="width:100%;"><div style="position:relative;width:100%;height:0;padding-bottom:60%;"><span style="color:#565656">Make this Notebook Trusted to load map: File -> Trust Notebook</span><iframe srcdoc="&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;

    &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

        &lt;script&gt;
            L_NO_TOUCH = false;
            L_DISABLE_3D = false;
        &lt;/script&gt;

    &lt;style&gt;html, body {width: 100%;height: 100%;margin: 0;padding: 0;}&lt;/style&gt;
    &lt;style&gt;#map {position:absolute;top:0;bottom:0;right:0;left:0;}&lt;/style&gt;
    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;https://code.jquery.com/jquery-1.12.4.min.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js&quot;&gt;&lt;/script&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css&quot;/&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css&quot;/&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css&quot;/&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css&quot;/&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css&quot;/&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css&quot;/&gt;

            &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,
                initial-scale=1.0, maximum-scale=1.0, user-scalable=no&quot; /&gt;
            &lt;style&gt;
                #map_52c910d9a8beadf5e6b8546e0098f9b3 {
                    position: relative;
                    width: 100.0%;
                    height: 100.0%;
                    left: 0.0%;
                    top: 0.0%;
                }
                .leaflet-container { font-size: 1rem; }
            &lt;/style&gt;

&lt;/head&gt;
&lt;body&gt;


            &lt;div class=&quot;folium-map&quot; id=&quot;map_52c910d9a8beadf5e6b8546e0098f9b3&quot; &gt;&lt;/div&gt;

&lt;/body&gt;
&lt;script&gt;


            var map_52c910d9a8beadf5e6b8546e0098f9b3 = L.map(
                &quot;map_52c910d9a8beadf5e6b8546e0098f9b3&quot;,
                {
                    center: [25.0, -50.0],
                    crs: L.CRS.EPSG3857,
                    zoom: 4,
                    zoomControl: true,
                    preferCanvas: false,
                }
            );





            var tile_layer_52a0dd2999c8826340325da4b3cca4ae = L.tileLayer(
                &quot;https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png&quot;,
                {&quot;attribution&quot;: &quot;Data by \u0026copy; \u003ca target=\&quot;_blank\&quot; href=\&quot;http://openstreetmap.org\&quot;\u003eOpenStreetMap\u003c/a\u003e, under \u003ca target=\&quot;_blank\&quot; href=\&quot;http://www.openstreetmap.org/copyright\&quot;\u003eODbL\u003c/a\u003e.&quot;, &quot;detectRetina&quot;: false, &quot;maxNativeZoom&quot;: 18, &quot;maxZoom&quot;: 18, &quot;minZoom&quot;: 0, &quot;noWrap&quot;: false, &quot;opacity&quot;: 1, &quot;subdomains&quot;: &quot;abc&quot;, &quot;tms&quot;: false}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var marker_b1c7d02c9de073156236b756d6a996ba = L.marker(
                [30.2, -76.1],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_92dd3fd6987e8e3a27406b2024dc5b5d = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_b1c7d02c9de073156236b756d6a996ba.setIcon(icon_92dd3fd6987e8e3a27406b2024dc5b5d);


            var marker_3bcfc073d7b2f9ef095bbf74631740c3 = L.marker(
                [25.6, -74.9],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_2f8cc1052644f822efb2542576b60661 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_3bcfc073d7b2f9ef095bbf74631740c3.setIcon(icon_2f8cc1052644f822efb2542576b60661);


            var marker_63c30ec709b31d31066df8b58d84fe39 = L.marker(
                [14.2, -65.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_b734f3eef9f43c23cb9e2072f104f67b = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_63c30ec709b31d31066df8b58d84fe39.setIcon(icon_b734f3eef9f43c23cb9e2072f104f67b);


            var marker_f6397968dc0abd24783f6f79d8f7f307 = L.marker(
                [20.8, -58.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_72d4643b1227ecc5486a2a80337cf370 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_f6397968dc0abd24783f6f79d8f7f307.setIcon(icon_72d4643b1227ecc5486a2a80337cf370);


            var marker_e39e494a0a7bd7964364e146819f6f9c = L.marker(
                [20.0, -84.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_b788b19a165ce37edb74bf19bc5ba562 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_e39e494a0a7bd7964364e146819f6f9c.setIcon(icon_b788b19a165ce37edb74bf19bc5ba562);


            var marker_aacb64b1440f653b882eb699fa8e7087 = L.marker(
                [29.2, -55.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_ed919fbf383dad99f3b13f1a1d5f4663 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_aacb64b1440f653b882eb699fa8e7087.setIcon(icon_ed919fbf383dad99f3b13f1a1d5f4663);


            var marker_3e25067fe220c8890f8964034f90143a = L.marker(
                [16.1, -80.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_2f54ebf685db34b08cb9025721a0ae81 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_3e25067fe220c8890f8964034f90143a.setIcon(icon_2f54ebf685db34b08cb9025721a0ae81);


            var marker_91a5f6cbc3562616b31138bb1d164a9a = L.marker(
                [27.6, -85.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_acd2cbac5195a6986425688a1ead8ff0 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_91a5f6cbc3562616b31138bb1d164a9a.setIcon(icon_acd2cbac5195a6986425688a1ead8ff0);


            var marker_52b64c0758af093d46941c77bf7701d3 = L.marker(
                [21.6, -95.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_b7d18dfdd33ee1fbef48d41ff1c8520b = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_52b64c0758af093d46941c77bf7701d3.setIcon(icon_b7d18dfdd33ee1fbef48d41ff1c8520b);


            var marker_9fcb0fe2d88bb04fd5f98b07ac4fc72e = L.marker(
                [19.0, -56.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_bc1d149cc6a02d450ca23e2e79ae6e6b = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_9fcb0fe2d88bb04fd5f98b07ac4fc72e.setIcon(icon_bc1d149cc6a02d450ca23e2e79ae6e6b);


            var marker_e05a5fcc3cf3554ab1c18c5b30b3fa38 = L.marker(
                [16.2, -82.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_9f642be52fa794376276e7cea691bc7b = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_e05a5fcc3cf3554ab1c18c5b30b3fa38.setIcon(icon_9f642be52fa794376276e7cea691bc7b);


            var marker_2dfa2dc976f661f2831bb59fa1106ef3 = L.marker(
                [19.6, -80.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_2a30f5a30f495036794e2eb51d1dbd31 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_2dfa2dc976f661f2831bb59fa1106ef3.setIcon(icon_2a30f5a30f495036794e2eb51d1dbd31);


            var marker_a1b792a676a324eb503d254908b86dcc = L.marker(
                [36.5, -72.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_34c69217e365bb83b3b15f89d24c8711 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_a1b792a676a324eb503d254908b86dcc.setIcon(icon_34c69217e365bb83b3b15f89d24c8711);


            var marker_7ad43af8c62fcf1a1f8c7ca3c82578bc = L.marker(
                [26.4, -77.9],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_92e5c839edceae216cc2578d7ebcdddd = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_7ad43af8c62fcf1a1f8c7ca3c82578bc.setIcon(icon_92e5c839edceae216cc2578d7ebcdddd);


            var marker_cdc6b79c31b2d9d76ed3ddf9a09eae50 = L.marker(
                [19.6, -85.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_87ee8e46a5e56bd9c07f79f83d7d5421 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_cdc6b79c31b2d9d76ed3ddf9a09eae50.setIcon(icon_87ee8e46a5e56bd9c07f79f83d7d5421);


            var marker_41ddcbbdbc024861895973cb561bf34e = L.marker(
                [21.0, -92.5],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_de936b0de532ba1e98ce17acb218d3a5 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_41ddcbbdbc024861895973cb561bf34e.setIcon(icon_de936b0de532ba1e98ce17acb218d3a5);


            var marker_a7c8cb166b7f02cca4fdc1dbb5dfab1f = L.marker(
                [26.5, -90.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_b8445653a02632abfc7d943c8a8cfc88 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_a7c8cb166b7f02cca4fdc1dbb5dfab1f.setIcon(icon_b8445653a02632abfc7d943c8a8cfc88);


            var marker_672bd24ffe38ee69267a387119cce30f = L.marker(
                [14.1, -24.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_dcab4b34a51baddf7809f45850bbf93d = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_672bd24ffe38ee69267a387119cce30f.setIcon(icon_dcab4b34a51baddf7809f45850bbf93d);


            var marker_96089231e523ff39951b0b9b452d3abd = L.marker(
                [24.1, -82.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_d949aa34fdfd4cabe53b2b9a9b938428 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_96089231e523ff39951b0b9b452d3abd.setIcon(icon_d949aa34fdfd4cabe53b2b9a9b938428);


            var marker_2f9e60ff6fc8181214b6ba4c6fc5c18f = L.marker(
                [19.7, -66.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_ef17549b67e699042229a49104e0bffa = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_2f9e60ff6fc8181214b6ba4c6fc5c18f.setIcon(icon_ef17549b67e699042229a49104e0bffa);


            var marker_1cd2065dfd4b8e2a51627e1f60e09145 = L.marker(
                [20.9, -61.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_7ef0cde2da766b598dca91e820eebc89 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_1cd2065dfd4b8e2a51627e1f60e09145.setIcon(icon_7ef0cde2da766b598dca91e820eebc89);


            var marker_3f10adbb01e78d2558e81e04788ad911 = L.marker(
                [25.8, -92.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_902e297527e9371c5fc98a772ac7798c = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_3f10adbb01e78d2558e81e04788ad911.setIcon(icon_902e297527e9371c5fc98a772ac7798c);


            var marker_b12981ffae4088de4fe10e3cee920f77 = L.marker(
                [14.3, -23.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_c1339bce0d271cc9c3aec27d41da7d46 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_b12981ffae4088de4fe10e3cee920f77.setIcon(icon_c1339bce0d271cc9c3aec27d41da7d46);


            var marker_8ebba9b2e71907c56102aa0bb6d4d79f = L.marker(
                [18.5, -80.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_74e468ef0c8448ab51f0a3f9d8acf5ce = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_8ebba9b2e71907c56102aa0bb6d4d79f.setIcon(icon_74e468ef0c8448ab51f0a3f9d8acf5ce);


            var marker_bae674b5024cd8d4ba9fc09ef0387ce2 = L.marker(
                [19.4, -85.1],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_9d09e47ec0dafc5ae37d0b9e360cdbb0 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_bae674b5024cd8d4ba9fc09ef0387ce2.setIcon(icon_9d09e47ec0dafc5ae37d0b9e360cdbb0);


            var marker_88bee480e1f45b5f780cda74436372e9 = L.marker(
                [25.9, -68.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_40660e181b3084b76af25da7da8b23eb = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_88bee480e1f45b5f780cda74436372e9.setIcon(icon_40660e181b3084b76af25da7da8b23eb);


            var marker_9cccc5432cd5b4303916e772babdbe21 = L.marker(
                [22.3, -64.7],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_a99a699cc95185001c33b1f842343aa6 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_9cccc5432cd5b4303916e772babdbe21.setIcon(icon_a99a699cc95185001c33b1f842343aa6);


            var marker_a0a8bbed9b0111be920887eab58b8bf4 = L.marker(
                [23.4, -73.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_e659fadb7c25b1c96b8f0de403d02343 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_a0a8bbed9b0111be920887eab58b8bf4.setIcon(icon_e659fadb7c25b1c96b8f0de403d02343);


            var marker_828bd87861920549a7ae7074710ea80a = L.marker(
                [20.9, -66.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_36637c12bdc0ef9981cfdc5bc2ba7130 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_828bd87861920549a7ae7074710ea80a.setIcon(icon_36637c12bdc0ef9981cfdc5bc2ba7130);


            var marker_78d20f9643d38c3e3f4829e9d4226e70 = L.marker(
                [23.0, -94.9],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_b7c3e5e78c1b66ca4a4b9be85ead8832 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_78d20f9643d38c3e3f4829e9d4226e70.setIcon(icon_b7c3e5e78c1b66ca4a4b9be85ead8832);


            var marker_120a2dfd54f4c40293a53c216d71c32d = L.marker(
                [16.4, -65.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_cf25570acc79c1fe48f6e7e62213d2ee = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_120a2dfd54f4c40293a53c216d71c32d.setIcon(icon_cf25570acc79c1fe48f6e7e62213d2ee);


            var marker_544f3cc676d728264dc01acec60902d8 = L.marker(
                [22.0, -94.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_4a485af68a3dc033950cac10ee681f73 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_544f3cc676d728264dc01acec60902d8.setIcon(icon_4a485af68a3dc033950cac10ee681f73);


            var marker_5422b179235a0411cba0a3cf6d161dd9 = L.marker(
                [24.2, -71.9],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_cfe24b49c7f214708b48efc86c211df0 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_5422b179235a0411cba0a3cf6d161dd9.setIcon(icon_cfe24b49c7f214708b48efc86c211df0);


            var marker_35b71075147615507010d79667630b53 = L.marker(
                [21.0, -62.5],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_3060c10f7c1a6a61d992bce65e92cfa7 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_35b71075147615507010d79667630b53.setIcon(icon_3060c10f7c1a6a61d992bce65e92cfa7);


            var marker_929c8cafe7763012c39cf14b7f0c78b0 = L.marker(
                [16.5, -57.4],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_f20b7834d0fe4622e3ea93a886cca960 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_929c8cafe7763012c39cf14b7f0c78b0.setIcon(icon_f20b7834d0fe4622e3ea93a886cca960);


            var marker_d1a14d6fb39a8cfdcca9636c20f1b2ab = L.marker(
                [22.0, -52.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_5f6cedbedb7da61dd1bc8e326c1a1d9b = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_d1a14d6fb39a8cfdcca9636c20f1b2ab.setIcon(icon_5f6cedbedb7da61dd1bc8e326c1a1d9b);


            var marker_8e82b5dfa6aba8670dd0a2d6e250cf40 = L.marker(
                [15.7, -56.5],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_f0ccd6503e2bd6c6406b24a64eec2101 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_8e82b5dfa6aba8670dd0a2d6e250cf40.setIcon(icon_f0ccd6503e2bd6c6406b24a64eec2101);


            var marker_180a324adacd835184913086c1c5134a = L.marker(
                [21.0, -82.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_342b7df26a2e25d3bcfaa7fd2f52d2da = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_180a324adacd835184913086c1c5134a.setIcon(icon_342b7df26a2e25d3bcfaa7fd2f52d2da);


            var marker_8b83981ee9d190247a75fb89af92cd5a = L.marker(
                [18.9, -50.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_5e63c49a4b21fb40bb61094e5ed50f52 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_8b83981ee9d190247a75fb89af92cd5a.setIcon(icon_5e63c49a4b21fb40bb61094e5ed50f52);


            var marker_6111f3c4a9a2a0af581b1f5aeb033182 = L.marker(
                [30.3, -63.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_347c60da1777a7894eb1b661b35aa6de = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_6111f3c4a9a2a0af581b1f5aeb033182.setIcon(icon_347c60da1777a7894eb1b661b35aa6de);


            var marker_d1491ea18f7221b6aae094c4115da9bf = L.marker(
                [21.0, -93.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_cca03c85f74fcb3f79a222d109df8a55 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_d1491ea18f7221b6aae094c4115da9bf.setIcon(icon_cca03c85f74fcb3f79a222d109df8a55);


            var marker_3a8ff304ee34cd2e16b678dc3a97a758 = L.marker(
                [25.4, -55.5],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_0f0aa158c7818654f8f68a44edb5dd5d = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_3a8ff304ee34cd2e16b678dc3a97a758.setIcon(icon_0f0aa158c7818654f8f68a44edb5dd5d);


            var marker_8c7760b315c2301f737256ae44cf2040 = L.marker(
                [18.2, -79.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_852a58484c8636191869765e6f6587c4 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_8c7760b315c2301f737256ae44cf2040.setIcon(icon_852a58484c8636191869765e6f6587c4);


            var marker_e97e57733a721b4a48c1c09b961c69b3 = L.marker(
                [27.5, -90.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_a99fd96fda190a8b6727e6b93cc92c52 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_e97e57733a721b4a48c1c09b961c69b3.setIcon(icon_a99fd96fda190a8b6727e6b93cc92c52);


            var marker_e3d0a982c48ff8f21630cf0ebbd5c614 = L.marker(
                [28.7, -78.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_68426d3df60a53c9dfedea834b934483 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_e3d0a982c48ff8f21630cf0ebbd5c614.setIcon(icon_68426d3df60a53c9dfedea834b934483);


            var marker_cb60b747d5c4f6a81a65282bc2fb5706 = L.marker(
                [15.4, -62.5],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_3a4b31e0a7603e39f2b55fe9a2380464 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_cb60b747d5c4f6a81a65282bc2fb5706.setIcon(icon_3a4b31e0a7603e39f2b55fe9a2380464);


            var marker_cec3582655a1974fb3785022dc62eadc = L.marker(
                [14.1, -58.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_4726e36f6bdce525bd099d24fbd56027 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_cec3582655a1974fb3785022dc62eadc.setIcon(icon_4726e36f6bdce525bd099d24fbd56027);


            var marker_564fcab9365c5651b1f324b3669aae75 = L.marker(
                [16.6, -42.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_3e4014776ab1ae540b12e5e4e4b70d85 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_564fcab9365c5651b1f324b3669aae75.setIcon(icon_3e4014776ab1ae540b12e5e4e4b70d85);


            var marker_a4df4eb5e3c9c5354cfcefdd98066bb1 = L.marker(
                [15.2, -36.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_cb3a3e3dc57a1c978bb42394c47ed668 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_a4df4eb5e3c9c5354cfcefdd98066bb1.setIcon(icon_cb3a3e3dc57a1c978bb42394c47ed668);


            var marker_963eedd4d003bff480c29abadf0e0be4 = L.marker(
                [29.0, -78.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_031af7120d2994ea5a896b6e748e1e3d = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_963eedd4d003bff480c29abadf0e0be4.setIcon(icon_031af7120d2994ea5a896b6e748e1e3d);


            var marker_7704ac80d47c79a94edc6ca8e3275347 = L.marker(
                [18.5, -82.1],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_4425dfa612a93f0eb6c59988735b79f7 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_7704ac80d47c79a94edc6ca8e3275347.setIcon(icon_4425dfa612a93f0eb6c59988735b79f7);


            var marker_540fe153a8e42150b30334ce009423e1 = L.marker(
                [29.4, -75.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_1207bdfb1e4a4cfa4a9529a87eaaf2e2 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_540fe153a8e42150b30334ce009423e1.setIcon(icon_1207bdfb1e4a4cfa4a9529a87eaaf2e2);


            var marker_a8006a0b2e897a7a470ee1cc20eac377 = L.marker(
                [21.9, -64.7],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_b670731d0d99879dbb4264ae1df1bb85 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_a8006a0b2e897a7a470ee1cc20eac377.setIcon(icon_b670731d0d99879dbb4264ae1df1bb85);


            var marker_92d0d4638a46bdf8ba3c20c180a8877f = L.marker(
                [18.2, -59.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_b3cdf03ad489b5cf8044736aab916684 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_92d0d4638a46bdf8ba3c20c180a8877f.setIcon(icon_b3cdf03ad489b5cf8044736aab916684);


            var marker_d82a99163dbc790f4483de4943b9541a = L.marker(
                [24.5, -73.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_0db9a25342962831e0f7b17f531056e3 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_d82a99163dbc790f4483de4943b9541a.setIcon(icon_0db9a25342962831e0f7b17f531056e3);


            var marker_0250d7cb5b2d0c344241a4734dc8db5e = L.marker(
                [16.6, -54.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_c2d799b66469117be3599075092b828b = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_0250d7cb5b2d0c344241a4734dc8db5e.setIcon(icon_c2d799b66469117be3599075092b828b);


            var marker_2385264d16929ac0a28c21a2a4235a23 = L.marker(
                [17.5, -51.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_afb12e4f2cbb74953a8359a49cc0d2ad = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_2385264d16929ac0a28c21a2a4235a23.setIcon(icon_afb12e4f2cbb74953a8359a49cc0d2ad);


            var marker_60e88e8efc889d5f6dbba6f598086d7e = L.marker(
                [16.8, -82.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_ec355b3cb37d85bb57419add443dd74f = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_60e88e8efc889d5f6dbba6f598086d7e.setIcon(icon_ec355b3cb37d85bb57419add443dd74f);


            var marker_751a82ff37be712b0f6635544d69f540 = L.marker(
                [29.2, -75.9],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_34318a47560c7ac927396dd944c21fa1 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_751a82ff37be712b0f6635544d69f540.setIcon(icon_34318a47560c7ac927396dd944c21fa1);


            var marker_8f8d3a00949d2ed822b0c99b63448605 = L.marker(
                [14.2, -49.5],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_282cfcc091a319d3b23f798909326da0 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_8f8d3a00949d2ed822b0c99b63448605.setIcon(icon_282cfcc091a319d3b23f798909326da0);


            var marker_e36f33f331d11c9e7a7227a577eba748 = L.marker(
                [20.7, -69.4],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_8af38921360226c0527c5e84a9329803 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_e36f33f331d11c9e7a7227a577eba748.setIcon(icon_8af38921360226c0527c5e84a9329803);


            var marker_db00f11a960b46e612503972d52ab05b = L.marker(
                [20.9, -67.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_5f1ff834976a7d7c1a6200b28478633d = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_db00f11a960b46e612503972d52ab05b.setIcon(icon_5f1ff834976a7d7c1a6200b28478633d);


            var marker_211c2e9382765bbf12dffafa24aed247 = L.marker(
                [20.9, -85.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_654d5cae0cd5500b61f0eca51f16740a = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_211c2e9382765bbf12dffafa24aed247.setIcon(icon_654d5cae0cd5500b61f0eca51f16740a);


            var marker_2d71b081df4e2db2ca0eecc64ac31f79 = L.marker(
                [14.8, -42.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_d10383746431e9ddd794caa7fe39b6da = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_2d71b081df4e2db2ca0eecc64ac31f79.setIcon(icon_d10383746431e9ddd794caa7fe39b6da);


            var marker_b6058f94a3dddd1433ffed835269c761 = L.marker(
                [24.0, -95.7],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_bde212da26e9577237e301c224868ec8 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_b6058f94a3dddd1433ffed835269c761.setIcon(icon_bde212da26e9577237e301c224868ec8);


            var marker_a893358242e9d74ad66a8e7c4543ec71 = L.marker(
                [28.9, -76.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_a122b657c0378f42e8b00152fe8b9ce8 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_a893358242e9d74ad66a8e7c4543ec71.setIcon(icon_a122b657c0378f42e8b00152fe8b9ce8);


            var marker_5ee4bfbd46a536d4adcd6c10c6e60345 = L.marker(
                [24.8, -69.5],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_999e9f83d9fd5d97ea9589e292cb1279 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_5ee4bfbd46a536d4adcd6c10c6e60345.setIcon(icon_999e9f83d9fd5d97ea9589e292cb1279);


            var marker_cd54a6410714e179d4cf0e777599206e = L.marker(
                [22.2, -70.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_86722443b8eb7169392e73622d39ee87 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_cd54a6410714e179d4cf0e777599206e.setIcon(icon_86722443b8eb7169392e73622d39ee87);


            var marker_e542a9410c45e636fba837f3b71902bf = L.marker(
                [20.8, -95.9],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_f0c349624931b1f42e081d3abfd59365 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_e542a9410c45e636fba837f3b71902bf.setIcon(icon_f0c349624931b1f42e081d3abfd59365);


            var marker_46269a2ae8c18699aa8455c35f410992 = L.marker(
                [31.0, -53.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_2e33dbf010abb6ef4881922b2b7e276a = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_46269a2ae8c18699aa8455c35f410992.setIcon(icon_2e33dbf010abb6ef4881922b2b7e276a);


            var marker_8347c11757d2c925d516162c8f0a6fa7 = L.marker(
                [12.8, -61.1],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_b203f855d24e13c116880ce6dca8cd7a = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_8347c11757d2c925d516162c8f0a6fa7.setIcon(icon_b203f855d24e13c116880ce6dca8cd7a);


            var marker_f7f9db9071a0dc5dc65cbeafe9a1125c = L.marker(
                [20.6, -55.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_5b270e786493b290ba8af652c815c723 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_f7f9db9071a0dc5dc65cbeafe9a1125c.setIcon(icon_5b270e786493b290ba8af652c815c723);


            var marker_e607925e0ffdce25cd3f687807532cc0 = L.marker(
                [18.0, -54.9],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_088cf085c7ddba5e373e169f5a97e472 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_e607925e0ffdce25cd3f687807532cc0.setIcon(icon_088cf085c7ddba5e373e169f5a97e472);


            var marker_de3d96c8bdc2350c5ca2b2abbe866c12 = L.marker(
                [24.0, -61.1],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_d7c178aeeb4de88134a3e69616694b4c = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_de3d96c8bdc2350c5ca2b2abbe866c12.setIcon(icon_d7c178aeeb4de88134a3e69616694b4c);


            var marker_dd94c362146ac357e44a72ebd73ed629 = L.marker(
                [21.3, -56.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_33d804c622afe9583d4756692c35866a = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_dd94c362146ac357e44a72ebd73ed629.setIcon(icon_33d804c622afe9583d4756692c35866a);


            var marker_96b5f6df83da7104eb51e6ea1ceddfc7 = L.marker(
                [21.0, -40.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_cc845f0a510093a727f7e7649c3e0c02 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_96b5f6df83da7104eb51e6ea1ceddfc7.setIcon(icon_cc845f0a510093a727f7e7649c3e0c02);


            var marker_02d30f7530d831c85d0834b5aa15d473 = L.marker(
                [23.6, -96.7],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_360b12417cb5486a56b5f37452708313 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_02d30f7530d831c85d0834b5aa15d473.setIcon(icon_360b12417cb5486a56b5f37452708313);


            var marker_cc5650a66f64e02f81a1d3ec7ed315ad = L.marker(
                [19.8, -68.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_0d698f7be7c073212b9a347a4718251c = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_cc5650a66f64e02f81a1d3ec7ed315ad.setIcon(icon_0d698f7be7c073212b9a347a4718251c);


            var marker_ea905728e859b2b6ded775f223712a5c = L.marker(
                [19.3, -62.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_b2d0b0ebaa4397aaadf7bc98fb986e1c = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_ea905728e859b2b6ded775f223712a5c.setIcon(icon_b2d0b0ebaa4397aaadf7bc98fb986e1c);


            var marker_07dc2d8fde7b9c8bf6d00c0ddb120d1a = L.marker(
                [12.9, -59.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_c7fc958d1a27fb2df447d8c1285081dc = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_07dc2d8fde7b9c8bf6d00c0ddb120d1a.setIcon(icon_c7fc958d1a27fb2df447d8c1285081dc);


            var marker_dc461d11c566688059919bb6419619d1 = L.marker(
                [14.3, -75.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_d3e4341373c2755f1bf909b0e80c6a78 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_dc461d11c566688059919bb6419619d1.setIcon(icon_d3e4341373c2755f1bf909b0e80c6a78);


            var marker_55c2e9fecb8f9a4664be250afa186268 = L.marker(
                [21.5, -96.7],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_d5f70991cdbf0e408d49ee2d92e6e7e5 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_55c2e9fecb8f9a4664be250afa186268.setIcon(icon_d5f70991cdbf0e408d49ee2d92e6e7e5);


            var marker_1d820991022e4309a36ac3c28e13339b = L.marker(
                [14.1, -53.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_e69155d252a700cf73c87099a6d2a5fd = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_1d820991022e4309a36ac3c28e13339b.setIcon(icon_e69155d252a700cf73c87099a6d2a5fd);


            var marker_fdc04de76b4e3629c9ba3b839e1d1e1d = L.marker(
                [26.9, -91.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_82f27c71ffeddef205ed49f90725eeb3 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_fdc04de76b4e3629c9ba3b839e1d1e1d.setIcon(icon_82f27c71ffeddef205ed49f90725eeb3);


            var marker_cc3bc6d6453260ab3cb1ac8c7a6e783d = L.marker(
                [23.3, -69.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_e8a886a9c617e255fb7940377a317e2d = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_cc3bc6d6453260ab3cb1ac8c7a6e783d.setIcon(icon_e8a886a9c617e255fb7940377a317e2d);


            var marker_58881ea5f94f312829d129925955bf0e = L.marker(
                [22.0, -93.4],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_9dd7fb45e558d856799467370a6776bc = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_58881ea5f94f312829d129925955bf0e.setIcon(icon_9dd7fb45e558d856799467370a6776bc);


            var marker_e9045965454d91590d2703344469d8ed = L.marker(
                [14.5, -32.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_088fb207a13f15fea9ccef07c575d3ce = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_e9045965454d91590d2703344469d8ed.setIcon(icon_088fb207a13f15fea9ccef07c575d3ce);


            var marker_d19293a70ab4fa2bfa27c890db9adf96 = L.marker(
                [36.4, -65.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_d72285c619820ab80a87243e50be85db = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_d19293a70ab4fa2bfa27c890db9adf96.setIcon(icon_d72285c619820ab80a87243e50be85db);


            var marker_a8fa6479f0545c206ec0540323c4d49b = L.marker(
                [12.0, -35.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_695dc8ac6ce03a908e5d99e3dc8ff4de = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_a8fa6479f0545c206ec0540323c4d49b.setIcon(icon_695dc8ac6ce03a908e5d99e3dc8ff4de);


            var marker_f8e34a43f0cf10e4f94cf8a0c7526f25 = L.marker(
                [27.0, -76.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_5ecc3dc1125b80a775d84100467743bf = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_f8e34a43f0cf10e4f94cf8a0c7526f25.setIcon(icon_5ecc3dc1125b80a775d84100467743bf);


            var marker_d300c6838ae80ca14b776a95b036e7e7 = L.marker(
                [16.3, -67.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_c75cf62df3a5ae6454620361be7a09f8 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_d300c6838ae80ca14b776a95b036e7e7.setIcon(icon_c75cf62df3a5ae6454620361be7a09f8);


            var marker_3c6b733acf35bbac64b36e0669e6a991 = L.marker(
                [15.6, -55.7],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_ef6fc707200afb47cb3129a62180be0e = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_3c6b733acf35bbac64b36e0669e6a991.setIcon(icon_ef6fc707200afb47cb3129a62180be0e);


            var marker_e5b8590e2434fa923e89294418416220 = L.marker(
                [26.7, -72.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_62ccce7550ffedf7bce848cf1349d61e = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_e5b8590e2434fa923e89294418416220.setIcon(icon_62ccce7550ffedf7bce848cf1349d61e);


            var marker_1b4458f7f2327582bb9282b2bda42fae = L.marker(
                [18.5, -57.1],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_e3a76e1b69ed03502ef80b29e23b6bda = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_1b4458f7f2327582bb9282b2bda42fae.setIcon(icon_e3a76e1b69ed03502ef80b29e23b6bda);


            var marker_f93f0c27227db0c8bbe838aabd1f4add = L.marker(
                [27.2, -75.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_2a5aabb2d2b399fc007ac55f0a4228a9 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_f93f0c27227db0c8bbe838aabd1f4add.setIcon(icon_2a5aabb2d2b399fc007ac55f0a4228a9);


            var marker_2b03ec9b7439d92998e740dc55f0a27e = L.marker(
                [38.4, -65.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_a5cfa501ed9afb797f1ac9f0aaed44b7 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_2b03ec9b7439d92998e740dc55f0a27e.setIcon(icon_a5cfa501ed9afb797f1ac9f0aaed44b7);


            var marker_5747d15d867b155328b285d87cb961e8 = L.marker(
                [32.3, -78.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_ce4bd3050c631ede55396d72c908e8b7 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_5747d15d867b155328b285d87cb961e8.setIcon(icon_ce4bd3050c631ede55396d72c908e8b7);


            var marker_6f20fee7a6b77e5fc557b5983c688dc7 = L.marker(
                [28.3, -95.4],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_03d8d9e3e9e304fa0af9b30e50a3b790 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_6f20fee7a6b77e5fc557b5983c688dc7.setIcon(icon_03d8d9e3e9e304fa0af9b30e50a3b790);


            var marker_6a2e135c2aa12f587f8ddb136795f493 = L.marker(
                [28.7, -41.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_1955d75d354ee83a6a25c75c107e3bc2 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_6a2e135c2aa12f587f8ddb136795f493.setIcon(icon_1955d75d354ee83a6a25c75c107e3bc2);


            var marker_cac2084229ef948dbdd9f79d57b4a45e = L.marker(
                [23.3, -73.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_75ec95e59f7a8214efe874af93dd4257 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_cac2084229ef948dbdd9f79d57b4a45e.setIcon(icon_75ec95e59f7a8214efe874af93dd4257);


            var marker_df21fa5c381fc4026c3ad009cba6b89f = L.marker(
                [27.0, -54.9],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_a4ef56a3397693b4a95cfedbf4d8411f = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_df21fa5c381fc4026c3ad009cba6b89f.setIcon(icon_a4ef56a3397693b4a95cfedbf4d8411f);


            var marker_18d802cf248c712935bcd4b0832b76c9 = L.marker(
                [24.7, -84.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_c0d9bfdf55f4a175081fb3e68ca91938 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_18d802cf248c712935bcd4b0832b76c9.setIcon(icon_c0d9bfdf55f4a175081fb3e68ca91938);


            var marker_3b387fe7a15504177cd99af96459df96 = L.marker(
                [13.8, -61.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_492bd563d5154c7d98eb630e9b8980c4 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_3b387fe7a15504177cd99af96459df96.setIcon(icon_492bd563d5154c7d98eb630e9b8980c4);


            var marker_1260a10e37182ad80a10ada69d7f2da0 = L.marker(
                [27.8, -71.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_56bc769dd84c483fdbd195d99684aca7 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_1260a10e37182ad80a10ada69d7f2da0.setIcon(icon_56bc769dd84c483fdbd195d99684aca7);


            var marker_236fce2c8bf2b039c32155218aa6bfaa = L.marker(
                [12.2, -39.4],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_245ef91ca73f6fc311d930d0e7356e66 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_236fce2c8bf2b039c32155218aa6bfaa.setIcon(icon_245ef91ca73f6fc311d930d0e7356e66);


            var marker_b314a82fc3c70233b042670e93aa69ac = L.marker(
                [25.6, -89.7],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_ec754cffc9ccc04b5c7618c0ab9f965e = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_b314a82fc3c70233b042670e93aa69ac.setIcon(icon_ec754cffc9ccc04b5c7618c0ab9f965e);


            var marker_89143a04e8953101f298c8f457fed1d2 = L.marker(
                [12.4, -65.7],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_16031b1ee61ad517191d25be315ab258 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_89143a04e8953101f298c8f457fed1d2.setIcon(icon_16031b1ee61ad517191d25be315ab258);


            var marker_62f1adb0eb04cb09854c23d22b86b542 = L.marker(
                [15.9, -46.7],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_a64a3e0b1345d8e237295ae8ac238aa4 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_62f1adb0eb04cb09854c23d22b86b542.setIcon(icon_a64a3e0b1345d8e237295ae8ac238aa4);


            var marker_aba1469d6b878b753752f00be6e01245 = L.marker(
                [18.8, -85.1],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_48b4b16144be59321370a33be8186cd8 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_aba1469d6b878b753752f00be6e01245.setIcon(icon_48b4b16144be59321370a33be8186cd8);


            var marker_091dcd1e1af3ae26fc3abc3dfa256af4 = L.marker(
                [15.2, -25.4],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_a7e8b7c9406cf4192570b62977c7a8ef = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_091dcd1e1af3ae26fc3abc3dfa256af4.setIcon(icon_a7e8b7c9406cf4192570b62977c7a8ef);


            var marker_28468d64cf521f43840ff218ca1fdfd1 = L.marker(
                [16.8, -40.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_04b4e90bbe87e54a84c76744c7026bfe = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_28468d64cf521f43840ff218ca1fdfd1.setIcon(icon_04b4e90bbe87e54a84c76744c7026bfe);


            var marker_6eb51b497b169373157679e68e594823 = L.marker(
                [24.3, -71.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_adca136c836cced7c43ef5ca1cd15f07 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_6eb51b497b169373157679e68e594823.setIcon(icon_adca136c836cced7c43ef5ca1cd15f07);


            var marker_ddef99d91d737f960721ed261fe37bd5 = L.marker(
                [12.8, -81.7],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_193f6883a119c6d82338e27022dafef2 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_ddef99d91d737f960721ed261fe37bd5.setIcon(icon_193f6883a119c6d82338e27022dafef2);


            var marker_efc617d91553eedc97f3d259a3b9d53b = L.marker(
                [28.0, -51.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_b006d0ab190f7db8ebe24c7345b20c10 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_efc617d91553eedc97f3d259a3b9d53b.setIcon(icon_b006d0ab190f7db8ebe24c7345b20c10);


            var marker_d49187b7f01cce0a1489d1e0a0fe2c4f = L.marker(
                [35.2, -75.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_a228478175bb14d3571b657b52c44ee1 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_d49187b7f01cce0a1489d1e0a0fe2c4f.setIcon(icon_a228478175bb14d3571b657b52c44ee1);


            var marker_9d4e58c97e817ca1647a1d8ba0b6a2d5 = L.marker(
                [23.6, -66.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_ef2ebec7305f850d33fbdf084f121f6a = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_9d4e58c97e817ca1647a1d8ba0b6a2d5.setIcon(icon_ef2ebec7305f850d33fbdf084f121f6a);


            var marker_63b2b9733673b2b90c49d19d0fbf967c = L.marker(
                [28.1, -75.4],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_2daf570d4e2df445359ba7e5b6403757 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_63b2b9733673b2b90c49d19d0fbf967c.setIcon(icon_2daf570d4e2df445359ba7e5b6403757);


            var marker_140a7db794f129bf6b7fdd9db2a59890 = L.marker(
                [13.3, -48.7],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_3d1529207442febfdd224aed1b47a7e7 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_140a7db794f129bf6b7fdd9db2a59890.setIcon(icon_3d1529207442febfdd224aed1b47a7e7);


            var marker_1906aae6ad04098697b6be5df50a73fc = L.marker(
                [17.9, -56.9],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_bc04453d863bf370fee314581c84280a = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_1906aae6ad04098697b6be5df50a73fc.setIcon(icon_bc04453d863bf370fee314581c84280a);


            var marker_0d1017963b52b22c43ef3c350c25de3d = L.marker(
                [28.0, -93.9],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_7a4b4a03496038396160a37afe1e603f = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_0d1017963b52b22c43ef3c350c25de3d.setIcon(icon_7a4b4a03496038396160a37afe1e603f);


            var marker_79da30575c25285ba90fb12a7cd3922f = L.marker(
                [23.0, -48.9],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_dc987219bd12684a115e60ca8762d1fd = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_79da30575c25285ba90fb12a7cd3922f.setIcon(icon_dc987219bd12684a115e60ca8762d1fd);


            var marker_bb39b3f91557d770b945a358bf4d69be = L.marker(
                [13.2, -58.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_729f5282c9b4ac0169343f3e72aa5465 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_bb39b3f91557d770b945a358bf4d69be.setIcon(icon_729f5282c9b4ac0169343f3e72aa5465);


            var marker_66efbc1665563ae4ff9e2221322a66e0 = L.marker(
                [10.3, -56.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_cd44efe87630718e6999150c2511c963 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_66efbc1665563ae4ff9e2221322a66e0.setIcon(icon_cd44efe87630718e6999150c2511c963);


            var marker_98ef3a7beea70547b7849dffbb7751e8 = L.marker(
                [33.5, -75.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_8f47a1d7c6ef596839e0687461aced42 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_98ef3a7beea70547b7849dffbb7751e8.setIcon(icon_8f47a1d7c6ef596839e0687461aced42);


            var marker_78210380a9f80a29831cf9ec6dfcbb7d = L.marker(
                [14.1, -51.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_3ef67a5a30c3507d2ea8af11265d7e9c = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_78210380a9f80a29831cf9ec6dfcbb7d.setIcon(icon_3ef67a5a30c3507d2ea8af11265d7e9c);


            var marker_7692b74d4e21093a32673992d2d6ded3 = L.marker(
                [17.8, -56.5],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_2fee30e38e56f43da5b4d71cfd7153b4 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_7692b74d4e21093a32673992d2d6ded3.setIcon(icon_2fee30e38e56f43da5b4d71cfd7153b4);


            var marker_11e807ca1a73b348092a6050c1beaf81 = L.marker(
                [24.4, -54.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_1a26c5a96fef850a9ef95b453680c40c = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_11e807ca1a73b348092a6050c1beaf81.setIcon(icon_1a26c5a96fef850a9ef95b453680c40c);


            var marker_76ecd5a5668d74368de98db676e7c2e5 = L.marker(
                [18.8, -52.1],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_64587f1afae3fd263b7650dfb0b8a082 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_76ecd5a5668d74368de98db676e7c2e5.setIcon(icon_64587f1afae3fd263b7650dfb0b8a082);


            var marker_e1e844845faf4c6c7a679d2bf04fb9d6 = L.marker(
                [23.4, -88.1],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_2a7f69d7c3e9683b4fdc82c0a63cedc7 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_e1e844845faf4c6c7a679d2bf04fb9d6.setIcon(icon_2a7f69d7c3e9683b4fdc82c0a63cedc7);


            var marker_75cc5adef0d4c28717bf6471e2c2d546 = L.marker(
                [21.7, -84.5],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_dad7f402578e3b112cbb03c40c80db0f = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_75cc5adef0d4c28717bf6471e2c2d546.setIcon(icon_dad7f402578e3b112cbb03c40c80db0f);


            var marker_deb8ca3516b449eecff444b3e082fb5a = L.marker(
                [37.5, -51.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_0a10c6fa5a77e515c103382aca949520 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_deb8ca3516b449eecff444b3e082fb5a.setIcon(icon_0a10c6fa5a77e515c103382aca949520);


            var marker_c7c492f893054b15137124731d629132 = L.marker(
                [21.2, -64.7],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_9ffceb8025674c4f03648f5087f8333b = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_c7c492f893054b15137124731d629132.setIcon(icon_9ffceb8025674c4f03648f5087f8333b);


            var marker_d983c611c12884b3e466dcdbe4e5f7ef = L.marker(
                [19.7, -40.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_617c175fd92b428ffb0ebd6e843b1607 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_d983c611c12884b3e466dcdbe4e5f7ef.setIcon(icon_617c175fd92b428ffb0ebd6e843b1607);


            var marker_3a267ec390135e16ebee9700fe93694f = L.marker(
                [27.3, -59.7],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_6c7233de2c7f2fe79822ffab3857bca8 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_3a267ec390135e16ebee9700fe93694f.setIcon(icon_6c7233de2c7f2fe79822ffab3857bca8);


            var marker_9d63feab6daa5bb95a166f903981c3a3 = L.marker(
                [18.5, -84.1],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_f6ced6e8840ab77f273009edb78a0367 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_9d63feab6daa5bb95a166f903981c3a3.setIcon(icon_f6ced6e8840ab77f273009edb78a0367);


            var marker_d18c5e9b4a683b532c9eef2f78f9cd3e = L.marker(
                [37.6, -54.4],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_8640931f7f846f0cbf2fb0d38f4aaaa6 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_d18c5e9b4a683b532c9eef2f78f9cd3e.setIcon(icon_8640931f7f846f0cbf2fb0d38f4aaaa6);


            var marker_defc5205270b243f0335b0c20ecca3a0 = L.marker(
                [33.6, -67.9],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_b8f8a3a7c006d1a7329cbdf23a362a56 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_defc5205270b243f0335b0c20ecca3a0.setIcon(icon_b8f8a3a7c006d1a7329cbdf23a362a56);


            var marker_d0413f0707629a06e96889b72b0f823e = L.marker(
                [33.0, -42.1],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_646b02f04ffe4582e30fa0fc96e0e4ed = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_d0413f0707629a06e96889b72b0f823e.setIcon(icon_646b02f04ffe4582e30fa0fc96e0e4ed);


            var marker_153deb6468275cfa0bc2f1056b3ba3fe = L.marker(
                [15.2, -39.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_13bec6b1ca3e48b207e9d59e4e6cded4 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_153deb6468275cfa0bc2f1056b3ba3fe.setIcon(icon_13bec6b1ca3e48b207e9d59e4e6cded4);


            var marker_5ca44e84198564484f0f23f8acb357b4 = L.marker(
                [15.8, -56.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_efe646e8f41b05883cfae95f3fad3bc0 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_5ca44e84198564484f0f23f8acb357b4.setIcon(icon_efe646e8f41b05883cfae95f3fad3bc0);


            var marker_74db938dde668eb0f75d3a6d6027f4a8 = L.marker(
                [24.8, -49.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_93d1365f7b6891342d0430303c31c5c7 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_74db938dde668eb0f75d3a6d6027f4a8.setIcon(icon_93d1365f7b6891342d0430303c31c5c7);


            var marker_420dbef56455a81e13a11d75308a3299 = L.marker(
                [37.6, -55.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_b051735e952dc2de102402b834663a9f = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_420dbef56455a81e13a11d75308a3299.setIcon(icon_b051735e952dc2de102402b834663a9f);


            var marker_05b70d2591cc346f9a8ac8ae94f31741 = L.marker(
                [14.7, -62.9],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_e6a8439b459ad61d9dc9700517ceeacd = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_05b70d2591cc346f9a8ac8ae94f31741.setIcon(icon_e6a8439b459ad61d9dc9700517ceeacd);


            var marker_45cb2ccb53b66bdf69e210993194494a = L.marker(
                [26.3, -39.4],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_b84ee03a6316367b2ef9a66c3b441549 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_45cb2ccb53b66bdf69e210993194494a.setIcon(icon_b84ee03a6316367b2ef9a66c3b441549);


            var marker_9289f4c0c89de695fb94895897dba8de = L.marker(
                [30.5, -77.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_4d6bc9765c55499b28b9489114e7aaf3 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_9289f4c0c89de695fb94895897dba8de.setIcon(icon_4d6bc9765c55499b28b9489114e7aaf3);


            var marker_ba394322ee30e63d15a90b6becc408c7 = L.marker(
                [22.6, -93.7],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_a3b9972d9a5b60ae538c6a8e1dd3cf66 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_ba394322ee30e63d15a90b6becc408c7.setIcon(icon_a3b9972d9a5b60ae538c6a8e1dd3cf66);


            var marker_b35ca98c1417aa94c0c825be88bf16c9 = L.marker(
                [30.8, -64.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_2682aa5314eeb9842c0f1a00f30fd4fd = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_b35ca98c1417aa94c0c825be88bf16c9.setIcon(icon_2682aa5314eeb9842c0f1a00f30fd4fd);


            var marker_16442a06585f95de7e92d80d5e5807f2 = L.marker(
                [24.5, -83.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_6e4582479732d996db0d8889c4cdc920 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_16442a06585f95de7e92d80d5e5807f2.setIcon(icon_6e4582479732d996db0d8889c4cdc920);


            var marker_6a9df5109dc9e8ade47fb72990357347 = L.marker(
                [34.7, -68.4],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_0651445de5a55630f6bb4796dda30495 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_6a9df5109dc9e8ade47fb72990357347.setIcon(icon_0651445de5a55630f6bb4796dda30495);


            var marker_71606d6871b5721fe9aea2a3b65f053e = L.marker(
                [36.4, -66.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_1590dbf40fd46f8c5ce5416ef85b9101 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_71606d6871b5721fe9aea2a3b65f053e.setIcon(icon_1590dbf40fd46f8c5ce5416ef85b9101);


            var marker_a0218be223ed3891d870036f94b47500 = L.marker(
                [35.2, -52.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_18a9a453b1df126810abc7bb624977f4 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_a0218be223ed3891d870036f94b47500.setIcon(icon_18a9a453b1df126810abc7bb624977f4);


            var marker_b0c2d144414647fb4005f8aae69ac6b3 = L.marker(
                [21.7, -83.5],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_53e0f7073a09121aa0b88df95da01e59 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_b0c2d144414647fb4005f8aae69ac6b3.setIcon(icon_53e0f7073a09121aa0b88df95da01e59);


            var marker_3b6ef462b2204c0a2a72eec99a238dfe = L.marker(
                [35.5, -69.9],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_112e9842ee6f1e50d528ae81bc6d675a = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_3b6ef462b2204c0a2a72eec99a238dfe.setIcon(icon_112e9842ee6f1e50d528ae81bc6d675a);


            var marker_8d575073e82245c919140d73ef13f72b = L.marker(
                [20.7, -83.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_41a8f7a2528960c7a6f3c35034f12642 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_8d575073e82245c919140d73ef13f72b.setIcon(icon_41a8f7a2528960c7a6f3c35034f12642);


            var marker_033889a95dca8eb82785937a22ead216 = L.marker(
                [15.5, -48.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_62088d92e9ee8c7b8fe264a3f98ca5d9 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_033889a95dca8eb82785937a22ead216.setIcon(icon_62088d92e9ee8c7b8fe264a3f98ca5d9);


            var marker_9c7728b81c08accbcc3974b6c4a33e29 = L.marker(
                [17.3, -83.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_f5f8acf7d311312c486122c511be7d73 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_9c7728b81c08accbcc3974b6c4a33e29.setIcon(icon_f5f8acf7d311312c486122c511be7d73);


            var marker_e50e3a1429f060d55d64df18cced8289 = L.marker(
                [32.0, -78.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_3b77b4cfb3958633daf1dd4c88c40ac8 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_e50e3a1429f060d55d64df18cced8289.setIcon(icon_3b77b4cfb3958633daf1dd4c88c40ac8);


            var marker_2eaa6ead608cf712cebc79f2965f667c = L.marker(
                [14.5, -49.5],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_7e69b756ced735cea67ec6bfd22dfd6e = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_2eaa6ead608cf712cebc79f2965f667c.setIcon(icon_7e69b756ced735cea67ec6bfd22dfd6e);


            var marker_c6fd2ded3b61a078585f3457726ba595 = L.marker(
                [26.1, -64.7],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_24036ea57c237fa11bf48338548a723b = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_c6fd2ded3b61a078585f3457726ba595.setIcon(icon_24036ea57c237fa11bf48338548a723b);


            var marker_850fd00486dd351a9bafeeeb822e7364 = L.marker(
                [37.0, -66.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_866a3834964a270c4de906eed6d08575 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_850fd00486dd351a9bafeeeb822e7364.setIcon(icon_866a3834964a270c4de906eed6d08575);


            var marker_2af3fbd2a486769785bfaf34bcb76095 = L.marker(
                [32.2, -74.5],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_fd26f3e6bdcfe625c27a281722a1414a = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_2af3fbd2a486769785bfaf34bcb76095.setIcon(icon_fd26f3e6bdcfe625c27a281722a1414a);


            var marker_abd1833c2df5c143a4f2f4ef4abc9b87 = L.marker(
                [24.3, -91.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_2bd0b26a63158a8825e4fe7ead48b8b9 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_abd1833c2df5c143a4f2f4ef4abc9b87.setIcon(icon_2bd0b26a63158a8825e4fe7ead48b8b9);


            var marker_337b1ed04eebf9c6aea6ca475149b024 = L.marker(
                [28.0, -38.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_b2fd86140cde3c131cfb0f6ec05c4ee2 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_337b1ed04eebf9c6aea6ca475149b024.setIcon(icon_b2fd86140cde3c131cfb0f6ec05c4ee2);


            var marker_f2bc2a677867de9eb713a351417507e8 = L.marker(
                [10.3, -81.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_3c815bcb41f290a74e834e0e51a63a4b = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_f2bc2a677867de9eb713a351417507e8.setIcon(icon_3c815bcb41f290a74e834e0e51a63a4b);


            var marker_ee69d0452f28e3b76d6e99a951f342a2 = L.marker(
                [16.8, -81.9],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_e3bd3bf6b28638a544b645b007654891 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_ee69d0452f28e3b76d6e99a951f342a2.setIcon(icon_e3bd3bf6b28638a544b645b007654891);


            var marker_5cce4c4f961570ae25ec5767f54ea492 = L.marker(
                [24.3, -87.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_53fa42c075f9698ffff7fe5788b99d16 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_5cce4c4f961570ae25ec5767f54ea492.setIcon(icon_53fa42c075f9698ffff7fe5788b99d16);


            var marker_525d6631de11e8d776be1d3e4ab26f7c = L.marker(
                [23.0, -90.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_fffc1a5edafba8767cd244b7a4cd250c = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_525d6631de11e8d776be1d3e4ab26f7c.setIcon(icon_fffc1a5edafba8767cd244b7a4cd250c);


            var marker_4c553364e935febda4c4e3e6a2fac6a3 = L.marker(
                [31.5, -66.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_c108a3ee21ef58f0cc42a3f0ea18581e = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_4c553364e935febda4c4e3e6a2fac6a3.setIcon(icon_c108a3ee21ef58f0cc42a3f0ea18581e);


            var marker_0c276d219f9cc91feda82bb4797d1250 = L.marker(
                [37.0, -36.5],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_7e91d42cd7bcaacedffb0e5b0bc9452d = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_0c276d219f9cc91feda82bb4797d1250.setIcon(icon_7e91d42cd7bcaacedffb0e5b0bc9452d);


            var marker_0a54be1caf660bdd8e055abdc8999fde = L.marker(
                [46.0, -49.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_0d580066ebb0b7509ea41922c1e4183c = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_0a54be1caf660bdd8e055abdc8999fde.setIcon(icon_0d580066ebb0b7509ea41922c1e4183c);


            var marker_28d0c0b90c604e3406b502d55f263bc8 = L.marker(
                [37.2, -69.9],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_b0ea39f5e05df46902f1baa08971bdcd = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_28d0c0b90c604e3406b502d55f263bc8.setIcon(icon_b0ea39f5e05df46902f1baa08971bdcd);


            var marker_15825ec42a74572fc30c496d94e95b0c = L.marker(
                [13.2, -73.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_debde2e9a651b18df3696f463676e9c1 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_15825ec42a74572fc30c496d94e95b0c.setIcon(icon_debde2e9a651b18df3696f463676e9c1);


            var marker_0d8e1519b1e9b768c7f127af15d79c32 = L.marker(
                [26.4, -93.7],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_39fafb0c6014be024b9474e217a94d01 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_0d8e1519b1e9b768c7f127af15d79c32.setIcon(icon_39fafb0c6014be024b9474e217a94d01);


            var marker_0bc9654e8677f110a0a6c8f05be40472 = L.marker(
                [27.9, -63.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_335b8515e642d16b264e67f0c574433d = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_0bc9654e8677f110a0a6c8f05be40472.setIcon(icon_335b8515e642d16b264e67f0c574433d);


            var marker_b7e26aa2a7fb0acbd936cc5e92c7cd0a = L.marker(
                [11.4, -82.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_fb9ac640df06d0ee33ee9f0d5d78583a = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_b7e26aa2a7fb0acbd936cc5e92c7cd0a.setIcon(icon_fb9ac640df06d0ee33ee9f0d5d78583a);


            var marker_7c15b8d74839f0124a7bb503a50c40d2 = L.marker(
                [23.8, -85.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_d441e68b9ff7fb2337d9709b70453a4d = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_7c15b8d74839f0124a7bb503a50c40d2.setIcon(icon_d441e68b9ff7fb2337d9709b70453a4d);


            var marker_1c2909db28eda9e9f14b158964275473 = L.marker(
                [38.8, -46.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_dd59d47e5b422c780f3c8495fb08d0e6 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_1c2909db28eda9e9f14b158964275473.setIcon(icon_dd59d47e5b422c780f3c8495fb08d0e6);


            var marker_db86114a9c3268205942ef8b128df701 = L.marker(
                [33.8, -70.4],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_1a4853322122a493a5b1d32cb6898955 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_db86114a9c3268205942ef8b128df701.setIcon(icon_1a4853322122a493a5b1d32cb6898955);


            var marker_6aad1286863bf6beb4c5678afcfe7895 = L.marker(
                [30.6, -65.4],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_b38b69111778e025706832374983b852 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_6aad1286863bf6beb4c5678afcfe7895.setIcon(icon_b38b69111778e025706832374983b852);


            var marker_90eedfa6e81b1bab0ce8b2f9bca7f593 = L.marker(
                [19.8, -91.7],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_d4e0719b3a6cdb8c5ea5fcc57c0e2770 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_90eedfa6e81b1bab0ce8b2f9bca7f593.setIcon(icon_d4e0719b3a6cdb8c5ea5fcc57c0e2770);


            var marker_000b760b68701c3d030c9990869304fc = L.marker(
                [26.9, -47.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_ebd88c4b1185f408d5aad4d681c74df5 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_000b760b68701c3d030c9990869304fc.setIcon(icon_ebd88c4b1185f408d5aad4d681c74df5);


            var marker_91ad2c55628cf0a2ddda294367c09472 = L.marker(
                [31.9, -55.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_0fbd9f36a4a6ea4d087cb6fea5794de1 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_91ad2c55628cf0a2ddda294367c09472.setIcon(icon_0fbd9f36a4a6ea4d087cb6fea5794de1);


            var marker_d3ff43a0ec6d6bd6e7c3f13fef2fbc5c = L.marker(
                [33.7, -67.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_4d3ea0ba515bc99408c1dd8e147298cf = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_d3ff43a0ec6d6bd6e7c3f13fef2fbc5c.setIcon(icon_4d3ea0ba515bc99408c1dd8e147298cf);


            var marker_79569659ea38fd4624f1c89e7011a37f = L.marker(
                [17.0, -76.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_748818dde5b1a0bddd57394be9bb69fb = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_79569659ea38fd4624f1c89e7011a37f.setIcon(icon_748818dde5b1a0bddd57394be9bb69fb);


            var marker_da4039bf61a527a746ae0dc2155502a1 = L.marker(
                [16.6, -80.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_200af6e96b4d156cd9932e6f81593d5a = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_da4039bf61a527a746ae0dc2155502a1.setIcon(icon_200af6e96b4d156cd9932e6f81593d5a);


            var marker_65e670eeb9b4f09ea135cdfbbf70f3d5 = L.marker(
                [11.0, -53.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_e41ecf3f11db9e1bd2c1a51806760b1a = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_65e670eeb9b4f09ea135cdfbbf70f3d5.setIcon(icon_e41ecf3f11db9e1bd2c1a51806760b1a);


            var marker_699dd87cb31d2a4d52ac8214fc48dce7 = L.marker(
                [35.9, -70.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_fd04dbdf498d6758991419691aa88d5e = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_699dd87cb31d2a4d52ac8214fc48dce7.setIcon(icon_fd04dbdf498d6758991419691aa88d5e);


            var marker_a24e89ba2a2c307d792ed3c36885da8f = L.marker(
                [23.3, -94.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_7dda4f9ce6deda76302b3a4640a15490 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_a24e89ba2a2c307d792ed3c36885da8f.setIcon(icon_7dda4f9ce6deda76302b3a4640a15490);


            var marker_7c9fb9855ac4fcd1140e9b6b5c52f02e = L.marker(
                [34.9, -46.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_6662c8e116dc734c3aafb7e77b329d4b = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_7c9fb9855ac4fcd1140e9b6b5c52f02e.setIcon(icon_6662c8e116dc734c3aafb7e77b329d4b);


            var marker_6c6e24bfcb9a13537506fef6b666ccfc = L.marker(
                [19.5, -68.4],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_a4b405210a7fda827b0f6926ab32ab46 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_6c6e24bfcb9a13537506fef6b666ccfc.setIcon(icon_a4b405210a7fda827b0f6926ab32ab46);


            var marker_9a6bbc733f37f9105540bab15ea5ba94 = L.marker(
                [26.5, -60.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_de1353fab2a8855168ce80ca4d635ab3 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_9a6bbc733f37f9105540bab15ea5ba94.setIcon(icon_de1353fab2a8855168ce80ca4d635ab3);


            var marker_9489287f65b2b68035bbbdb1eb8a6174 = L.marker(
                [15.8, -44.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_d728a9d25107aa8f60a9d4eb4f8749b8 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_9489287f65b2b68035bbbdb1eb8a6174.setIcon(icon_d728a9d25107aa8f60a9d4eb4f8749b8);


            var marker_81a7b8716db6cdea885127099f94d39d = L.marker(
                [26.6, -74.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_bbe690c99b6e445b0d94a22ab3987b85 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_81a7b8716db6cdea885127099f94d39d.setIcon(icon_bbe690c99b6e445b0d94a22ab3987b85);


            var marker_c4b165156774910c150be4aeaabcd197 = L.marker(
                [41.2, -59.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_7ec100fc8bdc988f1eb398a852b5ff95 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_c4b165156774910c150be4aeaabcd197.setIcon(icon_7ec100fc8bdc988f1eb398a852b5ff95);


            var marker_a381465016f6ef4551a60b60ddd06b9f = L.marker(
                [26.5, -62.1],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_a6f5f9bc61e396427304c53c8a506c2c = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_a381465016f6ef4551a60b60ddd06b9f.setIcon(icon_a6f5f9bc61e396427304c53c8a506c2c);


            var marker_7e3c162dc938d17361da23c860331b6f = L.marker(
                [18.3, -51.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_10bcc1a3d4060f3da801b5825657793f = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_7e3c162dc938d17361da23c860331b6f.setIcon(icon_10bcc1a3d4060f3da801b5825657793f);


            var marker_81b99840d1716287244467b0acd44595 = L.marker(
                [29.1, -59.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_e2db70da28d050a7e638e0bf07ec181b = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_81b99840d1716287244467b0acd44595.setIcon(icon_e2db70da28d050a7e638e0bf07ec181b);


            var marker_27b2e1f25afee9ada5b974abc377c58d = L.marker(
                [24.9, -58.1],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_4a4aeeb8b972f25480b1bf2da7b54f6e = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_27b2e1f25afee9ada5b974abc377c58d.setIcon(icon_4a4aeeb8b972f25480b1bf2da7b54f6e);


            var marker_7a2659f89b5d0e46b10f743292aae9ad = L.marker(
                [26.5, -90.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_47b5855901b946f97c5660ba1e5eeb23 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_7a2659f89b5d0e46b10f743292aae9ad.setIcon(icon_47b5855901b946f97c5660ba1e5eeb23);


            var marker_4bdf50999686a2217943ec0c3bb023a7 = L.marker(
                [28.7, -91.4],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_a728bc5d2025877c15bfa00c6dec1eb6 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_4bdf50999686a2217943ec0c3bb023a7.setIcon(icon_a728bc5d2025877c15bfa00c6dec1eb6);


            var marker_ff5984548cb8f6da4cafeaf439758bf8 = L.marker(
                [35.5, -67.7],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_966ee11c4899edcf0a6a77a8da89654d = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_ff5984548cb8f6da4cafeaf439758bf8.setIcon(icon_966ee11c4899edcf0a6a77a8da89654d);


            var marker_a3d69d39b884ae4b0c17fa8a94d373b7 = L.marker(
                [35.5, -59.7],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_eb620adde098515caa658362e8b46d67 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_a3d69d39b884ae4b0c17fa8a94d373b7.setIcon(icon_eb620adde098515caa658362e8b46d67);


            var marker_040b376fe0b990605f18009eb786814b = L.marker(
                [39.2, -63.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_a9a3725e65abf0b8db152a235d214ab8 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_040b376fe0b990605f18009eb786814b.setIcon(icon_a9a3725e65abf0b8db152a235d214ab8);


            var marker_ffb9a261ab9e5843b5cd94a1d6e9858c = L.marker(
                [14.0, -43.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_6ab3acd28931c23102614765cd1d8f5e = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_ffb9a261ab9e5843b5cd94a1d6e9858c.setIcon(icon_6ab3acd28931c23102614765cd1d8f5e);


            var marker_a081fd1742cbd740f8f92d9170422e84 = L.marker(
                [29.3, -68.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_9ae42016062b4b16792224813c9e7d95 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_a081fd1742cbd740f8f92d9170422e84.setIcon(icon_9ae42016062b4b16792224813c9e7d95);


            var marker_5cfadca818e21d5a46d90f3df0539390 = L.marker(
                [31.4, -44.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_4927d762ba91f604fccbe8d36886e7c2 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_5cfadca818e21d5a46d90f3df0539390.setIcon(icon_4927d762ba91f604fccbe8d36886e7c2);


            var marker_fab72bad44a36b67ecf8efea240467f8 = L.marker(
                [14.0, -77.7],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_9648d8e62e1adff7433f8ecd969a2cf3 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_fab72bad44a36b67ecf8efea240467f8.setIcon(icon_9648d8e62e1adff7433f8ecd969a2cf3);


            var marker_c790aac20b4792e090fa85f0b5c39b62 = L.marker(
                [26.2, -74.1],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_1e6b550bdc73cb73e4449bdf18994f8a = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_c790aac20b4792e090fa85f0b5c39b62.setIcon(icon_1e6b550bdc73cb73e4449bdf18994f8a);


            var marker_678bbdc07fd54fbc684a0fcb6ecbe3ad = L.marker(
                [26.2, -91.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_f02c8dbc1643ec86e635d4c11b0678e9 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_678bbdc07fd54fbc684a0fcb6ecbe3ad.setIcon(icon_f02c8dbc1643ec86e635d4c11b0678e9);


            var marker_bbaf8b780cc802dec17caf6df30df770 = L.marker(
                [11.8, -48.5],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_964bedf4029ca503d3d243fbf81b7d55 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_bbaf8b780cc802dec17caf6df30df770.setIcon(icon_964bedf4029ca503d3d243fbf81b7d55);


            var marker_f1636e465a3b0df8f00d16570f40517c = L.marker(
                [12.9, -48.7],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_eacdab670f13c5a62bca525ec2ba42c2 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_f1636e465a3b0df8f00d16570f40517c.setIcon(icon_eacdab670f13c5a62bca525ec2ba42c2);


            var marker_d9f71e2e1ecd5ec5899e6663ea76121f = L.marker(
                [24.4, -37.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_a62045e54c37a85cf137ca25ddd32c16 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_d9f71e2e1ecd5ec5899e6663ea76121f.setIcon(icon_a62045e54c37a85cf137ca25ddd32c16);


            var marker_8ca37232626d8634c776d3443a80a839 = L.marker(
                [20.2, -94.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_eaf235000ec53f9670ad8190f73478ed = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_8ca37232626d8634c776d3443a80a839.setIcon(icon_eaf235000ec53f9670ad8190f73478ed);


            var marker_5f7875a20ca30355d30df2b16df62625 = L.marker(
                [12.4, -51.4],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_ca265681d08c584bffe0b2ae560ff08c = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_5f7875a20ca30355d30df2b16df62625.setIcon(icon_ca265681d08c584bffe0b2ae560ff08c);


            var marker_3b2a6bcce7c95f92657745caef0ae348 = L.marker(
                [22.0, -38.7],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_7ba4ff84373d5d7a77045efdf87d589e = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_3b2a6bcce7c95f92657745caef0ae348.setIcon(icon_7ba4ff84373d5d7a77045efdf87d589e);


            var marker_158fb8feeff62987439629518d3b4cd1 = L.marker(
                [39.6, -65.9],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_fde5c8fb0977406f8c95c2296f369858 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_158fb8feeff62987439629518d3b4cd1.setIcon(icon_fde5c8fb0977406f8c95c2296f369858);


            var marker_ed2d1089e9d4ad1bb12650afa78472e5 = L.marker(
                [30.4, -42.5],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_a502de341747646e7d6435ca8772a692 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_ed2d1089e9d4ad1bb12650afa78472e5.setIcon(icon_a502de341747646e7d6435ca8772a692);


            var marker_cd20fcdf754f1f4a3e8ab8d9ab630211 = L.marker(
                [13.0, -25.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_c1904e9e74dbc49f4c8705743117c8cc = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_cd20fcdf754f1f4a3e8ab8d9ab630211.setIcon(icon_c1904e9e74dbc49f4c8705743117c8cc);


            var marker_4140738a1c327199e394bffa2dc6d2a3 = L.marker(
                [40.2, -59.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_355e43b7ccb068bdb3a1ba81ab735d02 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_4140738a1c327199e394bffa2dc6d2a3.setIcon(icon_355e43b7ccb068bdb3a1ba81ab735d02);


            var marker_7b00e65d2b179d54c5515fd1285b335b = L.marker(
                [30.1, -30.5],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_21fb897e1415965bb88e61995a37feea = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_7b00e65d2b179d54c5515fd1285b335b.setIcon(icon_21fb897e1415965bb88e61995a37feea);


            var marker_9338e128ae37bb24890b4d45e9f28e28 = L.marker(
                [24.1, -87.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_304af0a989b1393e87dd6361bce01c5f = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_9338e128ae37bb24890b4d45e9f28e28.setIcon(icon_304af0a989b1393e87dd6361bce01c5f);


            var marker_af5677a74c8923fd427875d9115fc7eb = L.marker(
                [37.7, -44.7],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_5baedbbb7bebb10fd064d22da2f0b5b8 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_af5677a74c8923fd427875d9115fc7eb.setIcon(icon_5baedbbb7bebb10fd064d22da2f0b5b8);


            var marker_d96a8de2bc18d7e2cb0c931a15e4511b = L.marker(
                [36.3, -73.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_31b1c96747eb97769b89d6c975815855 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_d96a8de2bc18d7e2cb0c931a15e4511b.setIcon(icon_31b1c96747eb97769b89d6c975815855);


            var marker_85aab1f675a17716ed8bbbfe28b965e4 = L.marker(
                [34.6, -63.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_e10a2ed66481b1a8a797e957deab97f8 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_85aab1f675a17716ed8bbbfe28b965e4.setIcon(icon_e10a2ed66481b1a8a797e957deab97f8);


            var marker_abd9226b591a1c57bf66fb2816ea7cfe = L.marker(
                [21.7, -67.1],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_6631ad5aad901f782050b0f089263920 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_abd9226b591a1c57bf66fb2816ea7cfe.setIcon(icon_6631ad5aad901f782050b0f089263920);


            var marker_0ad68d02b520e9b3342da6b140433bc7 = L.marker(
                [24.8, -74.4],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_8754188616bfa25f01f97a4782b88e77 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_0ad68d02b520e9b3342da6b140433bc7.setIcon(icon_8754188616bfa25f01f97a4782b88e77);


            var marker_43a2ab48ecd3f1d24d0597c7309e252b = L.marker(
                [20.2, -57.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_c9918cbf1845a1a7fe76e88851b6b476 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_43a2ab48ecd3f1d24d0597c7309e252b.setIcon(icon_c9918cbf1845a1a7fe76e88851b6b476);


            var marker_80c5310eea35458315b6046c505a69e8 = L.marker(
                [15.6, -50.1],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_adc0451ca1442d3e8cfaac514d6d3c8f = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_80c5310eea35458315b6046c505a69e8.setIcon(icon_adc0451ca1442d3e8cfaac514d6d3c8f);


            var marker_81fdb65d9110e017db4d16e7df64b2a1 = L.marker(
                [19.6, -80.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_7764c32782ed50c259b99172a59de975 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_81fdb65d9110e017db4d16e7df64b2a1.setIcon(icon_7764c32782ed50c259b99172a59de975);


            var marker_a0cb4a51960e08035a0a37958d7a41d9 = L.marker(
                [24.0, -83.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_d17e9c5e162912ca8d0ebae06d78ca4c = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_a0cb4a51960e08035a0a37958d7a41d9.setIcon(icon_d17e9c5e162912ca8d0ebae06d78ca4c);


            var marker_7a626b6e35d4135be5b6c588df85ae9a = L.marker(
                [25.6, -71.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_2998821c44800c1f3a222387b9a249e9 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_7a626b6e35d4135be5b6c588df85ae9a.setIcon(icon_2998821c44800c1f3a222387b9a249e9);


            var marker_7aaf99fdee548a236cd2d2e8c9dbe55b = L.marker(
                [27.4, -93.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_0a5106e071722ac86b4ebc2c630e69f1 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_7aaf99fdee548a236cd2d2e8c9dbe55b.setIcon(icon_0a5106e071722ac86b4ebc2c630e69f1);


            var marker_fc81be6c55bff364f9d7f84875c99293 = L.marker(
                [25.5, -96.4],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_066fd92881775986899ab39c8f84e74e = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_fc81be6c55bff364f9d7f84875c99293.setIcon(icon_066fd92881775986899ab39c8f84e74e);


            var marker_562cc74a2f5e25b74f833385c7992c68 = L.marker(
                [32.8, -60.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_566a6cc37ad0202c32ce7977832d6260 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_562cc74a2f5e25b74f833385c7992c68.setIcon(icon_566a6cc37ad0202c32ce7977832d6260);


            var marker_05d4a9198035709c407115fd198d0225 = L.marker(
                [30.5, -80.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_84c60c2a52c4654ec0c6701be1647e45 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_05d4a9198035709c407115fd198d0225.setIcon(icon_84c60c2a52c4654ec0c6701be1647e45);


            var marker_1bc4c4de7e8874a152d63c17d0ec42f4 = L.marker(
                [29.7, -60.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_9eac8182cf537ac0116cc10cfd870a5d = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_1bc4c4de7e8874a152d63c17d0ec42f4.setIcon(icon_9eac8182cf537ac0116cc10cfd870a5d);


            var marker_bd2b24dc402997a555199b59a3650a57 = L.marker(
                [27.2, -72.4],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_ebdf1fb41073b1070dfea1a918a42dd8 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_bd2b24dc402997a555199b59a3650a57.setIcon(icon_ebdf1fb41073b1070dfea1a918a42dd8);


            var marker_6bae66b2391a1a3948aa4124bf1a8192 = L.marker(
                [19.4, -64.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_219590e364a5026d792b4d78a0d3acf7 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_6bae66b2391a1a3948aa4124bf1a8192.setIcon(icon_219590e364a5026d792b4d78a0d3acf7);


            var marker_c06fac6ed2b828f84803da7ea94212ad = L.marker(
                [31.1, -52.4],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_0ee30feef0753048c5417f3d78aefea2 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_c06fac6ed2b828f84803da7ea94212ad.setIcon(icon_0ee30feef0753048c5417f3d78aefea2);


            var marker_fcf57fabaea8ea95da51bfd3e911137d = L.marker(
                [30.5, -80.5],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_0df77ead8d539ce35ea1b4814e0d11bc = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_fcf57fabaea8ea95da51bfd3e911137d.setIcon(icon_0df77ead8d539ce35ea1b4814e0d11bc);


            var marker_56173d5b6307b4d0278592667650022f = L.marker(
                [35.2, -52.5],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_554cf65a29337e92abda674d89f907d5 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_56173d5b6307b4d0278592667650022f.setIcon(icon_554cf65a29337e92abda674d89f907d5);


            var marker_7c870ccad79febe68698c2ca7539c5e5 = L.marker(
                [26.8, -91.5],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_28e87737e26d90ce8a7b8aed58370185 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_7c870ccad79febe68698c2ca7539c5e5.setIcon(icon_28e87737e26d90ce8a7b8aed58370185);


            var marker_7bd910312dd0a74796617ad3f0229eff = L.marker(
                [25.0, -85.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_82705a806e45639b3622698a8da2b376 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_7bd910312dd0a74796617ad3f0229eff.setIcon(icon_82705a806e45639b3622698a8da2b376);


            var marker_c73d22a93f80235d05645511a17b49dc = L.marker(
                [17.7, -55.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_83ad6e008dcc0f2227dc5dc2b55182b0 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_c73d22a93f80235d05645511a17b49dc.setIcon(icon_83ad6e008dcc0f2227dc5dc2b55182b0);


            var marker_dbc3b9afd78433715b297310ba7e89ed = L.marker(
                [27.8, -91.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_0485d802f5ab4731a07ca3dbf9f7bbfa = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_dbc3b9afd78433715b297310ba7e89ed.setIcon(icon_0485d802f5ab4731a07ca3dbf9f7bbfa);


            var marker_9437184e65938bf4b282de686f40d2e4 = L.marker(
                [21.1, -65.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_b78d7cffee9f2434248435fb695628b7 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_9437184e65938bf4b282de686f40d2e4.setIcon(icon_b78d7cffee9f2434248435fb695628b7);


            var marker_5e05d1efff799e95afe70832c828b3bc = L.marker(
                [27.7, -92.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_ab7e0148c84f57e8dc6f64657764f33a = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_5e05d1efff799e95afe70832c828b3bc.setIcon(icon_ab7e0148c84f57e8dc6f64657764f33a);


            var marker_acd5c02efcbb4ef9f7318f44d59f8ae3 = L.marker(
                [34.4, -76.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_fc9ee1434e9b0aa9d9e0253bb9a9cf9e = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_acd5c02efcbb4ef9f7318f44d59f8ae3.setIcon(icon_fc9ee1434e9b0aa9d9e0253bb9a9cf9e);


            var marker_cc78ba9d5e6c6ae8a8212275aeefa606 = L.marker(
                [25.0, -53.4],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_f2502a53fd40a6a59afeacbbfc4b2475 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_cc78ba9d5e6c6ae8a8212275aeefa606.setIcon(icon_f2502a53fd40a6a59afeacbbfc4b2475);


            var marker_79e89484f87a840806c216ddb32431b9 = L.marker(
                [27.0, -61.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_5eb897a26e853be5438e23375d657497 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_79e89484f87a840806c216ddb32431b9.setIcon(icon_5eb897a26e853be5438e23375d657497);


            var marker_ce8d178e979cd1e0b67245ec10a00fb4 = L.marker(
                [36.5, -43.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_f39c95af78a5a2548e727ad9fab6e2ae = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_ce8d178e979cd1e0b67245ec10a00fb4.setIcon(icon_f39c95af78a5a2548e727ad9fab6e2ae);


            var marker_2f003d2fe38c2bbb962e0329a542a2f9 = L.marker(
                [15.1, -66.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_ae715c7ecae0dbccbee425f50d60efd3 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_2f003d2fe38c2bbb962e0329a542a2f9.setIcon(icon_ae715c7ecae0dbccbee425f50d60efd3);


            var marker_84517565478135e95e8674ebb6aa31e1 = L.marker(
                [24.0, -82.9],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_ac3a60b76342fbdf3668e4f8bef59535 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_84517565478135e95e8674ebb6aa31e1.setIcon(icon_ac3a60b76342fbdf3668e4f8bef59535);


            var marker_cb4c69c5216a2d6141b0b0fdca0127ef = L.marker(
                [20.8, -96.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_f7016e33de6f2d270308269ca2852c09 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_cb4c69c5216a2d6141b0b0fdca0127ef.setIcon(icon_f7016e33de6f2d270308269ca2852c09);


            var marker_db7fa8ed7db456c3ca4ca3cbf55b09e7 = L.marker(
                [27.4, -89.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_3882a7842e8fd144d7a280746ee175e1 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_db7fa8ed7db456c3ca4ca3cbf55b09e7.setIcon(icon_3882a7842e8fd144d7a280746ee175e1);


            var marker_17f4b43a37d9aae70864457a5ff268d7 = L.marker(
                [15.9, -66.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_cc019a1a9f628acbbfcac8e0a69d7b1e = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_17f4b43a37d9aae70864457a5ff268d7.setIcon(icon_cc019a1a9f628acbbfcac8e0a69d7b1e);


            var marker_2e1a6fbbd8d31ab8296a8780a9fc9a93 = L.marker(
                [12.1, -38.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_c850d0a2f0e0849c5c37b42214789784 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_2e1a6fbbd8d31ab8296a8780a9fc9a93.setIcon(icon_c850d0a2f0e0849c5c37b42214789784);


            var marker_f27ce0f4a4b816ab4a3ba1f697540ed6 = L.marker(
                [11.8, -74.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_d7d02bb77c81de6768dcccbf220c5787 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_f27ce0f4a4b816ab4a3ba1f697540ed6.setIcon(icon_d7d02bb77c81de6768dcccbf220c5787);


            var marker_c94dc26341f3e5818ac1a31f4be99695 = L.marker(
                [27.9, -92.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_e42f1f8c018b996455a6d72e2291b2c9 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_c94dc26341f3e5818ac1a31f4be99695.setIcon(icon_e42f1f8c018b996455a6d72e2291b2c9);


            var marker_e980fc39e9cae5a64c511a1ee025e57e = L.marker(
                [17.3, -58.1],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_348a60a60bb7f399369259a804768074 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_e980fc39e9cae5a64c511a1ee025e57e.setIcon(icon_348a60a60bb7f399369259a804768074);


            var marker_91770b8ceac61a9d99a14f1922e9ac94 = L.marker(
                [28.8, -44.5],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_59db5ba8be5b83cc01c990a731e33938 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_91770b8ceac61a9d99a14f1922e9ac94.setIcon(icon_59db5ba8be5b83cc01c990a731e33938);


            var marker_6d38745b08e093654c88658987519518 = L.marker(
                [36.0, -48.7],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_277f682a24ec733e76d00acaa8461b33 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_6d38745b08e093654c88658987519518.setIcon(icon_277f682a24ec733e76d00acaa8461b33);


            var marker_b4ac910b4b92527dbf7321f755ab271d = L.marker(
                [11.5, -31.7],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_619eda1400f321ed8696f145aa52a1b6 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_b4ac910b4b92527dbf7321f755ab271d.setIcon(icon_619eda1400f321ed8696f145aa52a1b6);


            var marker_971c41fddbdf30ff5f1f105e499f17f2 = L.marker(
                [12.8, -43.5],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_6b128bd7bb49f822c70df95e33164de9 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_971c41fddbdf30ff5f1f105e499f17f2.setIcon(icon_6b128bd7bb49f822c70df95e33164de9);


            var marker_746acf7f189f7412ff42b0fb430fe7da = L.marker(
                [28.1, -94.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_7cf5e380bb0f8aeb610aa59d65d1e1de = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_746acf7f189f7412ff42b0fb430fe7da.setIcon(icon_7cf5e380bb0f8aeb610aa59d65d1e1de);


            var marker_1e145065161198488ab4155813eb71c2 = L.marker(
                [30.2, -73.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_eff2be48bc1c8b6a9a8b910844cc851e = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_1e145065161198488ab4155813eb71c2.setIcon(icon_eff2be48bc1c8b6a9a8b910844cc851e);


            var marker_f9efacfd7d52b6415fd5db042bd3e5b7 = L.marker(
                [20.7, -94.7],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_916d98276d60877bf04bae86960d93e8 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_f9efacfd7d52b6415fd5db042bd3e5b7.setIcon(icon_916d98276d60877bf04bae86960d93e8);


            var marker_e4faf2e74e5cb64fea788b2906fd363c = L.marker(
                [14.5, -55.5],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_2e948618a32dd33db4afb0a2792130a4 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_e4faf2e74e5cb64fea788b2906fd363c.setIcon(icon_2e948618a32dd33db4afb0a2792130a4);


            var marker_68a4ba50b9f5e1c336af33fc50a1d931 = L.marker(
                [15.9, -36.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_a3637e9eea454add19008ccb8c9812f3 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_68a4ba50b9f5e1c336af33fc50a1d931.setIcon(icon_a3637e9eea454add19008ccb8c9812f3);


            var marker_0d3f983bfa9248af1c5088a40f156142 = L.marker(
                [30.0, -41.5],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_2cbda01327deec59ad552df5492fe13b = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_0d3f983bfa9248af1c5088a40f156142.setIcon(icon_2cbda01327deec59ad552df5492fe13b);


            var marker_0dc7bd70d93e5733ca5c647d3575e232 = L.marker(
                [17.2, -61.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_84aea47ebaaa0b0b6a1c1ed23e261107 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_0dc7bd70d93e5733ca5c647d3575e232.setIcon(icon_84aea47ebaaa0b0b6a1c1ed23e261107);


            var marker_74b3b3d2c0227d8ecc490690d480ad93 = L.marker(
                [31.2, -55.9],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_ed47ec63ebfad29a04d58a9830f75705 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_74b3b3d2c0227d8ecc490690d480ad93.setIcon(icon_ed47ec63ebfad29a04d58a9830f75705);


            var marker_fbe216fb0954e7fc05589b77c2011c96 = L.marker(
                [22.8, -63.5],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_85cbcd601eed44274b4294831709831b = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_fbe216fb0954e7fc05589b77c2011c96.setIcon(icon_85cbcd601eed44274b4294831709831b);


            var marker_a342e18085abe52cfe42b89149f7aa7f = L.marker(
                [29.0, -77.1],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_10d668d2e10cad429d779a1d31f6bc69 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_a342e18085abe52cfe42b89149f7aa7f.setIcon(icon_10d668d2e10cad429d779a1d31f6bc69);


            var marker_44b062ac4f4936804844a661193a8141 = L.marker(
                [26.2, -58.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_8d65d9a47ea6ec0b52b9d27dacc21734 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_44b062ac4f4936804844a661193a8141.setIcon(icon_8d65d9a47ea6ec0b52b9d27dacc21734);


            var marker_4bc814771d663c2443406ab3546746ef = L.marker(
                [31.6, -68.1],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_d312a1959fb3b5c4fe52a606a5940eb3 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_4bc814771d663c2443406ab3546746ef.setIcon(icon_d312a1959fb3b5c4fe52a606a5940eb3);


            var marker_54af95b99bf8dc27a4dd80e9c43973d9 = L.marker(
                [38.2, -66.5],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_9de2f62699276a19e4e50651bca02d82 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_54af95b99bf8dc27a4dd80e9c43973d9.setIcon(icon_9de2f62699276a19e4e50651bca02d82);


            var marker_e73daa7cf2ff4985554706bbec805944 = L.marker(
                [25.8, -68.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_f068af4efa9e91be310897ca0c7669b4 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_e73daa7cf2ff4985554706bbec805944.setIcon(icon_f068af4efa9e91be310897ca0c7669b4);


            var marker_e924f3f5a76aad88e2d39d0f9779b525 = L.marker(
                [34.3, -58.1],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_062d6b2fd142f7710a0df25bd2a6d6bb = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_e924f3f5a76aad88e2d39d0f9779b525.setIcon(icon_062d6b2fd142f7710a0df25bd2a6d6bb);


            var marker_2436c2ffac5d27185800e5736e1a7aca = L.marker(
                [34.7, -34.5],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_d252cf3d3d706095d721a5130a864ebb = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_2436c2ffac5d27185800e5736e1a7aca.setIcon(icon_d252cf3d3d706095d721a5130a864ebb);


            var marker_feb95941934037416ea6ad9b05d037ce = L.marker(
                [28.7, -61.1],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_de55dd36d245d8749af14ce7f0dd8606 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_feb95941934037416ea6ad9b05d037ce.setIcon(icon_de55dd36d245d8749af14ce7f0dd8606);


            var marker_7a5c6ed80740789d0a8c3b091a7a7db7 = L.marker(
                [26.9, -61.7],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_ca5e3dffe63cda44c650dba8a1c9adf2 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_7a5c6ed80740789d0a8c3b091a7a7db7.setIcon(icon_ca5e3dffe63cda44c650dba8a1c9adf2);


            var marker_cc01260621b9d8626c2c346e97346f4e = L.marker(
                [41.7, -58.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_4a37e06e3f50d5732c286ef461da8e63 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_cc01260621b9d8626c2c346e97346f4e.setIcon(icon_4a37e06e3f50d5732c286ef461da8e63);


            var marker_8a85d97c991acb044efa8e5bf2affcf8 = L.marker(
                [21.1, -95.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_4d683d3f5197caed3344f5be8582264d = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_8a85d97c991acb044efa8e5bf2affcf8.setIcon(icon_4d683d3f5197caed3344f5be8582264d);


            var marker_1a0058cb5dc50e829ff08520e84a5418 = L.marker(
                [35.6, -55.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_d1021ad5d835e54f91fa35b76f88cb13 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_1a0058cb5dc50e829ff08520e84a5418.setIcon(icon_d1021ad5d835e54f91fa35b76f88cb13);


            var marker_2ef270b90020e1cec976e68a51cc8227 = L.marker(
                [14.5, -46.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_a523cc12f4ff8b54c5e69f0ed26565df = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_2ef270b90020e1cec976e68a51cc8227.setIcon(icon_a523cc12f4ff8b54c5e69f0ed26565df);


            var marker_1931751f1924be9e19db06688f6113b5 = L.marker(
                [28.1, -54.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_3db787bb01334e0b8e100104bf6159ca = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_1931751f1924be9e19db06688f6113b5.setIcon(icon_3db787bb01334e0b8e100104bf6159ca);


            var marker_f988b68daa65f6e691a9292372c80555 = L.marker(
                [31.5, -74.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_f4808560707fc587e7feaf186d03a7a3 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_f988b68daa65f6e691a9292372c80555.setIcon(icon_f4808560707fc587e7feaf186d03a7a3);


            var marker_662a2b4dd7fd09e5ba6e278310f27981 = L.marker(
                [24.7, -86.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_55bbd06c96463a6706f19cf4f4a4b133 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_662a2b4dd7fd09e5ba6e278310f27981.setIcon(icon_55bbd06c96463a6706f19cf4f4a4b133);


            var marker_3167ed1f4c26b5795f2e2ebeb6790824 = L.marker(
                [23.6, -74.9],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_917778eecadc805c2356f961665fdc04 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_3167ed1f4c26b5795f2e2ebeb6790824.setIcon(icon_917778eecadc805c2356f961665fdc04);


            var marker_e10b6cf5e38fbd8a4f2c87610bfb9bde = L.marker(
                [18.9, -52.4],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_71d6c07485bee13e0e29aa449bd2f926 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_e10b6cf5e38fbd8a4f2c87610bfb9bde.setIcon(icon_71d6c07485bee13e0e29aa449bd2f926);


            var marker_3a43f4a52afbc4ec7c396b23d94b72fc = L.marker(
                [14.9, -38.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_b0a7c40a01bfb08a35cce77624174fd5 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_3a43f4a52afbc4ec7c396b23d94b72fc.setIcon(icon_b0a7c40a01bfb08a35cce77624174fd5);


            var marker_c0f52637657b6bd9ea7a851d19edcf94 = L.marker(
                [15.0, -53.4],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_90ae257773eb34ff63c7196fc5fbfe26 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_c0f52637657b6bd9ea7a851d19edcf94.setIcon(icon_90ae257773eb34ff63c7196fc5fbfe26);


            var marker_88ba620483bc5ef59cdd646d217d246b = L.marker(
                [13.7, -37.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_700a89a0f1ec1ee4ae8c016c3d29149b = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_88ba620483bc5ef59cdd646d217d246b.setIcon(icon_700a89a0f1ec1ee4ae8c016c3d29149b);


            var marker_b5703eee175dba394d754f4e2e70d7ce = L.marker(
                [13.0, -57.7],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_97c9f89d9e5555b9c9f55a7a089c2ddd = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_b5703eee175dba394d754f4e2e70d7ce.setIcon(icon_97c9f89d9e5555b9c9f55a7a089c2ddd);


            var marker_77b86fe4ebd846a3bd420c985cd9ca46 = L.marker(
                [15.2, -42.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_0266fa1947d4977cd95603cfc3045477 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_77b86fe4ebd846a3bd420c985cd9ca46.setIcon(icon_0266fa1947d4977cd95603cfc3045477);


            var marker_8f6a3acb465915962a2e312751a94586 = L.marker(
                [21.0, -92.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_964dd36075501bfe32201f54286f4f97 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_8f6a3acb465915962a2e312751a94586.setIcon(icon_964dd36075501bfe32201f54286f4f97);


            var marker_546040a2fe139065070f24db4a6261d4 = L.marker(
                [19.2, -84.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_c66268901bcef68767e7a8e4d46de92e = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_546040a2fe139065070f24db4a6261d4.setIcon(icon_c66268901bcef68767e7a8e4d46de92e);


            var marker_547cf2c53a9ab1f42c861350a1d72265 = L.marker(
                [30.5, -54.9],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_9f6920bdbf4514dc80b0b55e0e734f67 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_547cf2c53a9ab1f42c861350a1d72265.setIcon(icon_9f6920bdbf4514dc80b0b55e0e734f67);


            var marker_e240e9310d476f91a6ad0362a15a1f46 = L.marker(
                [16.5, -58.4],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_4a181699dabdd73b5acb53bc8b2d5211 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_e240e9310d476f91a6ad0362a15a1f46.setIcon(icon_4a181699dabdd73b5acb53bc8b2d5211);


            var marker_95d34c899eaca5aefdcf411cd830ace4 = L.marker(
                [11.6, -79.5],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_688469394c889d60f64063ed72016bad = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_95d34c899eaca5aefdcf411cd830ace4.setIcon(icon_688469394c889d60f64063ed72016bad);


            var marker_587aec914d08b05064fb0cd5b0cff159 = L.marker(
                [19.2, -87.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_289487a56685089b8e778bab67c823ca = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_587aec914d08b05064fb0cd5b0cff159.setIcon(icon_289487a56685089b8e778bab67c823ca);


            var marker_5d9faf727f949e5e7ff4e7eda5e68708 = L.marker(
                [13.9, -38.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_ed55dbc25202122c3c3f4b2b0a995215 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_5d9faf727f949e5e7ff4e7eda5e68708.setIcon(icon_ed55dbc25202122c3c3f4b2b0a995215);


            var marker_9dbe020e23836a9eeaf176cdaf0ae33a = L.marker(
                [16.4, -53.7],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_75c3e67ffe3fbde048df1c5d859d6949 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_9dbe020e23836a9eeaf176cdaf0ae33a.setIcon(icon_75c3e67ffe3fbde048df1c5d859d6949);


            var marker_d30c7302b5be33dba8974bdf2f4a0841 = L.marker(
                [16.1, -64.5],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_1395a23f5eb15319a2347b7c5854acef = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_d30c7302b5be33dba8974bdf2f4a0841.setIcon(icon_1395a23f5eb15319a2347b7c5854acef);


            var marker_428f2080a25d06194d363631a2f5058f = L.marker(
                [11.7, -34.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_ee1521c830b99a210ce7527a87d3050b = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_428f2080a25d06194d363631a2f5058f.setIcon(icon_ee1521c830b99a210ce7527a87d3050b);


            var marker_2a0b40ddbeb1a294077a6e92553e00e3 = L.marker(
                [19.6, -83.5],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_1a9a7db2d3237e200edbf6fed448f34a = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_2a0b40ddbeb1a294077a6e92553e00e3.setIcon(icon_1a9a7db2d3237e200edbf6fed448f34a);


            var marker_2c4fed13711983b465ac7a2deb3fe45a = L.marker(
                [13.8, -78.5],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_21ad18cc5597e103fb55947bbf130973 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_2c4fed13711983b465ac7a2deb3fe45a.setIcon(icon_21ad18cc5597e103fb55947bbf130973);


            var marker_4b9888cb863b6a673d367b0500419d88 = L.marker(
                [37.9, -61.1],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_65caded65b91ab3669491233159d4581 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_4b9888cb863b6a673d367b0500419d88.setIcon(icon_65caded65b91ab3669491233159d4581);


            var marker_28cc9ed1a496c7cf6b08e3a6955d2128 = L.marker(
                [29.2, -89.9],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_03a11dc4bdf9cd483210d3a9fc121ca6 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_28cc9ed1a496c7cf6b08e3a6955d2128.setIcon(icon_03a11dc4bdf9cd483210d3a9fc121ca6);


            var marker_3130026e6027167c1ef394f8448f9d32 = L.marker(
                [15.2, -53.7],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_c6dfe3c2a3e5bfe26242decd84172633 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_3130026e6027167c1ef394f8448f9d32.setIcon(icon_c6dfe3c2a3e5bfe26242decd84172633);


            var marker_7f9d52d9d86fb9568e4266ffd846b31f = L.marker(
                [21.1, -67.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_0f4039fcbf36008f9ab7bb0bb401f4d6 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_7f9d52d9d86fb9568e4266ffd846b31f.setIcon(icon_0f4039fcbf36008f9ab7bb0bb401f4d6);


            var marker_aacfee27a133ddf29bd3d9e5f1a6df24 = L.marker(
                [16.2, -43.3],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_e253bca0ad68e56b75c55f2d5ef21420 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_aacfee27a133ddf29bd3d9e5f1a6df24.setIcon(icon_e253bca0ad68e56b75c55f2d5ef21420);


            var marker_d241c702379e9307d3a0114fbb1d67d7 = L.marker(
                [28.2, -89.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_263fd5c66f4ef396f270cc922f26b976 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_d241c702379e9307d3a0114fbb1d67d7.setIcon(icon_263fd5c66f4ef396f270cc922f26b976);


            var marker_bc2313609bbfd25c637c5f9508b18238 = L.marker(
                [12.3, -40.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_ecb9965f6c44dc80b3f1cf7aab37b770 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_bc2313609bbfd25c637c5f9508b18238.setIcon(icon_ecb9965f6c44dc80b3f1cf7aab37b770);


            var marker_f298bf2b83306f660c74db6aacf599e8 = L.marker(
                [29.6, -40.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_bb8f6fde1b79f9ccb856b0481c5e82d5 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_f298bf2b83306f660c74db6aacf599e8.setIcon(icon_bb8f6fde1b79f9ccb856b0481c5e82d5);


            var marker_04fa815587b9bea40279415003f6f591 = L.marker(
                [13.1, -25.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_17b23156a7a516d7b7823c8934e5243c = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_04fa815587b9bea40279415003f6f591.setIcon(icon_17b23156a7a516d7b7823c8934e5243c);


            var marker_95f3ac96afe3f78e23cf827455fe6952 = L.marker(
                [30.4, -54.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_4d1ffb31243af2ca5ddb0697a1a6da3c = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_95f3ac96afe3f78e23cf827455fe6952.setIcon(icon_4d1ffb31243af2ca5ddb0697a1a6da3c);


            var marker_e6925ae833adc0a5c2c0c0340759a61b = L.marker(
                [41.6, -38.7],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_28d0c43b107d3b155ff4bfbf8ccc3b0f = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_e6925ae833adc0a5c2c0c0340759a61b.setIcon(icon_28d0c43b107d3b155ff4bfbf8ccc3b0f);


            var marker_54e605d2c61ebb65b6b3baa62c4522ac = L.marker(
                [13.9, -77.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_f0ed3a53bb54951f379b88df7d95245e = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_54e605d2c61ebb65b6b3baa62c4522ac.setIcon(icon_f0ed3a53bb54951f379b88df7d95245e);


            var marker_86cd3646cccd70afcbd35f32bce7b9ee = L.marker(
                [32.6, -42.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_0829f0a48cb784cde4ec36dd68606d46 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_86cd3646cccd70afcbd35f32bce7b9ee.setIcon(icon_0829f0a48cb784cde4ec36dd68606d46);


            var marker_b65e57bee628a45b6304d7ff4a85eb28 = L.marker(
                [21.9, -94.5],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_c55813cbf7546e52824f5d3146aab1f5 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_b65e57bee628a45b6304d7ff4a85eb28.setIcon(icon_c55813cbf7546e52824f5d3146aab1f5);


            var marker_99039edad0f23f1f0d67b32237a99770 = L.marker(
                [14.2, -31.7],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_9ac68d9e01a08baf4abc42a2db876bc6 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_99039edad0f23f1f0d67b32237a99770.setIcon(icon_9ac68d9e01a08baf4abc42a2db876bc6);


            var marker_cae7d1f0b5b7aef1e006b6a3cbec9e08 = L.marker(
                [23.8, -73.1],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_bbe241231869e4c11bc655428fc824ba = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_cae7d1f0b5b7aef1e006b6a3cbec9e08.setIcon(icon_bbe241231869e4c11bc655428fc824ba);


            var marker_ab1473b9e9bc2e307ff7af72481ea9fe = L.marker(
                [19.3, -58.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_6753c7827e1fdeee0f4e52357dc38c4a = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_ab1473b9e9bc2e307ff7af72481ea9fe.setIcon(icon_6753c7827e1fdeee0f4e52357dc38c4a);


            var marker_c9a8f540fa1fc56ec153029fd84a9084 = L.marker(
                [15.9, -39.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_4e6425c65ad192faf2e2f884f1f107cf = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_c9a8f540fa1fc56ec153029fd84a9084.setIcon(icon_4e6425c65ad192faf2e2f884f1f107cf);


            var marker_49373dc4aacd34a168ca71b3e3111c59 = L.marker(
                [23.8, -82.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_822ec04a8b4b1df2466d7a9b509bf5a5 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_49373dc4aacd34a168ca71b3e3111c59.setIcon(icon_822ec04a8b4b1df2466d7a9b509bf5a5);


            var marker_4f951793081de39add8fa7e16387c739 = L.marker(
                [14.9, -58.9],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_68f3b2e4a38d0c001c1f8669dac6a113 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_4f951793081de39add8fa7e16387c739.setIcon(icon_68f3b2e4a38d0c001c1f8669dac6a113);


            var marker_03424c3a253f20fce7b2a52d50a424d7 = L.marker(
                [16.0, -78.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_bba0f9ecfe3a52e55f49f10840736adc = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_03424c3a253f20fce7b2a52d50a424d7.setIcon(icon_bba0f9ecfe3a52e55f49f10840736adc);


            var marker_04b70754e95f7ff0570d1542cc6a87cf = L.marker(
                [14.5, -33.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_f55033a815b5cdc52c819f87d0010a34 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_04b70754e95f7ff0570d1542cc6a87cf.setIcon(icon_f55033a815b5cdc52c819f87d0010a34);


            var marker_0ba91259462440880138ea68f3be3d30 = L.marker(
                [15.4, -54.0],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_d7adc3024a3f7488885dd5a2bdaad3a1 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_0ba91259462440880138ea68f3be3d30.setIcon(icon_d7adc3024a3f7488885dd5a2bdaad3a1);


            var marker_8c23d3721a03ba6d6977c0fb2b89d9f3 = L.marker(
                [30.1, -72.6],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_e71c1c0da58b011fc5e3911d390e67af = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_8c23d3721a03ba6d6977c0fb2b89d9f3.setIcon(icon_e71c1c0da58b011fc5e3911d390e67af);


            var marker_c89b58bad93a756828cd8acc65e7a2b9 = L.marker(
                [25.2, -85.4],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_6165aa8ff1d31585fbb7bd1c3639d70c = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_c89b58bad93a756828cd8acc65e7a2b9.setIcon(icon_6165aa8ff1d31585fbb7bd1c3639d70c);


            var marker_783760a377b512b8170646790b5a7a4e = L.marker(
                [14.3, -33.2],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_d8fed4966f25ebc927676a583bb73cb8 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_783760a377b512b8170646790b5a7a4e.setIcon(icon_d8fed4966f25ebc927676a583bb73cb8);


            var marker_114fac1f8216ea481feb11c5ecd7aa58 = L.marker(
                [12.4, -38.8],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_6d8e7ada48d3c013b7a9dbd59c5b7fe1 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_114fac1f8216ea481feb11c5ecd7aa58.setIcon(icon_6d8e7ada48d3c013b7a9dbd59c5b7fe1);


            var marker_b41940f2588af4bbbbdc699dc3c44695 = L.marker(
                [17.9, -86.4],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_d8cc6ba160c6ede1f446aad1469dce6b = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;red&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_b41940f2588af4bbbbdc699dc3c44695.setIcon(icon_d8cc6ba160c6ede1f446aad1469dce6b);


            var marker_2a98b1ddf31429c3a6bd305f62ad3712 = L.marker(
                [30.1, -70.9],
                {}
            ).addTo(map_52c910d9a8beadf5e6b8546e0098f9b3);


            var icon_47455459b0f1add573effe0f930b63b6 = L.AwesomeMarkers.icon(
                {&quot;extraClasses&quot;: &quot;fa-rotate-0&quot;, &quot;icon&quot;: &quot;info-sign&quot;, &quot;iconColor&quot;: &quot;white&quot;, &quot;markerColor&quot;: &quot;green&quot;, &quot;prefix&quot;: &quot;glyphicon&quot;}
            );
            marker_2a98b1ddf31429c3a6bd305f62ad3712.setIcon(icon_47455459b0f1add573effe0f930b63b6);

&lt;/script&gt;
&lt;/html&gt;" style="position:absolute;width:100%;height:100%;left:0;top:0;border:none !important;" allowfullscreen webkitallowfullscreen mozallowfullscreen></iframe></div></div></div></div>
</div>
</section>
<section id="logistische-regression-modellanpassung">
<h4>Logistische Regression: Modellanpassung<a class="headerlink" href="#logistische-regression-modellanpassung" title="Permalink to this headline">#</a></h4>
<p>Erinnern Sie sich an das Ziel der Übung: Wir wollen ein Modell erstellen, das die Gruppenzugehörigkeit eines Hurrikans vorhersagt, entweder tropisch (<span class="math notranslate nohighlight">\(0\)</span>) oder aussertropisch (<span class="math notranslate nohighlight">\(1\)</span>), basierend auf dem Breitengrad der Entstehung des Hurrikans. Die Antwortvariable ist die binäre Variable <code class="docutils literal notranslate"><span class="pre">Origins</span></code> und die Prädiktorvariable ist <code class="docutils literal notranslate"><span class="pre">FirstLat</span></code>. Wir erstellen ein Logit-Modell, indem wir die Funktion <code class="docutils literal notranslate"><span class="pre">GLM()</span></code> anwenden. Für das logistische Regressionsmodell geben wir <code class="docutils literal notranslate"><span class="pre">family</span> <span class="pre">=</span> <span class="pre">sm.families.Binomial()</span></code> an. Statsmodel erwartet numerischen Inputvariablen, deshalb wandeln wir <code class="docutils literal notranslate"><span class="pre">tropisch</span></code> zu <span class="math notranslate nohighlight">\(0\)</span> und <code class="docutils literal notranslate"><span class="pre">aussertropisch</span></code> zu <span class="math notranslate nohighlight">\(1\)</span> um.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">hurricanes</span><span class="p">[</span><span class="s2">&quot;FirstLat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">hurricanes</span><span class="p">[</span><span class="s2">&quot;Origins&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s2">&quot;tropisch&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;aussertropisch&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span><span class="o">.</span><span class="n">values</span>
<span class="n">log_model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">GLM</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="n">sm</span><span class="o">.</span><span class="n">families</span><span class="o">.</span><span class="n">Binomial</span><span class="p">())</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Wir verwenden die Extraktormethode <code class="docutils literal notranslate"><span class="pre">summary()</span></code>, um die Modelleigenschaften zu überprüfen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">log_model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>Generalized Linear Model Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>           <td>y</td>        <th>  No. Observations:  </th>  <td>   337</td> 
</tr>
<tr>
  <th>Model:</th>                  <td>GLM</td>       <th>  Df Residuals:      </th>  <td>   335</td> 
</tr>
<tr>
  <th>Model Family:</th>        <td>Binomial</td>     <th>  Df Model:          </th>  <td>     1</td> 
</tr>
<tr>
  <th>Link Function:</th>         <td>Logit</td>      <th>  Scale:             </th> <td>  1.0000</td>
</tr>
<tr>
  <th>Method:</th>                <td>IRLS</td>       <th>  Log-Likelihood:    </th> <td> -116.02</td>
</tr>
<tr>
  <th>Date:</th>            <td>Wed, 15 Feb 2023</td> <th>  Deviance:          </th> <td>  232.03</td>
</tr>
<tr>
  <th>Time:</th>                <td>16:59:50</td>     <th>  Pearson chi2:      </th>  <td>  430.</td> 
</tr>
<tr>
  <th>No. Iterations:</th>          <td>6</td>        <th>  Pseudo R-squ. (CS):</th>  <td>0.4963</td> 
</tr>
<tr>
  <th>Covariance Type:</th>     <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th> <td>   -9.0826</td> <td>    0.961</td> <td>   -9.446</td> <td> 0.000</td> <td>  -10.967</td> <td>   -7.198</td>
</tr>
<tr>
  <th>x1</th>    <td>    0.3728</td> <td>    0.039</td> <td>    9.447</td> <td> 0.000</td> <td>    0.295</td> <td>    0.450</td>
</tr>
</table></div></div>
</div>
<p>Schauen wir uns die Koeffizienten genauer an:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">log_model</span><span class="o">.</span><span class="n">params</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-9.08263355,  0.37282953])
</pre></div>
</div>
</div>
</div>
<p>Beachten Sie, dass die Ausgabe des logistischen Modells auf der Link-Skala (<em>logit</em>) erfolgt; die numerische Ausgabe des Modells entspricht also den <strong>Log-Odds</strong>! Der Einfachheit halber schreiben wir das logistische Regressionsmodell mit dem berechneten Achsenabschnitt und Koeffizienten auf.</p>
<div class="math notranslate nohighlight">
\[\phi(\eta) = \frac{1}{1+e^{-\eta}}= \frac{1}{1+e^{-(\beta_0+\beta_1x)}}= \frac{1}{1+e^{-(-9,0826335+ 0,3728295x)}}\]</div>
<p>Konzentrieren wir uns zunächst auf den Koeffizienten des Achsenabschnitts. Der Koeffizient des Achsenabschnitts entspricht der logarithmischen Wahrscheinlichkeit der Beobachtung eines Hurrikans auf dem Breitengrad Null, der als Äquator bekannt ist. Um die Wahrscheinlichkeit der Beobachtung eines aussertropischen Hurrikans bei einem Breitengrad von Null zu berechnen, exponentzieren wir die log-odds <span class="math notranslate nohighlight">\(e^{-9,0826335} \approx 1,1362198\times 10^{-4}\)</span>.</p>
<p>Dies ist eine sehr niedrige Zahl! Und sie macht durchaus Sinn, da es sehr unwahrscheinlich ist, einen aussertropischen Hurrikan am Äquator zu beobachten.</p>
<p>Der Koeffizient der Variable für die Bildungsbreite (<code class="docutils literal notranslate"><span class="pre">FirstLat</span></code>) hat einen numerischen Wert von <span class="math notranslate nohighlight">\(0,3728295\)</span>. Das positive Vorzeichen dieses Wertes zeigt an, dass die Wahrscheinlichkeit, einen außertropischen Wirbelsturm zu beobachten, mit dem Breitengrad zunimmt. Die Größe des Koeffizienten bedeutet, dass die Log-Odds für jedes Grad Zunahme der geografischen Breite im Durchschnitt um konstant <span class="math notranslate nohighlight">\(0,3728295\)</span> Einheiten zunimmt. Wenn man den Koeffizientenwertes als Exponenten nimmt, erhält man das Odds Verhältnis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">log_model</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.451836826600862
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">log_model</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3728295317136198
</pre></div>
</div>
</div>
</div>
<p>Somit erhöht sich das Chancenverhältnis für jedes Grad Zunahme der Bildungsbreite im Durchschnitt um einen konstanten Faktor von <span class="math notranslate nohighlight">\(1,4518368\)</span> (oder <span class="math notranslate nohighlight">\(45 \%\)</span>). Die Interpretation gilt nur für den Bereich der Breitengrade in den Daten und ist für Breitengrade außerhalb des Bereichs, in dem Hurrikane auftreten, physikalisch bedeutungslos.</p>
<p>Die obige Koeffiziententabelle enthält einen Standardfehler und den <span class="math notranslate nohighlight">\(p\)</span>-Wert. Je kleiner der <span class="math notranslate nohighlight">\(p\)</span>-Wert ist, desto geringer ist die Unterstützung für die Nullhypothese angesichts der Daten und des Modells. Zur Erinnerung: Die Nullhypothese besagt, dass der Koeffizient gleich <span class="math notranslate nohighlight">\(0\)</span> ist,
mit anderen Worten, die Nullhypothese besagt, dass es keinen Zusammenhang zwischen dem Auftreten eines nichttropischen Hurrikans und der Entstehungsbreite gibt. Der sehr kleine <span class="math notranslate nohighlight">\(p\)</span>-Wert stützt die Nullhypothese nicht und erlaubt uns, das Modell zu akzeptieren.</p>
<p>Wir haben gelernt, dass jede Punktschätzung von einem Konfidenzniveau bezüglich dieser Punktschätzung begleitet sein sollte. Daher konstruieren wir ein <span class="math notranslate nohighlight">\(95 \%\)</span>-Konfidenzintervall für den geschätzten Modellkoeffizienten. Wir exponentzieren das Ergebnis, um das Odds-Ratio zu erhalten, eine Größe, die leichter zu interpretieren ist als die Log-Odds.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lci</span> <span class="o">=</span> <span class="n">log_model</span><span class="o">.</span><span class="n">conf_int</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">uci</span> <span class="o">=</span> <span class="n">log_model</span><span class="o">.</span><span class="n">conf_int</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;2,5%:  </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">lci</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;97,5%: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">uci</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2,5%:  0.2955
97,5%: 0.4502
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;2,5%:  </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">lci</span><span class="p">),</span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;97,5%: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">uci</span><span class="p">),</span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2,5%:  1.3438
97,5%: 1.5686
</pre></div>
</div>
</div>
</div>
<p>Wir können also mit <span class="math notranslate nohighlight">\(95 \%\)</span>iger Sicherheit sagen, dass für jedes Grad Zunahme der geographischen Breite die Beobachtung eines aussertropischen Hurrikans im Durchschnitt zwischen <span class="math notranslate nohighlight">\(34\)</span> und <span class="math notranslate nohighlight">\(57 \%\)</span> wahrscheinlicher wird. Macht Sinn, oder? In anderen Worten je weiter nördlich Wirbestürme entstehen, umso eher is dieser aussertropischen Einflüssen unterworfen.</p>
</section>
<section id="logistische-regression-modellvorhersage">
<h4>Logistische Regression: Modellvorhersage<a class="headerlink" href="#logistische-regression-modellvorhersage" title="Permalink to this headline">#</a></h4>
<p>Im vorangegangenen Abschnitt haben wir ein logistisches Regressionsmodell für die Beziehung zwischen der Entstehungsbreite und der Art des Hurrikans (tropisch/aussertropisch) erstellt. In diesem Abschnitt wenden wir dieses Modell an, um Vorhersagen über die Wahrscheinlichkeit der Beobachtung eines aussertropischen Hurrikans in Abhängigkeit von der Entstehungsbreite zu machen.</p>
<p>Um die Wahrscheinlichkeit vorherzusagen, dass ein zufällig ausgewählter Hurrikan, der sich auf einem bestimmten Breitengrad bildet, vom Typ aussertropisch ist, wenden wir die Funktion <code class="docutils literal notranslate"><span class="pre">predict()</span></code> an. Berechnen wir die Wahrscheinlichkeit, einen aussertropischen Hurrikan zu beobachten, der sich bei folgenden Breitengraden gebildet hat : <span class="math notranslate nohighlight">\(10^\circ, 23,5^\circ \text{und }30^\circ\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pred</span> <span class="o">=</span> <span class="p">[</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">23.5</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">]</span>  <span class="c1">#</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">log_model</span><span class="o">.</span><span class="n">get_prediction</span><span class="p">(</span><span class="n">exog</span><span class="o">=</span><span class="n">pred</span><span class="p">)</span><span class="o">.</span><span class="n">summary_frame</span><span class="p">()</span>
<span class="n">predictions</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>mean_se</th>
      <th>mean_ci_lower</th>
      <th>mean_ci_upper</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.004705</td>
      <td>0.002701</td>
      <td>0.001524</td>
      <td>0.01443</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.420398</td>
      <td>0.040645</td>
      <td>0.343423</td>
      <td>0.50145</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.891122</td>
      <td>0.028045</td>
      <td>0.822841</td>
      <td>0.93516</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Die Ergebnisse machen durchaus Sinn. Mit zunehmender geografischer Breite nimmt die Wahrscheinlichkeit, die Bildung eines nichttropischen Hurrikans zu beobachten, deutlich zu. Bei einem Breitengrad von <span class="math notranslate nohighlight">\(10^\circ\)</span> beträgt die Wahrscheinlichkeit der Beobachtung eines außertropischen Hurrikans <span class="math notranslate nohighlight">\(0,005\)</span>, während sie bei einem Breitengrad von <span class="math notranslate nohighlight">\(30^\circ \  0,891\)</span> beträgt.</p>
<p>Zum besseren Verständnis wollen wir die Wahrscheinlichkeit der Beobachtung eines nichttropischen Hurrikans, der sich bei einem Breitengrad von <span class="math notranslate nohighlight">\(23,5^\circ\)</span>
von Hand. Erinnern wir uns an die Gleichung für das Regressionsmodell von oben:</p>
<p><span class="math notranslate nohighlight">\(\phi(\eta) = \frac{1}{1+e^{-\eta}} = \frac{1}{1+e^{-(\beta_0+\beta_1x_1)}}\)</span></p>
<p><span class="math notranslate nohighlight">\( = \frac{1}{1+e^{-(-9,0826335+ 0,3728295 \times 23,5)}}\)</span></p>
<p><span class="math notranslate nohighlight">\( =\frac{1}{1+e^{-(-0,3211396)}} \)</span></p>
<p><span class="math notranslate nohighlight">\( = \frac{1}{2,378698}  = 0,4203981 \)</span></p>
<p>Zur Veranschaulichung unserer Ergebnisse erstellen wir ein Diagramm der Vorhersagen über eine Reihe von Breitengraden. Dazu erstellen wir zunächst einen Vektor der Breitengrade, <code class="docutils literal notranslate"><span class="pre">lats</span></code>. Wir geben eine Schrittweite von <span class="math notranslate nohighlight">\(0,1\)</span> Grad an, damit die resultierende Vorhersagekurve glatt ist. Wir wenden die Funktion <code class="docutils literal notranslate"><span class="pre">predict()</span></code> an und verwenden die Methode <code class="docutils literal notranslate"><span class="pre">get_prediction()</span></code>, um den <strong>Standardfehler</strong> der Vorhersage zu erhalten. Die Kenntnis des Standardfehlers ermöglicht die Berechnung der <strong>Fehlermarge</strong> und damit des <strong>Konfidenzintervalls</strong>. Mit der Methode <code class="docutils literal notranslate"><span class="pre">summary_frame()</span></code> können wir die Werte in einem Dataframe ausgeben und darauf zugreifen. Schließlich zeichnen wir die Datenpunkte (Beobachtungen) bei <span class="math notranslate nohighlight">\(0\)</span> und <span class="math notranslate nohighlight">\(1\)</span> ein.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Berechne Vorhersagen für lats</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">hurricanes</span><span class="p">[</span><span class="s2">&quot;FirstLat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">hurricanes</span><span class="p">[</span><span class="s2">&quot;Origins&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s2">&quot;tropisch&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;aussertropisch&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span><span class="o">.</span><span class="n">values</span>

<span class="n">lats_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">hurricanes</span><span class="p">[</span><span class="s2">&quot;FirstLat&quot;</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="n">hurricanes</span><span class="p">[</span><span class="s2">&quot;FirstLat&quot;</span><span class="p">]))</span>


<span class="n">log_model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">GLM</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="n">sm</span><span class="o">.</span><span class="n">families</span><span class="o">.</span><span class="n">Binomial</span><span class="p">())</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">log_model</span><span class="o">.</span><span class="n">get_prediction</span><span class="p">(</span><span class="n">exog</span><span class="o">=</span><span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">lats_grid</span><span class="p">))</span><span class="o">.</span><span class="n">summary_frame</span><span class="p">()</span>

<span class="c1"># Ploting</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lats_grid</span><span class="p">,</span> <span class="n">predictions</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <span class="n">lats_grid</span><span class="p">,</span>
    <span class="n">predictions</span><span class="p">[</span><span class="s2">&quot;mean_ci_lower&quot;</span><span class="p">],</span>
    <span class="n">predictions</span><span class="p">[</span><span class="s2">&quot;mean_ci_upper&quot;</span><span class="p">],</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">outer</span> <span class="o">=</span> <span class="n">hurricanes</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hurricanes</span><span class="o">.</span><span class="n">Origins</span> <span class="o">==</span> <span class="s2">&quot;aussertropisch&quot;</span><span class="p">,</span> <span class="s2">&quot;FirstLat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">outer</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">repeats</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">outer</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;aussertropisch&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">tropical</span> <span class="o">=</span> <span class="n">hurricanes</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hurricanes</span><span class="o">.</span><span class="n">Origins</span> <span class="o">==</span> <span class="s2">&quot;tropisch&quot;</span><span class="p">,</span> <span class="s2">&quot;FirstLat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">tropical</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">repeats</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">tropical</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;tropisch&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="k">for</span> <span class="n">_y</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">_y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Geografische Breite&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Wahrscheinlichkeit&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f43da9758a0&gt;
</pre></div>
</div>
<img alt="_images/01_Logistische_Regression_74_1.png" src="_images/01_Logistische_Regression_74_1.png" />
</div>
</div>
<p>Die Beobachtungen tropischer und aussertropischer Hurrikane sind entlang der Linien <span class="math notranslate nohighlight">\(y=0\)</span> bzw. <span class="math notranslate nohighlight">\(y=1\)</span> Linien dargestellt. Das graue Band ist das <span class="math notranslate nohighlight">\(95 \%\)</span>ige punktweise Konfidenzintervall.</p>
<p>Die Modellvorhersagen zeigen, dass die Wahrscheinlichkeit eines nichttropischen Hurrikans bei Breitengraden südlich von <span class="math notranslate nohighlight">\(20^\circ N\)</span> weniger als <span class="math notranslate nohighlight">\(10 \%\)</span> beträgt. Bis zum Breitengrad <span class="math notranslate nohighlight">\(26^\circ N\)</span> übersteigt die Wahrscheinlichkeit jedoch <span class="math notranslate nohighlight">\(50 \%\)</span> und bis zum Breitengrad <span class="math notranslate nohighlight">\(33^\circ N\)</span> übersteigt die Wahrscheinlichkeit <span class="math notranslate nohighlight">\(90 \%\)</span>. Das Chancenverhältnis ist konstant, aber die Wahrscheinlichkeit ist eine nichtlineare Funktion des Breitengrads.</p>
</section>
</section>
</section>
<span id="document-Aufgaben/Kapitel09/Aufgaben"></span><section class="tex2jax_ignore mathjax_ignore" id="ubungsaufgaben">
<h2>Übungsaufgaben<a class="headerlink" href="#ubungsaufgaben" title="Permalink to this headline">#</a></h2>
<div class="toctree-wrapper compound">
<span id="document-Aufgaben/Kapitel09/LogReg_basics"></span><section class="tex2jax_ignore mathjax_ignore" id="logistische-regression-grundbegriffe">
<h3>Logistische Regression - Grundbegriffe<a class="headerlink" href="#logistische-regression-grundbegriffe" title="Permalink to this headline">#</a></h3>
<ol class="simple">
<li><p>Was sind Odds, Log-Odds (<span class="math notranslate nohighlight">\(Logit\)</span>)? Auf welchen Wertebereich bilden sie ab?</p></li>
<li><p>Vergleichen Sie lineare und einfache logistische Regression. Worin unterscheiden sie sich?</p></li>
<li><p>Was ist die logistische Funktion? Wie hängt Sie mit der <span class="math notranslate nohighlight">\(logit\)</span>-Funktion zusammen?</p></li>
</ol>
<hr class="docutils" />
<section id="losungen">
<h4>Lösungen<a class="headerlink" href="#losungen" title="Permalink to this headline">#</a></h4>
<div class="toggle docutils container">
<p>Odds (<span class="math notranslate nohighlight">\(o\)</span>) sind definiert als die Wahrscheinlichkeit, dass ein Ereignis eintritt, geteilt durch die Wahrscheinlichkeit, dass es nicht eintritt.</p>
<div class="math notranslate nohighlight">
\[o = \frac{\pi}{1-\pi}\]</div>
<p>Mit anderen Worten, es ist ein Verhältnis von Erfolgen (oder Gewinnen) zu Verlusten (oder Misserfolgen). Die Odds bilden auf den Wertebereich <span class="math notranslate nohighlight">\(]0 \ \)</span>,<span class="math notranslate nohighlight">\( \ +\infty[\)</span> ab.</p>
<p>Log-odds sind definiert als der Logarithmus der Odds:</p>
<div class="math notranslate nohighlight">
\[logit(\pi) =\log ( \frac{\pi}{1-\pi} )\]</div>
<p>Die Log-Odds bilden auf den Wertebereich <span class="math notranslate nohighlight">\(]-\infty , +\infty[\)</span> ab.</p>
</div>
<div class="toggle docutils container">
<p>Im linearen Regressionsmodell wird versucht eine Gerade durch Datenpunkte zulegen, wobei der Abstand zu allen Punkten minimiert wird. Die <span class="math notranslate nohighlight">\(y\)</span>-Achse wird dabei als stetig angenommen. Das linearen Regressionsmodell kann wie folgt definiert werden:</p>
<div class="math notranslate nohighlight">
\[y= \beta_0 + \beta_1x\]</div>
<p><span class="math notranslate nohighlight">\(\beta_0\)</span> und <span class="math notranslate nohighlight">\(\beta_1\)</span> können über die Methode der kleinsten Quadrate geschätzt werden.</p>
<p>Das einfache logistische Modell wird wie folgt definiert:</p>
<div class="math notranslate nohighlight">
\[\pi = \frac{1}{1+e^{-(\beta_0+ \beta_1x)}}\]</div>
<p>Es besitzt eine binäre <span class="math notranslate nohighlight">\(y\)</span>-Achse (<span class="math notranslate nohighlight">\(1\)</span> oder <span class="math notranslate nohighlight">\(0\)</span>) und <span class="math notranslate nohighlight">\(\pi\)</span> gibt die Wahrscheinlichkeit an für einen bestimmten <span class="math notranslate nohighlight">\(x\)</span>-Wert entweder <span class="math notranslate nohighlight">\(1\)</span> oder <span class="math notranslate nohighlight">\(0\)</span> zu erhalten. Um <span class="math notranslate nohighlight">\(\beta_0+ \beta_1x_1\)</span> zu schätzen gehen wir analog zur linearen Regression vor, nur unterscheiden sie sich dadurch das wir in diesem Fall für die <span class="math notranslate nohighlight">\(logit\)</span>-Funktion:</p>
<div class="math notranslate nohighlight">
\[logit(\pi) = \beta_0+ \beta_1x\]</div>
<p><span class="math notranslate nohighlight">\(\beta_0\)</span> und <span class="math notranslate nohighlight">\(\beta_1\)</span> mittels Maximum-Likelihood Methode schätzen.</p>
</div>
<div class="toggle docutils container">
<p>Die logistische Funktion für einfache logistische Regression ist definiert als:</p>
<div class="math notranslate nohighlight">
\[\pi = logit^{-1}(log \left( \frac{\pi}{1-\pi}\right)) = logit^{-1}(\eta) = \frac{e^{\eta}}{1+e^{\eta}} = \frac{1}{1+e^{-(\beta_0+ \beta_1x)}}\]</div>
<p>Die logistische Funktion ist die Inverse der <span class="math notranslate nohighlight">\(logit\)</span>-Funktion.</p>
</div>
</section>
</section>
<span id="document-Aufgaben/Kapitel09/logit_funktion"></span><section class="tex2jax_ignore mathjax_ignore" id="logistische-funktion">
<h3>Logistische Funktion<a class="headerlink" href="#logistische-funktion" title="Permalink to this headline">#</a></h3>
<ol class="simple">
<li><p>Zeigen Sie dass die logistische Funktion <span class="math notranslate nohighlight">\(logit^{-1}(\eta) = \frac{e^{\eta}}{1+e^{\eta}}\)</span> die inverse Funktion zur <span class="math notranslate nohighlight">\(logit\)</span>-Funktion <span class="math notranslate nohighlight">\(\eta = logit(\pi) = log \left( \frac{\pi}{1-\pi}\right)\)</span> ist.</p></li>
</ol>
<hr class="docutils" />
<section id="losungen">
<h4>Lösungen<a class="headerlink" href="#losungen" title="Permalink to this headline">#</a></h4>
<div class="toggle docutils container">
<ul class="simple">
<li><p>logistische Funktion umwandeln</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\frac{e^{\eta}}{1+e^{\eta}} = \frac{e^{\eta}}{e^{\eta}}\frac{1}{e^{-\eta}+1} = \frac{1}{e^{-\eta}+1}\]</div>
<ul class="simple">
<li><p>Logit Funktion in logistische Funktion einsetzen</p></li>
</ul>
<div class="math notranslate nohighlight">
\[logit^{-1}(logit(\pi)) = logit^{-1}(log \left( \frac{\pi}{1-\pi}\right))) = \]</div>
<div class="math notranslate nohighlight">
\[ = \frac{1}{1+e^{-log \left( \frac{\pi}{1-\pi}\right)}} = \frac{1}{1+\frac{1}{\left( \frac{\pi}{1-\pi}\right)}} =\]</div>
<div class="math notranslate nohighlight">
\[ = \frac{1}{1+\frac{1 - \pi}{\pi}} = \frac{1}{\frac{\pi + 1 - \pi}{\pi}} = \pi\]</div>
</div>
</section>
</section>
<span id="document-Aufgaben/Kapitel09/logodds"></span><section class="tex2jax_ignore mathjax_ignore" id="odds-und-log-odds">
<h3>Odds und Log-Odds<a class="headerlink" href="#odds-und-log-odds" title="Permalink to this headline">#</a></h3>
<p>Zeigen Sie, dass wenn die Odds und das einfache (binomiale) logistische Regressionsmodell (<span class="math notranslate nohighlight">\(\pi\)</span>) gegeben sind durch:</p>
<div class="math notranslate nohighlight">
\[\text{Odds} = \frac{\pi}{1-\pi}\]</div>
<div class="math notranslate nohighlight">
\[\pi = \frac{1}{1+e^{-\eta}} = \frac{1}{1+e^{-(\beta_0+ \beta_1x_1)}}\]</div>
<p>die Log-Odds gleich</p>
<p>$<span class="math notranslate nohighlight">\(\text{Log-Odds} =\log \biggl( \frac{\pi}{1-\pi} \biggr)= \beta_0+ \beta_1x_1\)</span>$ sind.</p>
<hr class="docutils" />
<section id="losungen">
<h4>Lösungen<a class="headerlink" href="#losungen" title="Permalink to this headline">#</a></h4>
<div class="toggle docutils container">
<p>Wir setzen das logische Regressionsmodell in die Odds ein:</p>
<div class="math notranslate nohighlight">
\[ \frac{\pi}{1-\pi} = \frac{(1+e^{-(\beta_0 + \beta_1 x_1)})^{-1}}{1-(1+e^{-(\beta_0 + \beta_1 x_1)})^{-1}} = \]</div>
<div class="math notranslate nohighlight">
\[= \frac{1}{1+e^{-(\beta_0 + \beta_1 x_1)}-1} = e^{(\beta_0 + \beta_1 x_1)}\]</div>
<div class="math notranslate nohighlight">
\[\log \left( \frac{\pi}{1-\pi}\right) = \log (e^{(\beta_0 + \beta_1 x_1)}) = \beta_0 + \beta_1 x_1 \]</div>
</div>
</section>
</section>
<span id="document-Aufgaben/Kapitel09/logregmodell"></span><section class="tex2jax_ignore mathjax_ignore" id="einfaches-logistisches-regressionsmodell">
<h3>Einfaches logistisches Regressionsmodell<a class="headerlink" href="#einfaches-logistisches-regressionsmodell" title="Permalink to this headline">#</a></h3>
<ol class="simple">
<li><p>Erstellen Sie ein einfaches logistische Regressionsmodell für die folgenden Daten in Python und stellen Sie das logistische Modell graphisch dar.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mi">29</span><span class="p">,</span>
    <span class="mi">15</span><span class="p">,</span>
    <span class="mi">33</span><span class="p">,</span>
    <span class="mi">28</span><span class="p">,</span>
    <span class="mi">39</span><span class="p">,</span>
    <span class="mi">44</span><span class="p">,</span>
    <span class="mi">31</span><span class="p">,</span>
    <span class="mi">19</span><span class="p">,</span>
    <span class="mi">9</span><span class="p">,</span>
    <span class="mi">24</span><span class="p">,</span>
    <span class="mi">32</span><span class="p">,</span>
    <span class="mi">31</span><span class="p">,</span>
    <span class="mi">37</span><span class="p">,</span>
    <span class="mi">35</span><span class="p">,</span>
    <span class="mi">8</span><span class="p">,</span>
    <span class="mi">4</span><span class="p">,</span>
    <span class="mi">11</span><span class="p">,</span>
    <span class="mi">12</span><span class="p">,</span>
    <span class="mi">33</span><span class="p">,</span>
    <span class="mi">45</span><span class="p">,</span>
    <span class="mi">20</span><span class="p">,</span>
    <span class="mi">25</span><span class="p">,</span>
    <span class="mi">27</span><span class="p">,</span>
    <span class="mi">26</span><span class="p">,</span>
    <span class="mi">29</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<section id="losungen">
<h4>Lösungen<a class="headerlink" href="#losungen" title="Permalink to this headline">#</a></h4>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>


<span class="n">log_model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">GLM</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">family</span><span class="o">=</span><span class="n">sm</span><span class="o">.</span><span class="n">families</span><span class="o">.</span><span class="n">Binomial</span><span class="p">())</span>
<span class="n">log_results</span> <span class="o">=</span> <span class="n">log_model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="n">x_axis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">num</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">log_results</span><span class="o">.</span><span class="n">get_prediction</span><span class="p">(</span><span class="n">exog</span><span class="o">=</span><span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">x_axis</span><span class="p">))</span><span class="o">.</span><span class="n">summary_frame</span><span class="p">()</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">predictions</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Wahrscheinlichkeit&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/logregmodell_6_0.png" src="_images/logregmodell_6_0.png" />
</div>
</div>
</section>
</section>
</div>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-Literaturverzeichnis"></span><section class="tex2jax_ignore mathjax_ignore" id="literaturverzeichnis">
<h2>Literaturverzeichnis<a class="headerlink" href="#literaturverzeichnis" title="Permalink to this headline">#</a></h2>
<div class="docutils container" id="id1">
<dl class="citation">
<dt class="label" id="id11"><span class="brackets">1</span></dt>
<dd><p>Günther Bourier. <em>Wahrscheinlichkeitsrechnung und schließende Statistik</em>. Springer, 2002.</p>
</dd>
<dt class="label" id="id13"><span class="brackets">2</span></dt>
<dd><p>Peter Bruce and Peter Bruce, Andrew und Gedeck. <em>Praktische Statistik für Data Scientists</em>. dpunkt.verlag, 2021.</p>
</dd>
<dt class="label" id="id6"><span class="brackets">3</span></dt>
<dd><p>Udo Cramer, Erhard und Kamps. <em>Grundlagen der Wahrscheinlichkeitsrechnung und Statistik: Eine Einführung für Studierende der Informatik, der Ingenieur-und Wirtschaftswissenschaften</em>. Springer-Verlag, 2017.</p>
</dd>
<dt class="label" id="id9"><span class="brackets">4</span></dt>
<dd><p>Lutz Dümbgen. <em>Einführung in die Statistik</em>. Springer, 2016.</p>
</dd>
<dt class="label" id="id3"><span class="brackets">5</span></dt>
<dd><p>Ludwig Fahrmeir, Christian Heumann, Rita Künstler, Iris Pigeot, and Gerhard Tutz. <em>Statistik : Der Weg zur Datenanalyse</em>. Springer-Verlag, 2016.</p>
</dd>
<dt class="label" id="id12"><span class="brackets">6</span></dt>
<dd><p>Frost. <em>Einfache lineare Regression - Die Grundlage für komplexe Regressionsmodelle verstehen</em>. Springer, 2018.</p>
</dd>
<dt class="label" id="id10"><span class="brackets">7</span></dt>
<dd><p>Udo Kuckartz, Stefan Rädiker, Thomas Ebert, and Julia Schehl. <em>Statistik: eine verständliche Einführung</em>. Springer-Verlag, 2013.</p>
</dd>
<dt class="label" id="id5"><span class="brackets">8</span></dt>
<dd><p>Norbert Lang, Christian B und Pucker. <em>Mathematische Methoden in der Physik</em>. Volume 2. Springer, 2005.</p>
</dd>
<dt class="label" id="id8"><span class="brackets">9</span></dt>
<dd><p>Lothar Papula. <em>Mathematik für Ingenieure und Naturwissenschaftler Band 3</em>. Springer, 2016.</p>
</dd>
<dt class="label" id="id14"><span class="brackets">10</span></dt>
<dd><p>Stefanie Scheid, Sandro und Vogl. <em>Data Science: Grundlagen, Methode und Modelle der Statistik</em>. Carl Hanser Verlag GmbH Co KG, 2021.</p>
</dd>
<dt class="label" id="id4"><span class="brackets">11</span></dt>
<dd><p>Walpole. The weight of nations: an estimation of adult human biomass. <em>BMC Public Health</em>, 2012.</p>
</dd>
<dt class="label" id="id2"><span class="brackets">12</span></dt>
<dd><p>Christoph Weigand. <em>Statistik mit und ohne Zufall</em>. Springer, 2006.</p>
</dd>
</dl>
</div>
</section>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "ixianslab/srh-data-science",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By ixians<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>